<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">
    Поля в байтах КОП и ModeR/M при 16 битной адресации
    ───────────────────────────────────────────────────

 Wbit - определяет размер операнда
 W=0  - байт
 W=1  - полный размер (16 или 32 бита)

 Dbit - направление передачи данных
 D=0  - регистр в REG/MEM
 D=1  - REG/MEM в регистр

 Sbit - расширение непосредственных данных
 S=0  - до полного размера (16 или 32 бита)
 S=1  - байт

 REG  - определяет регистр общего назначения 8/16/32 бита
 MODE - определяет режим адресации вместе с REG/MEM
 REG/MEM - второй операнд - регистр 8/16/32 или память

 Mode    │   00    │      01      │  10   │    11
 REG/MEM │     │          │       │
 ────────┼─────────┼──────────────┼───────────────┼──────────
 000     │ [BX+SI] │ [BX+SI]+imm8 │ [BX+SI]+imm16 │ EAX/AX/AL
 001     │ [BX+DI] │ [BX+DI]+imm8 │ [BX+DI]+imm16 │ ECX/CX/CL
 010     │ [BP+SI] │ [BP+SI]+imm8 │ [BP+SI]+imm16 │ EDX/DX/DL
 011     │ [BP+DI] │ [BP+DI]+imm8 │ [BP+DI]+imm16 │ EBX/BX/BL
 100     │ [SI]    │ [SI]+imm8    │ [SI]+imm16    │ ESP/SP/AH
 101     │ [DI]    │ [DI]+imm8    │ [DI]+imm16    │ EBP/BP/CH
 110     │ [imm16] │ [BP]+imm8    │ [BP]+imm16    │ ESI/SI/DH
 111     │ [BX]    │ [BX]+imm8    │ [BX]+imm16    │ EDI/DI/BH


 SREG - сегментный регистр 000 - ES
               001 - CS
               010 - SS
               011 - DS
               100 - FS
               101 - GS

 НОП - непосредственный операнд

 ────────────────────────────────────────────────────────────────────────────

             СИСТЕМА КОММАНД i386
             ────────────────────


  MOV─переслать регистр в регистр/память
 ┌────────────────┬────────────────┐
 │1 0 0 0 1 0 d w │mod reg reg/mem │
 └────────────────┴────────────────┘

  НОП в регистр/память
 ┌────────────────┬────────────────┐
 │1 1 0 0 0 1 1 w │mod 000 reg/mem │ + Immediate 8/16 bit
 └────────────────┴────────────────┘

  НОП в регистр
 ┌────────────────┐
 │1 0 1 1 w  reg  │ + Immediate 8/16 bit      
 └────────────────┘

  память в аккумулятор
  (short form)
 ┌────────────────┐
 │1 0 1 0 0 0 d w │ + Immediate 16 bit
 └────────────────┘

  регистр/память в сегментный регистр
 ┌────────────────┬──────────────┐
 │1 0 0 0 1 1 d 0 │mod 0 sreg r/m│
 └────────────────┴──────────────┘

  Переслать с распространением в регистр из регистра/памяти
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 1011x11w │mod reg r/m│
 └──────────┴──────────┴───────────┘
  x=0 - с распространением нуля  - MOVZX
  x=1 - с распространением знака - MOVSX

  ───────────────────────────────────────────────────────────────────────────

  PUSH─запись в стек памяти
 ┌────────────────┬────────────────┐
 │1 1 1 1 1 1 1 1 │mod 110 reg/mem │
 └────────────────┴────────────────┘

  POP─чтение из стека в память
 ┌────────────────┬────────────────┐
 │1 0 0 0 1 1 1 1 │mod 000 reg/mem │
 └────────────────┴────────────────┘

  PUSH/POP регистра
 ┌────────────────┐
 │0 1 0 1 x  reg  │   x=0 - PUSH , x=1 - POP
 └────────────────┘

  PUSH/POP сегментного регистра ES, CS, SS или DS
 ┌────────────────┐
 │0 0 0 sreg 1 1 x│   x=0 - PUSH , x=1 - POP
 └────────────────┘

  сегментного регистра ES, CS, SS, DS, FS или GS
 ┌────────────────┬────────────────┐
 │0 0 0 0 1 1 1 1 │1 0 sreg 0 0 x  │   x=0 - PUSH , x=1 - POP
 └────────────────┴────────────────┘

  НОПа
 ┌────────────────┐
 │0 1 1 0 1 0 s 0 │ + Immediate 8/16 bit
 └────────────────┘

  PUSHA/POPA AllReg's
 ┌────────────────┐
 │0 1 1 0 0 0 0 x │   x=0 - PUSH , x=1 - POP
 └────────────────┘

  PUSHF/POPF flags
 ┌────────────────┐
 │1 0 0 1 1 1 0 x │   x=0 - PUSH , x=1 - POP
 └────────────────┘

 ────────────────────────────────────────────────────────────────────────────

 XCHG - обмен

  TEST/XCHG регистра/памяти с регистром
 ┌────────────────┬────────────────┐
 │1 0 0 0 0 1 x w │mod reg reg/mem │   x=0 - TEST , x=1 - XCHG
 └────────────────┴────────────────┘

  регистр с аккумулятором
  (short form)
 ┌────────────────┐
 │1 0 0 1 0  reg  │     
 └────────────────┘

 ────────────────────────────────────────────────────────────────────────────

  Ввод/вывод через аккумулятор
 ┌────────────────┐
 │1 1 1 0 x 1 y w │ + [Immediate 8] - номер порта
 └────────────────┘
  xy = 00 - IN ввод с фиксированным портом
  xy = 01 - OUT вывод с фиксированным портом
  xy = 10 - IN ввод с виртуальным портом адресуемым DL/DX
  xy = 11 - OUT вывод с виртуальным портом адресуемым DL/DX

  INS/OUTS ─ строковый ввод/вывод с виртуальным портом адресуемым DX
 ┌────────────────┐
 │0 1 1 0 1 1 x w │   x=0 - INS , x=1 - OUTS
 └────────────────┘

 ────────────────────────────────────────────────────────────────────────────

  LEA─загрузка в регистр исполнительного адреса
 ┌────────────────┬────────────────┐
 │1 0 0 0 1 1 0 1 │mod reg reg/mem │
 └────────────────┴────────────────┘

  Загрузка указателя в DS,ES:REG , sreg : 01 - DS
 ┌────────────────┬────────────────┐      00 - ES
 │1 1 0 0 0 1 sreg│mod reg reg/mem │
 └────────────────┴────────────────┘

  Загрузка указателя в FS,GS,SS:REG , sreg : 100 - FS
 ┌──────────┬──────────┬───────────┐         101 - GS
 │ 00001111 │10110 sreg│mod reg r/m│         010 - SS
 └──────────┴──────────┴───────────┘

 ────────────────────────────────────────────────────────────────────────────

  Сброс и установка флагов CF,IF,DF во Flags
 ┌────────────────┐
 │1 1 1 1 1 x x x │   xxx = 000 - CLC - сбросить CF
 └────────────────┘     001 - STC - установить CF
                010 - CLI - сбросить IF
                011 - STI - установить IF
                100 - CLD - сбросить DF
                101 - STD - установить DF


  CLTS ─ сброс флага пошагового режима TS
 ┌────────────────┬─────────────────┐
 │0 0 0 0 1 1 1 1 │ 0 0 0 0 0 1 1 0 │
 └────────────────┴─────────────────┘

  CMC ─ инверсия CF
 ┌────────────────┐
 │1 1 1 1 0 1 0 1 │
 └────────────────┘

  LAHF─загрузить в AH регистр флагов
  SAHF─сохранить в регистре флагов AH
 ┌────────────────┐
 │1 0 0 1 1 1 1 x │   x=0 - SAHF , x=1 - LAHF
 └────────────────┘

 ────────────────────────────────────────────────────────────────────────────

  Арифметические и логические команды

  регистр с регистром/памятью         xxx = 000 - add
 ┌────────────────┬────────────────┐        001 - or
 │0 0 x x x 0 d w │mod reg reg/mem │        010 - adc
 └────────────────┴────────────────┘        011 - sbb
                        100 - and
                        101 - sub
                        110 - xor
                        111 - cmp
  НОП с регистром/памятью
 ┌────────────────┬────────────────┐
 │1 0 0 0 0 0 s w │mod xxx reg/mem │ + Immediate 8/16
 └────────────────┴────────────────┘

  НОП с аккумулятором (short form)
 ┌────────────────┐
 │0 0 x x x 1 0 w │ + Immediate 8/16 bit
 └────────────────┘

 ────────────────────────────────────────────────────────────────────────────

  TEST ─ проверка разрядов

  TEST/XCHG регистра/памяти и регистра
 ┌────────────────┬────────────────┐
 │1 0 0 0 0 1 x w │mod reg reg/mem │   x=0 - TEST , x=1 - XCHG
 └────────────────┴────────────────┘

 TEST регистра/памяти и НОПа
 ┌────────────────┬────────────────┐
 │1 1 1 1 0 1 1 w │mod 000 reg/mem │ + Immediate 8/16
 └────────────────┴────────────────┘

 TEST аккумулятора и НОПа
 ┌────────────────┐
 │1 0 1 0 1 0 0 w │ + Immediate 8/16          
 └────────────────┘

 ────────────────────────────────────────────────────────────────────────────

  INC/DEC регистра/памяти
 ┌────────────────┬────────────────┐
 │1 1 1 1 1 1 1 w │mod 00x reg/mem │  x=0 - INC , x=1 - DEC
 └────────────────┴────────────────┘

  INC/DEC регистра
 ┌────────────────┐
 │0 1 0 0 x  reg  │     
 └────────────────┘

 ────────────────────────────────────────────────────────────────────────────

  NEG ─ замена знака в регистре/памяти
 ┌────────────────┬────────────────┐
 │1 1 1 1 0 1 1 w │mod 011 reg/mem │
 └────────────────┴────────────────┘

  NOT ─ инверсия регистра/памяти
 ┌────────────────┬────────────────┐
 │1 1 1 1 0 1 1 w │mod 010 reg/mem │
 └────────────────┴────────────────┘

 ────────────────────────────────────────────────────────────────────────────

  Умножение/деление аккумулятора на регистр/память
 ┌────────────────┬────────────────┐
 │1 1 1 1 0 1 1 w │mod 1xx reg/mem │   xx = 00 - MUL  - беззнаковое
 └────────────────┴────────────────┘        01 - IMUL - знаковое
                        10 - DIV  - беззнаковое
                        11 - IDIV - знаковое


  Знаковое умножение регистра на регистр/память
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 10101111 │mod reg r/m│
 └──────────┴──────────┴───────────┘

  Знаковое умножение регистра/памяти на НОП
 ┌────────────────┬────────────────┐
 │0 1 1 0 1 0 s 1 │mod reg reg/mem │ + Immediate 8/16
 └────────────────┴────────────────┘

 ────────────────────────────────────────────────────────────────────────────

 Сдвиговые команды

  Сдвиг регистра/памяти
 ┌────────────────┬────────────────┐
 │1 1 0 x 0 0 y w │mod zzz reg/mem │ + [Immediate 8bit]
 └────────────────┴────────────────┘

  xy = 00 - сдвиг на Imm8         zzz = 000 - ROL
       01 - не используется         001 - ROR
       10 - сдвиг на один разряд        010 - RCL
       11 - сдвиг на Imm8 через CL      011 - RCR
                        100 - SHL/SAL
                        101 - SHR
                        110 - SAL - (UnDocumented)
                        111 - SAR


  SHLD/SHRD ─ двойной сдвиг регистра/памяти на Imm8
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 1010x10y │mod reg r/m│ + [Immediate 8 bit]
 └──────────┴──────────┴───────────┘
  xy = 00 - влево на Imm8
       01 - влево на Imm8 через CL
       10 - вправо на Imm8
       11 - вправо на Imm8 через CL

 ────────────────────────────────────────────────────────────────────────────

  Коррекция и расширение аккумулятора

 ┌────────────────┐
 │0 0 1 x x 1 1 1 │  xx = 00 - DAA - десятичная после сложения
 └────────────────┘   01 - DAS - десятичная после вычитания
              10 - AAA - после сложения
              11 - AAS - после вычитания

 ┌────────────────┬────────────────┐
 │1 1 0 1 0 1 0 x │0 0 0 0 1 0 1 0 │
 └────────────────┴────────────────┘
  x=0 - AAM - коррекция после умножения
  x=1 - AAD - коррекция перед делением

  CBW/CWD ─ расширение
 ┌────────────────┐
 │1 0 0 1 1 0 0 x │
 └────────────────┘
  x=0 - CBW - байта в слово
  x=1 - CWD - слова в двойное слово

 ────────────────────────────────────────────────────────────────────────────

  Строковые команды   xxx = 010 - MOVS - пересылка
 ┌────────────────┐     011 - CMPS - сравнение
 │1 0 1 0 x x x w │     101 - STOS - запись       аккумулятора
 └────────────────┘     110 - LODS - загрузка
                111 - SCAS - сканирование

  INS/OUTS ─ строковый ввод/вывод с виртуальным портом через DX
 ┌────────────────┐
 │0 1 1 0 1 1 x w │   x=0 - INS , x=1 - OUTS
 └────────────────┘

  XLAT ─ табличное преобразвание
 ┌────────────────┐
 │1 1 0 1 0 1 1 1 │
 └────────────────┘

  Префиксы повторения  (Счетчик повторений в CX)
 ┌────────────────┐
 │1 1 1 1 0 0 1 x │  x=0 - REPNZ/REP , x=1 - REPZ
 └────────────────┘

 ────────────────────────────────────────────────────────────────────────────

  Обработка разрядов

  BSF/BSR - Поиск разряда
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 1011110x │mod reg r/m│
 └──────────┴──────────┴───────────┘
  x=0 - Bit Scan Forward
  x=1 - Bit Scan Reverse


  BitTest Регистр/Память,Регистр
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 101xx011 │mod reg r/m│  xx = 00 - BT  тестировать
 └──────────┴──────────┴───────────┘       01 - BTS и установить
                       10 - BTR и сбросить
                       11 - BTC и инвертировать

  BitTest Регистр/Память,НОП
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 10111010 │mod xxx r/m│ + Immediate 8 bit
 └──────────┴──────────┴───────────┘
  xxx = 010 - BTS и установить
    100 - BT  тестировать
    110 - BTR и сбросить
    111 - BTC и инвертировать


   XBTS/IBTS - исключение/вставка битов встроку
 ┌────────────────┬────────────────┐
 │0 0 0 0 1 1 1 1 │1 0 1 0 0 1 1 x │  x=0 - XBTS , x=1 - IBTS
 └────────────────┴────────────────┘

 ────────────────────────────────────────────────────────────────────────────

  Команды передачи управления

  CALL/JMP с прямой адресацией
 ┌────────────────┐
 │1 1 1 0 1 0 x x │ + Immediate 8/16/32
 └────────────────┘
  xx = 00 - CALL внутрисегментный - Rel16
       01 - JMP внутрисегментный - Rel16
       10 - JMP межсегментный - Abs16:Abs16 (смещение,селектор)
       11 - JMP внутрисегментный короткий - Rel8


  CALL межсегментный с прямой адресацией
 ┌────────────────┐
 │1 0 0 1 1 0 1 0 │ + Immediate 32 - Abs16:Abs16 (смещение,селектор)
 └────────────────┘

  CALL/JMP с косвенной адресацией через Регистр/Память
 ┌────────────────┬────────────────┐
 │1 1 1 1 1 1 1 1 │mod xxy reg/mem │  xx = 01 - CALL  y=0 - внутрисегментный
 └────────────────┴────────────────┘       10 - JMP 1 - межсегментный
  xxy = 010 - CALL внутрисегментный
    011 - CALL межсегментный
    100 - JMP внутрисегментный
    101 - JMP межсегментный


  Условные Переходы и Установки признака

                              xxxx = 0000 - o
  Jxx - Условный короткий переход                0001 - no
 ┌────────────────┐                      0010 - c
 │0 1 1 1 x x x x │ + Immediate 8 bit - Rel8             0011 - nc
 └────────────────┘                      0100 - z
                                 0101 - nz
  Jxx - Условный близкий переход                 0110 - be
 ┌────────────────┬────────────────┐                 0111 - a
 │0 0 0 0 1 1 1 1 │1 0 0 0 x x x x │ + Immediate 16 bit      1000 - s
 └────────────────┴────────────────┘                 1001 - ns
                                 1010 - p
  SETxx - Установка признака в регистр/память            1011 - np
 ┌──────────┬──────────┬───────────┐                 1100 - l
 │ 00001111 │ 1001xxxx │mod 000 r/m│                 1101 - ge
 └──────────┴──────────┴───────────┘                 1110 - le
                                 1111 - g

  Циклы и переходы со счетчиком CX
 ┌────────────────┐          xx = 00 - LOOPNZ
 │1 1 1 0 0 0 x x │ + Immediate 8 bit         01 - LOOPZ
 └────────────────┘               10 - LOOP
                          11 - JCXZ

 ────────────────────────────────────────────────────────────────────────────

  Прерывания,обработка процедур и возвраты
 ┌────────────────┐
 │1 1 0 0 1 x x x │ + [Immediate 16 bit] + [Immediate 8 bit]
 └────────────────┘
  xxx = 000 - ENTER - вход в процедуру (make stack frame)
    001 - LEAVE - выход из процедуры
    010 - RETF Imm8 - возврат дальний с очисткой стека
    011 - RETF  - возврат дальний

    100 - INT 3 - debug Int
    101 - INT Imm8  - прерывание по вектору
    110 - INTO  - прерывание по переполнению
    111 - IRET  - возврат из прерывания

  RET/RET Imm8 - ближние возвраты
 ┌────────────────┐
 │1 1 0 0 0 0 1 x │  x=0 - RETN Imm8 , x=1 - RETN
 └────────────────┘

  BOUND - контроль индекса в границах
 ┌────────────────┬────────────────┐
 │0 1 1 0 0 0 1 0 │mod reg reg/mem │
 └────────────────┴────────────────┘

 ────────────────────────────────────────────────────────────────────────────

  Управление процессором

  HLT - останов
 ┌────────────────┐
 │1 1 1 1 0 1 0 0 │
 └────────────────┘

  MOV - загрузка управляющих регистров   xx = 00 - CR0
 ┌──────────┬──────────┬───────────┐          01 - CR1  (UnDocumented)
 │ 00001111 │ 001000d0 │ 000xx reg │          10 - CR2
 └──────────┴──────────┴───────────┘          11 - CR3

  MOV - загрузка отладочных регистров    xxx = 000 - DR0
 ┌──────────┬──────────┬───────────┐           001 - DR1
 │ 00001111 │ 001000d1 │ 11xxx reg │           010 - DR2
 └──────────┴──────────┴───────────┘           011 - DR3
                           100 - DR4  (UnDocumented)
                           101 - DR5  (UnDocumented)
                           110 - DR6
                           111 - DR7

  MOV - загрузка проверочных регистров   xxx = 000 - TR0  (UnDocumented)
 ┌──────────┬──────────┬───────────┐           001 - TR1  (UnDocumented)
 │ 00001111 │ 001001d0 │ 11xxx reg │           010 - TR2  (UnDocumented)
 └──────────┴──────────┴───────────┘           011 - TR3
                           100 - TR4
                           101 - TR5
                           110 - TR6
                           111 - TR7

  NOP/XCHG AX,AX - нет операции
 ┌────────────────┐
 │1 0 0 1 0 0 0 0 │
 └────────────────┘

  WAIT - ожидание
 ┌────────────────┐
 │1 0 0 1 1 0 1 1 │
 └────────────────┘

  Команды сопроцессора
 ┌────────────────┬────────────────┐
 │1 1 0 1 1 x x x │mod yyy reg/mem │
 └────────────────┴────────────────┘
 xxx и yyy разряды кода операции для сопроцессора

 ────────────────────────────────────────────────────────────────────────────

  Байты префикса

  Префикс размера - 16/32 bit
 ┌────────────────┐
 │0 1 1 0 0 1 1 x │  x=0 - величины операнда , x=1 - адресной величины
 └────────────────┘

  LOCK - Префикс захвата шины
 ┌────────────────┐
 │1 1 1 1 0 0 0 0 │
 └────────────────┘

  Префикс заменяющего сегмента    xx = 00 - ES
 ┌────────────────┐            01 - CS
 │0 0 1 x x 1 1 0 │            10 - SS
 └────────────────┘            11 - DS

  Префикс заменяющего сегмента
 ┌────────────────┐
 │0 1 1 0 0 1 0 x │  x=0 - FS , x=1 - GS
 └────────────────┘

  Префиксы повторения  (Счетчик повторений в CX)
 ┌────────────────┐
 │1 1 1 1 0 0 1 x │  x=0 - REPNZ/REP , x=1 - REPZ
 └────────────────┘

 ────────────────────────────────────────────────────────────────────────────

   Управление заSHITой

  ARPL ─ коррекция Requested Privilege Level
 ┌────────────────┬────────────────┐
 │0 1 1 0 0 0 1 1 │mod reg reg/mem │
 └────────────────┴────────────────┘

  Загрузка из дескриптора сегмента
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 0000001x │mod reg r/m│
 └──────────┴──────────┴───────────┘
  x=0 - LAR ─ загрузить права доступа
  x=1 - LSL ─ загрузить предел сегмента




  LGDT/SGDT ─ загрузить/сохранить глобальную дескрипторную таблицу
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 00000001 │mod 0x0 r/m│  x=0 - SGDT , x=1 - LGDT
 └──────────┴──────────┴───────────┘

  LIDT/SIDT ─ загрузить/сохранить таблицу прерываний
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 00000001 │mod 0x1 r/m│  x=0 - SIDT , x=1 - LIDT
 └──────────┴──────────┴───────────┘

  LLDT/SLDT ─ загрузить/сохранить локальную дескрипторную таблицу
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 00000000 │mod 0x0 r/m│  x=0 - SLDT , x=1 - LLDT
 └──────────┴──────────┴───────────┘

  LMSW/SMSW ─ загрузить/сохранить состояния машиты
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 00000001 │mod 1x0 r/m│  x=0 - SMSW , x=1 - LMSW
 └──────────┴──────────┴───────────┘

  LTR/STR ─ загрузить/сохранить регистр работы
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 00000000 │mod 0x1 r/m│  x=0 - STR , x=1 - LTR
 └──────────┴──────────┴───────────┘

  VERR/VERW ─ проверить на доступ
 ┌──────────┬──────────┬───────────┐
 │ 00001111 │ 00000000 │mod 10x r/m│
 └──────────┴──────────┴───────────┘
  x=0 - VERR - по чтению
  x=1 - VERW - по записи

 ────────────────────────────────────────────────────────────────────────────
  Copyright Intel Corp.
  Edited [DaemonSerJ] ,August'98

</span></div></body>
</html>
