Imports System
Imports System.Collections.Generic
Imports System.Net
Imports System.Net.NetworkInformation

Namespace Complex
	' Token: 0x02000012 RID: 18
	Public Class NetScan
		' Token: 0x06000063 RID: 99 RVA: 0x00009064 File Offset: 0x00007264
		Public Shared Function scan(subnet As String) As List(Of String)
			Dim list As List(Of String) = New List(Of String)()
			For i As Integer = 1 To 255 - 1
				Dim str As String = "." + i.ToString()
				Dim ping As Ping = New Ping()
				Dim pingReply As PingReply = ping.Send(subnet + str, 900)
				If pingReply.Status = IPStatus.Success Then
					Try
						Dim address As IPAddress = IPAddress.Parse(subnet + str)
						Dim hostEntry As IPHostEntry = Dns.GetHostEntry(address)
						list.Add(subnet + str)
					Catch
					End Try
				End If
			Next
			Return list
		End Function
	End Class
End Namespace
