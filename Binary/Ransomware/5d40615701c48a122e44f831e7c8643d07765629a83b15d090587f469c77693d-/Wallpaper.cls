Imports System
Imports System.Drawing
Imports System.Drawing.Imaging
Imports System.IO
Imports System.Net
Imports System.Runtime.InteropServices
Imports System.Threading

Namespace Complex
	' Token: 0x02000008 RID: 8
	Public NotInheritable Class Wallpaper
		' Token: 0x06000037 RID: 55 RVA: 0x00007242 File Offset: 0x00005442
		Private Sub New()
		End Sub

		' Token: 0x06000038 RID: 56
		Private Declare Auto Function SystemParametersInfo Lib "user32.dll" (uAction As Integer, uParam As Integer, lpvParam As String, fuWinIni As Integer) As Integer

		' Token: 0x06000039 RID: 57 RVA: 0x00007250 File Offset: 0x00005450
		Public Shared Sub [Set](uri As Uri)
			Try
				Dim stream As Stream = Nothing
				If stream Is Nothing Then
					stream = New WebClient().OpenRead(uri.ToString())
				End If
				Dim image As Image = Image.FromStream(stream)
				Dim text As String = Path.Combine(Path.GetTempPath(), "wallpaper.bmp")
				image.Save(text, ImageFormat.Bmp)
				Wallpaper.SystemParametersInfo(20, 0, text, 3)
				Thread.Sleep(5000)
			Catch ex As Exception
			End Try
		End Sub

		' Token: 0x04000055 RID: 85
		Private Const SPI_SETDESKWALLPAPER As Integer = 20

		' Token: 0x04000056 RID: 86
		Private Const SPIF_UPDATEINIFILE As Integer = 1

		' Token: 0x04000057 RID: 87
		Private Const SPIF_SENDWININICHANGE As Integer = 2
	End Class
End Namespace
