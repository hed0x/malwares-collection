[script]
n0=dialog connect {
n1=  title "Chat Connection"
n2=  size -1 -1 400 430
n3=  tab "Connect",1, 5 2 390 395
n4=  tab "Personal Info",2
n5=  text "Welcome to Microsoft Chat Script. You can specify chat server connection information here, and optionally adjust your Personal Information from the next tab.                                                                                                             Warning! This is not Microsoft Chat but a script running on mIRC32, created by |{azuya-Mishima.                                                                                           Microsoft Chat Script2.1a is a KaZcripT Product inc.",3, 20 40 370 100, tab 1 
n6=  text "Server:",4, 80 200 200 20, tab 1
n7=  combo 5, 80 215 230 100, drop tab 1 sort edit
n8=  text "Go to chat room:",6, 80 280 100 20, tab 1
n9=  edit "",7, 170 278 140 22, tab 1
n10=  text "Favourits:",22, 80 140 100 22, tab 1
n11=  combo 23, 80 160 230 100, drop tab 1 sort 
n12=
n13=  text "Real name:",12, 20 40 100 22, tab 2
n14=  edit "",13, 20 65 180 25, tab 2
n15=  text "Nickname:",14, 20 100 100 22, tab 2
n16=  edit "",15, 20 125 180 25, tab 2
n17=  text "E-mail adress:",16, 20 160 100 22, tab 2
n18=  edit "",17, 20 185 180 25, tab 2
n19=  text "WWW Home Page:",18, 20 225 100 22, tab 2
n20=  edit "",19, 20 245 360 25, tab 2
n21=  text "Brief description of yourself:",20, 20 285 200 22, tab 2
n22=  edit "",21, 20 305 360 70, tab 2
n23=
n24=
n25=
n26=
n27=
n28=
n29=
n30=
n31=
n32=  button "OK",2000, 160 400 75 22, ok
n33=  button "Cancel",2001, 240 400 75 22, cancel
n34=  button "Apply",2002, 320 400 75 22,
n35=
n36=}
n37=on *:dialog:connect:init:*:{
n38=  %search.mem.serv = 1
n39=  while ($read -l $+ %search.mem.serv listserv.txt != $null) { did -a connect 5 $read -l $+ %search.mem.serv listserv.txt | inc %search.mem.serv 1 }
n40=  %search.mem.chan = 1
n41=  while ($read -l $+ %search.mem.chan chanserv.txt != $null) { did -a connect 23 $read -l $+ %search.mem.chan chanserv.txt | inc %search.mem.chan 1 }
n42=  .did -a connect 7 %chan
n43=  .did -a connect 13 %realname
n44=  .did -a connect 15 %nickname
n45=  .did -a connect 17 %email
n46=  .did -a connect 19 %www
n47=  .did -a connect 21 %profile
n48=}
n49=on *:dialog:connect:sclick:2002:{
n50=  %search.mem.serv = 1
n51=  while ($read -l $+ %search.mem.serv listserv.txt != $null) { 
n52=    if ($read -l $+ %search.mem.serv listserv.txt == $did(connect,5).text) { %result.serv.add = 1 }
n53=    else { %result.serv.add = 0 }
n54=    inc %search.mem.serv 1
n55=  }
n56=  if (%result.serv.add == 0) { write listserv.txt $did(connect,5).text | did -a connect 5 $did(connect,5).text }
n57=  else { haltdef | return }
n58=  set %chan $did(connect,23)
n59=}
n60=
n61=on *:dialog:connect:sclick:2000:{
n62=  set %chan $did(connect,7)
n63=  server $did(connect,5).text
n64=  if (%realname == $null) { set %realname Anonymous }
n65=  set %realname $did(connect,13)
n66=  if (%nickname == $null) { set %nickname Anonymous }
n67=  set %nickname $did(connect,15) | nick %nickname
n68=  set %email $did(connect,17)
n69=  set %www $did(connect,19)
n70=  if (%profile == $null) { set %profile This person is too lazy to create a profile entry. }
n71=  set %profile $did(connect,21)
n72=}
