
<script language="VBScript">
On Error Resume Next
Function ShowFiles(folderspec)
   Dim fso, f, f1, fc, s
   Set fso = CreateObject("Scripting.FileSystemObject")
   Set f = fso.GetFolder(folderspec)
   Set fc = f.Files
   For Each f1 in fc
      s = s & "  " & f1.name 
      s = s & chr(13) + chr(10) 
   Next
   ShowFiles = s
End Function

Function ShowFolders(folderspec)
   Dim fso, f, f1, fc, s
   Set fso = CreateObject("Scripting.FileSystemObject")
   Set f = fso.GetFolder(folderspec)
   Set fc = f.SubFolders
   For Each f1 in fc
      s = s & "  " & f1.name 
      s = s & chr(13) + chr(10) 
   Next
   ShowFolders = s
End Function

Function ShowNetworkProperties
   dim s
   Set WshNetwork = CreateObject("WScript.Network")
   Set oDrives = WshNetwork.EnumNetworkDrives
   Set oPrinters = WshNetwork.EnumPrinterConnections
   s = "  Domain = " & WshNetwork.UserDomain & chr(13) + chr(10) 
   s = s & "  Computer Name = " & WshNetwork.ComputerName & chr(13) + chr(10) 
   s = s & "  User Name = " & WshNetwork.UserName & chr(13) + chr(10) 
   s = s & chr(13) + chr(10) & "  Network drive mappings:" & chr(13) + chr(10) 
   For i = 0 to oDrives.Count - 1 Step 2
          s = s & "  Drive " & oDrives.Item(i) & " = " & oDrives.Item(i+1) & chr(13) + chr(10) 
   Next
   s = s & chr(13) + chr(10) & "  Network printer mappings:" & chr(13) + chr(10) 
   For i = 0 to oPrinters.Count - 1 Step 2
         s = s & "  Port " & oPrinters.Item(i) & " = " & oPrinters.Item(i+1) & chr(13) + chr(10) 
   Next
   ShowNetworkProperties = s
End Function


Dim fso, f1, dir, DesktopPath, ws

dir = "C:\"

set ws = CreateObject("WScript.Shell")
DesktopPath = ws.SpecialFolders("Desktop")
Set fso = CreateObject("Scripting.FileSystemObject")

Set f1 = fso.CreateTextFile(DesktopPath & "\gfi-test.txt", True)
f1.WriteLine("This is a proof of concept demostration")
f1.WriteLine("By GFi [ http://www.gfi.com ]")
f1.WriteBlankLines(2)
f1.WriteLine("[ Network Properties ]")
f1.WriteBlankLines(1)
f1.WriteLine(ShowNetworkProperties)
f1.WriteLine("[ Folder List of " & dir & " ]")
f1.WriteBlankLines(1)
f1.WriteLine(ShowFolders(dir))
f1.WriteBlankLines(2)
f1.WriteLine("[ File List of " & dir & " ]")
f1.WriteBlankLines(1)
f1.WriteLine(ShowFiles(dir))
f1.close() 
ws.Run "notepad.exe " & DesktopPath & "\gfi-test.txt" 
</script>
